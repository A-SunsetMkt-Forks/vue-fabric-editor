var qh=Object.defineProperty,Zh=Object.defineProperties;var tf=Object.getOwnPropertyDescriptors;var ea=Object.getOwnPropertySymbols;var ef=Object.prototype.hasOwnProperty,nf=Object.prototype.propertyIsEnumerable;var Vn=(e,t)=>{if(t=Symbol[e])return t;throw Error("Symbol."+e+" is not defined")},Wn=Math.pow,xr=(e,t,n)=>t in e?qh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,pt=(e,t)=>{for(var n in t||(t={}))ef.call(t,n)&&xr(e,n,t[n]);if(ea)for(var n of ea(t))nf.call(t,n)&&xr(e,n,t[n]);return e},Ft=(e,t)=>Zh(e,tf(t));var X=(e,t,n)=>(xr(e,typeof t!="symbol"?t+"":t,n),n);var _t=(e,t,n)=>new Promise((o,g)=>{var A=i=>{try{f(n.next(i))}catch(c){g(c)}},v=i=>{try{f(n.throw(i))}catch(c){g(c)}},f=i=>i.done?o(i.value):Promise.resolve(i.value).then(A,v);f((n=n.apply(e,t)).next())}),Cn=function(e,t){this[0]=e,this[1]=t},na=(e,t,n)=>{var o=(v,f,i,c)=>{try{var l=n[v](f),r=(f=l.value)instanceof Cn,a=l.done;Promise.resolve(r?f[0]:f).then(s=>r?o(v==="return"?v:"next",f[1]?{done:s.done,value:s.value}:s,i,c):i({value:s,done:a})).catch(s=>o("throw",s,i,c))}catch(s){c(s)}},g=v=>A[v]=f=>new Promise((i,c)=>o(v,f,i,c)),A={};return n=n.apply(e,t),A[Symbol.asyncIterator]=()=>A,g("next"),g("throw"),g("return"),A},ia=e=>{var t=e[Vn("asyncIterator")],n=!1,o,g={};return t==null?(t=e[Vn("iterator")](),o=A=>g[A]=v=>t[A](v)):(t=t.call(e),o=A=>g[A]=v=>{if(n){if(n=!1,A==="throw")throw v;return v}return n=!0,{done:!1,value:new Cn(new Promise(f=>{var i=t[A](v);if(!(i instanceof Object))throw TypeError("Object expected");f(i)}),1)}}),g[Vn("iterator")]=()=>g,o("next"),"throw"in t?o("throw"):g.throw=A=>{throw A},"return"in t&&o("return"),g},ra=(e,t,n)=>(t=e[Vn("asyncIterator")])?t.call(e):(e=e[Vn("iterator")](),t={},n=(o,g)=>(g=e[o])&&(t[o]=A=>new Promise((v,f,i)=>(A=g.call(e,A),i=A.done,Promise.resolve(A.value).then(c=>v({value:c,done:i}),f)))),n("next"),n("return"),t);import{i as fn,c as hc,g as ar,u as Ne,a as fc,v as Bt,r as ft,b as z,o as Z,d as wt,w as L,e as M,t as gt,f as O,h as T,j as Vt,k as vt,l as ut,F as Pt,m as Gt,n as bt,p as hn,q as rf,s as sf,x as of,y as af,z as Qt,A as lr,B as ye,C as ie,D as ge,E as zt,G as lf,H as Ct,I as te,J as ee,K as co,L as cf,M as uf,N as de,O as me,P as Ae,Q as we,R as Xt,S as dc,T as Ci,U as Wi,V as hf,W as ff,X as df,Y as gf,Z as Br,_ as pf,$ as Af}from"./index.109d8677.js";function kt(){const e=fn("fabric"),t=fn("canvasEditor"),n=fn("mixinState");return{fabric:e,canvasEditor:t,mixinState:n}}var gc={exports:{}};(function(e,t){(function(n,o){e.exports=o()})(hc,function(){var n=1e3,o=6e4,g=36e5,A="millisecond",v="second",f="minute",i="hour",c="day",l="week",r="month",a="quarter",s="year",u="date",d="Invalid Date",h=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,p=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,m={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(W){var G=["th","st","nd","rd"],V=W%100;return"["+W+(G[(V-20)%10]||G[V]||G[0])+"]"}},y=function(W,G,V){var st=String(W);return!st||st.length>=G?W:""+Array(G+1-st.length).join(V)+W},_={s:y,z:function(W){var G=-W.utcOffset(),V=Math.abs(G),st=Math.floor(V/60),et=V%60;return(G<=0?"+":"-")+y(st,2,"0")+":"+y(et,2,"0")},m:function W(G,V){if(G.date()<V.date())return-W(V,G);var st=12*(V.year()-G.year())+(V.month()-G.month()),et=G.clone().add(st,r),x=V-et<0,B=G.clone().add(st+(x?-1:1),r);return+(-(st+(V-et)/(x?et-B:B-et))||0)},a:function(W){return W<0?Math.ceil(W)||0:Math.floor(W)},p:function(W){return{M:r,y:s,w:l,d:c,D:u,h:i,m:f,s:v,ms:A,Q:a}[W]||String(W||"").toLowerCase().replace(/s$/,"")},u:function(W){return W===void 0}},C="en",w={};w[C]=m;var b="$isDayjsObject",S=function(W){return W instanceof R||!(!W||!W[b])},F=function W(G,V,st){var et;if(!G)return C;if(typeof G=="string"){var x=G.toLowerCase();w[x]&&(et=x),V&&(w[x]=V,et=x);var B=G.split("-");if(!et&&B.length>1)return W(B[0])}else{var k=G.name;w[k]=G,et=k}return!st&&et&&(C=et),et||!st&&C},$=function(W,G){if(S(W))return W.clone();var V=typeof G=="object"?G:{};return V.date=W,V.args=arguments,new R(V)},Q=_;Q.l=F,Q.i=S,Q.w=function(W,G){return $(W,{locale:G.$L,utc:G.$u,x:G.$x,$offset:G.$offset})};var R=function(){function W(V){this.$L=F(V.locale,null,!0),this.parse(V),this.$x=this.$x||V.x||{},this[b]=!0}var G=W.prototype;return G.parse=function(V){this.$d=function(st){var et=st.date,x=st.utc;if(et===null)return new Date(NaN);if(Q.u(et))return new Date;if(et instanceof Date)return new Date(et);if(typeof et=="string"&&!/Z$/i.test(et)){var B=et.match(h);if(B){var k=B[2]-1||0,D=(B[7]||"0").substring(0,3);return x?new Date(Date.UTC(B[1],k,B[3]||1,B[4]||0,B[5]||0,B[6]||0,D)):new Date(B[1],k,B[3]||1,B[4]||0,B[5]||0,B[6]||0,D)}}return new Date(et)}(V),this.init()},G.init=function(){var V=this.$d;this.$y=V.getFullYear(),this.$M=V.getMonth(),this.$D=V.getDate(),this.$W=V.getDay(),this.$H=V.getHours(),this.$m=V.getMinutes(),this.$s=V.getSeconds(),this.$ms=V.getMilliseconds()},G.$utils=function(){return Q},G.isValid=function(){return this.$d.toString()!==d},G.isSame=function(V,st){var et=$(V);return this.startOf(st)<=et&&et<=this.endOf(st)},G.isAfter=function(V,st){return $(V)<this.startOf(st)},G.isBefore=function(V,st){return this.endOf(st)<$(V)},G.$g=function(V,st,et){return Q.u(V)?this[st]:this.set(et,V)},G.unix=function(){return Math.floor(this.valueOf()/1e3)},G.valueOf=function(){return this.$d.getTime()},G.startOf=function(V,st){var et=this,x=!!Q.u(st)||st,B=Q.p(V),k=function(J,rt){var lt=Q.w(et.$u?Date.UTC(et.$y,rt,J):new Date(et.$y,rt,J),et);return x?lt:lt.endOf(c)},D=function(J,rt){return Q.w(et.toDate()[J].apply(et.toDate("s"),(x?[0,0,0,0]:[23,59,59,999]).slice(rt)),et)},Y=this.$W,I=this.$M,E=this.$D,P="set"+(this.$u?"UTC":"");switch(B){case s:return x?k(1,0):k(31,11);case r:return x?k(1,I):k(0,I+1);case l:var N=this.$locale().weekStart||0,q=(Y<N?Y+7:Y)-N;return k(x?E-q:E+(6-q),I);case c:case u:return D(P+"Hours",0);case i:return D(P+"Minutes",1);case f:return D(P+"Seconds",2);case v:return D(P+"Milliseconds",3);default:return this.clone()}},G.endOf=function(V){return this.startOf(V,!1)},G.$set=function(V,st){var et,x=Q.p(V),B="set"+(this.$u?"UTC":""),k=(et={},et[c]=B+"Date",et[u]=B+"Date",et[r]=B+"Month",et[s]=B+"FullYear",et[i]=B+"Hours",et[f]=B+"Minutes",et[v]=B+"Seconds",et[A]=B+"Milliseconds",et)[x],D=x===c?this.$D+(st-this.$W):st;if(x===r||x===s){var Y=this.clone().set(u,1);Y.$d[k](D),Y.init(),this.$d=Y.set(u,Math.min(this.$D,Y.daysInMonth())).$d}else k&&this.$d[k](D);return this.init(),this},G.set=function(V,st){return this.clone().$set(V,st)},G.get=function(V){return this[Q.p(V)]()},G.add=function(V,st){var et,x=this;V=Number(V);var B=Q.p(st),k=function(I){var E=$(x);return Q.w(E.date(E.date()+Math.round(I*V)),x)};if(B===r)return this.set(r,this.$M+V);if(B===s)return this.set(s,this.$y+V);if(B===c)return k(1);if(B===l)return k(7);var D=(et={},et[f]=o,et[i]=g,et[v]=n,et)[B]||1,Y=this.$d.getTime()+V*D;return Q.w(Y,this)},G.subtract=function(V,st){return this.add(-1*V,st)},G.format=function(V){var st=this,et=this.$locale();if(!this.isValid())return et.invalidDate||d;var x=V||"YYYY-MM-DDTHH:mm:ssZ",B=Q.z(this),k=this.$H,D=this.$m,Y=this.$M,I=et.weekdays,E=et.months,P=et.meridiem,N=function(rt,lt,dt,U){return rt&&(rt[lt]||rt(st,x))||dt[lt].slice(0,U)},q=function(rt){return Q.s(k%12||12,rt,"0")},J=P||function(rt,lt,dt){var U=rt<12?"AM":"PM";return dt?U.toLowerCase():U};return x.replace(p,function(rt,lt){return lt||function(dt){switch(dt){case"YY":return String(st.$y).slice(-2);case"YYYY":return Q.s(st.$y,4,"0");case"M":return Y+1;case"MM":return Q.s(Y+1,2,"0");case"MMM":return N(et.monthsShort,Y,E,3);case"MMMM":return N(E,Y);case"D":return st.$D;case"DD":return Q.s(st.$D,2,"0");case"d":return String(st.$W);case"dd":return N(et.weekdaysMin,st.$W,I,2);case"ddd":return N(et.weekdaysShort,st.$W,I,3);case"dddd":return I[st.$W];case"H":return String(k);case"HH":return Q.s(k,2,"0");case"h":return q(1);case"hh":return q(2);case"a":return J(k,D,!0);case"A":return J(k,D,!1);case"m":return String(D);case"mm":return Q.s(D,2,"0");case"s":return String(st.$s);case"ss":return Q.s(st.$s,2,"0");case"SSS":return Q.s(st.$ms,3,"0");case"Z":return B}return null}(rt)||B.replace(":","")})},G.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},G.diff=function(V,st,et){var x,B=this,k=Q.p(st),D=$(V),Y=(D.utcOffset()-this.utcOffset())*o,I=this-D,E=function(){return Q.m(B,D)};switch(k){case s:x=E()/12;break;case r:x=E();break;case a:x=E()/3;break;case l:x=(I-Y)/6048e5;break;case c:x=(I-Y)/864e5;break;case i:x=I/g;break;case f:x=I/o;break;case v:x=I/n;break;default:x=I}return et?x:Q.a(x)},G.daysInMonth=function(){return this.endOf(r).$D},G.$locale=function(){return w[this.$L]},G.locale=function(V,st){if(!V)return this.$L;var et=this.clone(),x=F(V,st,!0);return x&&(et.$L=x),et},G.clone=function(){return Q.w(this.$d,this)},G.toDate=function(){return new Date(this.valueOf())},G.toJSON=function(){return this.isValid()?this.toISOString():null},G.toISOString=function(){return this.$d.toISOString()},G.toString=function(){return this.$d.toUTCString()},W}(),H=R.prototype;return $.prototype=H,[["$ms",A],["$s",v],["$m",f],["$H",i],["$W",c],["$M",r],["$y",s],["$D",u]].forEach(function(W){H[W[1]]=function(G){return this.$g(G,W[0],W[1])}}),$.extend=function(W,G){return W.$i||(W(G,R,$),W.$i=!0),$},$.locale=F,$.isDayjs=S,$.unix=function(W){return $(1e3*W)},$.en=w[C],$.Ls=w,$.p={},$})})(gc);var mf=gc.exports;const sa=ar(mf);function pc(e,t){return function(){return e.apply(t,arguments)}}const{toString:vf}=Object.prototype,{getPrototypeOf:uo}=Object,cr=(e=>t=>{const n=vf.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Ie=e=>(e=e.toLowerCase(),t=>cr(t)===e),ur=e=>t=>typeof t===e,{isArray:Un}=Array,ai=ur("undefined");function yf(e){return e!==null&&!ai(e)&&e.constructor!==null&&!ai(e.constructor)&&ve(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Ac=Ie("ArrayBuffer");function _f(e){let t;return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Ac(e.buffer),t}const Cf=ur("string"),ve=ur("function"),mc=ur("number"),hr=e=>e!==null&&typeof e=="object",wf=e=>e===!0||e===!1,Mi=e=>{if(cr(e)!=="object")return!1;const t=uo(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},bf=Ie("Date"),Sf=Ie("File"),Ef=Ie("Blob"),If=Ie("FileList"),xf=e=>hr(e)&&ve(e.pipe),Bf=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||ve(e.append)&&((t=cr(e))==="formdata"||t==="object"&&ve(e.toString)&&e.toString()==="[object FormData]"))},Tf=Ie("URLSearchParams"),[Of,kf,Df,Mf]=["ReadableStream","Request","Response","Headers"].map(Ie),Pf=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function pi(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e=="undefined")return;let o,g;if(typeof e!="object"&&(e=[e]),Un(e))for(o=0,g=e.length;o<g;o++)t.call(null,e[o],o,e);else{const A=n?Object.getOwnPropertyNames(e):Object.keys(e),v=A.length;let f;for(o=0;o<v;o++)f=A[o],t.call(null,e[f],f,e)}}function vc(e,t){t=t.toLowerCase();const n=Object.keys(e);let o=n.length,g;for(;o-- >0;)if(g=n[o],t===g.toLowerCase())return g;return null}const yc=(()=>typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:global)(),_c=e=>!ai(e)&&e!==yc;function hs(){const{caseless:e}=_c(this)&&this||{},t={},n=(o,g)=>{const A=e&&vc(t,g)||g;Mi(t[A])&&Mi(o)?t[A]=hs(t[A],o):Mi(o)?t[A]=hs({},o):Un(o)?t[A]=o.slice():t[A]=o};for(let o=0,g=arguments.length;o<g;o++)arguments[o]&&pi(arguments[o],n);return t}const Qf=(e,t,n,{allOwnKeys:o}={})=>(pi(t,(g,A)=>{n&&ve(g)?e[A]=pc(g,n):e[A]=g},{allOwnKeys:o}),e),Lf=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Ff=(e,t,n,o)=>{e.prototype=Object.create(t.prototype,o),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},Rf=(e,t,n,o)=>{let g,A,v;const f={};if(t=t||{},e==null)return t;do{for(g=Object.getOwnPropertyNames(e),A=g.length;A-- >0;)v=g[A],(!o||o(v,e,t))&&!f[v]&&(t[v]=e[v],f[v]=!0);e=n!==!1&&uo(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},jf=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const o=e.indexOf(t,n);return o!==-1&&o===n},$f=e=>{if(!e)return null;if(Un(e))return e;let t=e.length;if(!mc(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},Nf=(e=>t=>e&&t instanceof e)(typeof Uint8Array!="undefined"&&uo(Uint8Array)),Uf=(e,t)=>{const o=(e&&e[Symbol.iterator]).call(e);let g;for(;(g=o.next())&&!g.done;){const A=g.value;t.call(e,A[0],A[1])}},Hf=(e,t)=>{let n;const o=[];for(;(n=e.exec(t))!==null;)o.push(n);return o},Gf=Ie("HTMLFormElement"),zf=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,o,g){return o.toUpperCase()+g}),oa=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),Yf=Ie("RegExp"),Cc=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),o={};pi(n,(g,A)=>{let v;(v=t(g,A,e))!==!1&&(o[A]=v||g)}),Object.defineProperties(e,o)},Vf=e=>{Cc(e,(t,n)=>{if(ve(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const o=e[n];if(ve(o)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},Wf=(e,t)=>{const n={},o=g=>{g.forEach(A=>{n[A]=!0})};return Un(e)?o(e):o(String(e).split(t)),n},Xf=()=>{},Jf=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t,Tr="abcdefghijklmnopqrstuvwxyz",aa="0123456789",wc={DIGIT:aa,ALPHA:Tr,ALPHA_DIGIT:Tr+Tr.toUpperCase()+aa},Kf=(e=16,t=wc.ALPHA_DIGIT)=>{let n="";const{length:o}=t;for(;e--;)n+=t[Math.random()*o|0];return n};function qf(e){return!!(e&&ve(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const Zf=e=>{const t=new Array(10),n=(o,g)=>{if(hr(o)){if(t.indexOf(o)>=0)return;if(!("toJSON"in o)){t[g]=o;const A=Un(o)?[]:{};return pi(o,(v,f)=>{const i=n(v,g+1);!ai(i)&&(A[f]=i)}),t[g]=void 0,A}}return o};return n(e,0)},td=Ie("AsyncFunction"),ed=e=>e&&(hr(e)||ve(e))&&ve(e.then)&&ve(e.catch),ot={isArray:Un,isArrayBuffer:Ac,isBuffer:yf,isFormData:Bf,isArrayBufferView:_f,isString:Cf,isNumber:mc,isBoolean:wf,isObject:hr,isPlainObject:Mi,isReadableStream:Of,isRequest:kf,isResponse:Df,isHeaders:Mf,isUndefined:ai,isDate:bf,isFile:Sf,isBlob:Ef,isRegExp:Yf,isFunction:ve,isStream:xf,isURLSearchParams:Tf,isTypedArray:Nf,isFileList:If,forEach:pi,merge:hs,extend:Qf,trim:Pf,stripBOM:Lf,inherits:Ff,toFlatObject:Rf,kindOf:cr,kindOfTest:Ie,endsWith:jf,toArray:$f,forEachEntry:Uf,matchAll:Hf,isHTMLForm:Gf,hasOwnProperty:oa,hasOwnProp:oa,reduceDescriptors:Cc,freezeMethods:Vf,toObjectSet:Wf,toCamelCase:zf,noop:Xf,toFiniteNumber:Jf,findKey:vc,global:yc,isContextDefined:_c,ALPHABET:wc,generateString:Kf,isSpecCompliantForm:qf,toJSONObject:Zf,isAsyncFn:td,isThenable:ed};function It(e,t,n,o,g){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),o&&(this.request=o),g&&(this.response=g)}ot.inherits(It,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ot.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const bc=It.prototype,Sc={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Sc[e]={value:e}});Object.defineProperties(It,Sc);Object.defineProperty(bc,"isAxiosError",{value:!0});It.from=(e,t,n,o,g,A)=>{const v=Object.create(bc);return ot.toFlatObject(e,v,function(i){return i!==Error.prototype},f=>f!=="isAxiosError"),It.call(v,e.message,t,n,o,g),v.cause=e,v.name=e.name,A&&Object.assign(v,A),v};const nd=null;function fs(e){return ot.isPlainObject(e)||ot.isArray(e)}function Ec(e){return ot.endsWith(e,"[]")?e.slice(0,-2):e}function la(e,t,n){return e?e.concat(t).map(function(g,A){return g=Ec(g),!n&&A?"["+g+"]":g}).join(n?".":""):t}function id(e){return ot.isArray(e)&&!e.some(fs)}const rd=ot.toFlatObject(ot,{},null,function(t){return/^is[A-Z]/.test(t)});function fr(e,t,n){if(!ot.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=ot.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(d,h){return!ot.isUndefined(h[d])});const o=n.metaTokens,g=n.visitor||l,A=n.dots,v=n.indexes,i=(n.Blob||typeof Blob!="undefined"&&Blob)&&ot.isSpecCompliantForm(t);if(!ot.isFunction(g))throw new TypeError("visitor must be a function");function c(u){if(u===null)return"";if(ot.isDate(u))return u.toISOString();if(!i&&ot.isBlob(u))throw new It("Blob is not supported. Use a Buffer instead.");return ot.isArrayBuffer(u)||ot.isTypedArray(u)?i&&typeof Blob=="function"?new Blob([u]):Buffer.from(u):u}function l(u,d,h){let p=u;if(u&&!h&&typeof u=="object"){if(ot.endsWith(d,"{}"))d=o?d:d.slice(0,-2),u=JSON.stringify(u);else if(ot.isArray(u)&&id(u)||(ot.isFileList(u)||ot.endsWith(d,"[]"))&&(p=ot.toArray(u)))return d=Ec(d),p.forEach(function(y,_){!(ot.isUndefined(y)||y===null)&&t.append(v===!0?la([d],_,A):v===null?d:d+"[]",c(y))}),!1}return fs(u)?!0:(t.append(la(h,d,A),c(u)),!1)}const r=[],a=Object.assign(rd,{defaultVisitor:l,convertValue:c,isVisitable:fs});function s(u,d){if(!ot.isUndefined(u)){if(r.indexOf(u)!==-1)throw Error("Circular reference detected in "+d.join("."));r.push(u),ot.forEach(u,function(p,m){(!(ot.isUndefined(p)||p===null)&&g.call(t,p,ot.isString(m)?m.trim():m,d,a))===!0&&s(p,d?d.concat(m):[m])}),r.pop()}}if(!ot.isObject(e))throw new TypeError("data must be an object");return s(e),t}function ca(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(o){return t[o]})}function ho(e,t){this._pairs=[],e&&fr(e,this,t)}const Ic=ho.prototype;Ic.append=function(t,n){this._pairs.push([t,n])};Ic.toString=function(t){const n=t?function(o){return t.call(this,o,ca)}:ca;return this._pairs.map(function(g){return n(g[0])+"="+n(g[1])},"").join("&")};function sd(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function xc(e,t,n){if(!t)return e;const o=n&&n.encode||sd,g=n&&n.serialize;let A;if(g?A=g(t,n):A=ot.isURLSearchParams(t)?t.toString():new ho(t,n).toString(o),A){const v=e.indexOf("#");v!==-1&&(e=e.slice(0,v)),e+=(e.indexOf("?")===-1?"?":"&")+A}return e}class od{constructor(){this.handlers=[]}use(t,n,o){return this.handlers.push({fulfilled:t,rejected:n,synchronous:o?o.synchronous:!1,runWhen:o?o.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){ot.forEach(this.handlers,function(o){o!==null&&t(o)})}}const ua=od,Bc={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},ad=typeof URLSearchParams!="undefined"?URLSearchParams:ho,ld=typeof FormData!="undefined"?FormData:null,cd=typeof Blob!="undefined"?Blob:null,ud={isBrowser:!0,classes:{URLSearchParams:ad,FormData:ld,Blob:cd},protocols:["http","https","file","blob","url","data"]},fo=typeof window!="undefined"&&typeof document!="undefined",hd=(e=>fo&&["ReactNative","NativeScript","NS"].indexOf(e)<0)(typeof navigator!="undefined"&&navigator.product),fd=(()=>typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),dd=fo&&window.location.href||"http://localhost",gd=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:fo,hasStandardBrowserEnv:hd,hasStandardBrowserWebWorkerEnv:fd,origin:dd},Symbol.toStringTag,{value:"Module"})),be=pt(pt({},gd),ud);function pd(e,t){return fr(e,new be.classes.URLSearchParams,Object.assign({visitor:function(n,o,g,A){return be.isNode&&ot.isBuffer(n)?(this.append(o,n.toString("base64")),!1):A.defaultVisitor.apply(this,arguments)}},t))}function Ad(e){return ot.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function md(e){const t={},n=Object.keys(e);let o;const g=n.length;let A;for(o=0;o<g;o++)A=n[o],t[A]=e[A];return t}function Tc(e){function t(n,o,g,A){let v=n[A++];if(v==="__proto__")return!0;const f=Number.isFinite(+v),i=A>=n.length;return v=!v&&ot.isArray(g)?g.length:v,i?(ot.hasOwnProp(g,v)?g[v]=[g[v],o]:g[v]=o,!f):((!g[v]||!ot.isObject(g[v]))&&(g[v]=[]),t(n,o,g[v],A)&&ot.isArray(g[v])&&(g[v]=md(g[v])),!f)}if(ot.isFormData(e)&&ot.isFunction(e.entries)){const n={};return ot.forEachEntry(e,(o,g)=>{t(Ad(o),g,n,0)}),n}return null}function vd(e,t,n){if(ot.isString(e))try{return(t||JSON.parse)(e),ot.trim(e)}catch(o){if(o.name!=="SyntaxError")throw o}return(n||JSON.stringify)(e)}const go={transitional:Bc,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const o=n.getContentType()||"",g=o.indexOf("application/json")>-1,A=ot.isObject(t);if(A&&ot.isHTMLForm(t)&&(t=new FormData(t)),ot.isFormData(t))return g?JSON.stringify(Tc(t)):t;if(ot.isArrayBuffer(t)||ot.isBuffer(t)||ot.isStream(t)||ot.isFile(t)||ot.isBlob(t)||ot.isReadableStream(t))return t;if(ot.isArrayBufferView(t))return t.buffer;if(ot.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let f;if(A){if(o.indexOf("application/x-www-form-urlencoded")>-1)return pd(t,this.formSerializer).toString();if((f=ot.isFileList(t))||o.indexOf("multipart/form-data")>-1){const i=this.env&&this.env.FormData;return fr(f?{"files[]":t}:t,i&&new i,this.formSerializer)}}return A||g?(n.setContentType("application/json",!1),vd(t)):t}],transformResponse:[function(t){const n=this.transitional||go.transitional,o=n&&n.forcedJSONParsing,g=this.responseType==="json";if(ot.isResponse(t)||ot.isReadableStream(t))return t;if(t&&ot.isString(t)&&(o&&!this.responseType||g)){const v=!(n&&n.silentJSONParsing)&&g;try{return JSON.parse(t)}catch(f){if(v)throw f.name==="SyntaxError"?It.from(f,It.ERR_BAD_RESPONSE,this,null,this.response):f}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:be.classes.FormData,Blob:be.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ot.forEach(["delete","get","head","post","put","patch"],e=>{go.headers[e]={}});const po=go,yd=ot.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),_d=e=>{const t={};let n,o,g;return e&&e.split(`
`).forEach(function(v){g=v.indexOf(":"),n=v.substring(0,g).trim().toLowerCase(),o=v.substring(g+1).trim(),!(!n||t[n]&&yd[n])&&(n==="set-cookie"?t[n]?t[n].push(o):t[n]=[o]:t[n]=t[n]?t[n]+", "+o:o)}),t},ha=Symbol("internals");function Xn(e){return e&&String(e).trim().toLowerCase()}function Pi(e){return e===!1||e==null?e:ot.isArray(e)?e.map(Pi):String(e)}function Cd(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let o;for(;o=n.exec(e);)t[o[1]]=o[2];return t}const wd=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Or(e,t,n,o,g){if(ot.isFunction(o))return o.call(this,t,n);if(g&&(t=n),!!ot.isString(t)){if(ot.isString(o))return t.indexOf(o)!==-1;if(ot.isRegExp(o))return o.test(t)}}function bd(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,o)=>n.toUpperCase()+o)}function Sd(e,t){const n=ot.toCamelCase(" "+t);["get","set","has"].forEach(o=>{Object.defineProperty(e,o+n,{value:function(g,A,v){return this[o].call(this,t,g,A,v)},configurable:!0})})}class dr{constructor(t){t&&this.set(t)}set(t,n,o){const g=this;function A(f,i,c){const l=Xn(i);if(!l)throw new Error("header name must be a non-empty string");const r=ot.findKey(g,l);(!r||g[r]===void 0||c===!0||c===void 0&&g[r]!==!1)&&(g[r||i]=Pi(f))}const v=(f,i)=>ot.forEach(f,(c,l)=>A(c,l,i));if(ot.isPlainObject(t)||t instanceof this.constructor)v(t,n);else if(ot.isString(t)&&(t=t.trim())&&!wd(t))v(_d(t),n);else if(ot.isHeaders(t))for(const[f,i]of t.entries())A(i,f,o);else t!=null&&A(n,t,o);return this}get(t,n){if(t=Xn(t),t){const o=ot.findKey(this,t);if(o){const g=this[o];if(!n)return g;if(n===!0)return Cd(g);if(ot.isFunction(n))return n.call(this,g,o);if(ot.isRegExp(n))return n.exec(g);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=Xn(t),t){const o=ot.findKey(this,t);return!!(o&&this[o]!==void 0&&(!n||Or(this,this[o],o,n)))}return!1}delete(t,n){const o=this;let g=!1;function A(v){if(v=Xn(v),v){const f=ot.findKey(o,v);f&&(!n||Or(o,o[f],f,n))&&(delete o[f],g=!0)}}return ot.isArray(t)?t.forEach(A):A(t),g}clear(t){const n=Object.keys(this);let o=n.length,g=!1;for(;o--;){const A=n[o];(!t||Or(this,this[A],A,t,!0))&&(delete this[A],g=!0)}return g}normalize(t){const n=this,o={};return ot.forEach(this,(g,A)=>{const v=ot.findKey(o,A);if(v){n[v]=Pi(g),delete n[A];return}const f=t?bd(A):String(A).trim();f!==A&&delete n[A],n[f]=Pi(g),o[f]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return ot.forEach(this,(o,g)=>{o!=null&&o!==!1&&(n[g]=t&&ot.isArray(o)?o.join(", "):o)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const o=new this(t);return n.forEach(g=>o.set(g)),o}static accessor(t){const o=(this[ha]=this[ha]={accessors:{}}).accessors,g=this.prototype;function A(v){const f=Xn(v);o[f]||(Sd(g,v),o[f]=!0)}return ot.isArray(t)?t.forEach(A):A(t),this}}dr.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ot.reduceDescriptors(dr.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(o){this[n]=o}}});ot.freezeMethods(dr);const Se=dr;function kr(e,t){const n=this||po,o=t||n,g=Se.from(o.headers);let A=o.data;return ot.forEach(e,function(f){A=f.call(n,A,g.normalize(),t?t.status:void 0)}),g.normalize(),A}function Oc(e){return!!(e&&e.__CANCEL__)}function Hn(e,t,n){It.call(this,e==null?"canceled":e,It.ERR_CANCELED,t,n),this.name="CanceledError"}ot.inherits(Hn,It,{__CANCEL__:!0});function kc(e,t,n){const o=n.config.validateStatus;!n.status||!o||o(n.status)?e(n):t(new It("Request failed with status code "+n.status,[It.ERR_BAD_REQUEST,It.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function Ed(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function Id(e,t){e=e||10;const n=new Array(e),o=new Array(e);let g=0,A=0,v;return t=t!==void 0?t:1e3,function(i){const c=Date.now(),l=o[A];v||(v=c),n[g]=i,o[g]=c;let r=A,a=0;for(;r!==g;)a+=n[r++],r=r%e;if(g=(g+1)%e,g===A&&(A=(A+1)%e),c-v<t)return;const s=l&&c-l;return s?Math.round(a*1e3/s):void 0}}function xd(e,t){let n=0;const o=1e3/t;let g=null;return function(){const v=this===!0,f=Date.now();if(v||f-n>o)return g&&(clearTimeout(g),g=null),n=f,e.apply(null,arguments);g||(g=setTimeout(()=>(g=null,n=Date.now(),e.apply(null,arguments)),o-(f-n)))}}const Xi=(e,t,n=3)=>{let o=0;const g=Id(50,250);return xd(A=>{const v=A.loaded,f=A.lengthComputable?A.total:void 0,i=v-o,c=g(i),l=v<=f;o=v;const r={loaded:v,total:f,progress:f?v/f:void 0,bytes:i,rate:c||void 0,estimated:c&&f&&l?(f-v)/c:void 0,event:A,lengthComputable:f!=null};r[t?"download":"upload"]=!0,e(r)},n)},Bd=be.hasStandardBrowserEnv?function(){const t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");let o;function g(A){let v=A;return t&&(n.setAttribute("href",v),v=n.href),n.setAttribute("href",v),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:n.pathname.charAt(0)==="/"?n.pathname:"/"+n.pathname}}return o=g(window.location.href),function(v){const f=ot.isString(v)?g(v):v;return f.protocol===o.protocol&&f.host===o.host}}():function(){return function(){return!0}}(),Td=be.hasStandardBrowserEnv?{write(e,t,n,o,g,A){const v=[e+"="+encodeURIComponent(t)];ot.isNumber(n)&&v.push("expires="+new Date(n).toGMTString()),ot.isString(o)&&v.push("path="+o),ot.isString(g)&&v.push("domain="+g),A===!0&&v.push("secure"),document.cookie=v.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Od(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function kd(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Dc(e,t){return e&&!Od(t)?kd(e,t):t}const fa=e=>e instanceof Se?pt({},e):e;function pn(e,t){t=t||{};const n={};function o(c,l,r){return ot.isPlainObject(c)&&ot.isPlainObject(l)?ot.merge.call({caseless:r},c,l):ot.isPlainObject(l)?ot.merge({},l):ot.isArray(l)?l.slice():l}function g(c,l,r){if(ot.isUndefined(l)){if(!ot.isUndefined(c))return o(void 0,c,r)}else return o(c,l,r)}function A(c,l){if(!ot.isUndefined(l))return o(void 0,l)}function v(c,l){if(ot.isUndefined(l)){if(!ot.isUndefined(c))return o(void 0,c)}else return o(void 0,l)}function f(c,l,r){if(r in t)return o(c,l);if(r in e)return o(void 0,c)}const i={url:A,method:A,data:A,baseURL:v,transformRequest:v,transformResponse:v,paramsSerializer:v,timeout:v,timeoutMessage:v,withCredentials:v,withXSRFToken:v,adapter:v,responseType:v,xsrfCookieName:v,xsrfHeaderName:v,onUploadProgress:v,onDownloadProgress:v,decompress:v,maxContentLength:v,maxBodyLength:v,beforeRedirect:v,transport:v,httpAgent:v,httpsAgent:v,cancelToken:v,socketPath:v,responseEncoding:v,validateStatus:f,headers:(c,l)=>g(fa(c),fa(l),!0)};return ot.forEach(Object.keys(Object.assign({},e,t)),function(l){const r=i[l]||g,a=r(e[l],t[l],l);ot.isUndefined(a)&&r!==f||(n[l]=a)}),n}const Mc=e=>{const t=pn({},e);let{data:n,withXSRFToken:o,xsrfHeaderName:g,xsrfCookieName:A,headers:v,auth:f}=t;t.headers=v=Se.from(v),t.url=xc(Dc(t.baseURL,t.url),e.params,e.paramsSerializer),f&&v.set("Authorization","Basic "+btoa((f.username||"")+":"+(f.password?unescape(encodeURIComponent(f.password)):"")));let i;if(ot.isFormData(n)){if(be.hasStandardBrowserEnv||be.hasStandardBrowserWebWorkerEnv)v.setContentType(void 0);else if((i=v.getContentType())!==!1){const[c,...l]=i?i.split(";").map(r=>r.trim()).filter(Boolean):[];v.setContentType([c||"multipart/form-data",...l].join("; "))}}if(be.hasStandardBrowserEnv&&(o&&ot.isFunction(o)&&(o=o(t)),o||o!==!1&&Bd(t.url))){const c=g&&A&&Td.read(A);c&&v.set(g,c)}return t},Dd=typeof XMLHttpRequest!="undefined",Md=Dd&&function(e){return new Promise(function(n,o){const g=Mc(e);let A=g.data;const v=Se.from(g.headers).normalize();let{responseType:f}=g,i;function c(){g.cancelToken&&g.cancelToken.unsubscribe(i),g.signal&&g.signal.removeEventListener("abort",i)}let l=new XMLHttpRequest;l.open(g.method.toUpperCase(),g.url,!0),l.timeout=g.timeout;function r(){if(!l)return;const s=Se.from("getAllResponseHeaders"in l&&l.getAllResponseHeaders()),d={data:!f||f==="text"||f==="json"?l.responseText:l.response,status:l.status,statusText:l.statusText,headers:s,config:e,request:l};kc(function(p){n(p),c()},function(p){o(p),c()},d),l=null}"onloadend"in l?l.onloadend=r:l.onreadystatechange=function(){!l||l.readyState!==4||l.status===0&&!(l.responseURL&&l.responseURL.indexOf("file:")===0)||setTimeout(r)},l.onabort=function(){l&&(o(new It("Request aborted",It.ECONNABORTED,g,l)),l=null)},l.onerror=function(){o(new It("Network Error",It.ERR_NETWORK,g,l)),l=null},l.ontimeout=function(){let u=g.timeout?"timeout of "+g.timeout+"ms exceeded":"timeout exceeded";const d=g.transitional||Bc;g.timeoutErrorMessage&&(u=g.timeoutErrorMessage),o(new It(u,d.clarifyTimeoutError?It.ETIMEDOUT:It.ECONNABORTED,g,l)),l=null},A===void 0&&v.setContentType(null),"setRequestHeader"in l&&ot.forEach(v.toJSON(),function(u,d){l.setRequestHeader(d,u)}),ot.isUndefined(g.withCredentials)||(l.withCredentials=!!g.withCredentials),f&&f!=="json"&&(l.responseType=g.responseType),typeof g.onDownloadProgress=="function"&&l.addEventListener("progress",Xi(g.onDownloadProgress,!0)),typeof g.onUploadProgress=="function"&&l.upload&&l.upload.addEventListener("progress",Xi(g.onUploadProgress)),(g.cancelToken||g.signal)&&(i=s=>{l&&(o(!s||s.type?new Hn(null,e,l):s),l.abort(),l=null)},g.cancelToken&&g.cancelToken.subscribe(i),g.signal&&(g.signal.aborted?i():g.signal.addEventListener("abort",i)));const a=Ed(g.url);if(a&&be.protocols.indexOf(a)===-1){o(new It("Unsupported protocol "+a+":",It.ERR_BAD_REQUEST,e));return}l.send(A||null)})},Pd=(e,t)=>{let n=new AbortController,o;const g=function(i){if(!o){o=!0,v();const c=i instanceof Error?i:this.reason;n.abort(c instanceof It?c:new Hn(c instanceof Error?c.message:c))}};let A=t&&setTimeout(()=>{g(new It(`timeout ${t} of ms exceeded`,It.ETIMEDOUT))},t);const v=()=>{e&&(A&&clearTimeout(A),A=null,e.forEach(i=>{i&&(i.removeEventListener?i.removeEventListener("abort",g):i.unsubscribe(g))}),e=null)};e.forEach(i=>i&&i.addEventListener&&i.addEventListener("abort",g));const{signal:f}=n;return f.unsubscribe=v,[f,()=>{A&&clearTimeout(A),A=null}]},Qd=Pd,Ld=function*(e,t){let n=e.byteLength;if(!t||n<t){yield e;return}let o=0,g;for(;o<n;)g=o+t,yield e.slice(o,g),o=g},Fd=function(e,t,n){return na(this,null,function*(){try{for(var o=ra(e),g,A,v;g=!(A=yield new Cn(o.next())).done;g=!1){const f=A.value;yield*ia(Ld(ArrayBuffer.isView(f)?f:yield new Cn(n(String(f))),t))}}catch(A){v=[A]}finally{try{g&&(A=o.return)&&(yield new Cn(A.call(o)))}finally{if(v)throw v[0]}}})},da=(e,t,n,o,g)=>{const A=Fd(e,t,g);let v=0;return new ReadableStream({type:"bytes",pull(i){return _t(this,null,function*(){const{done:c,value:l}=yield A.next();if(c){i.close(),o();return}let r=l.byteLength;n&&n(v+=r),i.enqueue(new Uint8Array(l))})},cancel(i){return o(i),A.return()}},{highWaterMark:2})},ga=(e,t)=>{const n=e!=null;return o=>setTimeout(()=>t({lengthComputable:n,total:e,loaded:o}))},gr=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Pc=gr&&typeof ReadableStream=="function",ds=gr&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):e=>_t(void 0,null,function*(){return new Uint8Array(yield new Response(e).arrayBuffer())})),Rd=Pc&&(()=>{let e=!1;const t=new Request(be.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t})(),pa=64*1024,gs=Pc&&!!(()=>{try{return ot.isReadableStream(new Response("").body)}catch(e){}})(),Ji={stream:gs&&(e=>e.body)};gr&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!Ji[t]&&(Ji[t]=ot.isFunction(e[t])?n=>n[t]():(n,o)=>{throw new It(`Response type '${t}' is not supported`,It.ERR_NOT_SUPPORT,o)})})})(new Response);const jd=e=>_t(void 0,null,function*(){if(e==null)return 0;if(ot.isBlob(e))return e.size;if(ot.isSpecCompliantForm(e))return(yield new Request(e).arrayBuffer()).byteLength;if(ot.isArrayBufferView(e))return e.byteLength;if(ot.isURLSearchParams(e)&&(e=e+""),ot.isString(e))return(yield ds(e)).byteLength}),$d=(e,t)=>_t(void 0,null,function*(){const n=ot.toFiniteNumber(e.getContentLength());return n==null?jd(t):n}),Nd=gr&&(e=>_t(void 0,null,function*(){let{url:t,method:n,data:o,signal:g,cancelToken:A,timeout:v,onDownloadProgress:f,onUploadProgress:i,responseType:c,headers:l,withCredentials:r="same-origin",fetchOptions:a}=Mc(e);c=c?(c+"").toLowerCase():"text";let[s,u]=g||A||v?Qd([g,A],v):[],d,h;const p=()=>{!d&&setTimeout(()=>{s&&s.unsubscribe()}),d=!0};let m;try{if(i&&Rd&&n!=="get"&&n!=="head"&&(m=yield $d(l,o))!==0){let w=new Request(t,{method:"POST",body:o,duplex:"half"}),b;ot.isFormData(o)&&(b=w.headers.get("content-type"))&&l.setContentType(b),w.body&&(o=da(w.body,pa,ga(m,Xi(i)),null,ds))}ot.isString(r)||(r=r?"cors":"omit"),h=new Request(t,Ft(pt({},a),{signal:s,method:n.toUpperCase(),headers:l.normalize().toJSON(),body:o,duplex:"half",withCredentials:r}));let y=yield fetch(h);const _=gs&&(c==="stream"||c==="response");if(gs&&(f||_)){const w={};["status","statusText","headers"].forEach(S=>{w[S]=y[S]});const b=ot.toFiniteNumber(y.headers.get("content-length"));y=new Response(da(y.body,pa,f&&ga(b,Xi(f,!0)),_&&p,ds),w)}c=c||"text";let C=yield Ji[ot.findKey(Ji,c)||"text"](y,e);return!_&&p(),u&&u(),yield new Promise((w,b)=>{kc(w,b,{data:C,headers:Se.from(y.headers),status:y.status,statusText:y.statusText,config:e,request:h})})}catch(y){throw p(),y&&y.name==="TypeError"&&/fetch/i.test(y.message)?Object.assign(new It("Network Error",It.ERR_NETWORK,e,h),{cause:y.cause||y}):It.from(y,y&&y.code,e,h)}})),ps={http:nd,xhr:Md,fetch:Nd};ot.forEach(ps,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(n){}Object.defineProperty(e,"adapterName",{value:t})}});const Aa=e=>`- ${e}`,Ud=e=>ot.isFunction(e)||e===null||e===!1,Qc={getAdapter:e=>{e=ot.isArray(e)?e:[e];const{length:t}=e;let n,o;const g={};for(let A=0;A<t;A++){n=e[A];let v;if(o=n,!Ud(n)&&(o=ps[(v=String(n)).toLowerCase()],o===void 0))throw new It(`Unknown adapter '${v}'`);if(o)break;g[v||"#"+A]=o}if(!o){const A=Object.entries(g).map(([f,i])=>`adapter ${f} `+(i===!1?"is not supported by the environment":"is not available in the build"));let v=t?A.length>1?`since :
`+A.map(Aa).join(`
`):" "+Aa(A[0]):"as no adapter specified";throw new It("There is no suitable adapter to dispatch the request "+v,"ERR_NOT_SUPPORT")}return o},adapters:ps};function Dr(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Hn(null,e)}function ma(e){return Dr(e),e.headers=Se.from(e.headers),e.data=kr.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Qc.getAdapter(e.adapter||po.adapter)(e).then(function(o){return Dr(e),o.data=kr.call(e,e.transformResponse,o),o.headers=Se.from(o.headers),o},function(o){return Oc(o)||(Dr(e),o&&o.response&&(o.response.data=kr.call(e,e.transformResponse,o.response),o.response.headers=Se.from(o.response.headers))),Promise.reject(o)})}const Lc="1.7.2",Ao={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Ao[e]=function(o){return typeof o===e||"a"+(t<1?"n ":" ")+e}});const va={};Ao.transitional=function(t,n,o){function g(A,v){return"[Axios v"+Lc+"] Transitional option '"+A+"'"+v+(o?". "+o:"")}return(A,v,f)=>{if(t===!1)throw new It(g(v," has been removed"+(n?" in "+n:"")),It.ERR_DEPRECATED);return n&&!va[v]&&(va[v]=!0,console.warn(g(v," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(A,v,f):!0}};function Hd(e,t,n){if(typeof e!="object")throw new It("options must be an object",It.ERR_BAD_OPTION_VALUE);const o=Object.keys(e);let g=o.length;for(;g-- >0;){const A=o[g],v=t[A];if(v){const f=e[A],i=f===void 0||v(f,A,e);if(i!==!0)throw new It("option "+A+" must be "+i,It.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new It("Unknown option "+A,It.ERR_BAD_OPTION)}}const As={assertOptions:Hd,validators:Ao},Ze=As.validators;class Ki{constructor(t){this.defaults=t,this.interceptors={request:new ua,response:new ua}}request(t,n){return _t(this,null,function*(){try{return yield this._request(t,n)}catch(o){if(o instanceof Error){let g;Error.captureStackTrace?Error.captureStackTrace(g={}):g=new Error;const A=g.stack?g.stack.replace(/^.+\n/,""):"";try{o.stack?A&&!String(o.stack).endsWith(A.replace(/^.+\n.+\n/,""))&&(o.stack+=`
`+A):o.stack=A}catch(v){}}throw o}})}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=pn(this.defaults,n);const{transitional:o,paramsSerializer:g,headers:A}=n;o!==void 0&&As.assertOptions(o,{silentJSONParsing:Ze.transitional(Ze.boolean),forcedJSONParsing:Ze.transitional(Ze.boolean),clarifyTimeoutError:Ze.transitional(Ze.boolean)},!1),g!=null&&(ot.isFunction(g)?n.paramsSerializer={serialize:g}:As.assertOptions(g,{encode:Ze.function,serialize:Ze.function},!0)),n.method=(n.method||this.defaults.method||"get").toLowerCase();let v=A&&ot.merge(A.common,A[n.method]);A&&ot.forEach(["delete","get","head","post","put","patch","common"],u=>{delete A[u]}),n.headers=Se.concat(v,A);const f=[];let i=!0;this.interceptors.request.forEach(function(d){typeof d.runWhen=="function"&&d.runWhen(n)===!1||(i=i&&d.synchronous,f.unshift(d.fulfilled,d.rejected))});const c=[];this.interceptors.response.forEach(function(d){c.push(d.fulfilled,d.rejected)});let l,r=0,a;if(!i){const u=[ma.bind(this),void 0];for(u.unshift.apply(u,f),u.push.apply(u,c),a=u.length,l=Promise.resolve(n);r<a;)l=l.then(u[r++],u[r++]);return l}a=f.length;let s=n;for(r=0;r<a;){const u=f[r++],d=f[r++];try{s=u(s)}catch(h){d.call(this,h);break}}try{l=ma.call(this,s)}catch(u){return Promise.reject(u)}for(r=0,a=c.length;r<a;)l=l.then(c[r++],c[r++]);return l}getUri(t){t=pn(this.defaults,t);const n=Dc(t.baseURL,t.url);return xc(n,t.params,t.paramsSerializer)}}ot.forEach(["delete","get","head","options"],function(t){Ki.prototype[t]=function(n,o){return this.request(pn(o||{},{method:t,url:n,data:(o||{}).data}))}});ot.forEach(["post","put","patch"],function(t){function n(o){return function(A,v,f){return this.request(pn(f||{},{method:t,headers:o?{"Content-Type":"multipart/form-data"}:{},url:A,data:v}))}}Ki.prototype[t]=n(),Ki.prototype[t+"Form"]=n(!0)});const Qi=Ki;class mo{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(A){n=A});const o=this;this.promise.then(g=>{if(!o._listeners)return;let A=o._listeners.length;for(;A-- >0;)o._listeners[A](g);o._listeners=null}),this.promise.then=g=>{let A;const v=new Promise(f=>{o.subscribe(f),A=f}).then(g);return v.cancel=function(){o.unsubscribe(A)},v},t(function(A,v,f){o.reason||(o.reason=new Hn(A,v,f),n(o.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}static source(){let t;return{token:new mo(function(g){t=g}),cancel:t}}}const Gd=mo;function zd(e){return function(n){return e.apply(null,n)}}function Yd(e){return ot.isObject(e)&&e.isAxiosError===!0}const ms={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(ms).forEach(([e,t])=>{ms[t]=e});const Vd=ms;function Fc(e){const t=new Qi(e),n=pc(Qi.prototype.request,t);return ot.extend(n,Qi.prototype,t,{allOwnKeys:!0}),ot.extend(n,t,null,{allOwnKeys:!0}),n.create=function(g){return Fc(pn(e,g))},n}const Zt=Fc(po);Zt.Axios=Qi;Zt.CanceledError=Hn;Zt.CancelToken=Gd;Zt.isCancel=Oc;Zt.VERSION=Lc;Zt.toFormData=fr;Zt.AxiosError=It;Zt.Cancel=Zt.CanceledError;Zt.all=function(t){return Promise.all(t)};Zt.spread=zd;Zt.isAxiosError=Yd;Zt.mergeConfig=pn;Zt.AxiosHeaders=Se;Zt.formToJSON=e=>Tc(ot.isHTMLForm(e)?new FormData(e):e);Zt.getAdapter=Qc.getAdapter;Zt.HttpStatusCode=Vd;Zt.default=Zt;const Ce=Zt,Wd="https://www.kuaitu.cc",pe=Ce.create({baseURL:Wd});pe.interceptors.request.use(function(e){const t=Xd();return t&&(e.headers.Authorization=`Bearer ${t}`),e});const vo="token";function Xd(){return localStorage.getItem(vo)}const Jd=e=>pe.get("/api/users/me",e),Kd=e=>pe.post("/api/auth/local",e),qd=e=>pe.post("/api/auth/local/register",e),ya=()=>localStorage.setItem(vo,""),_a=e=>localStorage.setItem(vo,e),Rc=e=>pe.get("/api/user-materials?populate=*",e),jc=e=>pe.post("/api/upload",e),Zd=e=>pe.post("/api/user-materials",e),tg=e=>pe.delete("/api/user-materials/"+e),Ca=e=>pe.post("/api/user-templs",e),eg=e=>pe.delete(`/api/user-templs/${e}`),ng=(e,t)=>pe.put(`/api/user-templs/${e}`,t),ig=e=>pe.get(`/api/user-templs?${e}`),rg=e=>pe.get(`/api/user-templs/${e}`);function pr(){const{t:e}=Ne(),t=fc(),n=fn("canvasEditor"),o=(r,a)=>_t(this,null,function*(){n.clear(),n.setSize(r,a);const s=sa().format("YYYY[年]MM[月]DD[日]HH[小时]mm[分钟]ss[秒]")+"创建的作品",u=yield A();return yield Ca({data:Ft(pt({},u),{name:s})})}),g=()=>_t(this,null,function*(){const r=sa().format("YYYY[年]MM[月]DD[日]HH[小时]mm[分钟]ss[秒]")+"创建的作品",a=yield A();return yield Ca({data:Ft(pt({},a),{name:r})})}),A=()=>_t(this,null,function*(){const r=n.getJson(),a=yield v();return{json:r,img:a.id,desc:""}}),v=()=>_t(this,null,function*(){const r=(d,h)=>{for(var p=d.split(","),m=p[0].match(/:(.*?);/)[1],y=atob(p[1]),_=y.length,C=new Uint8Array(_);_--;)C[_]=y.charCodeAt(_);return new File([C],h,{type:m})},a=d=>{const h=r(d,"123.png"),p=new FormData,m=new Date;return p.append("files",h,`${m.getTime()}`),jc(p).then(y=>{const[_]=y.data;return _}).catch(y=>{console.log(y)})},s=yield n.preview();return yield a(s)});return{createTmpl:o,createTmplByCommon:g,getTemplInfo:r=>_t(this,null,function*(){return(yield rg(r)).data}),updataTemplInfo:(r,a)=>_t(this,null,function*(){const s=yield A();a&&(s.name=a),yield ng(r,{data:s})}),removeTemplInfo:r=>new Promise((a,s)=>{Bt.Modal.confirm({title:e("my_spase.remove_templ"),content:`<p>${e("my_spase.remove_templTip")}</p>`,onOk:()=>{eg(r).then(a).catch(s)}})}),routerToId:r=>{t.replace("/?id="+r)}}}const xt=(e,t)=>{const n=e.__vccOpts||e;for(const[o,g]of t)n[o]=g;return n},sg=bt({name:"ImportJson"}),og=Object.assign(sg,{props:{title:{type:String,default:""}},emits:["set"],setup(e,{expose:t,emit:n}){const{canvasEditor:o}=kt(),g=n,A=e,v=ft(!1),f=ft(null),i=ft(null),c=ft([]),l=(s,u)=>{f.value=s||null,i.value=u||null,o.getSizeList().then(d=>{c.value=d}),v.value=!0},r=s=>{const[u,d]=s.split("x");f.value=Number(u),i.value=Number(d)},a=()=>_t(this,null,function*(){f.value&&i.value?(g("set",f.value,i.value),v.value=!1):Bt.Message.warning("请检查尺寸")});return t({showSetSize:l}),(s,u)=>{const d=z("InputNumber"),h=z("FormItem"),p=z("Button"),m=z("Form"),y=z("Divider"),_=z("Icon"),C=z("Cell"),w=z("CellGroup"),b=z("Modal");return Z(),wt(b,{modelValue:T(v),"onUpdate:modelValue":u[2]||(u[2]=S=>Vt(v)?v.value=S:null),title:A.title,"footer-hide":""},{default:L(()=>[M("h3",null,gt(s.$t("importFiles.createDesign.customSize")),1),O(m,{ref:"formInline",inline:"","label-width":40},{default:L(()=>[O(h,{label:"宽度"},{default:L(()=>[O(d,{modelValue:T(f),"onUpdate:modelValue":u[0]||(u[0]=S=>Vt(f)?f.value=S:null),min:1,placeholder:"请输入"},null,8,["modelValue"])]),_:1}),O(h,{label:"高度"},{default:L(()=>[O(d,{modelValue:T(i),"onUpdate:modelValue":u[1]||(u[1]=S=>Vt(i)?i.value=S:null),min:1,placeholder:"请输入"},null,8,["modelValue"])]),_:1}),O(h,{"label-width":0},{default:L(()=>[O(p,{type:"primary",onClick:a},{default:L(()=>[vt(gt(s.$t("importFiles.createDesign.create")),1)]),_:1})]),_:1})]),_:1},512),O(y,{class:"divider"}),M("h3",null,gt(s.$t("importFiles.createDesign.systemSize")),1),O(w,{onOnClick:r},{default:L(()=>[(Z(!0),ut(Pt,null,Gt(T(c),S=>(Z(),wt(C,{title:S.name,label:`${S.width}x${S.height}${S.unit}`,arrow:!1,key:S.name,name:`${S.width}x${S.height}x${S.unit}`},{extra:L(()=>[O(_,{type:"md-add"})]),_:2},1032,["title","label","name"]))),128))]),_:1})]),_:1},8,["modelValue","title"])}}}),$c=xt(og,[["__scopeId","data-v-5e2a9b02"]]);const ag={style:{display:"inline-block"}},lg={href:"javascript:void(0)"},cg=bt({name:"ImportJson"}),ug=Object.assign(cg,{setup(e){const{t}=Ne(),{canvasEditor:n}=kt(),{createTmpl:o,routerToId:g}=pr(),A=ft(null),v=c=>{var r;const l={importFiles:n.insert,createDesign:f,psd:()=>{Bt.Spin.show({render:a=>a("div",t("alert.loading_data"))}),n.insertPSD().finally(Bt.Spin.hide)}};(r=l[c])==null||r.call(l)},f=()=>{A.value.showSetSize()},i=(c,l)=>_t(this,null,function*(){const r=yield o(c,l);g(r.data.data.id),Bt.Message.success("创建成功")});return(c,l)=>{const r=z("Icon"),a=z("DropdownItem"),s=z("DropdownMenu"),u=z("Dropdown");return Z(),ut("div",ag,[O(u,{onOnClick:v},{list:L(()=>[O(s,null,{default:L(()=>[O(a,{name:"createDesign"},{default:L(()=>[vt(gt(c.$t("importFiles.createDesign.title")),1)]),_:1}),O(a,{name:"importFiles"},{default:L(()=>[vt(gt(c.$t("importFiles.importFiles")),1)]),_:1}),O(a,{name:"psd"},{default:L(()=>[vt("PSD")]),_:1})]),_:1})]),default:L(()=>[M("a",lg,[vt(gt(c.$t("importFiles.file"))+" ",1),O(r,{type:"ios-arrow-down"})])]),_:1}),O(T($c),{title:c.$t("importFiles.createDesign.title"),ref_key:"modalSizeRef",ref:A,onSet:i},null,8,["title"])])}}}),hg=xt(ug,[["__scopeId","data-v-c81617f2"]]);var yo={exports:{}},kn=typeof Reflect=="object"?Reflect:null,wa=kn&&typeof kn.apply=="function"?kn.apply:function(t,n,o){return Function.prototype.apply.call(t,n,o)},Li;kn&&typeof kn.ownKeys=="function"?Li=kn.ownKeys:Object.getOwnPropertySymbols?Li=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Li=function(t){return Object.getOwnPropertyNames(t)};function fg(e){console&&console.warn&&console.warn(e)}var Nc=Number.isNaN||function(t){return t!==t};function Rt(){Rt.init.call(this)}yo.exports=Rt;yo.exports.once=Ag;Rt.EventEmitter=Rt;Rt.prototype._events=void 0;Rt.prototype._eventsCount=0;Rt.prototype._maxListeners=void 0;var ba=10;function Ar(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(Rt,"defaultMaxListeners",{enumerable:!0,get:function(){return ba},set:function(e){if(typeof e!="number"||e<0||Nc(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");ba=e}});Rt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Rt.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||Nc(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function Uc(e){return e._maxListeners===void 0?Rt.defaultMaxListeners:e._maxListeners}Rt.prototype.getMaxListeners=function(){return Uc(this)};Rt.prototype.emit=function(t){for(var n=[],o=1;o<arguments.length;o++)n.push(arguments[o]);var g=t==="error",A=this._events;if(A!==void 0)g=g&&A.error===void 0;else if(!g)return!1;if(g){var v;if(n.length>0&&(v=n[0]),v instanceof Error)throw v;var f=new Error("Unhandled error."+(v?" ("+v.message+")":""));throw f.context=v,f}var i=A[t];if(i===void 0)return!1;if(typeof i=="function")wa(i,this,n);else for(var c=i.length,l=Vc(i,c),o=0;o<c;++o)wa(l[o],this,n);return!0};function Hc(e,t,n,o){var g,A,v;if(Ar(n),A=e._events,A===void 0?(A=e._events=Object.create(null),e._eventsCount=0):(A.newListener!==void 0&&(e.emit("newListener",t,n.listener?n.listener:n),A=e._events),v=A[t]),v===void 0)v=A[t]=n,++e._eventsCount;else if(typeof v=="function"?v=A[t]=o?[n,v]:[v,n]:o?v.unshift(n):v.push(n),g=Uc(e),g>0&&v.length>g&&!v.warned){v.warned=!0;var f=new Error("Possible EventEmitter memory leak detected. "+v.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");f.name="MaxListenersExceededWarning",f.emitter=e,f.type=t,f.count=v.length,fg(f)}return e}Rt.prototype.addListener=function(t,n){return Hc(this,t,n,!1)};Rt.prototype.on=Rt.prototype.addListener;Rt.prototype.prependListener=function(t,n){return Hc(this,t,n,!0)};function dg(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Gc(e,t,n){var o={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},g=dg.bind(o);return g.listener=n,o.wrapFn=g,g}Rt.prototype.once=function(t,n){return Ar(n),this.on(t,Gc(this,t,n)),this};Rt.prototype.prependOnceListener=function(t,n){return Ar(n),this.prependListener(t,Gc(this,t,n)),this};Rt.prototype.removeListener=function(t,n){var o,g,A,v,f;if(Ar(n),g=this._events,g===void 0)return this;if(o=g[t],o===void 0)return this;if(o===n||o.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete g[t],g.removeListener&&this.emit("removeListener",t,o.listener||n));else if(typeof o!="function"){for(A=-1,v=o.length-1;v>=0;v--)if(o[v]===n||o[v].listener===n){f=o[v].listener,A=v;break}if(A<0)return this;A===0?o.shift():gg(o,A),o.length===1&&(g[t]=o[0]),g.removeListener!==void 0&&this.emit("removeListener",t,f||n)}return this};Rt.prototype.off=Rt.prototype.removeListener;Rt.prototype.removeAllListeners=function(t){var n,o,g;if(o=this._events,o===void 0)return this;if(o.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):o[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete o[t]),this;if(arguments.length===0){var A=Object.keys(o),v;for(g=0;g<A.length;++g)v=A[g],v!=="removeListener"&&this.removeAllListeners(v);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=o[t],typeof n=="function")this.removeListener(t,n);else if(n!==void 0)for(g=n.length-1;g>=0;g--)this.removeListener(t,n[g]);return this};function zc(e,t,n){var o=e._events;if(o===void 0)return[];var g=o[t];return g===void 0?[]:typeof g=="function"?n?[g.listener||g]:[g]:n?pg(g):Vc(g,g.length)}Rt.prototype.listeners=function(t){return zc(this,t,!0)};Rt.prototype.rawListeners=function(t){return zc(this,t,!1)};Rt.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):Yc.call(e,t)};Rt.prototype.listenerCount=Yc;function Yc(e){var t=this._events;if(t!==void 0){var n=t[e];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}Rt.prototype.eventNames=function(){return this._eventsCount>0?Li(this._events):[]};function Vc(e,t){for(var n=new Array(t),o=0;o<t;++o)n[o]=e[o];return n}function gg(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function pg(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}function Ag(e,t){return new Promise(function(n,o){function g(v){e.removeListener(t,A),o(v)}function A(){typeof e.removeListener=="function"&&e.removeListener("error",g),n([].slice.call(arguments))}Wc(e,t,A,{once:!0}),t!=="error"&&mg(e,g,{once:!0})})}function mg(e,t,n){typeof e.on=="function"&&Wc(e,"error",t,n)}function Wc(e,t,n,o){if(typeof e.on=="function")o.once?e.once(t,n):e.on(t,n);else if(typeof e.addEventListener=="function")e.addEventListener(t,function g(A){o.once&&e.removeEventListener(t,g),n(A)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}var vg=yo.exports;const yg=ar(vg),Mr=typeof navigator!="undefined"?navigator.userAgent.toLowerCase().indexOf("firefox")>0:!1;function Pr(e,t,n,o){e.addEventListener?e.addEventListener(t,n,o):e.attachEvent&&e.attachEvent("on".concat(t),n)}function Jn(e,t,n,o){e.removeEventListener?e.removeEventListener(t,n,o):e.detachEvent&&e.detachEvent("on".concat(t),n)}function Xc(e,t){const n=t.slice(0,t.length-1);for(let o=0;o<n.length;o++)n[o]=e[n[o].toLowerCase()];return n}function Jc(e){typeof e!="string"&&(e=""),e=e.replace(/\s/g,"");const t=e.split(",");let n=t.lastIndexOf("");for(;n>=0;)t[n-1]+=",",t.splice(n,1),n=t.lastIndexOf("");return t}function _g(e,t){const n=e.length>=t.length?e:t,o=e.length>=t.length?t:e;let g=!0;for(let A=0;A<n.length;A++)o.indexOf(n[A])===-1&&(g=!1);return g}const li={backspace:8,"⌫":8,tab:9,clear:12,enter:13,"↩":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"⇪":20,",":188,".":190,"/":191,"`":192,"-":Mr?173:189,"=":Mr?61:187,";":Mr?59:186,"'":222,"[":219,"]":221,"\\":220},Le={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,cmd:91,command:91},vs={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},ae={16:!1,18:!1,17:!1,91:!1},Wt={};for(let e=1;e<20;e++)li["f".concat(e)]=111+e;let Ut=[],ti=null,Kc="all";const ze=new Map,Ai=e=>li[e.toLowerCase()]||Le[e.toLowerCase()]||e.toUpperCase().charCodeAt(0),Cg=e=>Object.keys(li).find(t=>li[t]===e),wg=e=>Object.keys(Le).find(t=>Le[t]===e);function qc(e){Kc=e||"all"}function ci(){return Kc||"all"}function bg(){return Ut.slice(0)}function Sg(){return Ut.map(e=>Cg(e)||wg(e)||String.fromCharCode(e))}function Eg(){const e=[];return Object.keys(Wt).forEach(t=>{Wt[t].forEach(n=>{let{key:o,scope:g,mods:A,shortcut:v}=n;e.push({scope:g,shortcut:v,mods:A,keys:o.split("+").map(f=>Ai(f))})})}),e}function Ig(e){const t=e.target||e.srcElement,{tagName:n}=t;let o=!0;const g=n==="INPUT"&&!["checkbox","radio","range","button","file","reset","submit","color"].includes(t.type);return(t.isContentEditable||(g||n==="TEXTAREA"||n==="SELECT")&&!t.readOnly)&&(o=!1),o}function xg(e){return typeof e=="string"&&(e=Ai(e)),Ut.indexOf(e)!==-1}function Bg(e,t){let n,o;e||(e=ci());for(const g in Wt)if(Object.prototype.hasOwnProperty.call(Wt,g))for(n=Wt[g],o=0;o<n.length;)n[o].scope===e?n.splice(o,1).forEach(v=>{let{element:f}=v;return _o(f)}):o++;ci()===e&&qc(t||"all")}function Tg(e){let t=e.keyCode||e.which||e.charCode;const n=Ut.indexOf(t);if(n>=0&&Ut.splice(n,1),e.key&&e.key.toLowerCase()==="meta"&&Ut.splice(0,Ut.length),(t===93||t===224)&&(t=91),t in ae){ae[t]=!1;for(const o in Le)Le[o]===t&&(Ve[o]=!1)}}function Zc(e){if(typeof e=="undefined")Object.keys(Wt).forEach(g=>{Array.isArray(Wt[g])&&Wt[g].forEach(A=>wi(A)),delete Wt[g]}),_o(null);else if(Array.isArray(e))e.forEach(g=>{g.key&&wi(g)});else if(typeof e=="object")e.key&&wi(e);else if(typeof e=="string"){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];let[g,A]=n;typeof g=="function"&&(A=g,g=""),wi({key:e,scope:g,method:A,splitKey:"+"})}}const wi=e=>{let{key:t,scope:n,method:o,splitKey:g="+"}=e;Jc(t).forEach(v=>{const f=v.split(g),i=f.length,c=f[i-1],l=c==="*"?"*":Ai(c);if(!Wt[l])return;n||(n=ci());const r=i>1?Xc(Le,f):[],a=[];Wt[l]=Wt[l].filter(s=>{const d=(o?s.method===o:!0)&&s.scope===n&&_g(s.mods,r);return d&&a.push(s.element),!d}),a.forEach(s=>_o(s))})};function Sa(e,t,n,o){if(t.element!==o)return;let g;if(t.scope===n||t.scope==="all"){g=t.mods.length>0;for(const A in ae)Object.prototype.hasOwnProperty.call(ae,A)&&(!ae[A]&&t.mods.indexOf(+A)>-1||ae[A]&&t.mods.indexOf(+A)===-1)&&(g=!1);(t.mods.length===0&&!ae[16]&&!ae[18]&&!ae[17]&&!ae[91]||g||t.shortcut==="*")&&(t.keys=[],t.keys=t.keys.concat(Ut),t.method(e,t)===!1&&(e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation&&e.stopPropagation(),e.cancelBubble&&(e.cancelBubble=!0)))}}function Ea(e,t){const n=Wt["*"];let o=e.keyCode||e.which||e.charCode;if(!Ve.filter.call(this,e))return;if((o===93||o===224)&&(o=91),Ut.indexOf(o)===-1&&o!==229&&Ut.push(o),["ctrlKey","altKey","shiftKey","metaKey"].forEach(f=>{const i=vs[f];e[f]&&Ut.indexOf(i)===-1?Ut.push(i):!e[f]&&Ut.indexOf(i)>-1?Ut.splice(Ut.indexOf(i),1):f==="metaKey"&&e[f]&&Ut.length===3&&(e.ctrlKey||e.shiftKey||e.altKey||(Ut=Ut.slice(Ut.indexOf(i))))}),o in ae){ae[o]=!0;for(const f in Le)Le[f]===o&&(Ve[f]=!0);if(!n)return}for(const f in ae)Object.prototype.hasOwnProperty.call(ae,f)&&(ae[f]=e[vs[f]]);e.getModifierState&&!(e.altKey&&!e.ctrlKey)&&e.getModifierState("AltGraph")&&(Ut.indexOf(17)===-1&&Ut.push(17),Ut.indexOf(18)===-1&&Ut.push(18),ae[17]=!0,ae[18]=!0);const g=ci();if(n)for(let f=0;f<n.length;f++)n[f].scope===g&&(e.type==="keydown"&&n[f].keydown||e.type==="keyup"&&n[f].keyup)&&Sa(e,n[f],g,t);if(!(o in Wt))return;const A=Wt[o],v=A.length;for(let f=0;f<v;f++)if((e.type==="keydown"&&A[f].keydown||e.type==="keyup"&&A[f].keyup)&&A[f].key){const i=A[f],{splitKey:c}=i,l=i.key.split(c),r=[];for(let a=0;a<l.length;a++)r.push(Ai(l[a]));r.sort().join("")===Ut.sort().join("")&&Sa(e,i,g,t)}}function Ve(e,t,n){Ut=[];const o=Jc(e);let g=[],A="all",v=document,f=0,i=!1,c=!0,l="+",r=!1,a=!1;for(n===void 0&&typeof t=="function"&&(n=t),Object.prototype.toString.call(t)==="[object Object]"&&(t.scope&&(A=t.scope),t.element&&(v=t.element),t.keyup&&(i=t.keyup),t.keydown!==void 0&&(c=t.keydown),t.capture!==void 0&&(r=t.capture),typeof t.splitKey=="string"&&(l=t.splitKey),t.single===!0&&(a=!0)),typeof t=="string"&&(A=t),a&&Zc(e,A);f<o.length;f++)e=o[f].split(l),g=[],e.length>1&&(g=Xc(Le,e)),e=e[e.length-1],e=e==="*"?"*":Ai(e),e in Wt||(Wt[e]=[]),Wt[e].push({keyup:i,keydown:c,scope:A,mods:g,shortcut:o[f],method:n,key:o[f],splitKey:l,element:v});if(typeof v!="undefined"&&window){if(!ze.has(v)){const s=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;return Ea(d,v)},u=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;Ea(d,v),Tg(d)};ze.set(v,{keydownListener:s,keyupListenr:u,capture:r}),Pr(v,"keydown",s,r),Pr(v,"keyup",u,r)}if(!ti){const s=()=>{Ut=[]};ti={listener:s,capture:r},Pr(window,"focus",s,r)}}}function Og(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"all";Object.keys(Wt).forEach(n=>{Wt[n].filter(g=>g.scope===t&&g.shortcut===e).forEach(g=>{g&&g.method&&g.method()})})}function _o(e){const t=Object.values(Wt).flat();if(t.findIndex(o=>{let{element:g}=o;return g===e})<0){const{keydownListener:o,keyupListenr:g,capture:A}=ze.get(e)||{};o&&g&&(Jn(e,"keyup",g,A),Jn(e,"keydown",o,A),ze.delete(e))}if((t.length<=0||ze.size<=0)&&(Object.keys(ze).forEach(g=>{const{keydownListener:A,keyupListenr:v,capture:f}=ze.get(g)||{};A&&v&&(Jn(g,"keyup",v,f),Jn(g,"keydown",A,f),ze.delete(g))}),ze.clear(),Object.keys(Wt).forEach(g=>delete Wt[g]),ti)){const{listener:g,capture:A}=ti;Jn(window,"focus",g,A),ti=null}}const Qr={getPressedKeyString:Sg,setScope:qc,getScope:ci,deleteScope:Bg,getPressedKeyCodes:bg,getAllKeyCodes:Eg,isPressed:xg,filter:Ig,trigger:Og,unbind:Zc,keyMap:li,modifier:Le,modifierMap:vs};for(const e in Qr)Object.prototype.hasOwnProperty.call(Qr,e)&&(Ve[e]=Qr[e]);if(typeof window!="undefined"){const e=window.hotkeys;Ve.noConflict=t=>(t&&window.hotkeys===Ve&&(window.hotkeys=e),Ve),window.hotkeys=Ve}class qi{constructor(t,n){this.container=t,this.dom=null,this.shown=!1,this.root=!0,this.parent=null,this.submenus=[],this.items=n,this._onclick=o=>{this.dom&&o.target!=this.dom&&o.target.parentElement!=this.dom&&!o.target.classList.contains("item")&&!o.target.parentElement.classList.contains("item")&&this.hideAll()},this._oncontextmenu=o=>{o.preventDefault(),o.target!=this.dom&&o.target.parentElement!=this.dom&&!o.target.classList.contains("item")&&!o.target.parentElement.classList.contains("item")&&(this.hideAll(),this.show(o.clientX,o.clientY))},this._oncontextmenu_keydown=o=>{o.keyCode==93&&(o.preventDefault(),this.hideAll(),this.show(o.clientX,o.clientY))},this._onblur=()=>{this.hideAll()}}getMenuDom(){const t=document.createElement("div");t.classList.add("context");for(const n of this.items)t.appendChild(this.itemToDomEl(n));return t}itemToDomEl(t){const n=document.createElement("div");if(t===null)return n.classList="separator",n;t.hasOwnProperty("color")&&/^#([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t.color.toString())&&(n.style.cssText=`color: ${t.color}`),n.classList.add("item");const o=document.createElement("span");o.classList="label",o.innerText=t.hasOwnProperty("text")?t.text.toString():"",n.appendChild(o),t.hasOwnProperty("disabled")&&t.disabled?n.classList.add("disabled"):n.classList.add("enabled");const g=document.createElement("span");if(g.classList="hotkey",g.innerText=t.hasOwnProperty("hotkey")?t.hotkey.toString():"",n.appendChild(g),t.hasOwnProperty("subitems")&&Array.isArray(t.subitems)&&t.subitems.length>0){const A=new qi(this.container,t.subitems);A.root=!1,A.parent=this;const v=()=>{if(t.hasOwnProperty("disabled")&&t.disabled==!0)return;this.hideSubMenus();const f=this.dom.offsetLeft+this.dom.clientWidth+n.offsetLeft,i=this.dom.offsetTop+n.offsetTop;A.shown?A.hide():A.show(f,i)};this.submenus.push(A),n.classList.add("has-subitems"),n.addEventListener("click",v),n.addEventListener("mousemove",v)}else if(t.hasOwnProperty("submenu")&&t.submenu instanceof qi){const A=t.submenu;A.root=!1,A.parent=this;const v=()=>{if(t.hasOwnProperty("disabled")&&t.disabled==!0)return;this.hideSubMenus();const f=this.dom.offsetLeft+this.dom.clientWidth+n.offsetLeft,i=this.dom.offsetTop+n.offsetTop;A.shown?A.hide():A.show(f,i)};this.submenus.push(A),n.classList.add("has-subitems"),n.addEventListener("click",v),n.addEventListener("mousemove",v)}else n.addEventListener("click",()=>{if(this.hideSubMenus(),!n.classList.contains("disabled"))if(t.hasOwnProperty("onclick")&&typeof t.onclick=="function"){const A={handled:!1,item:n,label:o,hotkey:g,items:this.items,data:t};t.onclick(A),A.handled||this.hide()}else this.hide()}),n.addEventListener("mousemove",()=>{this.hideSubMenus()});return n}hideAll(){if(this.root&&!this.parent){this.shown&&(this.hideSubMenus(),this.shown=!1,this.container.removeChild(this.dom),this.parent&&this.parent.shown&&this.parent.hide());return}this.parent.hide()}hide(){this.dom&&this.shown&&(this.shown=!1,this.hideSubMenus(),this.container.removeChild(this.dom),this.parent&&this.parent.shown&&this.parent.hide())}hideSubMenus(){for(const t of this.submenus)t.shown&&(t.shown=!1,t.container.removeChild(t.dom)),t.hideSubMenus()}show(t,n){this.dom=this.getMenuDom(),this.dom.style.left=`${t}px`,this.dom.style.top=`${n}px`,this.shown=!0,this.container.appendChild(this.dom)}install(){this.container.addEventListener("contextmenu",this._oncontextmenu),this.container.addEventListener("keydown",this._oncontextmenu_keydown),this.container.addEventListener("click",this._onclick),window.addEventListener("blur",this._onblur)}setData(t){this.items=t}uninstall(){this.dom=null,this.container.removeEventListener("keydown",this._oncontextmenu_keydown),this.container.removeEventListener("click",this._onclick),window.removeEventListener("blur",this._onblur)}}var bi,kg=new Uint8Array(16);function Dg(){if(!bi&&(bi=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!bi))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return bi(kg)}const Mg=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Pg(e){return typeof e=="string"&&Mg.test(e)}var oe=[];for(var Lr=0;Lr<256;++Lr)oe.push((Lr+256).toString(16).substr(1));function Qg(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=(oe[e[t+0]]+oe[e[t+1]]+oe[e[t+2]]+oe[e[t+3]]+"-"+oe[e[t+4]]+oe[e[t+5]]+"-"+oe[e[t+6]]+oe[e[t+7]]+"-"+oe[e[t+8]]+oe[e[t+9]]+"-"+oe[e[t+10]]+oe[e[t+11]]+oe[e[t+12]]+oe[e[t+13]]+oe[e[t+14]]+oe[e[t+15]]).toLowerCase();if(!Pg(n))throw TypeError("Stringified UUID is invalid");return n}function Mt(e,t,n){e=e||{};var o=e.random||(e.rng||Dg)();if(o[6]=o[6]&15|64,o[8]=o[8]&63|128,t){n=n||0;for(var g=0;g<16;++g)t[n+g]=o[g];return t}return Qg(o)}function Co(e){return rf()?(sf(e),!0):!1}function Lg(){const e=new Set,t=g=>{e.delete(g)};return{on:g=>{e.add(g);const A=()=>t(g);return Co(A),{off:A}},off:t,trigger:(...g)=>Promise.all(Array.from(e).map(A=>A(...g)))}}function mi(e){return typeof e=="function"?e():T(e)}const vi=typeof window!="undefined"&&typeof document!="undefined";typeof WorkerGlobalScope!="undefined"&&globalThis instanceof WorkerGlobalScope;const Fg=Object.prototype.toString,Rg=e=>Fg.call(e)==="[object Object]",tu=()=>{},jg=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);function $g(e){let t;function n(){return t||(t=e()),t}return n.reset=()=>_t(this,null,function*(){const o=t;t=void 0,o&&(yield o)}),n}function Ng(e){return e||ye()}function Ug(...e){if(e.length!==1)return of(...e);const t=e[0];return typeof t=="function"?hn(af(()=>({get:t,set:tu}))):ft(t)}function Hg(e,t=!0,n){Ng()?Qt(e,n):t?e():lr(e)}function Gg(e,t,n={}){const{immediate:o=!0}=n,g=ft(!1);let A=null;function v(){A&&(clearTimeout(A),A=null)}function f(){g.value=!1,v()}function i(...c){v(),g.value=!0,A=setTimeout(()=>{g.value=!1,A=null,e(...c)},mi(t))}return o&&(g.value=!0,vi&&i()),Co(f),{isPending:hn(g),start:i,stop:f}}function zg(e){var t;const n=mi(e);return(t=n==null?void 0:n.$el)!=null?t:n}const Yg=vi?window:void 0,Vg=vi?window.document:void 0,eu=vi?window.navigator:void 0;function ei(...e){let t,n,o,g;if(typeof e[0]=="string"||Array.isArray(e[0])?([n,o,g]=e,t=Yg):[t,n,o,g]=e,!t)return tu;Array.isArray(n)||(n=[n]),Array.isArray(o)||(o=[o]);const A=[],v=()=>{A.forEach(l=>l()),A.length=0},f=(l,r,a,s)=>(l.addEventListener(r,a,s),()=>l.removeEventListener(r,a,s)),i=ge(()=>[zg(t),mi(g)],([l,r])=>{if(v(),!l)return;const a=Rg(r)?pt({},r):r;A.push(...n.flatMap(s=>o.map(u=>f(l,s,u,a))))},{immediate:!0,flush:"post"}),c=()=>{i(),v()};return Co(c),c}function Wg(){const e=ft(!1),t=ye();return t&&Qt(()=>{e.value=!0},t),e}function nu(e){const t=Wg();return ie(()=>(t.value,!!e()))}const Kn={array:e=>JSON.stringify(e),object:e=>JSON.stringify(e),set:e=>JSON.stringify(Array.from(e)),map:e=>JSON.stringify(Object.fromEntries(e)),null:()=>""};function Xg(e){return e?e instanceof Map?Kn.map:e instanceof Set?Kn.set:Array.isArray(e)?Kn.array:Kn.object:Kn.null}function Jg(e,t){const n=ft(""),o=ft();function g(){if(vi)return o.value=new Promise((A,v)=>{try{const f=mi(e);if(f==null)A("");else if(typeof f=="string")A(Fr(new Blob([f],{type:"text/plain"})));else if(f instanceof Blob)A(Fr(f));else if(f instanceof ArrayBuffer)A(window.btoa(String.fromCharCode(...new Uint8Array(f))));else if(f instanceof HTMLCanvasElement)A(f.toDataURL(t==null?void 0:t.type,t==null?void 0:t.quality));else if(f instanceof HTMLImageElement){const i=f.cloneNode(!1);i.crossOrigin="Anonymous",Kg(i).then(()=>{const c=document.createElement("canvas"),l=c.getContext("2d");c.width=i.width,c.height=i.height,l.drawImage(i,0,0,c.width,c.height),A(c.toDataURL(t==null?void 0:t.type,t==null?void 0:t.quality))}).catch(v)}else if(typeof f=="object"){const c=((t==null?void 0:t.serializer)||Xg(f))(f);return A(Fr(new Blob([c],{type:"application/json"})))}else v(new Error("target is unsupported types"))}catch(f){v(f)}}),o.value.then(A=>n.value=A),o.value}return Vt(e)||typeof e=="function"?ge(e,g,{immediate:!0}):g(),{base64:n,promise:o,execute:g}}function Kg(e){return new Promise((t,n)=>{e.complete?t():(e.onload=()=>{t()},e.onerror=n)})}function Fr(e){return new Promise((t,n)=>{const o=new FileReader;o.onload=g=>{t(g.target.result)},o.onerror=n,o.readAsDataURL(e)})}function Ia(e,t={}){const{controls:n=!1,navigator:o=eu}=t,g=nu(()=>o&&"permissions"in o);let A;const v=typeof e=="string"?{name:e}:e,f=ft(),i=()=>{A&&(f.value=A.state)},c=$g(()=>_t(this,null,function*(){if(g.value){if(!A)try{A=yield o.permissions.query(v),ei(A,"change",i),i()}catch(l){f.value="prompt"}return A}}));return c(),n?{state:f,isSupported:g,query:c}:f}function qg(e={}){const{navigator:t=eu,read:n=!1,source:o,copiedDuring:g=1500,legacy:A=!1}=e,v=nu(()=>t&&"clipboard"in t),f=Ia("clipboard-read"),i=Ia("clipboard-write"),c=ie(()=>v.value||A),l=ft(""),r=ft(!1),a=Gg(()=>r.value=!1,g);function s(){v.value&&p(f.value)?t.clipboard.readText().then(m=>{l.value=m}):l.value=h()}c.value&&n&&ei(["copy","cut"],s);function u(){return _t(this,arguments,function*(m=mi(o)){c.value&&m!=null&&(v.value&&p(i.value)?yield t.clipboard.writeText(m):d(m),l.value=m,r.value=!0,a.start())})}function d(m){const y=document.createElement("textarea");y.value=m!=null?m:"",y.style.position="absolute",y.style.opacity="0",document.body.appendChild(y),y.select(),document.execCommand("copy"),y.remove()}function h(){var m,y,_;return(_=(y=(m=document==null?void 0:document.getSelection)==null?void 0:m.call(document))==null?void 0:y.toString())!=null?_:""}function p(m){return m==="granted"||m==="prompt"}return{isSupported:c,text:l,copied:r,copy:u}}const Zg={multiple:!0,accept:"*",reset:!1,directory:!1};function tp(e={}){const{document:t=Vg}=e,n=ft(null),{on:o,trigger:g}=Lg();let A;t&&(A=t.createElement("input"),A.type="file",A.onchange=i=>{const c=i.target;n.value=c.files,g(n.value)});const v=()=>{n.value=null,A&&(A.value="",g(null))},f=i=>{if(!A)return;const c=pt(pt(pt({},Zg),e),i);A.multiple=c.multiple,A.accept=c.accept,A.webkitdirectory=c.directory,jg(c,"capture")&&(A.capture=c.capture),c.reset&&v(),A.click()};return{files:hn(n),open:f,reset:v,onChange:o}}function ep(e,t={}){const n=Ug(e),{threshold:o=50,onSwipe:g,onSwipeEnd:A,onSwipeStart:v,disableTextSelect:f=!1}=t,i=zt({x:0,y:0}),c=(b,S)=>{i.x=b,i.y=S},l=zt({x:0,y:0}),r=(b,S)=>{l.x=b,l.y=S},a=ie(()=>i.x-l.x),s=ie(()=>i.y-l.y),{max:u,abs:d}=Math,h=ie(()=>u(d(a.value),d(s.value))>=o),p=ft(!1),m=ft(!1),y=ie(()=>h.value?d(a.value)>d(s.value)?a.value>0?"left":"right":s.value>0?"up":"down":"none"),_=b=>{var S,F,$;const Q=b.buttons===0,R=b.buttons===1;return($=(F=(S=t.pointerTypes)==null?void 0:S.includes(b.pointerType))!=null?F:Q||R)!=null?$:!0},C=[ei(e,"pointerdown",b=>{if(!_(b))return;m.value=!0;const S=b.target;S==null||S.setPointerCapture(b.pointerId);const{clientX:F,clientY:$}=b;c(F,$),r(F,$),v==null||v(b)}),ei(e,"pointermove",b=>{if(!_(b)||!m.value)return;const{clientX:S,clientY:F}=b;r(S,F),!p.value&&h.value&&(p.value=!0),p.value&&(g==null||g(b))}),ei(e,"pointerup",b=>{_(b)&&(p.value&&(A==null||A(b,y.value)),m.value=!1,p.value=!1)})];Hg(()=>{var b,S,F,$,Q,R,H,W;(S=(b=n.value)==null?void 0:b.style)==null||S.setProperty("touch-action","none"),f&&(($=(F=n.value)==null?void 0:F.style)==null||$.setProperty("-webkit-user-select","none"),(R=(Q=n.value)==null?void 0:Q.style)==null||R.setProperty("-ms-user-select","none"),(W=(H=n.value)==null?void 0:H.style)==null||W.setProperty("user-select","none"))});const w=()=>C.forEach(b=>b());return{isSwiping:hn(p),direction:hn(y),posStart:hn(i),posEnd:hn(l),distanceX:a,distanceY:s,stop:w}}function iu(e){return Jg(e).promise.value}function wo(e){return new Promise(t=>{const{onChange:n,open:o}=tp(e);n(g=>{t(g)}),o()})}function np(e){return new Promise(t=>{const n=document.createElement("img");n.src=e,document.body.appendChild(n),n.onload=()=>{t(n)}})}const ys=(e,t)=>_t(void 0,null,function*(){try{yield qg(pt({source:e},t)).copy(),Bt.Message.success("复制成功")}catch(n){throw Bt.Message.error("复制失败"),n}});function Dn(e,t){const n=document.createElement("a");n.href=e,n.download=`${Mt()}.${t}`,document.body.appendChild(n),n.click(),n.remove()}function ru(e,t,n,o,g,A,v){v!==void 0&&(e.save(),e.translate(t,n),e.rotate(v),e.drawImage(o,-g/2,-A/2,g,A),e.restore())}const mr={getImgStr:iu,downFile:Dn,selectFiles:wo,insertImgFile:np,clipboardText:ys,drawImg:ru};function ip(e,t){const n=e.x,o=e.y,g=t.x-n,A=t.y-o,v=Math.sqrt(g*g+A*A);let f=Math.atan2(A,g)/Math.PI*180;f=~~((f+7.5)%360/15)*15;const i=v*Math.cos(f*Math.PI/180),c=v*Math.sin(f*Math.PI/180);return{x:i+n,y:c+o}}var nt={};const rp={},sp=Object.freeze(Object.defineProperty({__proto__:null,default:rp},Symbol.toStringTag,{value:"Module"})),Fi=lf(sp);(function(e){/*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) */var t=t||{version:"5.3.0"};if(e.fabric=t,typeof document!="undefined"&&typeof window!="undefined")document instanceof(typeof HTMLDocument!="undefined"?HTMLDocument:Document)?t.document=document:t.document=document.implementation.createHTMLDocument(""),t.window=window;else{var n=Fi,o=new n.JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;t.document=o.document,t.jsdomImplForWrapper=Fi.implForWrapper,t.nodeCanvas=Fi.Canvas,t.window=o,DOMParser=t.window.DOMParser}t.isTouchSupported="ontouchstart"in t.window||"ontouchstart"in t.document||t.window&&t.window.navigator&&t.window.navigator.maxTouchPoints>0,t.isLikelyNode=typeof Buffer!="undefined"&&typeof window=="undefined",t.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],t.DPI=96,t.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",t.commaWsp="(?:\\s+,?\\s*|,\\s*)",t.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/ig,t.reNonWord=/[ \n\.,;!\?\-]/,t.fontPaths={},t.iMatrix=[1,0,0,1,0,0],t.svgNS="http://www.w3.org/2000/svg",t.perfLimitSizeTotal=2097152,t.maxCacheSideLimit=4096,t.minCacheSideLimit=256,t.charWidthsCache={},t.textureSize=2048,t.disableStyleCopyPaste=!1,t.enableGLFiltering=!0,t.devicePixelRatio=t.window.devicePixelRatio||t.window.webkitDevicePixelRatio||t.window.mozDevicePixelRatio||1,t.browserShadowBlurConstant=1,t.arcToSegmentsCache={},t.boundsOfCurveCache={},t.cachesBoundsOfCurve=!0,t.forceGLPutImageData=!1,t.initFilterBackend=function(){if(t.enableGLFiltering&&t.isWebglSupported&&t.isWebglSupported(t.textureSize))return console.log("max texture size: "+t.maxTextureSize),new t.WebglFilterBackend({tileSize:t.textureSize});if(t.Canvas2dFilterBackend)return new t.Canvas2dFilterBackend},typeof document!="undefined"&&typeof window!="undefined"&&(window.fabric=t),function(){function f(s,u){if(this.__eventListeners[s]){var d=this.__eventListeners[s];u?d[d.indexOf(u)]=!1:t.util.array.fill(d,!1)}}function i(s,u){if(this.__eventListeners||(this.__eventListeners={}),arguments.length===1)for(var d in s)this.on(d,s[d]);else this.__eventListeners[s]||(this.__eventListeners[s]=[]),this.__eventListeners[s].push(u);return this}function c(s,u){var d=function(){u.apply(this,arguments),this.off(s,d)}.bind(this);this.on(s,d)}function l(s,u){if(arguments.length===1)for(var d in s)c.call(this,d,s[d]);else c.call(this,s,u);return this}function r(s,u){if(!this.__eventListeners)return this;if(arguments.length===0)for(s in this.__eventListeners)f.call(this,s);else if(arguments.length===1&&typeof arguments[0]=="object")for(var d in s)f.call(this,d,s[d]);else f.call(this,s,u);return this}function a(s,u){if(!this.__eventListeners)return this;var d=this.__eventListeners[s];if(!d)return this;for(var h=0,p=d.length;h<p;h++)d[h]&&d[h].call(this,u||{});return this.__eventListeners[s]=d.filter(function(m){return m!==!1}),this}t.Observable={fire:a,on:i,once:l,off:r}}(),t.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var f=0,i=arguments.length;f<i;f++)this._onObjectAdded(arguments[f]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(f,i,c){var l=this._objects;return c?l[i]=f:l.splice(i,0,f),this._onObjectAdded&&this._onObjectAdded(f),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var f=this._objects,i,c=!1,l=0,r=arguments.length;l<r;l++)i=f.indexOf(arguments[l]),i!==-1&&(c=!0,f.splice(i,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[l]));return this.renderOnAddRemove&&c&&this.requestRenderAll(),this},forEachObject:function(f,i){for(var c=this.getObjects(),l=0,r=c.length;l<r;l++)f.call(i,c[l],l,c);return this},getObjects:function(f){return typeof f=="undefined"?this._objects.concat():this._objects.filter(function(i){return i.type===f})},item:function(f){return this._objects[f]},isEmpty:function(){return this._objects.length===0},size:function(){return this._objects.length},contains:function(f,i){return this._objects.indexOf(f)>-1?!0:i?this._objects.some(function(c){return typeof c.contains=="function"&&c.contains(f,!0)}):!1},complexity:function(){return this._objects.reduce(function(f,i){return f+=i.complexity?i.complexity():0,f},0)}},t.CommonMethods={_setOptions:function(f){for(var i in f)this.set(i,f[i])},_initGradient:function(f,i){f&&f.colorStops&&!(f instanceof t.Gradient)&&this.set(i,new t.Gradient(f))},_initPattern:function(f,i,c){f&&f.source&&!(f instanceof t.Pattern)?this.set(i,new t.Pattern(f,c)):c&&c()},_setObject:function(f){for(var i in f)this._set(i,f[i])},set:function(f,i){return typeof f=="object"?this._setObject(f):this._set(f,i),this},_set:function(f,i){this[f]=i},toggle:function(f){var i=this.get(f);return typeof i=="boolean"&&this.set(f,!i),this},get:function(f){return this[f]}},function(f){var i=Math.sqrt,c=Math.atan2,l=Math.pow,r=Math.PI/180,a=Math.PI/2;t.util={cos:function(s){if(s===0)return 1;s<0&&(s=-s);var u=s/a;switch(u){case 1:case 3:return 0;case 2:return-1}return Math.cos(s)},sin:function(s){if(s===0)return 0;var u=s/a,d=1;switch(s<0&&(d=-1),u){case 1:return d;case 2:return 0;case 3:return-d}return Math.sin(s)},removeFromArray:function(s,u){var d=s.indexOf(u);return d!==-1&&s.splice(d,1),s},getRandomInt:function(s,u){return Math.floor(Math.random()*(u-s+1))+s},degreesToRadians:function(s){return s*r},radiansToDegrees:function(s){return s/r},rotatePoint:function(s,u,d){var h=new t.Point(s.x-u.x,s.y-u.y),p=t.util.rotateVector(h,d);return new t.Point(p.x,p.y).addEquals(u)},rotateVector:function(s,u){var d=t.util.sin(u),h=t.util.cos(u),p=s.x*h-s.y*d,m=s.x*d+s.y*h;return{x:p,y:m}},createVector:function(s,u){return new t.Point(u.x-s.x,u.y-s.y)},calcAngleBetweenVectors:function(s,u){return Math.acos((s.x*u.x+s.y*u.y)/(Math.hypot(s.x,s.y)*Math.hypot(u.x,u.y)))},getHatVector:function(s){return new t.Point(s.x,s.y).multiply(1/Math.hypot(s.x,s.y))},getBisector:function(s,u,d){var h=t.util.createVector(s,u),p=t.util.createVector(s,d),m=t.util.calcAngleBetweenVectors(h,p),y=t.util.calcAngleBetweenVectors(t.util.rotateVector(h,m),p),_=m*(y===0?1:-1)/2;return{vector:t.util.getHatVector(t.util.rotateVector(h,_)),angle:m}},projectStrokeOnPoints:function(s,u,d){var h=[],p=u.strokeWidth/2,m=u.strokeUniform?new t.Point(1/u.scaleX,1/u.scaleY):new t.Point(1,1),y=function(_){var C=p/Math.hypot(_.x,_.y);return new t.Point(_.x*C*m.x,_.y*C*m.y)};return s.length<=1||s.forEach(function(_,C){var w=new t.Point(_.x,_.y),b,S;C===0?(S=s[C+1],b=d?y(t.util.createVector(S,w)).addEquals(w):s[s.length-1]):C===s.length-1?(b=s[C-1],S=d?y(t.util.createVector(b,w)).addEquals(w):s[0]):(b=s[C-1],S=s[C+1]);var F=t.util.getBisector(w,b,S),$=F.vector,Q=F.angle,R,H;if(u.strokeLineJoin==="miter"&&(R=-p/Math.sin(Q/2),H=new t.Point($.x*R*m.x,$.y*R*m.y),Math.hypot(H.x,H.y)/p<=u.strokeMiterLimit)){h.push(w.add(H)),h.push(w.subtract(H));return}R=-p*Math.SQRT2,H=new t.Point($.x*R*m.x,$.y*R*m.y),h.push(w.add(H)),h.push(w.subtract(H))}),h},transformPoint:function(s,u,d){return d?new t.Point(u[0]*s.x+u[2]*s.y,u[1]*s.x+u[3]*s.y):new t.Point(u[0]*s.x+u[2]*s.y+u[4],u[1]*s.x+u[3]*s.y+u[5])},makeBoundingBoxFromPoints:function(s,u){if(u)for(var d=0;d<s.length;d++)s[d]=t.util.transformPoint(s[d],u);var h=[s[0].x,s[1].x,s[2].x,s[3].x],p=t.util.array.min(h),m=t.util.array.max(h),y=m-p,_=[s[0].y,s[1].y,s[2].y,s[3].y],C=t.util.array.min(_),w=t.util.array.max(_),b=w-C;return{left:p,top:C,width:y,height:b}},invertTransform:function(s){var u=1/(s[0]*s[3]-s[1]*s[2]),d=[u*s[3],-u*s[1],-u*s[2],u*s[0]],h=t.util.transformPoint({x:s[4],y:s[5]},d,!0);return d[4]=-h.x,d[5]=-h.y,d},toFixed:function(s,u){return parseFloat(Number(s).toFixed(u))},parseUnit:function(s,u){var d=/\D{0,2}$/.exec(s),h=parseFloat(s);switch(u||(u=t.Text.DEFAULT_SVG_FONT_SIZE),d[0]){case"mm":return h*t.DPI/25.4;case"cm":return h*t.DPI/2.54;case"in":return h*t.DPI;case"pt":return h*t.DPI/72;case"pc":return h*t.DPI/72*12;case"em":return h*u;default:return h}},falseFunction:function(){return!1},getKlass:function(s,u){return s=t.util.string.camelize(s.charAt(0).toUpperCase()+s.slice(1)),t.util.resolveNamespace(u)[s]},getSvgAttributes:function(s){var u=["instantiated_by_use","style","id","class"];switch(s){case"linearGradient":u=u.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":u=u.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":u=u.concat(["offset","stop-color","stop-opacity"]);break}return u},resolveNamespace:function(s){if(!s)return t;var u=s.split("."),d=u.length,h,p=f||t.window;for(h=0;h<d;++h)p=p[u[h]];return p},loadImage:function(s,u,d,h){if(!s){u&&u.call(d,s);return}var p=t.util.createImage(),m=function(){u&&u.call(d,p,!1),p=p.onload=p.onerror=null};p.onload=m,p.onerror=function(){t.log("Error loading "+p.src),u&&u.call(d,null,!0),p=p.onload=p.onerror=null},s.indexOf("data")!==0&&h!==void 0&&h!==null&&(p.crossOrigin=h),s.substring(0,14)==="data:image/svg"&&(p.onload=null,t.util.loadImageInDom(p,m)),p.src=s},loadImageInDom:function(s,u){var d=t.document.createElement("div");d.style.width=d.style.height="1px",d.style.left=d.style.top="-100%",d.style.position="absolute",d.appendChild(s),t.document.querySelector("body").appendChild(d),s.onload=function(){u(),d.parentNode.removeChild(d),d=null}},enlivenObjects:function(s,u,d,h){s=s||[];var p=[],m=0,y=s.length;function _(){++m===y&&u&&u(p.filter(function(C){return C}))}if(!y){u&&u(p);return}s.forEach(function(C,w){if(!C||!C.type){_();return}var b=t.util.getKlass(C.type,d);b.fromObject(C,function(S,F){F||(p[w]=S),h&&h(C,S,F),_()})})},enlivenObjectEnlivables:function(s,u,d){var h=t.Object.ENLIVEN_PROPS.filter(function(p){return!!s[p]});t.util.enlivenObjects(h.map(function(p){return s[p]}),function(p){var m={};h.forEach(function(y,_){m[y]=p[_],u&&(u[y]=p[_])}),d&&d(m)})},enlivenPatterns:function(s,u){s=s||[];function d(){++p===m&&u&&u(h)}var h=[],p=0,m=s.length;if(!m){u&&u(h);return}s.forEach(function(y,_){y&&y.source?new t.Pattern(y,function(C){h[_]=C,d()}):(h[_]=y,d())})},groupSVGElements:function(s,u,d){var h;return s&&s.length===1?(typeof d!="undefined"&&(s[0].sourcePath=d),s[0]):(u&&(u.width&&u.height?u.centerPoint={x:u.width/2,y:u.height/2}:(delete u.width,delete u.height)),h=new t.Group(s,u),typeof d!="undefined"&&(h.sourcePath=d),h)},populateWithProperties:function(s,u,d){if(d&&Array.isArray(d))for(var h=0,p=d.length;h<p;h++)d[h]in s&&(u[d[h]]=s[d[h]])},createCanvasElement:function(){return t.document.createElement("canvas")},copyCanvasElement:function(s){var u=t.util.createCanvasElement();return u.width=s.width,u.height=s.height,u.getContext("2d").drawImage(s,0,0),u},toDataURL:function(s,u,d){return s.toDataURL("image/"+u,d)},createImage:function(){return t.document.createElement("img")},multiplyTransformMatrices:function(s,u,d){return[s[0]*u[0]+s[2]*u[1],s[1]*u[0]+s[3]*u[1],s[0]*u[2]+s[2]*u[3],s[1]*u[2]+s[3]*u[3],d?0:s[0]*u[4]+s[2]*u[5]+s[4],d?0:s[1]*u[4]+s[3]*u[5]+s[5]]},qrDecompose:function(s){var u=c(s[1],s[0]),d=l(s[0],2)+l(s[1],2),h=i(d),p=(s[0]*s[3]-s[2]*s[1])/h,m=c(s[0]*s[2]+s[1]*s[3],d);return{angle:u/r,scaleX:h,scaleY:p,skewX:m/r,skewY:0,translateX:s[4],translateY:s[5]}},calcRotateMatrix:function(s){if(!s.angle)return t.iMatrix.concat();var u=t.util.degreesToRadians(s.angle),d=t.util.cos(u),h=t.util.sin(u);return[d,h,-h,d,0,0]},calcDimensionsMatrix:function(s){var u=typeof s.scaleX=="undefined"?1:s.scaleX,d=typeof s.scaleY=="undefined"?1:s.scaleY,h=[s.flipX?-u:u,0,0,s.flipY?-d:d,0,0],p=t.util.multiplyTransformMatrices,m=t.util.degreesToRadians;return s.skewX&&(h=p(h,[1,0,Math.tan(m(s.skewX)),1],!0)),s.skewY&&(h=p(h,[1,Math.tan(m(s.skewY)),0,1],!0)),h},composeMatrix:function(s){var u=[1,0,0,1,s.translateX||0,s.translateY||0],d=t.util.multiplyTransformMatrices;return s.angle&&(u=d(u,t.util.calcRotateMatrix(s))),(s.scaleX!==1||s.scaleY!==1||s.skewX||s.skewY||s.flipX||s.flipY)&&(u=d(u,t.util.calcDimensionsMatrix(s))),u},resetObjectTransform:function(s){s.scaleX=1,s.scaleY=1,s.skewX=0,s.skewY=0,s.flipX=!1,s.flipY=!1,s.rotate(0)},saveObjectTransform:function(s){return{scaleX:s.scaleX,scaleY:s.scaleY,skewX:s.skewX,skewY:s.skewY,angle:s.angle,left:s.left,flipX:s.flipX,flipY:s.flipY,top:s.top}},isTransparent:function(s,u,d,h){h>0&&(u>h?u-=h:u=0,d>h?d-=h:d=0);var p=!0,m,y,_=s.getImageData(u,d,h*2||1,h*2||1),C=_.data.length;for(m=3;m<C&&(y=_.data[m],p=y<=0,p!==!1);m+=4);return _=null,p},parsePreserveAspectRatioAttribute:function(s){var u="meet",d="Mid",h="Mid",p=s.split(" "),m;return p&&p.length&&(u=p.pop(),u!=="meet"&&u!=="slice"?(m=u,u="meet"):p.length&&(m=p.pop())),d=m!=="none"?m.slice(1,4):"none",h=m!=="none"?m.slice(5,8):"none",{meetOrSlice:u,alignX:d,alignY:h}},clearFabricFontCache:function(s){s=(s||"").toLowerCase(),s?t.charWidthsCache[s]&&delete t.charWidthsCache[s]:t.charWidthsCache={}},limitDimsByArea:function(s,u){var d=Math.sqrt(u*s),h=Math.floor(u/d);return{x:Math.floor(d),y:h}},capValue:function(s,u,d){return Math.max(s,Math.min(u,d))},findScaleToFit:function(s,u){return Math.min(u.width/s.width,u.height/s.height)},findScaleToCover:function(s,u){return Math.max(u.width/s.width,u.height/s.height)},matrixToSVG:function(s){return"matrix("+s.map(function(u){return t.util.toFixed(u,t.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(s,u){var d=t.util.invertTransform(u),h=t.util.multiplyTransformMatrices(d,s.calcOwnMatrix());t.util.applyTransformToObject(s,h)},addTransformToObject:function(s,u){t.util.applyTransformToObject(s,t.util.multiplyTransformMatrices(u,s.calcOwnMatrix()))},applyTransformToObject:function(s,u){var d=t.util.qrDecompose(u),h=new t.Point(d.translateX,d.translateY);s.flipX=!1,s.flipY=!1,s.set("scaleX",d.scaleX),s.set("scaleY",d.scaleY),s.skewX=d.skewX,s.skewY=d.skewY,s.angle=d.angle,s.setPositionByOrigin(h,"center","center")},sizeAfterTransform:function(s,u,d){var h=s/2,p=u/2,m=[{x:-h,y:-p},{x:h,y:-p},{x:-h,y:p},{x:h,y:p}],y=t.util.calcDimensionsMatrix(d),_=t.util.makeBoundingBoxFromPoints(m,y);return{x:_.width,y:_.height}},mergeClipPaths:function(s,u){var d=s,h=u;d.inverted&&!h.inverted&&(d=u,h=s),t.util.applyTransformToObject(h,t.util.multiplyTransformMatrices(t.util.invertTransform(d.calcTransformMatrix()),h.calcTransformMatrix()));var p=d.inverted&&h.inverted;return p&&(d.inverted=h.inverted=!1),new t.Group([d],{clipPath:h,inverted:p})},hasStyleChanged:function(s,u,d){return d=d||!1,s.fill!==u.fill||s.stroke!==u.stroke||s.strokeWidth!==u.strokeWidth||s.fontSize!==u.fontSize||s.fontFamily!==u.fontFamily||s.fontWeight!==u.fontWeight||s.fontStyle!==u.fontStyle||s.textBackgroundColor!==u.textBackgroundColor||s.deltaY!==u.deltaY||d&&(s.overline!==u.overline||s.underline!==u.underline||s.linethrough!==u.linethrough)},stylesToArray:function(d,u){for(var d=t.util.object.clone(d,!0),h=u.split(`
`),p=-1,m={},y=[],_=0;_<h.length;_++){if(!d[_]){p+=h[_].length;continue}for(var C=0;C<h[_].length;C++){p++;var w=d[_][C];if(w&&Object.keys(w).length>0){var b=t.util.hasStyleChanged(m,w,!0);b?y.push({start:p,end:p+1,style:w}):y[y.length-1].end++}m=w||{}}}return y},stylesFromArray:function(s,u){if(!Array.isArray(s))return s;for(var d=u.split(`
`),h=-1,p=0,m={},y=0;y<d.length;y++)for(var _=0;_<d[y].length;_++)h++,s[p]&&s[p].start<=h&&h<s[p].end&&(m[y]=m[y]||{},m[y][_]=Object.assign({},s[p].style),h===s[p].end-1&&p++);return m}}}(e),function(){var f=Array.prototype.join,i={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},c={m:"l",M:"L"};function l(x,B,k,D,Y,I,E,P,N,q,J){var rt=t.util.cos(x),lt=t.util.sin(x),dt=t.util.cos(B),U=t.util.sin(B),j=k*Y*dt-D*I*U+E,K=D*Y*dt+k*I*U+P,it=q+N*(-k*Y*lt-D*I*rt),tt=J+N*(-D*Y*lt+k*I*rt),ct=j+N*(k*Y*U+D*I*dt),ht=K+N*(D*Y*U-k*I*dt);return["C",it,tt,ct,ht,j,K]}function r(x,B,k,D,Y,I,E){var P=Math.PI,N=E*P/180,q=t.util.sin(N),J=t.util.cos(N),rt=0,lt=0;k=Math.abs(k),D=Math.abs(D);var dt=-J*x*.5-q*B*.5,U=-J*B*.5+q*x*.5,j=k*k,K=D*D,it=U*U,tt=dt*dt,ct=j*K-j*it-K*tt,ht=0;if(ct<0){var yt=Math.sqrt(1-ct/(j*K));k*=yt,D*=yt}else ht=(Y===I?-1:1)*Math.sqrt(ct/(j*it+K*tt));var At=ht*k*U/D,at=-ht*D*dt/k,mt=J*At-q*at+x*.5,St=q*At+J*at+B*.5,Tt=a(1,0,(dt-At)/k,(U-at)/D),jt=a((dt-At)/k,(U-at)/D,(-dt-At)/k,(-U-at)/D);I===0&&jt>0?jt-=2*P:I===1&&jt<0&&(jt+=2*P);for(var Dt=Math.ceil(Math.abs(jt/P*2)),Yt=[],qt=jt/Dt,an=8/3*Math.sin(qt/4)*Math.sin(qt/4)/Math.sin(qt/2),Yn=Tt+qt,Be=0;Be<Dt;Be++)Yt[Be]=l(Tt,Yn,J,q,k,D,mt,St,an,rt,lt),rt=Yt[Be][5],lt=Yt[Be][6],Tt=Yn,Yn+=qt;return Yt}function a(x,B,k,D){var Y=Math.atan2(B,x),I=Math.atan2(D,k);return I>=Y?I-Y:2*Math.PI-(Y-I)}function s(x,B,k,D,Y,I,E,P){var N;if(t.cachesBoundsOfCurve&&(N=f.call(arguments),t.boundsOfCurveCache[N]))return t.boundsOfCurveCache[N];var q=Math.sqrt,J=Math.min,rt=Math.max,lt=Math.abs,dt=[],U=[[],[]],j,K,it,tt,ct,ht,yt,At;K=6*x-12*k+6*Y,j=-3*x+9*k-9*Y+3*E,it=3*k-3*x;for(var at=0;at<2;++at){if(at>0&&(K=6*B-12*D+6*I,j=-3*B+9*D-9*I+3*P,it=3*D-3*B),lt(j)<1e-12){if(lt(K)<1e-12)continue;tt=-it/K,0<tt&&tt<1&&dt.push(tt);continue}yt=K*K-4*it*j,!(yt<0)&&(At=q(yt),ct=(-K+At)/(2*j),0<ct&&ct<1&&dt.push(ct),ht=(-K-At)/(2*j),0<ht&&ht<1&&dt.push(ht))}for(var mt,St,Tt=dt.length,jt=Tt,Dt;Tt--;)tt=dt[Tt],Dt=1-tt,mt=Dt*Dt*Dt*x+3*Dt*Dt*tt*k+3*Dt*tt*tt*Y+tt*tt*tt*E,U[0][Tt]=mt,St=Dt*Dt*Dt*B+3*Dt*Dt*tt*D+3*Dt*tt*tt*I+tt*tt*tt*P,U[1][Tt]=St;U[0][jt]=x,U[1][jt]=B,U[0][jt+1]=E,U[1][jt+1]=P;var Yt=[{x:J.apply(null,U[0]),y:J.apply(null,U[1])},{x:rt.apply(null,U[0]),y:rt.apply(null,U[1])}];return t.cachesBoundsOfCurve&&(t.boundsOfCurveCache[N]=Yt),Yt}function u(x,B,k){for(var D=k[1],Y=k[2],I=k[3],E=k[4],P=k[5],N=k[6],q=k[7],J=r(N-x,q-B,D,Y,E,P,I),rt=0,lt=J.length;rt<lt;rt++)J[rt][1]+=x,J[rt][2]+=B,J[rt][3]+=x,J[rt][4]+=B,J[rt][5]+=x,J[rt][6]+=B;return J}function d(x){var B=0,k=0,D=x.length,Y=0,I=0,E,P,N,q=[],J,rt,lt;for(P=0;P<D;++P){switch(N=!1,E=x[P].slice(0),E[0]){case"l":E[0]="L",E[1]+=B,E[2]+=k;case"L":B=E[1],k=E[2];break;case"h":E[1]+=B;case"H":E[0]="L",E[2]=k,B=E[1];break;case"v":E[1]+=k;case"V":E[0]="L",k=E[1],E[1]=B,E[2]=k;break;case"m":E[0]="M",E[1]+=B,E[2]+=k;case"M":B=E[1],k=E[2],Y=E[1],I=E[2];break;case"c":E[0]="C",E[1]+=B,E[2]+=k,E[3]+=B,E[4]+=k,E[5]+=B,E[6]+=k;case"C":rt=E[3],lt=E[4],B=E[5],k=E[6];break;case"s":E[0]="S",E[1]+=B,E[2]+=k,E[3]+=B,E[4]+=k;case"S":J==="C"?(rt=2*B-rt,lt=2*k-lt):(rt=B,lt=k),B=E[3],k=E[4],E[0]="C",E[5]=E[3],E[6]=E[4],E[3]=E[1],E[4]=E[2],E[1]=rt,E[2]=lt,rt=E[3],lt=E[4];break;case"q":E[0]="Q",E[1]+=B,E[2]+=k,E[3]+=B,E[4]+=k;case"Q":rt=E[1],lt=E[2],B=E[3],k=E[4];break;case"t":E[0]="T",E[1]+=B,E[2]+=k;case"T":J==="Q"?(rt=2*B-rt,lt=2*k-lt):(rt=B,lt=k),E[0]="Q",B=E[1],k=E[2],E[1]=rt,E[2]=lt,E[3]=B,E[4]=k;break;case"a":E[0]="A",E[6]+=B,E[7]+=k;case"A":N=!0,q=q.concat(u(B,k,E)),B=E[6],k=E[7];break;case"z":case"Z":B=Y,k=I;break}N||q.push(E),J=E[0]}return q}function h(x,B,k,D){return Math.sqrt((k-x)*(k-x)+(D-B)*(D-B))}function p(x){return x*x*x}function m(x){return 3*x*x*(1-x)}function y(x){return 3*x*(1-x)*(1-x)}function _(x){return(1-x)*(1-x)*(1-x)}function C(x,B,k,D,Y,I,E,P){return function(N){var q=p(N),J=m(N),rt=y(N),lt=_(N);return{x:E*q+Y*J+k*rt+x*lt,y:P*q+I*J+D*rt+B*lt}}}function w(x,B,k,D,Y,I,E,P){return function(N){var q=1-N,J=3*q*q*(k-x)+6*q*N*(Y-k)+3*N*N*(E-Y),rt=3*q*q*(D-B)+6*q*N*(I-D)+3*N*N*(P-I);return Math.atan2(rt,J)}}function b(x){return x*x}function S(x){return 2*x*(1-x)}function F(x){return(1-x)*(1-x)}function $(x,B,k,D,Y,I){return function(E){var P=b(E),N=S(E),q=F(E);return{x:Y*P+k*N+x*q,y:I*P+D*N+B*q}}}function Q(x,B,k,D,Y,I){return function(E){var P=1-E,N=2*P*(k-x)+2*E*(Y-k),q=2*P*(D-B)+2*E*(I-D);return Math.atan2(q,N)}}function R(x,B,k){var D={x:B,y:k},Y,I=0,E;for(E=1;E<=100;E+=1)Y=x(E/100),I+=h(D.x,D.y,Y.x,Y.y),D=Y;return I}function H(x,B){for(var k=0,D=0,Y=x.iterator,I={x:x.x,y:x.y},E,P,N=.01,q=x.angleFinder,J;D<B&&N>1e-4;)E=Y(k),J=k,P=h(I.x,I.y,E.x,E.y),P+D>B?(k-=N,N/=2):(I=E,k+=N,D+=P);return E.angle=q(J),E}function W(x){for(var B=0,k=x.length,D,Y=0,I=0,E=0,P=0,N=[],q,J,rt,lt=0;lt<k;lt++){switch(D=x[lt],J={x:Y,y:I,command:D[0]},D[0]){case"M":J.length=0,E=Y=D[1],P=I=D[2];break;case"L":J.length=h(Y,I,D[1],D[2]),Y=D[1],I=D[2];break;case"C":q=C(Y,I,D[1],D[2],D[3],D[4],D[5],D[6]),rt=w(Y,I,D[1],D[2],D[3],D[4],D[5],D[6]),J.iterator=q,J.angleFinder=rt,J.length=R(q,Y,I),Y=D[5],I=D[6];break;case"Q":q=$(Y,I,D[1],D[2],D[3],D[4]),rt=Q(Y,I,D[1],D[2],D[3],D[4]),J.iterator=q,J.angleFinder=rt,J.length=R(q,Y,I),Y=D[3],I=D[4];break;case"Z":case"z":J.destX=E,J.destY=P,J.length=h(Y,I,E,P),Y=E,I=P;break}B+=J.length,N.push(J)}return N.push({length:B,x:Y,y:I}),N}function G(x,B,k){k||(k=W(x));for(var D=0;B-k[D].length>0&&D<k.length-2;)B-=k[D].length,D++;var Y=k[D],I=B/Y.length,E=Y.command,P=x[D],N;switch(E){case"M":return{x:Y.x,y:Y.y,angle:0};case"Z":case"z":return N=new t.Point(Y.x,Y.y).lerp(new t.Point(Y.destX,Y.destY),I),N.angle=Math.atan2(Y.destY-Y.y,Y.destX-Y.x),N;case"L":return N=new t.Point(Y.x,Y.y).lerp(new t.Point(P[1],P[2]),I),N.angle=Math.atan2(P[2]-Y.y,P[1]-Y.x),N;case"C":return H(Y,B);case"Q":return H(Y,B)}}function V(x){var B=[],k=[],D,Y,I=t.rePathCommand,E="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",P="("+E+")"+t.commaWsp,N="([01])"+t.commaWsp+"?",q=P+"?"+P+"?"+P+N+N+P+"?("+E+")",J=new RegExp(q,"g"),rt,lt,dt;if(!x||!x.match)return B;dt=x.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);for(var U=0,j,K=dt.length;U<K;U++){D=dt[U],lt=D.slice(1).trim(),k.length=0;var it=D.charAt(0);if(j=[it],it.toLowerCase()==="a")for(var tt;tt=J.exec(lt);)for(var ct=1;ct<tt.length;ct++)k.push(tt[ct]);else for(;rt=I.exec(lt);)k.push(rt[0]);for(var ct=0,ht=k.length;ct<ht;ct++)Y=parseFloat(k[ct]),isNaN(Y)||j.push(Y);var yt=i[it.toLowerCase()],At=c[it]||it;if(j.length-1>yt)for(var at=1,mt=j.length;at<mt;at+=yt)B.push([it].concat(j.slice(at,at+yt))),it=At;else B.push(j)}return B}function st(x,B){var k=[],D,Y=new t.Point(x[0].x,x[0].y),I=new t.Point(x[1].x,x[1].y),E=x.length,P=1,N=0,q=E>2;for(B=B||0,q&&(P=x[2].x<I.x?-1:x[2].x===I.x?0:1,N=x[2].y<I.y?-1:x[2].y===I.y?0:1),k.push(["M",Y.x-P*B,Y.y-N*B]),D=1;D<E;D++){if(!Y.eq(I)){var J=Y.midPointFrom(I);k.push(["Q",Y.x,Y.y,J.x,J.y])}Y=x[D],D+1<x.length&&(I=x[D+1])}return q&&(P=Y.x>x[D-2].x?1:Y.x===x[D-2].x?0:-1,N=Y.y>x[D-2].y?1:Y.y===x[D-2].y?0:-1),k.push(["L",Y.x+P*B,Y.y+N*B]),k}function et(x,B,k){return k&&(B=t.util.multiplyTransformMatrices(B,[1,0,0,1,-k.x,-k.y])),x.map(function(D){for(var Y=D.slice(0),I={},E=1;E<D.length-1;E+=2)I.x=D[E],I.y=D[E+1],I=t.util.transformPoint(I,B),Y[E]=I.x,Y[E+1]=I.y;return Y})}t.util.joinPath=function(x){return x.map(function(B){return B.join(" ")}).join(" ")},t.util.parsePath=V,t.util.makePathSimpler=d,t.util.getSmoothPathFromPoints=st,t.util.getPathSegmentsInfo=W,t.util.getBoundsOfCurve=s,t.util.getPointOnPath=G,t.util.transformPath=et}(),function(){var f=Array.prototype.slice;function i(s,u){for(var d=f.call(arguments,2),h=[],p=0,m=s.length;p<m;p++)h[p]=d.length?s[p][u].apply(s[p],d):s[p][u].call(s[p]);return h}function c(s,u){return a(s,u,function(d,h){return d>=h})}function l(s,u){return a(s,u,function(d,h){return d<h})}function r(s,u){for(var d=s.length;d--;)s[d]=u;return s}function a(s,u,d){if(!(!s||s.length===0)){var h=s.length-1,p=u?s[h][u]:s[h];if(u)for(;h--;)d(s[h][u],p)&&(p=s[h][u]);else for(;h--;)d(s[h],p)&&(p=s[h]);return p}}t.util.array={fill:r,invoke:i,min:l,max:c}}(),function(){function f(c,l,r){if(r)if(!t.isLikelyNode&&l instanceof Element)c=l;else if(l instanceof Array){c=[];for(var a=0,s=l.length;a<s;a++)c[a]=f({},l[a],r)}else if(l&&typeof l=="object")for(var u in l)u==="canvas"||u==="group"?c[u]=null:l.hasOwnProperty(u)&&(c[u]=f({},l[u],r));else c=l;else for(var u in l)c[u]=l[u];return c}function i(c,l){return f({},c,l)}t.util.object={extend:f,clone:i},t.util.object.extend(t.util,t.Observable)}(),function(){function f(a){return a.replace(/-+(.)?/g,function(s,u){return u?u.toUpperCase():""})}function i(a,s){return a.charAt(0).toUpperCase()+(s?a.slice(1):a.slice(1).toLowerCase())}function c(a){return a.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function l(a){var s=0,u,d=[];for(s=0,u;s<a.length;s++)(u=r(a,s))!==!1&&d.push(u);return d}function r(a,s){var u=a.charCodeAt(s);if(isNaN(u))return"";if(u<55296||u>57343)return a.charAt(s);if(55296<=u&&u<=56319){if(a.length<=s+1)throw"High surrogate without following low surrogate";var d=a.charCodeAt(s+1);if(56320>d||d>57343)throw"High surrogate without following low surrogate";return a.charAt(s)+a.charAt(s+1)}if(s===0)throw"Low surrogate without preceding high surrogate";var h=a.charCodeAt(s-1);if(55296>h||h>56319)throw"Low surrogate without preceding high surrogate";return!1}t.util.string={camelize:f,capitalize:i,escapeXml:c,graphemeSplit:l}}(),function(){var f=Array.prototype.slice,i=function(){},c=function(){for(var u in{toString:1})if(u==="toString")return!1;return!0}(),l=function(u,d,h){for(var p in d)p in u.prototype&&typeof u.prototype[p]=="function"&&(d[p]+"").indexOf("callSuper")>-1?u.prototype[p]=function(m){return function(){var y=this.constructor.superclass;this.constructor.superclass=h;var _=d[m].apply(this,arguments);if(this.constructor.superclass=y,m!=="initialize")return _}}(p):u.prototype[p]=d[p],c&&(d.toString!==Object.prototype.toString&&(u.prototype.toString=d.toString),d.valueOf!==Object.prototype.valueOf&&(u.prototype.valueOf=d.valueOf))};function r(){}function a(u){for(var d=null,h=this;h.constructor.superclass;){var p=h.constructor.superclass.prototype[u];if(h[u]!==p){d=p;break}h=h.constructor.superclass.prototype}return d?arguments.length>1?d.apply(this,f.call(arguments,1)):d.call(this):console.log("tried to callSuper "+u+", method not found in prototype chain",this)}function s(){var u=null,d=f.call(arguments,0);typeof d[0]=="function"&&(u=d.shift());function h(){this.initialize.apply(this,arguments)}h.superclass=u,h.subclasses=[],u&&(r.prototype=u.prototype,h.prototype=new r,u.subclasses.push(h));for(var p=0,m=d.length;p<m;p++)l(h,d[p],u);return h.prototype.initialize||(h.prototype.initialize=i),h.prototype.constructor=h,h.prototype.callSuper=a,h}t.util.createClass=s}(),function(){var f=!!t.document.createElement("div").attachEvent,i=["touchstart","touchmove","touchend"];t.util.addListener=function(l,r,a,s){l&&l.addEventListener(r,a,f?!1:s)},t.util.removeListener=function(l,r,a,s){l&&l.removeEventListener(r,a,f?!1:s)};function c(l){var r=l.changedTouches;return r&&r[0]?r[0]:l}t.util.getPointer=function(l){var r=l.target,a=t.util.getScrollLeftTop(r),s=c(l);return{x:s.clientX+a.left,y:s.clientY+a.top}},t.util.isTouchEvent=function(l){return i.indexOf(l.type)>-1||l.pointerType==="touch"}}(),function(){function f(s,u){var d=s.style;if(!d)return s;if(typeof u=="string")return s.style.cssText+=";"+u,u.indexOf("opacity")>-1?a(s,u.match(/opacity:\s*(\d?\.?\d*)/)[1]):s;for(var h in u)if(h==="opacity")a(s,u[h]);else{var p=h==="float"||h==="cssFloat"?typeof d.styleFloat=="undefined"?"cssFloat":"styleFloat":h;d.setProperty(p,u[h])}return s}var i=t.document.createElement("div"),c=typeof i.style.opacity=="string",l=typeof i.style.filter=="string",r=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,a=function(s){return s};c?a=function(s,u){return s.style.opacity=u,s}:l&&(a=function(s,u){var d=s.style;return s.currentStyle&&!s.currentStyle.hasLayout&&(d.zoom=1),r.test(d.filter)?(u=u>=.9999?"":"alpha(opacity="+u*100+")",d.filter=d.filter.replace(r,u)):d.filter+=" alpha(opacity="+u*100+")",s}),t.util.setStyle=f}(),function(){var f=Array.prototype.slice;function i(_){return typeof _=="string"?t.document.getElementById(_):_}var c,l=function(_){return f.call(_,0)};try{c=l(t.document.childNodes)instanceof Array}catch(_){}c||(l=function(_){for(var C=new Array(_.length),w=_.length;w--;)C[w]=_[w];return C});function r(_,C){var w=t.document.createElement(_);for(var b in C)b==="class"?w.className=C[b]:b==="for"?w.htmlFor=C[b]:w.setAttribute(b,C[b]);return w}function a(_,C){_&&(" "+_.className+" ").indexOf(" "+C+" ")===-1&&(_.className+=(_.className?" ":"")+C)}function s(_,C,w){return typeof C=="string"&&(C=r(C,w)),_.parentNode&&_.parentNode.replaceChild(C,_),C.appendChild(_),C}function u(_){for(var C=0,w=0,b=t.document.documentElement,S=t.document.body||{scrollLeft:0,scrollTop:0};_&&(_.parentNode||_.host)&&(_=_.parentNode||_.host,_===t.document?(C=S.scrollLeft||b.scrollLeft||0,w=S.scrollTop||b.scrollTop||0):(C+=_.scrollLeft||0,w+=_.scrollTop||0),!(_.nodeType===1&&_.style.position==="fixed")););return{left:C,top:w}}function d(_){var C,w=_&&_.ownerDocument,b={left:0,top:0},S={left:0,top:0},F,$={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!w)return S;for(var Q in $)S[$[Q]]+=parseInt(h(_,Q),10)||0;return C=w.documentElement,typeof _.getBoundingClientRect!="undefined"&&(b=_.getBoundingClientRect()),F=u(_),{left:b.left+F.left-(C.clientLeft||0)+S.left,top:b.top+F.top-(C.clientTop||0)+S.top}}var h;t.document.defaultView&&t.document.defaultView.getComputedStyle?h=function(_,C){var w=t.document.defaultView.getComputedStyle(_,null);return w?w[C]:void 0}:h=function(_,C){var w=_.style[C];return!w&&_.currentStyle&&(w=_.currentStyle[C]),w},function(){var _=t.document.documentElement.style,C="userSelect"in _?"userSelect":"MozUserSelect"in _?"MozUserSelect":"WebkitUserSelect"in _?"WebkitUserSelect":"KhtmlUserSelect"in _?"KhtmlUserSelect":"";function w(S){return typeof S.onselectstart!="undefined"&&(S.onselectstart=t.util.falseFunction),C?S.style[C]="none":typeof S.unselectable=="string"&&(S.unselectable="on"),S}function b(S){return typeof S.onselectstart!="undefined"&&(S.onselectstart=null),C?S.style[C]="":typeof S.unselectable=="string"&&(S.unselectable=""),S}t.util.makeElementUnselectable=w,t.util.makeElementSelectable=b}();function p(_){var C=t.jsdomImplForWrapper(_);return C._canvas||C._image}function m(_){if(t.isLikelyNode){var C=t.jsdomImplForWrapper(_);C&&(C._image=null,C._canvas=null,C._currentSrc=null,C._attributes=null,C._classList=null)}}function y(_,C){_.imageSmoothingEnabled=_.imageSmoothingEnabled||_.webkitImageSmoothingEnabled||_.mozImageSmoothingEnabled||_.msImageSmoothingEnabled||_.oImageSmoothingEnabled,_.imageSmoothingEnabled=C}t.util.setImageSmoothing=y,t.util.getById=i,t.util.toArray=l,t.util.addClass=a,t.util.makeElement=r,t.util.wrapElement=s,t.util.getScrollLeftTop=u,t.util.getElementOffset=d,t.util.getNodeCanvas=p,t.util.cleanUpJsdomNode=m}(),function(){function f(l,r){return l+(/\?/.test(l)?"&":"?")+r}function i(){}function c(l,r){r||(r={});var a=r.method?r.method.toUpperCase():"GET",s=r.onComplete||function(){},u=new t.window.XMLHttpRequest,d=r.body||r.parameters;return u.onreadystatechange=function(){u.readyState===4&&(s(u),u.onreadystatechange=i)},a==="GET"&&(d=null,typeof r.parameters=="string"&&(l=f(l,r.parameters))),u.open(a,l,!0),(a==="POST"||a==="PUT")&&u.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),u.send(d),u}t.util.request=c}(),t.log=console.log,t.warn=console.warn,function(){var f=t.util.object.extend,i=t.util.object.clone,c=[];t.util.object.extend(c,{cancelAll:function(){var p=this.splice(0);return p.forEach(function(m){m.cancel()}),p},cancelByCanvas:function(p){if(!p)return[];var m=this.filter(function(y){return typeof y.target=="object"&&y.target.canvas===p});return m.forEach(function(y){y.cancel()}),m},cancelByTarget:function(p){var m=this.findAnimationsByTarget(p);return m.forEach(function(y){y.cancel()}),m},findAnimationIndex:function(p){return this.indexOf(this.findAnimation(p))},findAnimation:function(p){return this.find(function(m){return m.cancel===p})},findAnimationsByTarget:function(p){return p?this.filter(function(m){return m.target===p}):[]}});function l(){return!1}function r(p,m,y,_){return-y*Math.cos(p/_*(Math.PI/2))+y+m}function a(p){p||(p={});var m=!1,y,_=function(){var C=t.runningAnimations.indexOf(y);return C>-1&&t.runningAnimations.splice(C,1)[0]};return y=f(i(p),{cancel:function(){return m=!0,_()},currentValue:"startValue"in p?p.startValue:0,completionRate:0,durationRate:0}),t.runningAnimations.push(y),d(function(C){var w=C||+new Date,b=p.duration||500,S=w+b,F,$=p.onChange||l,Q=p.abort||l,R=p.onComplete||l,H=p.easing||r,W="startValue"in p?p.startValue.length>0:!1,G="startValue"in p?p.startValue:0,V="endValue"in p?p.endValue:100,st=p.byValue||(W?G.map(function(et,x){return V[x]-G[x]}):V-G);p.onStart&&p.onStart(),function et(x){F=x||+new Date;var B=F>S?b:F-w,k=B/b,D=W?G.map(function(I,E){return H(B,G[E],st[E],b)}):H(B,G,st,b),Y=Math.abs(W?(D[0]-G[0])/st[0]:(D-G)/st);if(y.currentValue=W?D.slice():D,y.completionRate=Y,y.durationRate=k,!m){if(Q(D,Y,k)){_();return}if(F>S){y.currentValue=W?V.slice():V,y.completionRate=1,y.durationRate=1,$(W?V.slice():V,1,1),R(V,1,1),_();return}else $(D,Y,k),d(et)}}(w)}),y.cancel}var s=t.window.requestAnimationFrame||t.window.webkitRequestAnimationFrame||t.window.mozRequestAnimationFrame||t.window.oRequestAnimationFrame||t.window.msRequestAnimationFrame||function(p){return t.window.setTimeout(p,1e3/60)},u=t.window.cancelAnimationFrame||t.window.clearTimeout;function d(){return s.apply(t.window,arguments)}function h(){return u.apply(t.window,arguments)}t.util.animate=a,t.util.requestAnimFrame=d,t.util.cancelAnimFrame=h,t.runningAnimations=c}(),function(){function f(c,l,r){var a="rgba("+parseInt(c[0]+r*(l[0]-c[0]),10)+","+parseInt(c[1]+r*(l[1]-c[1]),10)+","+parseInt(c[2]+r*(l[2]-c[2]),10);return a+=","+(c&&l?parseFloat(c[3]+r*(l[3]-c[3])):1),a+=")",a}function i(c,l,r,a){var s=new t.Color(c).getSource(),u=new t.Color(l).getSource(),d=a.onComplete,h=a.onChange;return a=a||{},t.util.animate(t.util.object.extend(a,{duration:r||500,startValue:s,endValue:u,byValue:u,easing:function(p,m,y,_){var C=a.colorEasing?a.colorEasing(p,_):1-Math.cos(p/_*(Math.PI/2));return f(m,y,C)},onComplete:function(p,m,y){if(d)return d(f(u,u,0),m,y)},onChange:function(p,m,y){if(h){if(Array.isArray(p))return h(f(p,p,0),m,y);h(p,m,y)}}}))}t.util.animateColor=i}(),function(){function f(x,B,k,D){return x<Math.abs(B)?(x=B,D=k/4):B===0&&x===0?D=k/(2*Math.PI)*Math.asin(1):D=k/(2*Math.PI)*Math.asin(B/x),{a:x,c:B,p:k,s:D}}function i(x,B,k){return x.a*Math.pow(2,10*(B-=1))*Math.sin((B*k-x.s)*(2*Math.PI)/x.p)}function c(x,B,k,D){return k*((x=x/D-1)*x*x+1)+B}function l(x,B,k,D){return x/=D/2,x<1?k/2*x*x*x+B:k/2*((x-=2)*x*x+2)+B}function r(x,B,k,D){return k*(x/=D)*x*x*x+B}function a(x,B,k,D){return-k*((x=x/D-1)*x*x*x-1)+B}function s(x,B,k,D){return x/=D/2,x<1?k/2*x*x*x*x+B:-k/2*((x-=2)*x*x*x-2)+B}function u(x,B,k,D){return k*(x/=D)*x*x*x*x+B}function d(x,B,k,D){return k*((x=x/D-1)*x*x*x*x+1)+B}function h(x,B,k,D){return x/=D/2,x<1?k/2*x*x*x*x*x+B:k/2*((x-=2)*x*x*x*x+2)+B}function p(x,B,k,D){return-k*Math.cos(x/D*(Math.PI/2))+k+B}function m(x,B,k,D){return k*Math.sin(x/D*(Math.PI/2))+B}function y(x,B,k,D){return-k/2*(Math.cos(Math.PI*x/D)-1)+B}function _(x,B,k,D){return x===0?B:k*Math.pow(2,10*(x/D-1))+B}function C(x,B,k,D){return x===D?B+k:k*(-Math.pow(2,-10*x/D)+1)+B}function w(x,B,k,D){return x===0?B:x===D?B+k:(x/=D/2,x<1?k/2*Math.pow(2,10*(x-1))+B:k/2*(-Math.pow(2,-10*--x)+2)+B)}function b(x,B,k,D){return-k*(Math.sqrt(1-(x/=D)*x)-1)+B}function S(x,B,k,D){return k*Math.sqrt(1-(x=x/D-1)*x)+B}function F(x,B,k,D){return x/=D/2,x<1?-k/2*(Math.sqrt(1-x*x)-1)+B:k/2*(Math.sqrt(1-(x-=2)*x)+1)+B}function $(x,B,k,D){var Y=1.70158,I=0,E=k;if(x===0)return B;if(x/=D,x===1)return B+k;I||(I=D*.3);var P=f(E,k,I,Y);return-i(P,x,D)+B}function Q(x,B,k,D){var Y=1.70158,I=0,E=k;if(x===0)return B;if(x/=D,x===1)return B+k;I||(I=D*.3);var P=f(E,k,I,Y);return P.a*Math.pow(2,-10*x)*Math.sin((x*D-P.s)*(2*Math.PI)/P.p)+P.c+B}function R(x,B,k,D){var Y=1.70158,I=0,E=k;if(x===0)return B;if(x/=D/2,x===2)return B+k;I||(I=D*(.3*1.5));var P=f(E,k,I,Y);return x<1?-.5*i(P,x,D)+B:P.a*Math.pow(2,-10*(x-=1))*Math.sin((x*D-P.s)*(2*Math.PI)/P.p)*.5+P.c+B}function H(x,B,k,D,Y){return Y===void 0&&(Y=1.70158),k*(x/=D)*x*((Y+1)*x-Y)+B}function W(x,B,k,D,Y){return Y===void 0&&(Y=1.70158),k*((x=x/D-1)*x*((Y+1)*x+Y)+1)+B}function G(x,B,k,D,Y){return Y===void 0&&(Y=1.70158),x/=D/2,x<1?k/2*(x*x*(((Y*=1.525)+1)*x-Y))+B:k/2*((x-=2)*x*(((Y*=1.525)+1)*x+Y)+2)+B}function V(x,B,k,D){return k-st(D-x,0,k,D)+B}function st(x,B,k,D){return(x/=D)<1/2.75?k*(7.5625*x*x)+B:x<2/2.75?k*(7.5625*(x-=1.5/2.75)*x+.75)+B:x<2.5/2.75?k*(7.5625*(x-=2.25/2.75)*x+.9375)+B:k*(7.5625*(x-=2.625/2.75)*x+.984375)+B}function et(x,B,k,D){return x<D/2?V(x*2,0,k,D)*.5+B:st(x*2-D,0,k,D)*.5+k*.5+B}t.util.ease={easeInQuad:function(x,B,k,D){return k*(x/=D)*x+B},easeOutQuad:function(x,B,k,D){return-k*(x/=D)*(x-2)+B},easeInOutQuad:function(x,B,k,D){return x/=D/2,x<1?k/2*x*x+B:-k/2*(--x*(x-2)-1)+B},easeInCubic:function(x,B,k,D){return k*(x/=D)*x*x+B},easeOutCubic:c,easeInOutCubic:l,easeInQuart:r,easeOutQuart:a,easeInOutQuart:s,easeInQuint:u,easeOutQuint:d,easeInOutQuint:h,easeInSine:p,easeOutSine:m,easeInOutSine:y,easeInExpo:_,easeOutExpo:C,easeInOutExpo:w,easeInCirc:b,easeOutCirc:S,easeInOutCirc:F,easeInElastic:$,easeOutElastic:Q,easeInOutElastic:R,easeInBack:H,easeOutBack:W,easeInOutBack:G,easeInBounce:V,easeOutBounce:st,easeInOutBounce:et}}(),function(f){var i=f.fabric||(f.fabric={}),c=i.util.object.extend,l=i.util.object.clone,r=i.util.toFixed,a=i.util.parseUnit,s=i.util.multiplyTransformMatrices,u=["path","circle","polygon","polyline","ellipse","rect","line","image","text"],d=["symbol","image","marker","pattern","view","svg"],h=["pattern","defs","symbol","metadata","clipPath","mask","desc"],p=["symbol","g","a","svg","clipPath","defs"],m={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},y={stroke:"strokeOpacity",fill:"fillOpacity"},_="font-size",C="clip-path";i.svgValidTagNamesRegEx=S(u),i.svgViewBoxElementsRegEx=S(d),i.svgInvalidAncestorsRegEx=S(h),i.svgValidParentsRegEx=S(p),i.cssRules={},i.gradientDefs={},i.clipPaths={};function w(I){return I in m?m[I]:I}function b(I,E,P,N){var q=Array.isArray(E),J;if((I==="fill"||I==="stroke")&&E==="none")E="";else{if(I==="strokeUniform")return E==="non-scaling-stroke";if(I==="strokeDashArray")E==="none"?E=null:E=E.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(I==="transformMatrix")P&&P.transformMatrix?E=s(P.transformMatrix,i.parseTransformAttribute(E)):E=i.parseTransformAttribute(E);else if(I==="visible")E=E!=="none"&&E!=="hidden",P&&P.visible===!1&&(E=!1);else if(I==="opacity")E=parseFloat(E),P&&typeof P.opacity!="undefined"&&(E*=P.opacity);else if(I==="textAnchor")E=E==="start"?"left":E==="end"?"right":"center";else if(I==="charSpacing")J=a(E,N)/N*1e3;else if(I==="paintFirst"){var rt=E.indexOf("fill"),lt=E.indexOf("stroke"),E="fill";(rt>-1&&lt>-1&&lt<rt||rt===-1&&lt>-1)&&(E="stroke")}else{if(I==="href"||I==="xlink:href"||I==="font")return E;if(I==="imageSmoothing")return E==="optimizeQuality";J=q?E.map(a):a(E,N)}}return!q&&isNaN(J)?E:J}function S(I){return new RegExp("^("+I.join("|")+")\\b","i")}function F(I){for(var E in y)if(!(typeof I[y[E]]=="undefined"||I[E]==="")){if(typeof I[E]=="undefined"){if(!i.Object.prototype[E])continue;I[E]=i.Object.prototype[E]}if(I[E].indexOf("url(")!==0){var P=new i.Color(I[E]);I[E]=P.setAlpha(r(P.getAlpha()*I[y[E]],2)).toRgba()}}return I}function $(I,E){var P,N=[],q,J,rt;for(J=0,rt=E.length;J<rt;J++)P=E[J],q=I.getElementsByTagName(P),N=N.concat(Array.prototype.slice.call(q));return N}i.parseTransformAttribute=function(){function I(at,mt){var St=i.util.cos(mt[0]),Tt=i.util.sin(mt[0]),jt=0,Dt=0;mt.length===3&&(jt=mt[1],Dt=mt[2]),at[0]=St,at[1]=Tt,at[2]=-Tt,at[3]=St,at[4]=jt-(St*jt-Tt*Dt),at[5]=Dt-(Tt*jt+St*Dt)}function E(at,mt){var St=mt[0],Tt=mt.length===2?mt[1]:mt[0];at[0]=St,at[3]=Tt}function P(at,mt,St){at[St]=Math.tan(i.util.degreesToRadians(mt[0]))}function N(at,mt){at[4]=mt[0],mt.length===2&&(at[5]=mt[1])}var q=i.iMatrix,J=i.reNum,rt=i.commaWsp,lt="(?:(skewX)\\s*\\(\\s*("+J+")\\s*\\))",dt="(?:(skewY)\\s*\\(\\s*("+J+")\\s*\\))",U="(?:(rotate)\\s*\\(\\s*("+J+")(?:"+rt+"("+J+")"+rt+"("+J+"))?\\s*\\))",j="(?:(scale)\\s*\\(\\s*("+J+")(?:"+rt+"("+J+"))?\\s*\\))",K="(?:(translate)\\s*\\(\\s*("+J+")(?:"+rt+"("+J+"))?\\s*\\))",it="(?:(matrix)\\s*\\(\\s*("+J+")"+rt+"("+J+")"+rt+"("+J+")"+rt+"("+J+")"+rt+"("+J+")"+rt+"("+J+")\\s*\\))",tt="(?:"+it+"|"+K+"|"+j+"|"+U+"|"+lt+"|"+dt+")",ct="(?:"+tt+"(?:"+rt+"*"+tt+")*)",ht="^\\s*(?:"+ct+"?)\\s*$",yt=new RegExp(ht),At=new RegExp(tt,"g");return function(at){var mt=q.concat(),St=[];if(!at||at&&!yt.test(at))return mt;at.replace(At,function(jt){var Dt=new RegExp(tt).exec(jt).filter(function(an){return!!an}),Yt=Dt[1],qt=Dt.slice(2).map(parseFloat);switch(Yt){case"translate":N(mt,qt);break;case"rotate":qt[0]=i.util.degreesToRadians(qt[0]),I(mt,qt);break;case"scale":E(mt,qt);break;case"skewX":P(mt,qt,2);break;case"skewY":P(mt,qt,1);break;case"matrix":mt=qt;break}St.push(mt.concat()),mt=q.concat()});for(var Tt=St[0];St.length>1;)St.shift(),Tt=i.util.multiplyTransformMatrices(Tt,St[0]);return Tt}}();function Q(I,E){var P,N;I.replace(/;\s*$/,"").split(";").forEach(function(q){var J=q.split(":");P=J[0].trim().toLowerCase(),N=J[1].trim(),E[P]=N})}function R(I,E){var P,N;for(var q in I)typeof I[q]!="undefined"&&(P=q.toLowerCase(),N=I[q],E[P]=N)}function H(I,E){var P={};for(var N in i.cssRules[E])if(W(I,N.split(" ")))for(var q in i.cssRules[E][N])P[q]=i.cssRules[E][N][q];return P}function W(I,E){var P,N=!0;return P=V(I,E.pop()),P&&E.length&&(N=G(I,E)),P&&N&&E.length===0}function G(I,E){for(var P,N=!0;I.parentNode&&I.parentNode.nodeType===1&&E.length;)N&&(P=E.pop()),I=I.parentNode,N=V(I,P);return E.length===0}function V(I,E){var P=I.nodeName,N=I.getAttribute("class"),q=I.getAttribute("id"),J,rt;if(J=new RegExp("^"+P,"i"),E=E.replace(J,""),q&&E.length&&(J=new RegExp("#"+q+"(?![a-zA-Z\\-]+)","i"),E=E.replace(J,"")),N&&E.length)for(N=N.split(" "),rt=N.length;rt--;)J=new RegExp("\\."+N[rt]+"(?![a-zA-Z\\-]+)","i"),E=E.replace(J,"");return E.length===0}function st(I,E){var P;if(I.getElementById&&(P=I.getElementById(E)),P)return P;var N,q,J,rt=I.getElementsByTagName("*");for(q=0,J=rt.length;q<J;q++)if(N=rt[q],E===N.getAttribute("id"))return N}function et(I){for(var E=$(I,["use","svg:use"]),P=0;E.length&&P<E.length;){var N=E[P],q=N.getAttribute("xlink:href")||N.getAttribute("href");if(q===null)return;var J=q.slice(1),rt=N.getAttribute("x")||0,lt=N.getAttribute("y")||0,dt=st(I,J).cloneNode(!0),U=(dt.getAttribute("transform")||"")+" translate("+rt+", "+lt+")",j,K=E.length,it,tt,ct,ht,yt=i.svgNS;if(B(dt),/^svg$/i.test(dt.nodeName)){var At=dt.ownerDocument.createElementNS(yt,"g");for(tt=0,ct=dt.attributes,ht=ct.length;tt<ht;tt++)it=ct.item(tt),At.setAttributeNS(yt,it.nodeName,it.nodeValue);for(;dt.firstChild;)At.appendChild(dt.firstChild);dt=At}for(tt=0,ct=N.attributes,ht=ct.length;tt<ht;tt++)it=ct.item(tt),!(it.nodeName==="x"||it.nodeName==="y"||it.nodeName==="xlink:href"||it.nodeName==="href")&&(it.nodeName==="transform"?U=it.nodeValue+" "+U:dt.setAttribute(it.nodeName,it.nodeValue));dt.setAttribute("transform",U),dt.setAttribute("instantiated_by_use","1"),dt.removeAttribute("id"),j=N.parentNode,j.replaceChild(dt,N),E.length===K&&P++}}var x=new RegExp("^\\s*("+i.reNum+"+)\\s*,?\\s*("+i.reNum+"+)\\s*,?\\s*("+i.reNum+"+)\\s*,?\\s*("+i.reNum+"+)\\s*$");function B(I){if(!i.svgViewBoxElementsRegEx.test(I.nodeName))return{};var E=I.getAttribute("viewBox"),P=1,N=1,q=0,J=0,rt,lt,dt,U,j=I.getAttribute("width"),K=I.getAttribute("height"),it=I.getAttribute("x")||0,tt=I.getAttribute("y")||0,ct=I.getAttribute("preserveAspectRatio")||"",ht=!E||!(E=E.match(x)),yt=!j||!K||j==="100%"||K==="100%",At=ht&&yt,at={},mt="",St=0,Tt=0;if(at.width=0,at.height=0,at.toBeParsed=At,ht&&(it||tt)&&I.parentNode&&I.parentNode.nodeName!=="#document"&&(mt=" translate("+a(it)+" "+a(tt)+") ",dt=(I.getAttribute("transform")||"")+mt,I.setAttribute("transform",dt),I.removeAttribute("x"),I.removeAttribute("y")),At)return at;if(ht)return at.width=a(j),at.height=a(K),at;if(q=-parseFloat(E[1]),J=-parseFloat(E[2]),rt=parseFloat(E[3]),lt=parseFloat(E[4]),at.minX=q,at.minY=J,at.viewBoxWidth=rt,at.viewBoxHeight=lt,yt?(at.width=rt,at.height=lt):(at.width=a(j),at.height=a(K),P=at.width/rt,N=at.height/lt),ct=i.util.parsePreserveAspectRatioAttribute(ct),ct.alignX!=="none"&&(ct.meetOrSlice==="meet"&&(N=P=P>N?N:P),ct.meetOrSlice==="slice"&&(N=P=P>N?P:N),St=at.width-rt*P,Tt=at.height-lt*P,ct.alignX==="Mid"&&(St/=2),ct.alignY==="Mid"&&(Tt/=2),ct.alignX==="Min"&&(St=0),ct.alignY==="Min"&&(Tt=0)),P===1&&N===1&&q===0&&J===0&&it===0&&tt===0)return at;if((it||tt)&&I.parentNode.nodeName!=="#document"&&(mt=" translate("+a(it)+" "+a(tt)+") "),dt=mt+" matrix("+P+" 0 0 "+N+" "+(q*P+St)+" "+(J*N+Tt)+") ",I.nodeName==="svg"){for(U=I.ownerDocument.createElementNS(i.svgNS,"g");I.firstChild;)U.appendChild(I.firstChild);I.appendChild(U)}else U=I,U.removeAttribute("x"),U.removeAttribute("y"),dt=U.getAttribute("transform")+dt;return U.setAttribute("transform",dt),at}function k(I,E){for(;I&&(I=I.parentNode);)if(I.nodeName&&E.test(I.nodeName.replace("svg:",""))&&!I.getAttribute("instantiated_by_use"))return!0;return!1}i.parseSVGDocument=function(I,E,P,N){if(I){et(I);var q=i.Object.__uid++,J,rt,lt=B(I),dt=i.util.toArray(I.getElementsByTagName("*"));if(lt.crossOrigin=N&&N.crossOrigin,lt.svgUid=q,dt.length===0&&i.isLikelyNode){dt=I.selectNodes('//*[name(.)!="svg"]');var U=[];for(J=0,rt=dt.length;J<rt;J++)U[J]=dt[J];dt=U}var j=dt.filter(function(it){return B(it),i.svgValidTagNamesRegEx.test(it.nodeName.replace("svg:",""))&&!k(it,i.svgInvalidAncestorsRegEx)});if(!j||j&&!j.length){E&&E([],{});return}var K={};dt.filter(function(it){return it.nodeName.replace("svg:","")==="clipPath"}).forEach(function(it){var tt=it.getAttribute("id");K[tt]=i.util.toArray(it.getElementsByTagName("*")).filter(function(ct){return i.svgValidTagNamesRegEx.test(ct.nodeName.replace("svg:",""))})}),i.gradientDefs[q]=i.getGradientDefs(I),i.cssRules[q]=i.getCSSRules(I),i.clipPaths[q]=K,i.parseElements(j,function(it,tt){E&&(E(it,lt,tt,dt),delete i.gradientDefs[q],delete i.cssRules[q],delete i.clipPaths[q])},l(lt),P,N)}};function D(I,E){var P=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],N="xlink:href",q=E.getAttribute(N).slice(1),J=st(I,q);if(J&&J.getAttribute(N)&&D(I,J),P.forEach(function(lt){J&&!E.hasAttribute(lt)&&J.hasAttribute(lt)&&E.setAttribute(lt,J.getAttribute(lt))}),!E.children.length)for(var rt=J.cloneNode(!0);rt.firstChild;)E.appendChild(rt.firstChild);E.removeAttribute(N)}var Y=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+i.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+i.reNum+"))?\\s+(.*)");c(i,{parseFontDeclaration:function(I,E){var P=I.match(Y);if(P){var N=P[1],q=P[3],J=P[4],rt=P[5],lt=P[6];N&&(E.fontStyle=N),q&&(E.fontWeight=isNaN(parseFloat(q))?q:parseFloat(q)),J&&(E.fontSize=a(J)),lt&&(E.fontFamily=lt),rt&&(E.lineHeight=rt==="normal"?1:rt)}},getGradientDefs:function(I){var E=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"],P=$(I,E),N,q=0,J={};for(q=P.length;q--;)N=P[q],N.getAttribute("xlink:href")&&D(I,N),J[N.getAttribute("id")]=N;return J},parseAttributes:function(I,E,P){if(I){var N,q={},J,rt;typeof P=="undefined"&&(P=I.getAttribute("svgUid")),I.parentNode&&i.svgValidParentsRegEx.test(I.parentNode.nodeName)&&(q=i.parseAttributes(I.parentNode,E,P));var lt=E.reduce(function(ct,ht){return N=I.getAttribute(ht),N&&(ct[ht]=N),ct},{}),dt=c(H(I,P),i.parseStyleAttribute(I));lt=c(lt,dt),dt[C]&&I.setAttribute(C,dt[C]),J=rt=q.fontSize||i.Text.DEFAULT_SVG_FONT_SIZE,lt[_]&&(lt[_]=J=a(lt[_],rt));var U,j,K={};for(var it in lt)U=w(it),j=b(U,lt[it],q,J),K[U]=j;K&&K.font&&i.parseFontDeclaration(K.font,K);var tt=c(q,K);return i.svgValidParentsRegEx.test(I.nodeName)?tt:F(tt)}},parseElements:function(I,E,P,N,q){new i.ElementsParser(I,E,P,N,q).parse()},parseStyleAttribute:function(I){var E={},P=I.getAttribute("style");return P&&(typeof P=="string"?Q(P,E):R(P,E)),E},parsePointsAttribute:function(I){if(!I)return null;I=I.replace(/,/g," ").trim(),I=I.split(/\s+/);var E=[],P,N;for(P=0,N=I.length;P<N;P+=2)E.push({x:parseFloat(I[P]),y:parseFloat(I[P+1])});return E},getCSSRules:function(I){var E=I.getElementsByTagName("style"),P,N,q={},J;for(P=0,N=E.length;P<N;P++){var rt=E[P].textContent;rt=rt.replace(/\/\*[\s\S]*?\*\//g,""),rt.trim()!==""&&(J=rt.split("}"),J=J.filter(function(lt){return lt.trim()}),J.forEach(function(lt){var dt=lt.split("{"),U={},j=dt[1].trim(),K=j.split(";").filter(function(ht){return ht.trim()});for(P=0,N=K.length;P<N;P++){var it=K[P].split(":"),tt=it[0].trim(),ct=it[1].trim();U[tt]=ct}lt=dt[0].trim(),lt.split(",").forEach(function(ht){ht=ht.replace(/^svg/i,"").trim(),ht!==""&&(q[ht]?i.util.object.extend(q[ht],U):q[ht]=i.util.object.clone(U))})}))}return q},loadSVGFromURL:function(I,E,P,N){I=I.replace(/^\n\s*/,"").trim(),new i.util.request(I,{method:"get",onComplete:q});function q(J){var rt=J.responseXML;if(!rt||!rt.documentElement)return E&&E(null),!1;i.parseSVGDocument(rt.documentElement,function(lt,dt,U,j){E&&E(lt,dt,U,j)},P,N)}},loadSVGFromString:function(I,E,P,N){var q=new i.window.DOMParser,J=q.parseFromString(I.trim(),"text/xml");i.parseSVGDocument(J.documentElement,function(rt,lt,dt,U){E(rt,lt,dt,U)},P,N)}})}(e),t.ElementsParser=function(f,i,c,l,r,a){this.elements=f,this.callback=i,this.options=c,this.reviver=l,this.svgUid=c&&c.svgUid||0,this.parsingOptions=r,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=a},function(f){f.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},f.createObjects=function(){var i=this;this.elements.forEach(function(c,l){c.setAttribute("svgUid",i.svgUid),i.createObject(c,l)})},f.findTag=function(i){return t[t.util.string.capitalize(i.tagName.replace("svg:",""))]},f.createObject=function(i,c){var l=this.findTag(i);if(l&&l.fromElement)try{l.fromElement(i,this.createCallback(c,i),this.options)}catch(r){t.log(r)}else this.checkIfDone()},f.createCallback=function(i,c){var l=this;return function(r){var a;l.resolveGradient(r,c,"fill"),l.resolveGradient(r,c,"stroke"),r instanceof t.Image&&r._originalElement&&(a=r.parsePreserveAspectRatioAttribute(c)),r._removeTransformMatrix(a),l.resolveClipPath(r,c),l.reviver&&l.reviver(c,r),l.instances[i]=r,l.checkIfDone()}},f.extractPropertyDefinition=function(i,c,l){var r=i[c],a=this.regexUrl;if(a.test(r)){a.lastIndex=0;var s=a.exec(r)[1];return a.lastIndex=0,t[l][this.svgUid][s]}},f.resolveGradient=function(i,c,l){var r=this.extractPropertyDefinition(i,l,"gradientDefs");if(r){var a=c.getAttribute(l+"-opacity"),s=t.Gradient.fromElement(r,i,a,this.options);i.set(l,s)}},f.createClipPathCallback=function(i,c){return function(l){l._removeTransformMatrix(),l.fillRule=l.clipRule,c.push(l)}},f.resolveClipPath=function(i,c){var l=this.extractPropertyDefinition(i,"clipPath","clipPaths"),r,a,s,u,d,h;if(l){u=[],s=t.util.invertTransform(i.calcTransformMatrix());for(var p=l[0].parentNode,m=c;m.parentNode&&m.getAttribute("clip-path")!==i.clipPath;)m=m.parentNode;m.parentNode.appendChild(p);for(var y=0;y<l.length;y++)r=l[y],a=this.findTag(r),a.fromElement(r,this.createClipPathCallback(i,u),this.options);u.length===1?l=u[0]:l=new t.Group(u),d=t.util.multiplyTransformMatrices(s,l.calcTransformMatrix()),l.clipPath&&this.resolveClipPath(l,m);var h=t.util.qrDecompose(d);l.flipX=!1,l.flipY=!1,l.set("scaleX",h.scaleX),l.set("scaleY",h.scaleY),l.angle=h.angle,l.skewX=h.skewX,l.skewY=0,l.setPositionByOrigin({x:h.translateX,y:h.translateY},"center","center"),i.clipPath=l}else delete i.clipPath},f.checkIfDone=function(){--this.numElements===0&&(this.instances=this.instances.filter(function(i){return i!=null}),this.callback(this.instances,this.elements))}}(t.ElementsParser.prototype),function(f){var i=f.fabric||(f.fabric={});if(i.Point){i.warn("fabric.Point is already defined");return}i.Point=c;function c(l,r){this.x=l,this.y=r}c.prototype={type:"point",constructor:c,add:function(l){return new c(this.x+l.x,this.y+l.y)},addEquals:function(l){return this.x+=l.x,this.y+=l.y,this},scalarAdd:function(l){return new c(this.x+l,this.y+l)},scalarAddEquals:function(l){return this.x+=l,this.y+=l,this},subtract:function(l){return new c(this.x-l.x,this.y-l.y)},subtractEquals:function(l){return this.x-=l.x,this.y-=l.y,this},scalarSubtract:function(l){return new c(this.x-l,this.y-l)},scalarSubtractEquals:function(l){return this.x-=l,this.y-=l,this},multiply:function(l){return new c(this.x*l,this.y*l)},multiplyEquals:function(l){return this.x*=l,this.y*=l,this},divide:function(l){return new c(this.x/l,this.y/l)},divideEquals:function(l){return this.x/=l,this.y/=l,this},eq:function(l){return this.x===l.x&&this.y===l.y},lt:function(l){return this.x<l.x&&this.y<l.y},lte:function(l){return this.x<=l.x&&this.y<=l.y},gt:function(l){return this.x>l.x&&this.y>l.y},gte:function(l){return this.x>=l.x&&this.y>=l.y},lerp:function(l,r){return typeof r=="undefined"&&(r=.5),r=Math.max(Math.min(1,r),0),new c(this.x+(l.x-this.x)*r,this.y+(l.y-this.y)*r)},distanceFrom:function(l){var r=this.x-l.x,a=this.y-l.y;return Math.sqrt(r*r+a*a)},midPointFrom:function(l){return this.lerp(l)},min:function(l){return new c(Math.min(this.x,l.x),Math.min(this.y,l.y))},max:function(l){return new c(Math.max(this.x,l.x),Math.max(this.y,l.y))},toString:function(){return this.x+","+this.y},setXY:function(l,r){return this.x=l,this.y=r,this},setX:function(l){return this.x=l,this},setY:function(l){return this.y=l,this},setFromPoint:function(l){return this.x=l.x,this.y=l.y,this},swap:function(l){var r=this.x,a=this.y;this.x=l.x,this.y=l.y,l.x=r,l.y=a},clone:function(){return new c(this.x,this.y)}}}(e),function(f){var i=f.fabric||(f.fabric={});if(i.Intersection){i.warn("fabric.Intersection is already defined");return}function c(l){this.status=l,this.points=[]}i.Intersection=c,i.Intersection.prototype={constructor:c,appendPoint:function(l){return this.points.push(l),this},appendPoints:function(l){return this.points=this.points.concat(l),this}},i.Intersection.intersectLineLine=function(l,r,a,s){var u,d=(s.x-a.x)*(l.y-a.y)-(s.y-a.y)*(l.x-a.x),h=(r.x-l.x)*(l.y-a.y)-(r.y-l.y)*(l.x-a.x),p=(s.y-a.y)*(r.x-l.x)-(s.x-a.x)*(r.y-l.y);if(p!==0){var m=d/p,y=h/p;0<=m&&m<=1&&0<=y&&y<=1?(u=new c("Intersection"),u.appendPoint(new i.Point(l.x+m*(r.x-l.x),l.y+m*(r.y-l.y)))):u=new c}else d===0||h===0?u=new c("Coincident"):u=new c("Parallel");return u},i.Intersection.intersectLinePolygon=function(l,r,a){var s=new c,u=a.length,d,h,p,m;for(m=0;m<u;m++)d=a[m],h=a[(m+1)%u],p=c.intersectLineLine(l,r,d,h),s.appendPoints(p.points);return s.points.length>0&&(s.status="Intersection"),s},i.Intersection.intersectPolygonPolygon=function(l,r){var a=new c,s=l.length,u;for(u=0;u<s;u++){var d=l[u],h=l[(u+1)%s],p=c.intersectLinePolygon(d,h,r);a.appendPoints(p.points)}return a.points.length>0&&(a.status="Intersection"),a},i.Intersection.intersectPolygonRectangle=function(l,r,a){var s=r.min(a),u=r.max(a),d=new i.Point(u.x,s.y),h=new i.Point(s.x,u.y),p=c.intersectLinePolygon(s,d,l),m=c.intersectLinePolygon(d,u,l),y=c.intersectLinePolygon(u,h,l),_=c.intersectLinePolygon(h,s,l),C=new c;return C.appendPoints(p.points),C.appendPoints(m.points),C.appendPoints(y.points),C.appendPoints(_.points),C.points.length>0&&(C.status="Intersection"),C}}(e),function(f){var i=f.fabric||(f.fabric={});if(i.Color){i.warn("fabric.Color is already defined.");return}function c(r){r?this._tryParsingColor(r):this.setSource([0,0,0,1])}i.Color=c,i.Color.prototype={_tryParsingColor:function(r){var a;r in c.colorNameMap&&(r=c.colorNameMap[r]),r==="transparent"&&(a=[255,255,255,0]),a||(a=c.sourceFromHex(r)),a||(a=c.sourceFromRgb(r)),a||(a=c.sourceFromHsl(r)),a||(a=[0,0,0,1]),a&&this.setSource(a)},_rgbToHsl:function(r,a,s){r/=255,a/=255,s/=255;var u,d,h,p=i.util.array.max([r,a,s]),m=i.util.array.min([r,a,s]);if(h=(p+m)/2,p===m)u=d=0;else{var y=p-m;switch(d=h>.5?y/(2-p-m):y/(p+m),p){case r:u=(a-s)/y+(a<s?6:0);break;case a:u=(s-r)/y+2;break;case s:u=(r-a)/y+4;break}u/=6}return[Math.round(u*360),Math.round(d*100),Math.round(h*100)]},getSource:function(){return this._source},setSource:function(r){this._source=r},toRgb:function(){var r=this.getSource();return"rgb("+r[0]+","+r[1]+","+r[2]+")"},toRgba:function(){var r=this.getSource();return"rgba("+r[0]+","+r[1]+","+r[2]+","+r[3]+")"},toHsl:function(){var r=this.getSource(),a=this._rgbToHsl(r[0],r[1],r[2]);return"hsl("+a[0]+","+a[1]+"%,"+a[2]+"%)"},toHsla:function(){var r=this.getSource(),a=this._rgbToHsl(r[0],r[1],r[2]);return"hsla("+a[0]+","+a[1]+"%,"+a[2]+"%,"+r[3]+")"},toHex:function(){var r=this.getSource(),a,s,u;return a=r[0].toString(16),a=a.length===1?"0"+a:a,s=r[1].toString(16),s=s.length===1?"0"+s:s,u=r[2].toString(16),u=u.length===1?"0"+u:u,a.toUpperCase()+s.toUpperCase()+u.toUpperCase()},toHexa:function(){var r=this.getSource(),a;return a=Math.round(r[3]*255),a=a.toString(16),a=a.length===1?"0"+a:a,this.toHex()+a.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(r){var a=this.getSource();return a[3]=r,this.setSource(a),this},toGrayscale:function(){var r=this.getSource(),a=parseInt((r[0]*.3+r[1]*.59+r[2]*.11).toFixed(0),10),s=r[3];return this.setSource([a,a,a,s]),this},toBlackWhite:function(r){var a=this.getSource(),s=(a[0]*.3+a[1]*.59+a[2]*.11).toFixed(0),u=a[3];return r=r||127,s=Number(s)<Number(r)?0:255,this.setSource([s,s,s,u]),this},overlayWith:function(r){r instanceof c||(r=new c(r));var a=[],s=this.getAlpha(),u=.5,d=this.getSource(),h=r.getSource(),p;for(p=0;p<3;p++)a.push(Math.round(d[p]*(1-u)+h[p]*u));return a[3]=s,this.setSource(a),this}},i.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,i.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,i.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,i.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};function l(r,a,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?r+(a-r)*6*s:s<1/2?a:s<2/3?r+(a-r)*(2/3-s)*6:r}i.Color.fromRgb=function(r){return c.fromSource(c.sourceFromRgb(r))},i.Color.sourceFromRgb=function(r){var a=r.match(c.reRGBa);if(a){var s=parseInt(a[1],10)/(/%$/.test(a[1])?100:1)*(/%$/.test(a[1])?255:1),u=parseInt(a[2],10)/(/%$/.test(a[2])?100:1)*(/%$/.test(a[2])?255:1),d=parseInt(a[3],10)/(/%$/.test(a[3])?100:1)*(/%$/.test(a[3])?255:1);return[parseInt(s,10),parseInt(u,10),parseInt(d,10),a[4]?parseFloat(a[4]):1]}},i.Color.fromRgba=c.fromRgb,i.Color.fromHsl=function(r){return c.fromSource(c.sourceFromHsl(r))},i.Color.sourceFromHsl=function(r){var a=r.match(c.reHSLa);if(a){var s=(parseFloat(a[1])%360+360)%360/360,u=parseFloat(a[2])/(/%$/.test(a[2])?100:1),d=parseFloat(a[3])/(/%$/.test(a[3])?100:1),h,p,m;if(u===0)h=p=m=d;else{var y=d<=.5?d*(u+1):d+u-d*u,_=d*2-y;h=l(_,y,s+1/3),p=l(_,y,s),m=l(_,y,s-1/3)}return[Math.round(h*255),Math.round(p*255),Math.round(m*255),a[4]?parseFloat(a[4]):1]}},i.Color.fromHsla=c.fromHsl,i.Color.fromHex=function(r){return c.fromSource(c.sourceFromHex(r))},i.Color.sourceFromHex=function(r){if(r.match(c.reHex)){var a=r.slice(r.indexOf("#")+1),s=a.length===3||a.length===4,u=a.length===8||a.length===4,d=s?a.charAt(0)+a.charAt(0):a.substring(0,2),h=s?a.charAt(1)+a.charAt(1):a.substring(2,4),p=s?a.charAt(2)+a.charAt(2):a.substring(4,6),m=u?s?a.charAt(3)+a.charAt(3):a.substring(6,8):"FF";return[parseInt(d,16),parseInt(h,16),parseInt(p,16),parseFloat((parseInt(m,16)/255).toFixed(2))]}},i.Color.fromSource=function(r){var a=new c;return a.setSource(r),a}}(e),function(f){var i=f.fabric||(f.fabric={}),c=["e","se","s","sw","w","nw","n","ne","e"],l=["ns","nesw","ew","nwse"],r={},a="left",s="top",u="right",d="bottom",h="center",p={top:d,bottom:s,left:u,right:a,center:h},m=i.util.radiansToDegrees,y=Math.sign||function(U){return(U>0)-(U<0)||+U};function _(U,j){var K=U.angle+m(Math.atan2(j.y,j.x))+360;return Math.round(K%360/45)}function C(U,j){var K=j.transform.target,it=K.canvas,tt=i.util.object.clone(j);tt.target=K,it&&it.fire("object:"+U,tt),K.fire(U,j)}function w(U,j){var K=j.canvas,it=K.uniScaleKey,tt=U[it];return K.uniformScaling&&!tt||!K.uniformScaling&&tt}function b(U){return U.originX===h&&U.originY===h}function S(U,j,K){var it=U.lockScalingX,tt=U.lockScalingY;return!!(it&&tt||!j&&(it||tt)&&K||it&&j==="x"||tt&&j==="y")}function F(U,j,K){var it="not-allowed",tt=w(U,K),ct="";if(j.x!==0&&j.y===0?ct="x":j.x===0&&j.y!==0&&(ct="y"),S(K,ct,tt))return it;var ht=_(K,j);return c[ht]+"-resize"}function $(U,j,K){var it="not-allowed";if(j.x!==0&&K.lockSkewingY||j.y!==0&&K.lockSkewingX)return it;var tt=_(K,j)%4;return l[tt]+"-resize"}function Q(U,j,K){return U[K.canvas.altActionKey]?r.skewCursorStyleHandler(U,j,K):r.scaleCursorStyleHandler(U,j,K)}function R(U,j,K){var it=U[K.canvas.altActionKey];if(j.x===0)return it?"skewX":"scaleY";if(j.y===0)return it?"skewY":"scaleX"}function H(U,j,K){return K.lockRotation?"not-allowed":j.cursorStyle}function W(U,j,K,it){return{e:U,transform:j,pointer:{x:K,y:it}}}function G(U){return function(j,K,it,tt){var ct=K.target,ht=ct.getCenterPoint(),yt=ct.translateToOriginPoint(ht,K.originX,K.originY),At=U(j,K,it,tt);return ct.setPositionByOrigin(yt,K.originX,K.originY),At}}function V(U,j){return function(K,it,tt,ct){var ht=j(K,it,tt,ct);return ht&&C(U,W(K,it,tt,ct)),ht}}function st(U,j,K,it,tt){var ct=U.target,ht=ct.controls[U.corner],yt=ct.canvas.getZoom(),At=ct.padding/yt,at=ct.toLocalPoint(new i.Point(it,tt),j,K);return at.x>=At&&(at.x-=At),at.x<=-At&&(at.x+=At),at.y>=At&&(at.y-=At),at.y<=At&&(at.y+=At),at.x-=ht.offsetX,at.y-=ht.offsetY,at}function et(U){return U.flipX!==U.flipY}function x(U,j,K,it,tt){if(U[j]!==0){var ct=U._getTransformedDimensions()[it],ht=tt/ct*U[K];U.set(K,ht)}}function B(U,j,K,it){var tt=j.target,ct=tt._getTransformedDimensions(0,tt.skewY),ht=st(j,j.originX,j.originY,K,it),yt=Math.abs(ht.x*2)-ct.x,At=tt.skewX,at;yt<2?at=0:(at=m(Math.atan2(yt/tt.scaleX,ct.y/tt.scaleY)),j.originX===a&&j.originY===d&&(at=-at),j.originX===u&&j.originY===s&&(at=-at),et(tt)&&(at=-at));var mt=At!==at;if(mt){var St=tt._getTransformedDimensions().y;tt.set("skewX",at),x(tt,"skewY","scaleY","y",St)}return mt}function k(U,j,K,it){var tt=j.target,ct=tt._getTransformedDimensions(tt.skewX,0),ht=st(j,j.originX,j.originY,K,it),yt=Math.abs(ht.y*2)-ct.y,At=tt.skewY,at;yt<2?at=0:(at=m(Math.atan2(yt/tt.scaleY,ct.x/tt.scaleX)),j.originX===a&&j.originY===d&&(at=-at),j.originX===u&&j.originY===s&&(at=-at),et(tt)&&(at=-at));var mt=At!==at;if(mt){var St=tt._getTransformedDimensions().x;tt.set("skewY",at),x(tt,"skewX","scaleX","x",St)}return mt}function D(U,j,K,it){var tt=j.target,ct=tt.skewX,ht,yt=j.originY;if(tt.lockSkewingX)return!1;if(ct===0){var At=st(j,h,h,K,it);At.x>0?ht=a:ht=u}else ct>0&&(ht=yt===s?a:u),ct<0&&(ht=yt===s?u:a),et(tt)&&(ht=ht===a?u:a);j.originX=ht;var at=V("skewing",G(B));return at(U,j,K,it)}function Y(U,j,K,it){var tt=j.target,ct=tt.skewY,ht,yt=j.originX;if(tt.lockSkewingY)return!1;if(ct===0){var At=st(j,h,h,K,it);At.y>0?ht=s:ht=d}else ct>0&&(ht=yt===a?s:d),ct<0&&(ht=yt===a?d:s),et(tt)&&(ht=ht===s?d:s);j.originY=ht;var at=V("skewing",G(k));return at(U,j,K,it)}function I(U,j,K,it){var tt=j,ct=tt.target,ht=ct.translateToOriginPoint(ct.getCenterPoint(),tt.originX,tt.originY);if(ct.lockRotation)return!1;var yt=Math.atan2(tt.ey-ht.y,tt.ex-ht.x),At=Math.atan2(it-ht.y,K-ht.x),at=m(At-yt+tt.theta),mt=!0;if(ct.snapAngle>0){var St=ct.snapAngle,Tt=ct.snapThreshold||St,jt=Math.ceil(at/St)*St,Dt=Math.floor(at/St)*St;Math.abs(at-Dt)<Tt?at=Dt:Math.abs(at-jt)<Tt&&(at=jt)}return at<0&&(at=360+at),at%=360,mt=ct.angle!==at,ct.angle=at,mt}function E(U,j,K,it,tt){tt=tt||{};var ct=j.target,ht=ct.lockScalingX,yt=ct.lockScalingY,At=tt.by,at,mt,St,Tt,jt=w(U,ct),Dt=S(ct,At,jt),Yt,qt,an=j.gestureScale;if(Dt)return!1;if(an)mt=j.scaleX*an,St=j.scaleY*an;else{if(at=st(j,j.originX,j.originY,K,it),Yt=At!=="y"?y(at.x):1,qt=At!=="x"?y(at.y):1,j.signX||(j.signX=Yt),j.signY||(j.signY=qt),ct.lockScalingFlip&&(j.signX!==Yt||j.signY!==qt))return!1;if(Tt=ct._getTransformedDimensions(),jt&&!At){var Yn=Math.abs(at.x)+Math.abs(at.y),Be=j.original,Xh=Math.abs(Tt.x*Be.scaleX/ct.scaleX)+Math.abs(Tt.y*Be.scaleY/ct.scaleY),ta=Yn/Xh;mt=Be.scaleX*ta,St=Be.scaleY*ta}else mt=Math.abs(at.x*ct.scaleX/Tt.x),St=Math.abs(at.y*ct.scaleY/Tt.y);b(j)&&(mt*=2,St*=2),j.signX!==Yt&&At!=="y"&&(j.originX=p[j.originX],mt*=-1,j.signX=Yt),j.signY!==qt&&At!=="x"&&(j.originY=p[j.originY],St*=-1,j.signY=qt)}var Jh=ct.scaleX,Kh=ct.scaleY;return At?(At==="x"&&ct.set("scaleX",mt),At==="y"&&ct.set("scaleY",St)):(!ht&&ct.set("scaleX",mt),!yt&&ct.set("scaleY",St)),Jh!==ct.scaleX||Kh!==ct.scaleY}function P(U,j,K,it){return E(U,j,K,it)}function N(U,j,K,it){return E(U,j,K,it,{by:"x"})}function q(U,j,K,it){return E(U,j,K,it,{by:"y"})}function J(U,j,K,it){return U[j.target.canvas.altActionKey]?r.skewHandlerX(U,j,K,it):r.scalingY(U,j,K,it)}function rt(U,j,K,it){return U[j.target.canvas.altActionKey]?r.skewHandlerY(U,j,K,it):r.scalingX(U,j,K,it)}function lt(U,j,K,it){var tt=j.target,ct=st(j,j.originX,j.originY,K,it),ht=tt.strokeWidth/(tt.strokeUniform?tt.scaleX:1),yt=b(j)?2:1,At=tt.width,at=Math.abs(ct.x*yt/tt.scaleX)-ht;return tt.set("width",Math.max(at,0)),At!==at}function dt(U,j,K,it){var tt=j.target,ct=K-j.offsetX,ht=it-j.offsetY,yt=!tt.get("lockMovementX")&&tt.left!==ct,At=!tt.get("lockMovementY")&&tt.top!==ht;return yt&&tt.set("left",ct),At&&tt.set("top",ht),(yt||At)&&C("moving",W(U,j,K,it)),yt||At}r.scaleCursorStyleHandler=F,r.skewCursorStyleHandler=$,r.scaleSkewCursorStyleHandler=Q,r.rotationWithSnapping=V("rotating",G(I)),r.scalingEqually=V("scaling",G(P)),r.scalingX=V("scaling",G(N)),r.scalingY=V("scaling",G(q)),r.scalingYOrSkewingX=J,r.scalingXOrSkewingY=rt,r.changeWidth=V("resizing",G(lt)),r.skewHandlerX=D,r.skewHandlerY=Y,r.dragHandler=dt,r.scaleOrSkewActionName=R,r.rotationStyleHandler=H,r.fireEvent=C,r.wrapWithFixedAnchor=G,r.wrapWithFireEvent=V,r.getLocalPoint=st,i.controlsUtils=r}(e),function(f){var i=f.fabric||(f.fabric={}),c=i.util.degreesToRadians,l=i.controlsUtils;function r(s,u,d,h,p){h=h||{};var m=this.sizeX||h.cornerSize||p.cornerSize,y=this.sizeY||h.cornerSize||p.cornerSize,_=typeof h.transparentCorners!="undefined"?h.transparentCorners:p.transparentCorners,C=_?"stroke":"fill",w=!_&&(h.cornerStrokeColor||p.cornerStrokeColor),b=u,S=d,F;s.save(),s.fillStyle=h.cornerColor||p.cornerColor,s.strokeStyle=h.cornerStrokeColor||p.cornerStrokeColor,m>y?(F=m,s.scale(1,y/m),S=d*m/y):y>m?(F=y,s.scale(m/y,1),b=u*y/m):F=m,s.lineWidth=1,s.beginPath(),s.arc(b,S,F/2,0,2*Math.PI,!1),s[C](),w&&s.stroke(),s.restore()}function a(s,u,d,h,p){h=h||{};var m=this.sizeX||h.cornerSize||p.cornerSize,y=this.sizeY||h.cornerSize||p.cornerSize,_=typeof h.transparentCorners!="undefined"?h.transparentCorners:p.transparentCorners,C=_?"stroke":"fill",w=!_&&(h.cornerStrokeColor||p.cornerStrokeColor),b=m/2,S=y/2;s.save(),s.fillStyle=h.cornerColor||p.cornerColor,s.strokeStyle=h.cornerStrokeColor||p.cornerStrokeColor,s.lineWidth=1,s.translate(u,d),s.rotate(c(p.angle)),s[C+"Rect"](-b,-S,m,y),w&&s.strokeRect(-b,-S,m,y),s.restore()}l.renderCircleControl=r,l.renderSquareControl=a}(e),function(f){var i=f.fabric||(f.fabric={});function c(l){for(var r in l)this[r]=l[r]}i.Control=c,i.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(l,r){return r.cursorStyle},getActionName:function(l,r){return r.actionName},getVisibility:function(l,r){var a=l._controlsVisibility;return a&&typeof a[r]!="undefined"?a[r]:this.visible},setVisibility:function(l){this.visible=l},positionHandler:function(l,r){var a=i.util.transformPoint({x:this.x*l.x+this.offsetX,y:this.y*l.y+this.offsetY},r);return a},calcCornerCoords:function(l,r,a,s,u){var d,h,p,m,y=u?this.touchSizeX:this.sizeX,_=u?this.touchSizeY:this.sizeY;if(y&&_&&y!==_){var C=Math.atan2(_,y),w=Math.sqrt(y*y+_*_)/2,b=C-i.util.degreesToRadians(l),S=Math.PI/2-C-i.util.degreesToRadians(l);d=w*i.util.cos(b),h=w*i.util.sin(b),p=w*i.util.cos(S),m=w*i.util.sin(S)}else{var F=y&&_?y:r;w=F*.7071067812;var b=i.util.degreesToRadians(45-l);d=p=w*i.util.cos(b),h=m=w*i.util.sin(b)}return{tl:{x:a-m,y:s-p},tr:{x:a+d,y:s-h},bl:{x:a-d,y:s+h},br:{x:a+m,y:s+p}}},render:function(l,r,a,s,u){switch(s=s||{},s.cornerStyle||u.cornerStyle){case"circle":i.controlsUtils.renderCircleControl.call(this,l,r,a,s,u);break;default:i.controlsUtils.renderSquareControl.call(this,l,r,a,s,u)}}}}(e),function(){function f(a,s){var u=a.getAttribute("style"),d=a.getAttribute("offset")||0,h,p,m,y;if(d=parseFloat(d)/(/%$/.test(d)?100:1),d=d<0?0:d>1?1:d,u){var _=u.split(/\s*;\s*/);for(_[_.length-1]===""&&_.pop(),y=_.length;y--;){var C=_[y].split(/\s*:\s*/),w=C[0].trim(),b=C[1].trim();w==="stop-color"?h=b:w==="stop-opacity"&&(m=b)}}return h||(h=a.getAttribute("stop-color")||"rgb(0,0,0)"),m||(m=a.getAttribute("stop-opacity")),h=new t.Color(h),p=h.getAlpha(),m=isNaN(parseFloat(m))?1:parseFloat(m),m*=p*s,{offset:d,color:h.toRgb(),opacity:m}}function i(a){return{x1:a.getAttribute("x1")||0,y1:a.getAttribute("y1")||0,x2:a.getAttribute("x2")||"100%",y2:a.getAttribute("y2")||0}}function c(a){return{x1:a.getAttribute("fx")||a.getAttribute("cx")||"50%",y1:a.getAttribute("fy")||a.getAttribute("cy")||"50%",r1:0,x2:a.getAttribute("cx")||"50%",y2:a.getAttribute("cy")||"50%",r2:a.getAttribute("r")||"50%"}}var l=t.util.object.clone;t.Gradient=t.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(a){a||(a={}),a.coords||(a.coords={});var s,u=this;Object.keys(a).forEach(function(d){u[d]=a[d]}),this.id?this.id+="_"+t.Object.__uid++:this.id=t.Object.__uid++,s={x1:a.coords.x1||0,y1:a.coords.y1||0,x2:a.coords.x2||0,y2:a.coords.y2||0},this.type==="radial"&&(s.r1=a.coords.r1||0,s.r2=a.coords.r2||0),this.coords=s,this.colorStops=a.colorStops.slice()},addColorStop:function(a){for(var s in a){var u=new t.Color(a[s]);this.colorStops.push({offset:parseFloat(s),color:u.toRgb(),opacity:u.getAlpha()})}return this},toObject:function(a){var s={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return t.util.populateWithProperties(this,s,a),s},toSVG:function(a,p){var u=l(this.coords,!0),d,h,p=p||{},m,y,_=l(this.colorStops,!0),C=u.r1>u.r2,w=this.gradientTransform?this.gradientTransform.concat():t.iMatrix.concat(),b=-this.offsetX,S=-this.offsetY,F=!!p.additionalTransform,$=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox";if(_.sort(function(G,V){return G.offset-V.offset}),$==="objectBoundingBox"?(b/=a.width,S/=a.height):(b+=a.width/2,S+=a.height/2),a.type==="path"&&this.gradientUnits!=="percentage"&&(b-=a.pathOffset.x,S-=a.pathOffset.y),w[4]-=b,w[5]-=S,y='id="SVGID_'+this.id+'" gradientUnits="'+$+'"',y+=' gradientTransform="'+(F?p.additionalTransform+" ":"")+t.util.matrixToSVG(w)+'" ',this.type==="linear"?m=["<linearGradient ",y,' x1="',u.x1,'" y1="',u.y1,'" x2="',u.x2,'" y2="',u.y2,`">
`]:this.type==="radial"&&(m=["<radialGradient ",y,' cx="',C?u.x1:u.x2,'" cy="',C?u.y1:u.y2,'" r="',C?u.r1:u.r2,'" fx="',C?u.x2:u.x1,'" fy="',C?u.y2:u.y1,`">
`]),this.type==="radial"){if(C)for(_=_.concat(),_.reverse(),d=0,h=_.length;d<h;d++)_[d].offset=1-_[d].offset;var Q=Math.min(u.r1,u.r2);if(Q>0){var R=Math.max(u.r1,u.r2),H=Q/R;for(d=0,h=_.length;d<h;d++)_[d].offset+=H*(1-_[d].offset)}}for(d=0,h=_.length;d<h;d++){var W=_[d];m.push("<stop ",'offset="',W.offset*100+"%",'" style="stop-color:',W.color,typeof W.opacity!="undefined"?";stop-opacity: "+W.opacity:";",`"/>
`)}return m.push(this.type==="linear"?`</linearGradient>
`:`</radialGradient>
`),m.join("")},toLive:function(a){var s,u=t.util.object.clone(this.coords),d,h;if(this.type){for(this.type==="linear"?s=a.createLinearGradient(u.x1,u.y1,u.x2,u.y2):this.type==="radial"&&(s=a.createRadialGradient(u.x1,u.y1,u.r1,u.x2,u.y2,u.r2)),d=0,h=this.colorStops.length;d<h;d++){var p=this.colorStops[d].color,m=this.colorStops[d].opacity,y=this.colorStops[d].offset;typeof m!="undefined"&&(p=new t.Color(p).setAlpha(m).toRgba()),s.addColorStop(y,p)}return s}}}),t.util.object.extend(t.Gradient,{fromElement:function(a,s,u,d){var h=parseFloat(u)/(/%$/.test(u)?100:1);h=h<0?0:h>1?1:h,isNaN(h)&&(h=1);var p=a.getElementsByTagName("stop"),m,y=a.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage",_=a.getAttribute("gradientTransform")||"",C=[],w,b,S=0,F=0,$;for(a.nodeName==="linearGradient"||a.nodeName==="LINEARGRADIENT"?(m="linear",w=i(a)):(m="radial",w=c(a)),b=p.length;b--;)C.push(f(p[b],h));$=t.parseTransformAttribute(_),r(s,w,d,y),y==="pixels"&&(S=-s.left,F=-s.top);var Q=new t.Gradient({id:a.getAttribute("id"),type:m,coords:w,colorStops:C,gradientUnits:y,gradientTransform:$,offsetX:S,offsetY:F});return Q}});function r(a,s,u,d){var h,p;Object.keys(s).forEach(function(m){h=s[m],h==="Infinity"?p=1:h==="-Infinity"?p=0:(p=parseFloat(s[m],10),typeof h=="string"&&/^(\d+\.\d+)%|(\d+)%$/.test(h)&&(p*=.01,d==="pixels"&&((m==="x1"||m==="x2"||m==="r2")&&(p*=u.viewBoxWidth||u.width),(m==="y1"||m==="y2")&&(p*=u.viewBoxHeight||u.height)))),s[m]=p})}}(),function(){var f=t.util.toFixed;t.Pattern=t.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(i,c){if(i||(i={}),this.id=t.Object.__uid++,this.setOptions(i),!i.source||i.source&&typeof i.source!="string"){c&&c(this);return}else{var l=this;this.source=t.util.createImage(),t.util.loadImage(i.source,function(r,a){l.source=r,c&&c(l,a)},null,this.crossOrigin)}},toObject:function(i){var c=t.Object.NUM_FRACTION_DIGITS,l,r;return typeof this.source.src=="string"?l=this.source.src:typeof this.source=="object"&&this.source.toDataURL&&(l=this.source.toDataURL()),r={type:"pattern",source:l,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:f(this.offsetX,c),offsetY:f(this.offsetY,c),patternTransform:this.patternTransform?this.patternTransform.concat():null},t.util.populateWithProperties(this,r,i),r},toSVG:function(i){var c=typeof this.source=="function"?this.source():this.source,l=c.width/i.width,r=c.height/i.height,a=this.offsetX/i.width,s=this.offsetY/i.height,u="";return(this.repeat==="repeat-x"||this.repeat==="no-repeat")&&(r=1,s&&(r+=Math.abs(s))),(this.repeat==="repeat-y"||this.repeat==="no-repeat")&&(l=1,a&&(l+=Math.abs(a))),c.src?u=c.src:c.toDataURL&&(u=c.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+a+'" y="'+s+'" width="'+l+'" height="'+r+`">
<image x="0" y="0" width="`+c.width+'" height="'+c.height+'" xlink:href="'+u+`"></image>
</pattern>
`},setOptions:function(i){for(var c in i)this[c]=i[c]},toLive:function(i){var c=this.source;return!c||typeof c.src!="undefined"&&(!c.complete||c.naturalWidth===0||c.naturalHeight===0)?"":i.createPattern(c,this.repeat)}})}(),function(f){var i=f.fabric||(f.fabric={}),c=i.util.toFixed;if(i.Shadow){i.warn("fabric.Shadow is already defined.");return}i.Shadow=i.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(l){typeof l=="string"&&(l=this._parseShadow(l));for(var r in l)this[r]=l[r];this.id=i.Object.__uid++},_parseShadow:function(l){var r=l.trim(),a=i.Shadow.reOffsetsAndBlur.exec(r)||[],s=r.replace(i.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:s.trim(),offsetX:parseFloat(a[1],10)||0,offsetY:parseFloat(a[2],10)||0,blur:parseFloat(a[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(l){var r=40,a=40,s=i.Object.NUM_FRACTION_DIGITS,u=i.util.rotateVector({x:this.offsetX,y:this.offsetY},i.util.degreesToRadians(-l.angle)),d=20,h=new i.Color(this.color);return l.width&&l.height&&(r=c((Math.abs(u.x)+this.blur)/l.width,s)*100+d,a=c((Math.abs(u.y)+this.blur)/l.height,s)*100+d),l.flipX&&(u.x*=-1),l.flipY&&(u.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+a+'%" height="'+(100+2*a)+'%" x="-'+r+'%" width="'+(100+2*r)+`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`+c(this.blur?this.blur/2:0,s)+`"></feGaussianBlur>
	<feOffset dx="`+c(u.x,s)+'" dy="'+c(u.y,s)+`" result="oBlur" ></feOffset>
	<feFlood flood-color="`+h.toRgb()+'" flood-opacity="'+h.getAlpha()+`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var l={},r=i.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(a){this[a]!==r[a]&&(l[a]=this[a])},this),l}}),i.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/}(e),function(){if(t.StaticCanvas){t.warn("fabric.StaticCanvas is already defined.");return}var f=t.util.object.extend,i=t.util.getElementOffset,c=t.util.removeFromArray,l=t.util.toFixed,r=t.util.transformPoint,a=t.util.invertTransform,s=t.util.getNodeCanvas,u=t.util.createCanvasElement,d=new Error("Could not initialize `canvas` element");t.StaticCanvas=t.util.createClass(t.CommonMethods,{initialize:function(h,p){p||(p={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(h,p)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:t.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(h,p){var m=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(h),this._initOptions(p),this.interactive||this._initRetinaScaling(),p.overlayImage&&this.setOverlayImage(p.overlayImage,m),p.backgroundImage&&this.setBackgroundImage(p.backgroundImage,m),p.backgroundColor&&this.setBackgroundColor(p.backgroundColor,m),p.overlayColor&&this.setOverlayColor(p.overlayColor,m),this.calcOffset()},_isRetinaScaling:function(){return t.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,t.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var h=t.devicePixelRatio;this.__initRetinaScaling(h,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(h,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(h,p,m){p.setAttribute("width",this.width*h),p.setAttribute("height",this.height*h),m.scale(h,h)},calcOffset:function(){return this._offset=i(this.lowerCanvasEl),this},setOverlayImage:function(h,p,m){return this.__setBgOverlayImage("overlayImage",h,p,m)},setBackgroundImage:function(h,p,m){return this.__setBgOverlayImage("backgroundImage",h,p,m)},setOverlayColor:function(h,p){return this.__setBgOverlayColor("overlayColor",h,p)},setBackgroundColor:function(h,p){return this.__setBgOverlayColor("backgroundColor",h,p)},__setBgOverlayImage:function(h,p,m,y){return typeof p=="string"?t.util.loadImage(p,function(_,C){if(_){var w=new t.Image(_,y);this[h]=w,w.canvas=this}m&&m(_,C)},this,y&&y.crossOrigin):(y&&p.setOptions(y),this[h]=p,p&&(p.canvas=this),m&&m(p,!1)),this},__setBgOverlayColor:function(h,p,m){return this[h]=p,this._initGradient(p,h),this._initPattern(p,h,m),this},_createCanvasElement:function(){var h=u();if(!h||(h.style||(h.style={}),typeof h.getContext=="undefined"))throw d;return h},_initOptions:function(h){var p=this.lowerCanvasEl;this._setOptions(h),this.width=this.width||parseInt(p.width,10)||0,this.height=this.height||parseInt(p.height,10)||0,this.lowerCanvasEl.style&&(p.width=this.width,p.height=this.height,p.style.width=this.width+"px",p.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(h){h&&h.getContext?this.lowerCanvasEl=h:this.lowerCanvasEl=t.util.getById(h)||this._createCanvasElement(),t.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(h,p){return this.setDimensions({width:h},p)},setHeight:function(h,p){return this.setDimensions({height:h},p)},setDimensions:function(h,p){var m;p=p||{};for(var y in h)m=h[y],p.cssOnly||(this._setBackstoreDimension(y,h[y]),m+="px",this.hasLostContext=!0),p.backstoreOnly||this._setCssDimension(y,m);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),p.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(h,p){return this.lowerCanvasEl[h]=p,this.upperCanvasEl&&(this.upperCanvasEl[h]=p),this.cacheCanvasEl&&(this.cacheCanvasEl[h]=p),this[h]=p,this},_setCssDimension:function(h,p){return this.lowerCanvasEl.style[h]=p,this.upperCanvasEl&&(this.upperCanvasEl.style[h]=p),this.wrapperEl&&(this.wrapperEl.style[h]=p),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(h){var p=this._activeObject,m=this.backgroundImage,y=this.overlayImage,_,C,w;for(this.viewportTransform=h,C=0,w=this._objects.length;C<w;C++)_=this._objects[C],_.group||_.setCoords(!0);return p&&p.setCoords(),m&&m.setCoords(!0),y&&y.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(h,p){var m=h,y=this.viewportTransform.slice(0);h=r(h,a(this.viewportTransform)),y[0]=p,y[3]=p;var _=r(h,y);return y[4]+=m.x-_.x,y[5]+=m.y-_.y,this.setViewportTransform(y)},setZoom:function(h){return this.zoomToPoint(new t.Point(0,0),h),this},absolutePan:function(h){var p=this.viewportTransform.slice(0);return p[4]=-h.x,p[5]=-h.y,this.setViewportTransform(p)},relativePan:function(h){return this.absolutePan(new t.Point(-h.x-this.viewportTransform[4],-h.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(h){this.stateful&&h.setupState(),h._set("canvas",this),h.setCoords(),this.fire("object:added",{target:h}),h.fire("added")},_onObjectRemoved:function(h){this.fire("object:removed",{target:h}),h.fire("removed"),delete h.canvas},clearContext:function(h){return h.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var h=this.contextContainer;return this.renderCanvas(h,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=t.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var h={},p=this.width,m=this.height,y=a(this.viewportTransform);return h.tl=r({x:0,y:0},y),h.br=r({x:p,y:m},y),h.tr=new t.Point(h.br.x,h.tl.y),h.bl=new t.Point(h.tl.x,h.br.y),this.vptCoords=h,h},cancelRequestedRender:function(){this.isRendering&&(t.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(h,p){var m=this.viewportTransform,y=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(h),t.util.setImageSmoothing(h,this.imageSmoothingEnabled),this.fire("before:render",{ctx:h}),this._renderBackground(h),h.save(),h.transform(m[0],m[1],m[2],m[3],m[4],m[5]),this._renderObjects(h,p),h.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(h),y&&(y.canvas=this,y.shouldCache(),y._transformDone=!0,y.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(h)),this._renderOverlay(h),this.controlsAboveOverlay&&this.interactive&&this.drawControls(h),this.fire("after:render",{ctx:h})},drawClipPathOnCanvas:function(h){var p=this.viewportTransform,m=this.clipPath;h.save(),h.transform(p[0],p[1],p[2],p[3],p[4],p[5]),h.globalCompositeOperation="destination-in",m.transform(h),h.scale(1/m.zoomX,1/m.zoomY),h.drawImage(m._cacheCanvas,-m.cacheTranslationX,-m.cacheTranslationY),h.restore()},_renderObjects:function(h,p){var m,y;for(m=0,y=p.length;m<y;++m)p[m]&&p[m].render(h)},_renderBackgroundOrOverlay:function(h,p){var m=this[p+"Color"],y=this[p+"Image"],_=this.viewportTransform,C=this[p+"Vpt"];if(!(!m&&!y)){if(m){h.save(),h.beginPath(),h.moveTo(0,0),h.lineTo(this.width,0),h.lineTo(this.width,this.height),h.lineTo(0,this.height),h.closePath(),h.fillStyle=m.toLive?m.toLive(h,this):m,C&&h.transform(_[0],_[1],_[2],_[3],_[4],_[5]),h.transform(1,0,0,1,m.offsetX||0,m.offsetY||0);var w=m.gradientTransform||m.patternTransform;w&&h.transform(w[0],w[1],w[2],w[3],w[4],w[5]),h.fill(),h.restore()}y&&(h.save(),C&&h.transform(_[0],_[1],_[2],_[3],_[4],_[5]),y.render(h),h.restore())}},_renderBackground:function(h){this._renderBackgroundOrOverlay(h,"background")},_renderOverlay:function(h){this._renderBackgroundOrOverlay(h,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new t.Point(this.width/2,this.height/2)},centerObjectH:function(h){return this._centerObject(h,new t.Point(this.getCenterPoint().x,h.getCenterPoint().y))},centerObjectV:function(h){return this._centerObject(h,new t.Point(h.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(h){var p=this.getCenterPoint();return this._centerObject(h,p)},viewportCenterObject:function(h){var p=this.getVpCenter();return this._centerObject(h,p)},viewportCenterObjectH:function(h){var p=this.getVpCenter();return this._centerObject(h,new t.Point(p.x,h.getCenterPoint().y)),this},viewportCenterObjectV:function(h){var p=this.getVpCenter();return this._centerObject(h,new t.Point(h.getCenterPoint().x,p.y))},getVpCenter:function(){var h=this.getCenterPoint(),p=a(this.viewportTransform);return r(h,p)},_centerObject:function(h,p){return h.setPositionByOrigin(p,"center","center"),h.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(h){return this.toDatalessObject(h)},toObject:function(h){return this._toObjectMethod("toObject",h)},toDatalessObject:function(h){return this._toObjectMethod("toDatalessObject",h)},_toObjectMethod:function(h,p){var m=this.clipPath,y={version:t.version,objects:this._toObjects(h,p)};return m&&!m.excludeFromExport&&(y.clipPath=this._toObject(this.clipPath,h,p)),f(y,this.__serializeBgOverlay(h,p)),t.util.populateWithProperties(this,y,p),y},_toObjects:function(h,p){return this._objects.filter(function(m){return!m.excludeFromExport}).map(function(m){return this._toObject(m,h,p)},this)},_toObject:function(h,p,m){var y;this.includeDefaultValues||(y=h.includeDefaultValues,h.includeDefaultValues=!1);var _=h[p](m);return this.includeDefaultValues||(h.includeDefaultValues=y),_},__serializeBgOverlay:function(h,p){var m={},y=this.backgroundImage,_=this.overlayImage,C=this.backgroundColor,w=this.overlayColor;return C&&C.toObject?C.excludeFromExport||(m.background=C.toObject(p)):C&&(m.background=C),w&&w.toObject?w.excludeFromExport||(m.overlay=w.toObject(p)):w&&(m.overlay=w),y&&!y.excludeFromExport&&(m.backgroundImage=this._toObject(y,h,p)),_&&!_.excludeFromExport&&(m.overlayImage=this._toObject(_,h,p)),m},svgViewportTransformation:!0,toSVG:function(h,p){h||(h={}),h.reviver=p;var m=[];return this._setSVGPreamble(m,h),this._setSVGHeader(m,h),this.clipPath&&m.push('<g clip-path="url(#'+this.clipPath.clipPathId+`)" >
`),this._setSVGBgOverlayColor(m,"background"),this._setSVGBgOverlayImage(m,"backgroundImage",p),this._setSVGObjects(m,p),this.clipPath&&m.push(`</g>
`),this._setSVGBgOverlayColor(m,"overlay"),this._setSVGBgOverlayImage(m,"overlayImage",p),m.push("</svg>"),m.join("")},_setSVGPreamble:function(h,p){p.suppressPreamble||h.push('<?xml version="1.0" encoding="',p.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)},_setSVGHeader:function(h,p){var m=p.width||this.width,y=p.height||this.height,_,C='viewBox="0 0 '+this.width+" "+this.height+'" ',w=t.Object.NUM_FRACTION_DIGITS;p.viewBox?C='viewBox="'+p.viewBox.x+" "+p.viewBox.y+" "+p.viewBox.width+" "+p.viewBox.height+'" ':this.svgViewportTransformation&&(_=this.viewportTransform,C='viewBox="'+l(-_[4]/_[0],w)+" "+l(-_[5]/_[3],w)+" "+l(this.width/_[0],w)+" "+l(this.height/_[3],w)+'" '),h.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',m,'" ','height="',y,'" ',C,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",t.version,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(p),`</defs>
`)},createSVGClipPathMarkup:function(h){var p=this.clipPath;return p?(p.clipPathId="CLIPPATH_"+t.Object.__uid++,'<clipPath id="'+p.clipPathId+`" >
`+this.clipPath.toClipPathSVG(h.reviver)+`</clipPath>
`):""},createSVGRefElementsMarkup:function(){var h=this,p=["background","overlay"].map(function(m){var y=h[m+"Color"];if(y&&y.toLive){var _=h[m+"Vpt"],C=h.viewportTransform,w={width:h.width/(_?C[0]:1),height:h.height/(_?C[3]:1)};return y.toSVG(w,{additionalTransform:_?t.util.matrixToSVG(C):""})}});return p.join("")},createSVGFontFacesMarkup:function(){var h="",p={},m,y,_,C,w,b,S,F,$,Q=t.fontPaths,R=[];for(this._objects.forEach(function W(G){R.push(G),G._objects&&G._objects.forEach(W)}),F=0,$=R.length;F<$;F++)if(m=R[F],y=m.fontFamily,!(m.type.indexOf("text")===-1||p[y]||!Q[y])&&(p[y]=!0,!!m.styles)){_=m.styles;for(w in _){C=_[w];for(S in C)b=C[S],y=b.fontFamily,!p[y]&&Q[y]&&(p[y]=!0)}}for(var H in p)h+=[`		@font-face {
`,"			font-family: '",H,`';
`,"			src: url('",Q[H],`');
`,`		}
`].join("");return h&&(h=['	<style type="text/css">',`<![CDATA[
`,h,"]]>",`</style>
`].join("")),h},_setSVGObjects:function(h,p){var m,y,_,C=this._objects;for(y=0,_=C.length;y<_;y++)m=C[y],!m.excludeFromExport&&this._setSVGObject(h,m,p)},_setSVGObject:function(h,p,m){h.push(p.toSVG(m))},_setSVGBgOverlayImage:function(h,p,m){this[p]&&!this[p].excludeFromExport&&this[p].toSVG&&h.push(this[p].toSVG(m))},_setSVGBgOverlayColor:function(h,p){var m=this[p+"Color"],y=this.viewportTransform,_=this.width,C=this.height;if(m)if(m.toLive){var w=m.repeat,b=t.util.invertTransform(y),S=this[p+"Vpt"],F=S?t.util.matrixToSVG(b):"";h.push('<rect transform="'+F+" translate(",_/2,",",C/2,')"',' x="',m.offsetX-_/2,'" y="',m.offsetY-C/2,'" ','width="',w==="repeat-y"||w==="no-repeat"?m.source.width:_,'" height="',w==="repeat-x"||w==="no-repeat"?m.source.height:C,'" fill="url(#SVGID_'+m.id+')"',`></rect>
`)}else h.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',m,'"',`></rect>
`)},sendToBack:function(h){if(!h)return this;var p=this._activeObject,m,y,_;if(h===p&&h.type==="activeSelection")for(_=p._objects,m=_.length;m--;)y=_[m],c(this._objects,y),this._objects.unshift(y);else c(this._objects,h),this._objects.unshift(h);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(h){if(!h)return this;var p=this._activeObject,m,y,_;if(h===p&&h.type==="activeSelection")for(_=p._objects,m=0;m<_.length;m++)y=_[m],c(this._objects,y),this._objects.push(y);else c(this._objects,h),this._objects.push(h);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(h,p){if(!h)return this;var m=this._activeObject,y,_,C,w,b,S=0;if(h===m&&h.type==="activeSelection")for(b=m._objects,y=0;y<b.length;y++)_=b[y],C=this._objects.indexOf(_),C>0+S&&(w=C-1,c(this._objects,_),this._objects.splice(w,0,_)),S++;else C=this._objects.indexOf(h),C!==0&&(w=this._findNewLowerIndex(h,C,p),c(this._objects,h),this._objects.splice(w,0,h));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(h,p,m){var y,_;if(m)for(y=p,_=p-1;_>=0;--_){var C=h.intersectsWithObject(this._objects[_])||h.isContainedWithinObject(this._objects[_])||this._objects[_].isContainedWithinObject(h);if(C){y=_;break}}else y=p-1;return y},bringForward:function(h,p){if(!h)return this;var m=this._activeObject,y,_,C,w,b,S=0;if(h===m&&h.type==="activeSelection")for(b=m._objects,y=b.length;y--;)_=b[y],C=this._objects.indexOf(_),C<this._objects.length-1-S&&(w=C+1,c(this._objects,_),this._objects.splice(w,0,_)),S++;else C=this._objects.indexOf(h),C!==this._objects.length-1&&(w=this._findNewUpperIndex(h,C,p),c(this._objects,h),this._objects.splice(w,0,h));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(h,p,m){var y,_,C;if(m)for(y=p,_=p+1,C=this._objects.length;_<C;++_){var w=h.intersectsWithObject(this._objects[_])||h.isContainedWithinObject(this._objects[_])||this._objects[_].isContainedWithinObject(h);if(w){y=_;break}}else y=p+1;return y},moveTo:function(h,p){return c(this._objects,h),this._objects.splice(p,0,h),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(t.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(h){h.dispose&&h.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),t.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),t.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),f(t.StaticCanvas.prototype,t.Observable),f(t.StaticCanvas.prototype,t.Collection),f(t.StaticCanvas.prototype,t.DataURLExporter),f(t.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(h){var p=u();if(!p||!p.getContext)return null;var m=p.getContext("2d");if(!m)return null;switch(h){case"setLineDash":return typeof m.setLineDash!="undefined";default:return null}}}),t.StaticCanvas.prototype.toJSON=t.StaticCanvas.prototype.toObject,t.isLikelyNode&&(t.StaticCanvas.prototype.createPNGStream=function(){var h=s(this.lowerCanvasEl);return h&&h.createPNGStream()},t.StaticCanvas.prototype.createJPEGStream=function(h){var p=s(this.lowerCanvasEl);return p&&p.createJPEGStream(h)})}(),t.BaseBrush=t.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(f){f.strokeStyle=this.color,f.lineWidth=this.width,f.lineCap=this.strokeLineCap,f.miterLimit=this.strokeMiterLimit,f.lineJoin=this.strokeLineJoin,f.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(f){var i=this.canvas.viewportTransform;f.save(),f.transform(i[0],i[1],i[2],i[3],i[4],i[5])},_setShadow:function(){if(this.shadow){var f=this.canvas,i=this.shadow,c=f.contextTop,l=f.getZoom();f&&f._isRetinaScaling()&&(l*=t.devicePixelRatio),c.shadowColor=i.color,c.shadowBlur=i.blur*l,c.shadowOffsetX=i.offsetX*l,c.shadowOffsetY=i.offsetY*l}},needsFullRender:function(){var f=new t.Color(this.color);return f.getAlpha()<1||!!this.shadow},_resetShadow:function(){var f=this.canvas.contextTop;f.shadowColor="",f.shadowBlur=f.shadowOffsetX=f.shadowOffsetY=0},_isOutSideCanvas:function(f){return f.x<0||f.x>this.canvas.getWidth()||f.y<0||f.y>this.canvas.getHeight()}}),function(){t.PencilBrush=t.util.createClass(t.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(f){this.canvas=f,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(f,i,c){var l=i.midPointFrom(c);return f.quadraticCurveTo(i.x,i.y,l.x,l.y),l},onMouseDown:function(f,i){this.canvas._isMainEvent(i.e)&&(this.drawStraightLine=i.e[this.straightLineKey],this._prepareForDrawing(f),this._captureDrawingPath(f),this._render())},onMouseMove:function(f,i){if(this.canvas._isMainEvent(i.e)&&(this.drawStraightLine=i.e[this.straightLineKey],!(this.limitedToCanvasSize===!0&&this._isOutSideCanvas(f))&&this._captureDrawingPath(f)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var c=this._points,l=c.length,r=this.canvas.contextTop;this._saveAndTransform(r),this.oldEnd&&(r.beginPath(),r.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(r,c[l-2],c[l-1],!0),r.stroke(),r.restore()}},onMouseUp:function(f){return this.canvas._isMainEvent(f.e)?(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1):!0},_prepareForDrawing:function(f){var i=new t.Point(f.x,f.y);this._reset(),this._addPoint(i),this.canvas.contextTop.moveTo(i.x,i.y)},_addPoint:function(f){return this._points.length>1&&f.eq(this._points[this._points.length-1])?!1:(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(f),!0)},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(f){var i=new t.Point(f.x,f.y);return this._addPoint(i)},_render:function(f){var i,c,l=this._points[0],r=this._points[1];if(f=f||this.canvas.contextTop,this._saveAndTransform(f),f.beginPath(),this._points.length===2&&l.x===r.x&&l.y===r.y){var a=this.width/1e3;l=new t.Point(l.x,l.y),r=new t.Point(r.x,r.y),l.x-=a,r.x+=a}for(f.moveTo(l.x,l.y),i=1,c=this._points.length;i<c;i++)this._drawSegment(f,l,r),l=this._points[i],r=this._points[i+1];f.lineTo(l.x,l.y),f.stroke(),f.restore()},convertPointsToSVGPath:function(f){var i=this.width/1e3;return t.util.getSmoothPathFromPoints(f,i)},_isEmptySVGPath:function(f){var i=t.util.joinPath(f);return i==="M 0 0 Q 0 0 0 0 L 0 0"},createPath:function(f){var i=new t.Path(f,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,i.shadow=new t.Shadow(this.shadow)),i},decimatePoints:function(f,i){if(f.length<=2)return f;var c=this.canvas.getZoom(),l=Math.pow(i/c,2),r,a=f.length-1,s=f[0],u=[s],d;for(r=1;r<a-1;r++)d=Math.pow(s.x-f[r].x,2)+Math.pow(s.y-f[r].y,2),d>=l&&(s=f[r],u.push(s));return u.push(f[a]),u},_finalizeAndAddPath:function(){var f=this.canvas.contextTop;f.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var i=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(i)){this.canvas.requestRenderAll();return}var c=this.createPath(i);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:c}),this.canvas.add(c),this.canvas.requestRenderAll(),c.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:c})}})}(),t.CircleBrush=t.util.createClass(t.BaseBrush,{width:10,initialize:function(f){this.canvas=f,this.points=[]},drawDot:function(f){var i=this.addPoint(f),c=this.canvas.contextTop;this._saveAndTransform(c),this.dot(c,i),c.restore()},dot:function(f,i){f.fillStyle=i.fill,f.beginPath(),f.arc(i.x,i.y,i.radius,0,Math.PI*2,!1),f.closePath(),f.fill()},onMouseDown:function(f){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(f)},_render:function(){var f=this.canvas.contextTop,i,c,l=this.points;for(this._saveAndTransform(f),i=0,c=l.length;i<c;i++)this.dot(f,l[i]);f.restore()},onMouseMove:function(f){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(f)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(f),this._render()):this.drawDot(f))},onMouseUp:function(){var f=this.canvas.renderOnAddRemove,i,c;this.canvas.renderOnAddRemove=!1;var l=[];for(i=0,c=this.points.length;i<c;i++){var r=this.points[i],a=new t.Circle({radius:r.radius,left:r.x,top:r.y,originX:"center",originY:"center",fill:r.fill});this.shadow&&(a.shadow=new t.Shadow(this.shadow)),l.push(a)}var s=new t.Group(l);s.canvas=this.canvas,this.canvas.fire("before:path:created",{path:s}),this.canvas.add(s),this.canvas.fire("path:created",{path:s}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=f,this.canvas.requestRenderAll()},addPoint:function(f){var i=new t.Point(f.x,f.y),c=t.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,l=new t.Color(this.color).setAlpha(t.util.getRandomInt(0,100)/100).toRgba();return i.radius=c,i.fill=l,this.points.push(i),i}}),t.SprayBrush=t.util.createClass(t.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(f){this.canvas=f,this.sprayChunks=[]},onMouseDown:function(f){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(f),this.render(this.sprayChunkPoints)},onMouseMove:function(f){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(f)||(this.addSprayChunk(f),this.render(this.sprayChunkPoints))},onMouseUp:function(){var f=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var i=[],c=0,l=this.sprayChunks.length;c<l;c++)for(var r=this.sprayChunks[c],a=0,s=r.length;a<s;a++){var u=new t.Rect({width:r[a].width,height:r[a].width,left:r[a].x+1,top:r[a].y+1,originX:"center",originY:"center",fill:this.color});i.push(u)}this.optimizeOverlapping&&(i=this._getOptimizedRects(i));var d=new t.Group(i);this.shadow&&d.set("shadow",new t.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:d}),this.canvas.add(d),this.canvas.fire("path:created",{path:d}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=f,this.canvas.requestRenderAll()},_getOptimizedRects:function(f){var i={},c,l,r;for(l=0,r=f.length;l<r;l++)c=f[l].left+""+f[l].top,i[c]||(i[c]=f[l]);var a=[];for(c in i)a.push(i[c]);return a},render:function(f){var i=this.canvas.contextTop,c,l;for(i.fillStyle=this.color,this._saveAndTransform(i),c=0,l=f.length;c<l;c++){var r=f[c];typeof r.opacity!="undefined"&&(i.globalAlpha=r.opacity),i.fillRect(r.x,r.y,r.width,r.width)}i.restore()},_render:function(){var f=this.canvas.contextTop,i,c;for(f.fillStyle=this.color,this._saveAndTransform(f),i=0,c=this.sprayChunks.length;i<c;i++)this.render(this.sprayChunks[i]);f.restore()},addSprayChunk:function(f){this.sprayChunkPoints=[];var i,c,l,r=this.width/2,a;for(a=0;a<this.density;a++){i=t.util.getRandomInt(f.x-r,f.x+r),c=t.util.getRandomInt(f.y-r,f.y+r),this.dotWidthVariance?l=t.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):l=this.dotWidth;var s=new t.Point(i,c);s.width=l,this.randomOpacity&&(s.opacity=t.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(s)}this.sprayChunks.push(this.sprayChunkPoints)}}),t.PatternBrush=t.util.createClass(t.PencilBrush,{getPatternSrc:function(){var f=20,i=5,c=t.util.createCanvasElement(),l=c.getContext("2d");return c.width=c.height=f+i,l.fillStyle=this.color,l.beginPath(),l.arc(f/2,f/2,f/2,0,Math.PI*2,!1),l.closePath(),l.fill(),c},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(f){return f.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(f){this.callSuper("_setBrushStyles",f),f.strokeStyle=this.getPattern(f)},createPath:function(f){var i=this.callSuper("createPath",f),c=i._getLeftTopCoords().scalarAdd(i.strokeWidth/2);return i.stroke=new t.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-c.x,offsetY:-c.y}),i}}),function(){var f=t.util.getPointer,i=t.util.degreesToRadians,c=t.util.isTouchEvent;t.Canvas=t.util.createClass(t.StaticCanvas,{initialize:function(r,a){a||(a={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(r,a),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=t.PencilBrush&&new t.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var r=this.getActiveObjects(),a,s,u;if(r.length>0&&!this.preserveObjectStacking){s=[],u=[];for(var d=0,h=this._objects.length;d<h;d++)a=this._objects[d],r.indexOf(a)===-1?s.push(a):u.push(a);r.length>1&&(this._activeObject._objects=u),s.push.apply(s,u)}else s=this._objects;return s},renderAll:function(){this.contextTopDirty&&!this._groupSelector&&!this.isDrawingMode&&(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var r=this.contextContainer;return this.renderCanvas(r,this._chooseObjectsToRender()),this},renderTopLayer:function(r){r.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(r),this.contextTopDirty=!0),r.restore()},renderTop:function(){var r=this.contextTop;return this.clearContext(r),this.renderTopLayer(r),this.fire("after:render"),this},_normalizePointer:function(r,a){var s=r.calcTransformMatrix(),u=t.util.invertTransform(s),d=this.restorePointerVpt(a);return t.util.transformPoint(d,u)},isTargetTransparent:function(r,a,s){if(r.shouldCache()&&r._cacheCanvas&&r!==this._activeObject){var u=this._normalizePointer(r,{x:a,y:s}),d=Math.max(r.cacheTranslationX+u.x*r.zoomX,0),h=Math.max(r.cacheTranslationY+u.y*r.zoomY,0),_=t.util.isTransparent(r._cacheContext,Math.round(d),Math.round(h),this.targetFindTolerance);return _}var p=this.contextCache,m=r.selectionBackgroundColor,y=this.viewportTransform;r.selectionBackgroundColor="",this.clearContext(p),p.save(),p.transform(y[0],y[1],y[2],y[3],y[4],y[5]),r.render(p),p.restore(),r.selectionBackgroundColor=m;var _=t.util.isTransparent(p,a,s,this.targetFindTolerance);return _},_isSelectionKeyPressed:function(r){var a=!1;return Array.isArray(this.selectionKey)?a=!!this.selectionKey.find(function(s){return r[s]===!0}):a=r[this.selectionKey],a},_shouldClearSelection:function(r,a){var s=this.getActiveObjects(),u=this._activeObject;return!a||a&&u&&s.length>1&&s.indexOf(a)===-1&&u!==a&&!this._isSelectionKeyPressed(r)||a&&!a.evented||a&&!a.selectable&&u&&u!==a},_shouldCenterTransform:function(r,a,s){if(r){var u;return a==="scale"||a==="scaleX"||a==="scaleY"||a==="resizing"?u=this.centeredScaling||r.centeredScaling:a==="rotate"&&(u=this.centeredRotation||r.centeredRotation),u?!s:s}},_getOriginFromCorner:function(r,a){var s={x:r.originX,y:r.originY};return a==="ml"||a==="tl"||a==="bl"?s.x="right":(a==="mr"||a==="tr"||a==="br")&&(s.x="left"),a==="tl"||a==="mt"||a==="tr"?s.y="bottom":(a==="bl"||a==="mb"||a==="br")&&(s.y="top"),s},_getActionFromCorner:function(r,a,s,u){if(!a||!r)return"drag";var d=u.controls[a];return d.getActionName(s,d,u)},_setupCurrentTransform:function(r,a,s){if(a){var u=this.getPointer(r),d=a.__corner,h=a.controls[d],p=s&&d?h.getActionHandler(r,a,h):t.controlsUtils.dragHandler,m=this._getActionFromCorner(s,d,r,a),y=this._getOriginFromCorner(a,d),_=r[this.centeredKey],C={target:a,action:m,actionHandler:p,corner:d,scaleX:a.scaleX,scaleY:a.scaleY,skewX:a.skewX,skewY:a.skewY,offsetX:u.x-a.left,offsetY:u.y-a.top,originX:y.x,originY:y.y,ex:u.x,ey:u.y,lastX:u.x,lastY:u.y,theta:i(a.angle),width:a.width*a.scaleX,shiftKey:r.shiftKey,altKey:_,original:t.util.saveObjectTransform(a)};this._shouldCenterTransform(a,m,_)&&(C.originX="center",C.originY="center"),C.original.originX=y.x,C.original.originY=y.y,this._currentTransform=C,this._beforeTransform(r)}},setCursor:function(r){this.upperCanvasEl.style.cursor=r},_drawSelection:function(r){var a=this._groupSelector,s=new t.Point(a.ex,a.ey),u=t.util.transformPoint(s,this.viewportTransform),d=new t.Point(a.ex+a.left,a.ey+a.top),h=t.util.transformPoint(d,this.viewportTransform),p=Math.min(u.x,h.x),m=Math.min(u.y,h.y),y=Math.max(u.x,h.x),_=Math.max(u.y,h.y),C=this.selectionLineWidth/2;this.selectionColor&&(r.fillStyle=this.selectionColor,r.fillRect(p,m,y-p,_-m)),!(!this.selectionLineWidth||!this.selectionBorderColor)&&(r.lineWidth=this.selectionLineWidth,r.strokeStyle=this.selectionBorderColor,p+=C,m+=C,y-=C,_-=C,t.Object.prototype._setLineDash.call(this,r,this.selectionDashArray),r.strokeRect(p,m,y-p,_-m))},findTarget:function(r,a){if(!this.skipTargetFind){var s=!0,u=this.getPointer(r,s),d=this._activeObject,h=this.getActiveObjects(),p,m,y=c(r),_=h.length>1&&!a||h.length===1;if(this.targets=[],_&&d._findTargetCorner(u,y)||h.length>1&&!a&&d===this._searchPossibleTargets([d],u))return d;if(h.length===1&&d===this._searchPossibleTargets([d],u))if(this.preserveObjectStacking)p=d,m=this.targets,this.targets=[];else return d;var C=this._searchPossibleTargets(this._objects,u);return r[this.altSelectionKey]&&C&&p&&C!==p&&(C=p,this.targets=m),C}},_checkTarget:function(r,a,s){if(a&&a.visible&&a.evented&&a.containsPoint(r))if((this.perPixelTargetFind||a.perPixelTargetFind)&&!a.isEditing){var u=this.isTargetTransparent(a,s.x,s.y);if(!u)return!0}else return!0},_searchPossibleTargets:function(r,a){for(var s,u=r.length,d;u--;){var h=r[u],p=h.group?this._normalizePointer(h.group,a):a;if(this._checkTarget(p,h,a)){s=r[u],s.subTargetCheck&&s instanceof t.Group&&(d=this._searchPossibleTargets(s._objects,a),d&&this.targets.push(d));break}}return s},restorePointerVpt:function(r){return t.util.transformPoint(r,t.util.invertTransform(this.viewportTransform))},getPointer:function(r,a){if(this._absolutePointer&&!a)return this._absolutePointer;if(this._pointer&&a)return this._pointer;var s=f(r),u=this.upperCanvasEl,d=u.getBoundingClientRect(),h=d.width||0,p=d.height||0,m;(!h||!p)&&("top"in d&&"bottom"in d&&(p=Math.abs(d.top-d.bottom)),"right"in d&&"left"in d&&(h=Math.abs(d.right-d.left))),this.calcOffset(),s.x=s.x-this._offset.left,s.y=s.y-this._offset.top,a||(s=this.restorePointerVpt(s));var y=this.getRetinaScaling();return y!==1&&(s.x/=y,s.y/=y),h===0||p===0?m={width:1,height:1}:m={width:u.width/h,height:u.height/p},{x:s.x*m.width,y:s.y*m.height}},_createUpperCanvas:function(){var r=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),a=this.lowerCanvasEl,s=this.upperCanvasEl;s?s.className="":(s=this._createCanvasElement(),this.upperCanvasEl=s),t.util.addClass(s,"upper-canvas "+r),this.wrapperEl.appendChild(s),this._copyCanvasStyle(a,s),this._applyCanvasStyle(s),this.contextTop=s.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=t.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),t.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),t.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(r){var a=this.width||r.width,s=this.height||r.height;t.util.setStyle(r,{position:"absolute",width:a+"px",height:s+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),r.width=a,r.height=s,t.util.makeElementUnselectable(r)},_copyCanvasStyle:function(r,a){a.style.cssText=r.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var r=this._activeObject;return r?r.type==="activeSelection"&&r._objects?r._objects.slice(0):[r]:[]},_onObjectRemoved:function(r){r===this._activeObject&&(this.fire("before:selection:cleared",{target:r}),this._discardActiveObject(),this.fire("selection:cleared",{target:r}),r.fire("deselected")),r===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",r)},_fireSelectionEvents:function(r,a){var s=!1,u=this.getActiveObjects(),d=[],h=[];r.forEach(function(p){u.indexOf(p)===-1&&(s=!0,p.fire("deselected",{e:a,target:p}),h.push(p))}),u.forEach(function(p){r.indexOf(p)===-1&&(s=!0,p.fire("selected",{e:a,target:p}),d.push(p))}),r.length>0&&u.length>0?s&&this.fire("selection:updated",{e:a,selected:d,deselected:h}):u.length>0?this.fire("selection:created",{e:a,selected:d}):r.length>0&&this.fire("selection:cleared",{e:a,deselected:h})},setActiveObject:function(r,a){var s=this.getActiveObjects();return this._setActiveObject(r,a),this._fireSelectionEvents(s,a),this},_setActiveObject:function(r,a){return this._activeObject===r||!this._discardActiveObject(a,r)||r.onSelect({e:a})?!1:(this._activeObject=r,!0)},_discardActiveObject:function(r,a){var s=this._activeObject;if(s){if(s.onDeselect({e:r,object:a}))return!1;this._activeObject=null}return!0},discardActiveObject:function(r){var a=this.getActiveObjects(),s=this.getActiveObject();return a.length&&this.fire("before:selection:cleared",{target:s,e:r}),this._discardActiveObject(r),this._fireSelectionEvents(a,r),this},dispose:function(){var r=this.wrapperEl;return this.removeListeners(),r.removeChild(this.upperCanvasEl),r.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach(function(a){t.util.cleanUpJsdomNode(this[a]),this[a]=void 0}.bind(this)),r.parentNode&&r.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,t.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(r){var a=this._activeObject;a&&a._renderControls(r)},_toObject:function(r,a,s){var u=this._realizeGroupTransformOnObject(r),d=this.callSuper("_toObject",r,a,s);return this._unwindGroupTransformOnObject(r,u),d},_realizeGroupTransformOnObject:function(r){if(r.group&&r.group.type==="activeSelection"&&this._activeObject===r.group){var a=["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"],s={};return a.forEach(function(u){s[u]=r[u]}),t.util.addTransformToObject(r,this._activeObject.calcOwnMatrix()),s}else return null},_unwindGroupTransformOnObject:function(r,a){a&&r.set(a)},_setSVGObject:function(r,a,s){var u=this._realizeGroupTransformOnObject(a);this.callSuper("_setSVGObject",r,a,s),this._unwindGroupTransformOnObject(a,u)},setViewportTransform:function(r){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),t.StaticCanvas.prototype.setViewportTransform.call(this,r)}});for(var l in t.StaticCanvas)l!=="prototype"&&(t.Canvas[l]=t.StaticCanvas[l])}(),function(){var f=t.util.addListener,i=t.util.removeListener,c=3,l=2,r=1,a={passive:!1};function s(u,d){return u.button&&u.button===d-1}t.util.object.extend(t.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(f,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(u,d){var h=this.upperCanvasEl,p=this._getEventPrefix();u(t.window,"resize",this._onResize),u(h,p+"down",this._onMouseDown),u(h,p+"move",this._onMouseMove,a),u(h,p+"out",this._onMouseOut),u(h,p+"enter",this._onMouseEnter),u(h,"wheel",this._onMouseWheel),u(h,"contextmenu",this._onContextMenu),u(h,"dblclick",this._onDoubleClick),u(h,"dragover",this._onDragOver),u(h,"dragenter",this._onDragEnter),u(h,"dragleave",this._onDragLeave),u(h,"drop",this._onDrop),this.enablePointerEvents||u(h,"touchstart",this._onTouchStart,a),typeof eventjs!="undefined"&&d in eventjs&&(eventjs[d](h,"gesture",this._onGesture),eventjs[d](h,"drag",this._onDrag),eventjs[d](h,"orientation",this._onOrientationChange),eventjs[d](h,"shake",this._onShake),eventjs[d](h,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(i,"remove");var u=this._getEventPrefix();i(t.document,u+"up",this._onMouseUp),i(t.document,"touchend",this._onTouchEnd,a),i(t.document,u+"move",this._onMouseMove,a),i(t.document,"touchmove",this._onMouseMove,a)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(u,d){this.__onTransformGesture&&this.__onTransformGesture(u,d)},_onDrag:function(u,d){this.__onDrag&&this.__onDrag(u,d)},_onMouseWheel:function(u){this.__onMouseWheel(u)},_onMouseOut:function(u){var d=this._hoveredTarget;this.fire("mouse:out",{target:d,e:u}),this._hoveredTarget=null,d&&d.fire("mouseout",{e:u});var h=this;this._hoveredTargets.forEach(function(p){h.fire("mouse:out",{target:d,e:u}),p&&d.fire("mouseout",{e:u})}),this._hoveredTargets=[]},_onMouseEnter:function(u){!this._currentTransform&&!this.findTarget(u)&&(this.fire("mouse:over",{target:null,e:u}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(u,d){this.__onOrientationChange&&this.__onOrientationChange(u,d)},_onShake:function(u,d){this.__onShake&&this.__onShake(u,d)},_onLongPress:function(u,d){this.__onLongPress&&this.__onLongPress(u,d)},_onDragOver:function(u){u.preventDefault();var d=this._simpleEventHandler("dragover",u);this._fireEnterLeaveEvents(d,u)},_onDrop:function(u){return this._simpleEventHandler("drop:before",u),this._simpleEventHandler("drop",u)},_onContextMenu:function(u){return this.stopContextMenu&&(u.stopPropagation(),u.preventDefault()),!1},_onDoubleClick:function(u){this._cacheTransformEventData(u),this._handleEvent(u,"dblclick"),this._resetTransformEventData(u)},getPointerId:function(u){var d=u.changedTouches;return d?d[0]&&d[0].identifier:this.enablePointerEvents?u.pointerId:-1},_isMainEvent:function(u){return u.isPrimary===!0?!0:u.isPrimary===!1?!1:u.type==="touchend"&&u.touches.length===0?!0:u.changedTouches?u.changedTouches[0].identifier===this.mainTouchId:!0},_onTouchStart:function(u){u.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(u)),this.__onMouseDown(u),this._resetTransformEventData();var d=this.upperCanvasEl,h=this._getEventPrefix();f(t.document,"touchend",this._onTouchEnd,a),f(t.document,"touchmove",this._onMouseMove,a),i(d,h+"down",this._onMouseDown)},_onMouseDown:function(u){this.__onMouseDown(u),this._resetTransformEventData();var d=this.upperCanvasEl,h=this._getEventPrefix();i(d,h+"move",this._onMouseMove,a),f(t.document,h+"up",this._onMouseUp),f(t.document,h+"move",this._onMouseMove,a)},_onTouchEnd:function(u){if(!(u.touches.length>0)){this.__onMouseUp(u),this._resetTransformEventData(),this.mainTouchId=null;var d=this._getEventPrefix();i(t.document,"touchend",this._onTouchEnd,a),i(t.document,"touchmove",this._onMouseMove,a);var h=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){f(h.upperCanvasEl,d+"down",h._onMouseDown),h._willAddMouseDown=0},400)}},_onMouseUp:function(u){this.__onMouseUp(u),this._resetTransformEventData();var d=this.upperCanvasEl,h=this._getEventPrefix();this._isMainEvent(u)&&(i(t.document,h+"up",this._onMouseUp),i(t.document,h+"move",this._onMouseMove,a),f(d,h+"move",this._onMouseMove,a))},_onMouseMove:function(u){!this.allowTouchScrolling&&u.preventDefault&&u.preventDefault(),this.__onMouseMove(u)},_onResize:function(){this.calcOffset()},_shouldRender:function(u){var d=this._activeObject;return!!d!=!!u||d&&u&&d!==u?!0:(d&&d.isEditing,!1)},__onMouseUp:function(u){var d,h=this._currentTransform,p=this._groupSelector,m=!1,y=!p||p.left===0&&p.top===0;if(this._cacheTransformEventData(u),d=this._target,this._handleEvent(u,"up:before"),s(u,c)){this.fireRightClick&&this._handleEvent(u,"up",c,y);return}if(s(u,l)){this.fireMiddleClick&&this._handleEvent(u,"up",l,y),this._resetTransformEventData();return}if(this.isDrawingMode&&this._isCurrentlyDrawing){this._onMouseUpInDrawingMode(u);return}if(this._isMainEvent(u)){if(h&&(this._finalizeCurrentTransform(u),m=h.actionPerformed),!y){var _=d===this._activeObject;this._maybeGroupObjects(u),m||(m=this._shouldRender(d)||!_&&d===this._activeObject)}var C,w;if(d){if(C=d._findTargetCorner(this.getPointer(u,!0),t.util.isTouchEvent(u)),d.selectable&&d!==this._activeObject&&d.activeOn==="up")this.setActiveObject(d,u),m=!0;else{var b=d.controls[C],S=b&&b.getMouseUpHandler(u,d,b);S&&(w=this.getPointer(u),S(u,h,w.x,w.y))}d.isMoving=!1}if(h&&(h.target!==d||h.corner!==C)){var F=h.target&&h.target.controls[h.corner],$=F&&F.getMouseUpHandler(u,d,b);w=w||this.getPointer(u),$&&$(u,h,w.x,w.y)}this._setCursorFromEvent(u,d),this._handleEvent(u,"up",r,y),this._groupSelector=null,this._currentTransform=null,d&&(d.__corner=0),m?this.requestRenderAll():y||this.renderTop()}},_simpleEventHandler:function(u,d){var h=this.findTarget(d),p=this.targets,m={e:d,target:h,subTargets:p};if(this.fire(u,m),h&&h.fire(u,m),!p)return h;for(var y=0;y<p.length;y++)p[y].fire(u,m);return h},_handleEvent:function(u,d,h,p){var m=this._target,y=this.targets||[],_={e:u,target:m,subTargets:y,button:h||r,isClick:p||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};d==="up"&&(_.currentTarget=this.findTarget(u),_.currentSubTargets=this.targets),this.fire("mouse:"+d,_),m&&m.fire("mouse"+d,_);for(var C=0;C<y.length;C++)y[C].fire("mouse"+d,_)},_finalizeCurrentTransform:function(u){var d=this._currentTransform,h=d.target,p={e:u,target:h,transform:d,action:d.action};h._scaling&&(h._scaling=!1),h.setCoords(),(d.actionPerformed||this.stateful&&h.hasStateChanged())&&this._fire("modified",p)},_onMouseDownInDrawingMode:function(u){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(u).requestRenderAll();var d=this.getPointer(u);this.freeDrawingBrush.onMouseDown(d,{e:u,pointer:d}),this._handleEvent(u,"down")},_onMouseMoveInDrawingMode:function(u){if(this._isCurrentlyDrawing){var d=this.getPointer(u);this.freeDrawingBrush.onMouseMove(d,{e:u,pointer:d})}this.setCursor(this.freeDrawingCursor),this._handleEvent(u,"move")},_onMouseUpInDrawingMode:function(u){var d=this.getPointer(u);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:u,pointer:d}),this._handleEvent(u,"up")},__onMouseDown:function(u){this._cacheTransformEventData(u),this._handleEvent(u,"down:before");var d=this._target;if(s(u,c)){this.fireRightClick&&this._handleEvent(u,"down",c);return}if(s(u,l)){this.fireMiddleClick&&this._handleEvent(u,"down",l);return}if(this.isDrawingMode){this._onMouseDownInDrawingMode(u);return}if(this._isMainEvent(u)&&!this._currentTransform){var h=this._pointer;this._previousPointer=h;var p=this._shouldRender(d),m=this._shouldGroup(u,d);if(this._shouldClearSelection(u,d)?this.discardActiveObject(u):m&&(this._handleGrouping(u,d),d=this._activeObject),this.selection&&(!d||!d.selectable&&!d.isEditing&&d!==this._activeObject)&&(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),d){var y=d===this._activeObject;d.selectable&&d.activeOn==="down"&&this.setActiveObject(d,u);var _=d._findTargetCorner(this.getPointer(u,!0),t.util.isTouchEvent(u));if(d.__corner=_,d===this._activeObject&&(_||!m)){this._setupCurrentTransform(u,d,y);var C=d.controls[_],h=this.getPointer(u),w=C&&C.getMouseDownHandler(u,d,C);w&&w(u,this._currentTransform,h.x,h.y)}}this._handleEvent(u,"down"),(p||m)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(u){this._resetTransformEventData(),this._pointer=this.getPointer(u,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(u)||null},_beforeTransform:function(u){var d=this._currentTransform;this.stateful&&d.target.saveState(),this.fire("before:transform",{e:u,transform:d})},__onMouseMove:function(u){this._handleEvent(u,"move:before"),this._cacheTransformEventData(u);var d,h;if(this.isDrawingMode){this._onMouseMoveInDrawingMode(u);return}if(this._isMainEvent(u)){var p=this._groupSelector;p?(h=this._absolutePointer,p.left=h.x-p.ex,p.top=h.y-p.ey,this.renderTop()):this._currentTransform?this._transformObject(u):(d=this.findTarget(u)||null,this._setCursorFromEvent(u,d),this._fireOverOutEvents(d,u)),this._handleEvent(u,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(u,d){var h=this._hoveredTarget,p=this._hoveredTargets,m=this.targets,y=Math.max(p.length,m.length);this.fireSyntheticInOutEvents(u,d,{oldTarget:h,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var _=0;_<y;_++)this.fireSyntheticInOutEvents(m[_],d,{oldTarget:p[_],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=u,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(u,d){var h=this._draggedoverTarget,p=this._hoveredTargets,m=this.targets,y=Math.max(p.length,m.length);this.fireSyntheticInOutEvents(u,d,{oldTarget:h,evtOut:"dragleave",evtIn:"dragenter"});for(var _=0;_<y;_++)this.fireSyntheticInOutEvents(m[_],d,{oldTarget:p[_],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=u},fireSyntheticInOutEvents:function(u,d,h){var p,m,y=h.oldTarget,_,C,w=y!==u,b=h.canvasEvtIn,S=h.canvasEvtOut;w&&(p={e:d,target:u,previousTarget:y},m={e:d,target:y,nextTarget:u}),C=u&&w,_=y&&w,_&&(S&&this.fire(S,m),y.fire(h.evtOut,m)),C&&(b&&this.fire(b,p),u.fire(h.evtIn,p))},__onMouseWheel:function(u){this._cacheTransformEventData(u),this._handleEvent(u,"wheel"),this._resetTransformEventData()},_transformObject:function(u){var d=this.getPointer(u),h=this._currentTransform;h.reset=!1,h.shiftKey=u.shiftKey,h.altKey=u[this.centeredKey],this._performTransformAction(u,h,d),h.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(u,d,h){var p=h.x,m=h.y,y=d.action,_=!1,C=d.actionHandler;C&&(_=C(u,d,p,m)),y==="drag"&&_&&(d.target.isMoving=!0,this.setCursor(d.target.moveCursor||this.moveCursor)),d.actionPerformed=d.actionPerformed||_},_fire:t.controlsUtils.fireEvent,_setCursorFromEvent:function(u,d){if(!d)return this.setCursor(this.defaultCursor),!1;var h=d.hoverCursor||this.hoverCursor,p=this._activeObject&&this._activeObject.type==="activeSelection"?this._activeObject:null,m=(!p||!p.contains(d))&&d._findTargetCorner(this.getPointer(u,!0));m?this.setCursor(this.getCornerCursor(m,d,u)):(d.subTargetCheck&&this.targets.concat().reverse().map(function(y){h=y.hoverCursor||h}),this.setCursor(h))},getCornerCursor:function(u,d,h){var p=d.controls[u];return p.cursorStyleHandler(h,p,d)}})}(),function(){var f=Math.min,i=Math.max;t.util.object.extend(t.Canvas.prototype,{_shouldGroup:function(c,l){var r=this._activeObject;return r&&this._isSelectionKeyPressed(c)&&l&&l.selectable&&this.selection&&(r!==l||r.type==="activeSelection")&&!l.onSelect({e:c})},_handleGrouping:function(c,l){var r=this._activeObject;r.__corner||l===r&&(l=this.findTarget(c,!0),!l||!l.selectable)||(r&&r.type==="activeSelection"?this._updateActiveSelection(l,c):this._createActiveSelection(l,c))},_updateActiveSelection:function(c,l){var r=this._activeObject,a=r._objects.slice(0);r.contains(c)?(r.removeWithUpdate(c),this._hoveredTarget=c,this._hoveredTargets=this.targets.concat(),r.size()===1&&this._setActiveObject(r.item(0),l)):(r.addWithUpdate(c),this._hoveredTarget=r,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(a,l)},_createActiveSelection:function(c,l){var r=this.getActiveObjects(),a=this._createGroup(c);this._hoveredTarget=a,this._setActiveObject(a,l),this._fireSelectionEvents(r,l)},_createGroup:function(c){var l=this._objects,r=l.indexOf(this._activeObject)<l.indexOf(c),a=r?[this._activeObject,c]:[c,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new t.ActiveSelection(a,{canvas:this})},_groupSelectedObjects:function(c){var l=this._collectObjects(c),r;l.length===1?this.setActiveObject(l[0],c):l.length>1&&(r=new t.ActiveSelection(l.reverse(),{canvas:this}),this.setActiveObject(r,c))},_collectObjects:function(c){for(var l=[],r,a=this._groupSelector.ex,s=this._groupSelector.ey,u=a+this._groupSelector.left,d=s+this._groupSelector.top,h=new t.Point(f(a,u),f(s,d)),p=new t.Point(i(a,u),i(s,d)),m=!this.selectionFullyContained,y=a===u&&s===d,_=this._objects.length;_--&&(r=this._objects[_],!(!(!r||!r.selectable||!r.visible)&&(m&&r.intersectsWithRect(h,p,!0)||r.isContainedWithinRect(h,p,!0)||m&&r.containsPoint(h,null,!0)||m&&r.containsPoint(p,null,!0))&&(l.push(r),y))););return l.length>1&&(l=l.filter(function(C){return!C.onSelect({e:c})})),l},_maybeGroupObjects:function(c){this.selection&&this._groupSelector&&this._groupSelectedObjects(c),this.setCursor(this.defaultCursor),this._groupSelector=null}})}(),function(){t.util.object.extend(t.StaticCanvas.prototype,{toDataURL:function(f){f||(f={});var i=f.format||"png",c=f.quality||1,l=(f.multiplier||1)*(f.enableRetinaScaling?this.getRetinaScaling():1),r=this.toCanvasElement(l,f);return t.util.toDataURL(r,i,c)},toCanvasElement:function(f,i){f=f||1,i=i||{};var c=(i.width||this.width)*f,l=(i.height||this.height)*f,r=this.getZoom(),a=this.width,s=this.height,u=r*f,d=this.viewportTransform,h=(d[4]-(i.left||0))*f,p=(d[5]-(i.top||0))*f,m=this.interactive,y=[u,0,0,u,h,p],_=this.enableRetinaScaling,C=t.util.createCanvasElement(),w=this.contextTop;return C.width=c,C.height=l,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=y,this.width=c,this.height=l,this.calcViewportBoundaries(),this.renderCanvas(C.getContext("2d"),this._objects),this.viewportTransform=d,this.width=a,this.height=s,this.calcViewportBoundaries(),this.interactive=m,this.enableRetinaScaling=_,this.contextTop=w,C}})}(),t.util.object.extend(t.StaticCanvas.prototype,{loadFromJSON:function(f,i,c){if(f){var l=typeof f=="string"?JSON.parse(f):t.util.object.clone(f),r=this,a=l.clipPath,s=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete l.clipPath,this._enlivenObjects(l.objects,function(u){r.clear(),r._setBgOverlay(l,function(){a?r._enlivenObjects([a],function(d){r.clipPath=d[0],r.__setupCanvas.call(r,l,u,s,i)}):r.__setupCanvas.call(r,l,u,s,i)})},c),this}},__setupCanvas:function(f,i,c,l){var r=this;i.forEach(function(a,s){r.insertAt(a,s)}),this.renderOnAddRemove=c,delete f.objects,delete f.backgroundImage,delete f.overlayImage,delete f.background,delete f.overlay,this._setOptions(f),this.renderAll(),l&&l()},_setBgOverlay:function(f,i){var c={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!f.backgroundImage&&!f.overlayImage&&!f.background&&!f.overlay){i&&i();return}var l=function(){c.backgroundImage&&c.overlayImage&&c.backgroundColor&&c.overlayColor&&i&&i()};this.__setBgOverlay("backgroundImage",f.backgroundImage,c,l),this.__setBgOverlay("overlayImage",f.overlayImage,c,l),this.__setBgOverlay("backgroundColor",f.background,c,l),this.__setBgOverlay("overlayColor",f.overlay,c,l)},__setBgOverlay:function(f,i,c,l){var r=this;if(!i){c[f]=!0,l&&l();return}f==="backgroundImage"||f==="overlayImage"?t.util.enlivenObjects([i],function(a){r[f]=a[0],c[f]=!0,l&&l()}):this["set"+t.util.string.capitalize(f,!0)](i,function(){c[f]=!0,l&&l()})},_enlivenObjects:function(f,i,c){if(!f||f.length===0){i&&i([]);return}t.util.enlivenObjects(f,function(l){i&&i(l)},null,c)},_toDataURL:function(f,i){this.clone(function(c){i(c.toDataURL(f))})},_toDataURLWithMultiplier:function(f,i,c){this.clone(function(l){c(l.toDataURLWithMultiplier(f,i))})},clone:function(f,i){var c=JSON.stringify(this.toJSON(i));this.cloneWithoutData(function(l){l.loadFromJSON(c,function(){f&&f(l)})})},cloneWithoutData:function(f){var i=t.util.createCanvasElement();i.width=this.width,i.height=this.height;var c=new t.Canvas(i);this.backgroundImage?(c.setBackgroundImage(this.backgroundImage.src,function(){c.renderAll(),f&&f(c)}),c.backgroundImageOpacity=this.backgroundImageOpacity,c.backgroundImageStretch=this.backgroundImageStretch):f&&f(c)}}),function(f){var i=f.fabric||(f.fabric={}),c=i.util.object.extend,l=i.util.object.clone,r=i.util.toFixed,a=i.util.string.capitalize,s=i.util.degreesToRadians,u=!i.isLikelyNode,d=2;i.Object||(i.Object=i.util.createClass(i.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:u,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(h){h&&this.setOptions(h)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=i.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(h){var p=i.perfLimitSizeTotal,m=h.width,y=h.height,_=i.maxCacheSideLimit,C=i.minCacheSideLimit;if(m<=_&&y<=_&&m*y<=p)return m<C&&(h.width=C),y<C&&(h.height=C),h;var w=m/y,b=i.util.limitDimsByArea(w,p),S=i.util.capValue,F=S(C,b.x,_),$=S(C,b.y,_);return m>F&&(h.zoomX/=m/F,h.width=F,h.capped=!0),y>$&&(h.zoomY/=y/$,h.height=$,h.capped=!0),h},_getCacheCanvasDimensions:function(){var h=this.getTotalObjectScaling(),p=this._getTransformedDimensions(0,0),m=p.x*h.scaleX/this.scaleX,y=p.y*h.scaleY/this.scaleY;return{width:m+d,height:y+d,zoomX:h.scaleX,zoomY:h.scaleY,x:m,y}},_updateCacheCanvas:function(){var h=this.canvas;if(this.noScaleCache&&h&&h._currentTransform){var p=h._currentTransform.target,m=h._currentTransform.action;if(this===p&&m.slice&&m.slice(0,5)==="scale")return!1}var y=this._cacheCanvas,_=this._limitCacheSize(this._getCacheCanvasDimensions()),C=i.minCacheSideLimit,w=_.width,b=_.height,S,F,$=_.zoomX,Q=_.zoomY,R=w!==this.cacheWidth||b!==this.cacheHeight,H=this.zoomX!==$||this.zoomY!==Q,W=R||H,G=0,V=0,st=!1;if(R){var et=this._cacheCanvas.width,x=this._cacheCanvas.height,B=w>et||b>x,k=(w<et*.9||b<x*.9)&&et>C&&x>C;st=B||k,B&&!_.capped&&(w>C||b>C)&&(G=w*.1,V=b*.1)}return this instanceof i.Text&&this.path&&(W=!0,st=!0,G+=this.getHeightOfLine(0)*this.zoomX,V+=this.getHeightOfLine(0)*this.zoomY),W?(st?(y.width=Math.ceil(w+G),y.height=Math.ceil(b+V)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,y.width,y.height)),S=_.x/2,F=_.y/2,this.cacheTranslationX=Math.round(y.width/2-S)+S,this.cacheTranslationY=Math.round(y.height/2-F)+F,this.cacheWidth=w,this.cacheHeight=b,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale($,Q),this.zoomX=$,this.zoomY=Q,!0):!1},setOptions:function(h){this._setOptions(h),this._initGradient(h.fill,"fill"),this._initGradient(h.stroke,"stroke"),this._initPattern(h.fill,"fill"),this._initPattern(h.stroke,"stroke")},transform:function(h){var p=this.group&&!this.group._transformDone||this.group&&this.canvas&&h===this.canvas.contextTop,m=this.calcTransformMatrix(!p);h.transform(m[0],m[1],m[2],m[3],m[4],m[5])},toObject:function(h){var p=i.Object.NUM_FRACTION_DIGITS,m={type:this.type,version:i.version,originX:this.originX,originY:this.originY,left:r(this.left,p),top:r(this.top,p),width:r(this.width,p),height:r(this.height,p),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:r(this.strokeWidth,p),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:r(this.strokeMiterLimit,p),scaleX:r(this.scaleX,p),scaleY:r(this.scaleY,p),angle:r(this.angle,p),flipX:this.flipX,flipY:this.flipY,opacity:r(this.opacity,p),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:r(this.skewX,p),skewY:r(this.skewY,p)};return this.clipPath&&!this.clipPath.excludeFromExport&&(m.clipPath=this.clipPath.toObject(h),m.clipPath.inverted=this.clipPath.inverted,m.clipPath.absolutePositioned=this.clipPath.absolutePositioned),i.util.populateWithProperties(this,m,h),this.includeDefaultValues||(m=this._removeDefaultValues(m)),m},toDatalessObject:function(h){return this.toObject(h)},_removeDefaultValues:function(h){var p=i.util.getKlass(h.type).prototype,m=p.stateProperties;return m.forEach(function(y){y==="left"||y==="top"||(h[y]===p[y]&&delete h[y],Array.isArray(h[y])&&Array.isArray(p[y])&&h[y].length===0&&p[y].length===0&&delete h[y])}),h},toString:function(){return"#<fabric."+a(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var h=i.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(h.scaleX),scaleY:Math.abs(h.scaleY)}},getTotalObjectScaling:function(){var h=this.getObjectScaling(),p=h.scaleX,m=h.scaleY;if(this.canvas){var y=this.canvas.getZoom(),_=this.canvas.getRetinaScaling();p*=y*_,m*=y*_}return{scaleX:p,scaleY:m}},getObjectOpacity:function(){var h=this.opacity;return this.group&&(h*=this.group.getObjectOpacity()),h},_set:function(h,p){var m=h==="scaleX"||h==="scaleY",y=this[h]!==p,_=!1;return m&&(p=this._constrainScale(p)),h==="scaleX"&&p<0?(this.flipX=!this.flipX,p*=-1):h==="scaleY"&&p<0?(this.flipY=!this.flipY,p*=-1):h==="shadow"&&p&&!(p instanceof i.Shadow)?p=new i.Shadow(p):h==="dirty"&&this.group&&this.group.set("dirty",p),this[h]=p,y&&(_=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(h)>-1?(this.dirty=!0,_&&this.group.set("dirty",!0)):_&&this.stateProperties.indexOf(h)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:i.iMatrix.concat()},isNotVisible:function(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible},render:function(h){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(h.save(),this._setupCompositeOperation(h),this.drawSelectionBackground(h),this.transform(h),this._setOpacity(h),this._setShadow(h,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(h)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(h),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),h.restore())},renderCache:function(h){h=h||{},(!this._cacheCanvas||!this._cacheContext)&&this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,h.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0},hasFill:function(){return this.fill&&this.fill!=="transparent"},needsItsOwnCache:function(){return!!(this.paintFirst==="stroke"&&this.hasFill()&&this.hasStroke()&&typeof this.shadow=="object"||this.clipPath)},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)},drawClipPathOnCache:function(h,p){if(h.save(),p.inverted?h.globalCompositeOperation="destination-out":h.globalCompositeOperation="destination-in",p.absolutePositioned){var m=i.util.invertTransform(this.calcTransformMatrix());h.transform(m[0],m[1],m[2],m[3],m[4],m[5])}p.transform(h),h.scale(1/p.zoomX,1/p.zoomY),h.drawImage(p._cacheCanvas,-p.cacheTranslationX,-p.cacheTranslationY),h.restore()},drawObject:function(h,p){var m=this.fill,y=this.stroke;p?(this.fill="black",this.stroke="",this._setClippingProperties(h)):this._renderBackground(h),this._render(h),this._drawClipPath(h,this.clipPath),this.fill=m,this.stroke=y},_drawClipPath:function(h,p){p&&(p.canvas=this.canvas,p.shouldCache(),p._transformDone=!0,p.renderCache({forClipping:!0}),this.drawClipPathOnCache(h,p))},drawCacheOnCanvas:function(h){h.scale(1/this.zoomX,1/this.zoomY),h.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(h){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!h&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!h){var p=this.cacheWidth/this.zoomX,m=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-p/2,-m/2,p,m)}return!0}return!1},_renderBackground:function(h){if(this.backgroundColor){var p=this._getNonTransformedDimensions();h.fillStyle=this.backgroundColor,h.fillRect(-p.x/2,-p.y/2,p.x,p.y),this._removeShadow(h)}},_setOpacity:function(h){this.group&&!this.group._transformDone?h.globalAlpha=this.getObjectOpacity():h.globalAlpha*=this.opacity},_setStrokeStyles:function(h,p){var m=p.stroke;m&&(h.lineWidth=p.strokeWidth,h.lineCap=p.strokeLineCap,h.lineDashOffset=p.strokeDashOffset,h.lineJoin=p.strokeLineJoin,h.miterLimit=p.strokeMiterLimit,m.toLive?m.gradientUnits==="percentage"||m.gradientTransform||m.patternTransform?this._applyPatternForTransformedGradient(h,m):(h.strokeStyle=m.toLive(h,this),this._applyPatternGradientTransform(h,m)):h.strokeStyle=p.stroke)},_setFillStyles:function(h,p){var m=p.fill;m&&(m.toLive?(h.fillStyle=m.toLive(h,this),this._applyPatternGradientTransform(h,p.fill)):h.fillStyle=m)},_setClippingProperties:function(h){h.globalAlpha=1,h.strokeStyle="transparent",h.fillStyle="#000000"},_setLineDash:function(h,p){!p||p.length===0||(1&p.length&&p.push.apply(p,p),h.setLineDash(p))},_renderControls:function(h,p){var m=this.getViewportTransform(),y=this.calcTransformMatrix(),_,C,w;p=p||{},C=typeof p.hasBorders!="undefined"?p.hasBorders:this.hasBorders,w=typeof p.hasControls!="undefined"?p.hasControls:this.hasControls,y=i.util.multiplyTransformMatrices(m,y),_=i.util.qrDecompose(y),h.save(),h.translate(_.translateX,_.translateY),h.lineWidth=1*this.borderScaleFactor,this.group||(h.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(_.angle-=180),h.rotate(s(this.group?_.angle:this.angle)),p.forActiveSelection||this.group?C&&this.drawBordersInGroup(h,_,p):C&&this.drawBorders(h,p),w&&this.drawControls(h,p),h.restore()},_setShadow:function(h){if(this.shadow){var p=this.shadow,m=this.canvas,y,_=m&&m.viewportTransform[0]||1,C=m&&m.viewportTransform[3]||1;p.nonScaling?y={scaleX:1,scaleY:1}:y=this.getObjectScaling(),m&&m._isRetinaScaling()&&(_*=i.devicePixelRatio,C*=i.devicePixelRatio),h.shadowColor=p.color,h.shadowBlur=p.blur*i.browserShadowBlurConstant*(_+C)*(y.scaleX+y.scaleY)/4,h.shadowOffsetX=p.offsetX*_*y.scaleX,h.shadowOffsetY=p.offsetY*C*y.scaleY}},_removeShadow:function(h){this.shadow&&(h.shadowColor="",h.shadowBlur=h.shadowOffsetX=h.shadowOffsetY=0)},_applyPatternGradientTransform:function(h,p){if(!p||!p.toLive)return{offsetX:0,offsetY:0};var m=p.gradientTransform||p.patternTransform,y=-this.width/2+p.offsetX||0,_=-this.height/2+p.offsetY||0;return p.gradientUnits==="percentage"?h.transform(this.width,0,0,this.height,y,_):h.transform(1,0,0,1,y,_),m&&h.transform(m[0],m[1],m[2],m[3],m[4],m[5]),{offsetX:y,offsetY:_}},_renderPaintInOrder:function(h){this.paintFirst==="stroke"?(this._renderStroke(h),this._renderFill(h)):(this._renderFill(h),this._renderStroke(h))},_render:function(){},_renderFill:function(h){this.fill&&(h.save(),this._setFillStyles(h,this),this.fillRule==="evenodd"?h.fill("evenodd"):h.fill(),h.restore())},_renderStroke:function(h){if(!(!this.stroke||this.strokeWidth===0)){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(h),h.save(),this.strokeUniform&&this.group){var p=this.getObjectScaling();h.scale(1/p.scaleX,1/p.scaleY)}else this.strokeUniform&&h.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(h,this.strokeDashArray),this._setStrokeStyles(h,this),h.stroke(),h.restore()}},_applyPatternForTransformedGradient:function(h,p){var m=this._limitCacheSize(this._getCacheCanvasDimensions()),y=i.util.createCanvasElement(),_,C=this.canvas.getRetinaScaling(),w=m.x/this.scaleX/C,b=m.y/this.scaleY/C;y.width=w,y.height=b,_=y.getContext("2d"),_.beginPath(),_.moveTo(0,0),_.lineTo(w,0),_.lineTo(w,b),_.lineTo(0,b),_.closePath(),_.translate(w/2,b/2),_.scale(m.zoomX/this.scaleX/C,m.zoomY/this.scaleY/C),this._applyPatternGradientTransform(_,p),_.fillStyle=p.toLive(h),_.fill(),h.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),h.scale(C*this.scaleX/m.zoomX,C*this.scaleY/m.zoomY),h.strokeStyle=_.createPattern(y,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var h=i.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",h.scaleX),this.set("scaleY",h.scaleY),this.angle=h.angle,this.skewX=h.skewX,this.skewY=0}},_removeTransformMatrix:function(h){var p=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),p=i.util.transformPoint(p,this.transformMatrix)),this.transformMatrix=null,h&&(this.scaleX*=h.scaleX,this.scaleY*=h.scaleY,this.cropX=h.cropX,this.cropY=h.cropY,p.x+=h.offsetLeft,p.y+=h.offsetTop,this.width=h.width,this.height=h.height),this.setPositionByOrigin(p,"center","center")},clone:function(h,p){var m=this.toObject(p);this.constructor.fromObject?this.constructor.fromObject(m,h):i.Object._fromObject("Object",m,h)},cloneAsImage:function(h,p){var m=this.toCanvasElement(p);return h&&h(new i.Image(m)),this},toCanvasElement:function(h){h||(h={});var p=i.util,m=p.saveObjectTransform(this),y=this.group,_=this.shadow,C=Math.abs,w=(h.multiplier||1)*(h.enableRetinaScaling?i.devicePixelRatio:1);delete this.group,h.withoutTransform&&p.resetObjectTransform(this),h.withoutShadow&&(this.shadow=null);var b=i.util.createCanvasElement(),S=this.getBoundingRect(!0,!0),F=this.shadow,$,Q={x:0,y:0},R,H,W;F&&(R=F.blur,F.nonScaling?$={scaleX:1,scaleY:1}:$=this.getObjectScaling(),Q.x=2*Math.round(C(F.offsetX)+R)*C($.scaleX),Q.y=2*Math.round(C(F.offsetY)+R)*C($.scaleY)),H=S.width+Q.x,W=S.height+Q.y,b.width=Math.ceil(H),b.height=Math.ceil(W);var G=new i.StaticCanvas(b,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});h.format==="jpeg"&&(G.backgroundColor="#fff"),this.setPositionByOrigin(new i.Point(G.width/2,G.height/2),"center","center");var V=this.canvas;G.add(this);var st=G.toCanvasElement(w||1,h);return this.shadow=_,this.set("canvas",V),y&&(this.group=y),this.set(m).setCoords(),G._objects=[],G.dispose(),G=null,st},toDataURL:function(h){return h||(h={}),i.util.toDataURL(this.toCanvasElement(h),h.format||"png",h.quality||1)},isType:function(h){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===h},complexity:function(){return 1},toJSON:function(h){return this.toObject(h)},rotate:function(h){var p=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;return p&&this._setOriginToCenter(),this.set("angle",h),p&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(h,p){p=p||this.canvas.getPointer(h);var m=new i.Point(p.x,p.y),y=this._getLeftTopCoords();return this.angle&&(m=i.util.rotatePoint(m,y,s(-this.angle))),{x:m.x-y.x,y:m.y-y.y}},_setupCompositeOperation:function(h){this.globalCompositeOperation&&(h.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){i.runningAnimations&&i.runningAnimations.cancelByTarget(this)}}),i.util.createAccessors&&i.util.createAccessors(i.Object),c(i.Object.prototype,i.Observable),i.Object.NUM_FRACTION_DIGITS=2,i.Object.ENLIVEN_PROPS=["clipPath"],i.Object._fromObject=function(h,p,m,y){var _=i[h];p=l(p,!0),i.util.enlivenPatterns([p.fill,p.stroke],function(C){typeof C[0]!="undefined"&&(p.fill=C[0]),typeof C[1]!="undefined"&&(p.stroke=C[1]),i.util.enlivenObjectEnlivables(p,p,function(){var w=y?new _(p[y],p):new _(p);m&&m(w)})})},i.Object.__uid=0)}(e),function(){var f=t.util.degreesToRadians,i={left:-.5,center:0,right:.5},c={top:-.5,center:0,bottom:.5};t.util.object.extend(t.Object.prototype,{translateToGivenOrigin:function(l,r,a,s,u){var d=l.x,h=l.y,p,m,y;return typeof r=="string"?r=i[r]:r-=.5,typeof s=="string"?s=i[s]:s-=.5,p=s-r,typeof a=="string"?a=c[a]:a-=.5,typeof u=="string"?u=c[u]:u-=.5,m=u-a,(p||m)&&(y=this._getTransformedDimensions(),d=l.x+p*y.x,h=l.y+m*y.y),new t.Point(d,h)},translateToCenterPoint:function(l,r,a){var s=this.translateToGivenOrigin(l,r,a,"center","center");return this.angle?t.util.rotatePoint(s,l,f(this.angle)):s},translateToOriginPoint:function(l,r,a){var s=this.translateToGivenOrigin(l,"center","center",r,a);return this.angle?t.util.rotatePoint(s,l,f(this.angle)):s},getCenterPoint:function(){var l=new t.Point(this.left,this.top);return this.translateToCenterPoint(l,this.originX,this.originY)},getPointByOrigin:function(l,r){var a=this.getCenterPoint();return this.translateToOriginPoint(a,l,r)},toLocalPoint:function(l,r,a){var s=this.getCenterPoint(),u,d;return typeof r!="undefined"&&typeof a!="undefined"?u=this.translateToGivenOrigin(s,"center","center",r,a):u=new t.Point(this.left,this.top),d=new t.Point(l.x,l.y),this.angle&&(d=t.util.rotatePoint(d,s,-f(this.angle))),d.subtractEquals(u)},setPositionByOrigin:function(l,r,a){var s=this.translateToCenterPoint(l,r,a),u=this.translateToOriginPoint(s,this.originX,this.originY);this.set("left",u.x),this.set("top",u.y)},adjustPosition:function(l){var r=f(this.angle),a=this.getScaledWidth(),s=t.util.cos(r)*a,u=t.util.sin(r)*a,d,h;typeof this.originX=="string"?d=i[this.originX]:d=this.originX-.5,typeof l=="string"?h=i[l]:h=l-.5,this.left+=s*(h-d),this.top+=u*(h-d),this.setCoords(),this.originX=l},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var l=this.getCenterPoint();this.originX="center",this.originY="center",this.left=l.x,this.top=l.y},_resetOrigin:function(){var l=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=l.x,this.top=l.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})}(),function(){function f(a){return[new t.Point(a.tl.x,a.tl.y),new t.Point(a.tr.x,a.tr.y),new t.Point(a.br.x,a.br.y),new t.Point(a.bl.x,a.bl.y)]}var i=t.util,c=i.degreesToRadians,l=i.multiplyTransformMatrices,r=i.transformPoint;i.object.extend(t.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(a,s){return s?a?this.calcACoords():this.calcLineCoords():((!this.aCoords||!this.lineCoords)&&this.setCoords(!0),a?this.aCoords:this.lineCoords)},getCoords:function(a,s){return f(this._getCoords(a,s))},intersectsWithRect:function(a,s,u,d){var h=this.getCoords(u,d),p=t.Intersection.intersectPolygonRectangle(h,a,s);return p.status==="Intersection"},intersectsWithObject:function(a,s,u){var d=t.Intersection.intersectPolygonPolygon(this.getCoords(s,u),a.getCoords(s,u));return d.status==="Intersection"||a.isContainedWithinObject(this,s,u)||this.isContainedWithinObject(a,s,u)},isContainedWithinObject:function(a,s,u){for(var d=this.getCoords(s,u),h=s?a.aCoords:a.lineCoords,p=0,m=a._getImageLines(h);p<4;p++)if(!a.containsPoint(d[p],m))return!1;return!0},isContainedWithinRect:function(a,s,u,d){var h=this.getBoundingRect(u,d);return h.left>=a.x&&h.left+h.width<=s.x&&h.top>=a.y&&h.top+h.height<=s.y},containsPoint:function(a,p,u,d){var h=this._getCoords(u,d),p=p||this._getImageLines(h),m=this._findCrossPoints(a,p);return m!==0&&m%2===1},isOnScreen:function(a){if(!this.canvas)return!1;var s=this.canvas.vptCoords.tl,u=this.canvas.vptCoords.br,d=this.getCoords(!0,a);return d.some(function(h){return h.x<=u.x&&h.x>=s.x&&h.y<=u.y&&h.y>=s.y})||this.intersectsWithRect(s,u,!0,a)?!0:this._containsCenterOfCanvas(s,u,a)},_containsCenterOfCanvas:function(a,s,u){var d={x:(a.x+s.x)/2,y:(a.y+s.y)/2};return!!this.containsPoint(d,null,!0,u)},isPartiallyOnScreen:function(a){if(!this.canvas)return!1;var s=this.canvas.vptCoords.tl,u=this.canvas.vptCoords.br;if(this.intersectsWithRect(s,u,!0,a))return!0;var d=this.getCoords(!0,a).every(function(h){return(h.x>=u.x||h.x<=s.x)&&(h.y>=u.y||h.y<=s.y)});return d&&this._containsCenterOfCanvas(s,u,a)},_getImageLines:function(a){var s={topline:{o:a.tl,d:a.tr},rightline:{o:a.tr,d:a.br},bottomline:{o:a.br,d:a.bl},leftline:{o:a.bl,d:a.tl}};return s},_findCrossPoints:function(a,s){var u,d,h,p,m,y=0,_;for(var C in s)if(_=s[C],!(_.o.y<a.y&&_.d.y<a.y)&&!(_.o.y>=a.y&&_.d.y>=a.y)&&(_.o.x===_.d.x&&_.o.x>=a.x?m=_.o.x:(u=0,d=(_.d.y-_.o.y)/(_.d.x-_.o.x),h=a.y-u*a.x,p=_.o.y-d*_.o.x,m=-(h-p)/(u-d)),m>=a.x&&(y+=1),y===2))break;return y},getBoundingRect:function(a,s){var u=this.getCoords(a,s);return i.makeBoundingBoxFromPoints(u)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(a){return Math.abs(a)<this.minScaleLimit?a<0?-this.minScaleLimit:this.minScaleLimit:a===0?1e-4:a},scale:function(a){return this._set("scaleX",a),this._set("scaleY",a),this.setCoords()},scaleToWidth:function(a,s){var u=this.getBoundingRect(s).width/this.getScaledWidth();return this.scale(a/this.width/u)},scaleToHeight:function(a,s){var u=this.getBoundingRect(s).height/this.getScaledHeight();return this.scale(a/this.height/u)},calcLineCoords:function(){var a=this.getViewportTransform(),s=this.padding,u=c(this.angle),d=i.cos(u),h=i.sin(u),p=d*s,m=h*s,y=p+m,_=p-m,C=this.calcACoords(),w={tl:r(C.tl,a),tr:r(C.tr,a),bl:r(C.bl,a),br:r(C.br,a)};return s&&(w.tl.x-=_,w.tl.y-=y,w.tr.x+=y,w.tr.y-=_,w.bl.x-=y,w.bl.y+=_,w.br.x+=_,w.br.y+=y),w},calcOCoords:function(){var a=this._calcRotateMatrix(),s=this._calcTranslateMatrix(),u=this.getViewportTransform(),d=l(u,s),h=l(d,a),h=l(h,[1/u[0],0,0,1/u[3],0,0]),p=this._calculateCurrentDimensions(),m={};return this.forEachControl(function(y,_,C){m[_]=y.positionHandler(p,h,C)}),m},calcACoords:function(){var a=this._calcRotateMatrix(),s=this._calcTranslateMatrix(),u=l(s,a),d=this._getTransformedDimensions(),h=d.x/2,p=d.y/2;return{tl:r({x:-h,y:-p},u),tr:r({x:h,y:-p},u),bl:r({x:-h,y:p},u),br:r({x:h,y:p},u)}},setCoords:function(a){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),a?this:(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords(),this)},_calcRotateMatrix:function(){return i.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var a=this.getCenterPoint();return[1,0,0,1,a.x,a.y]},transformMatrixKey:function(a){var s="_",u="";return!a&&this.group&&(u=this.group.transformMatrixKey(a)+s),u+this.top+s+this.left+s+this.scaleX+s+this.scaleY+s+this.skewX+s+this.skewY+s+this.angle+s+this.originX+s+this.originY+s+this.width+s+this.height+s+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(a){var s=this.calcOwnMatrix();if(a||!this.group)return s;var u=this.transformMatrixKey(a),d=this.matrixCache||(this.matrixCache={});return d.key===u?d.value:(this.group&&(s=l(this.group.calcTransformMatrix(!1),s)),d.key=u,d.value=s,s)},calcOwnMatrix:function(){var a=this.transformMatrixKey(!0),s=this.ownMatrixCache||(this.ownMatrixCache={});if(s.key===a)return s.value;var u=this._calcTranslateMatrix(),d={angle:this.angle,translateX:u[4],translateY:u[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return s.key=a,s.value=i.composeMatrix(d),s.value},_getNonTransformedDimensions:function(){var a=this.strokeWidth,s=this.width+a,u=this.height+a;return{x:s,y:u}},_getTransformedDimensions:function(a,s){typeof a=="undefined"&&(a=this.skewX),typeof s=="undefined"&&(s=this.skewY);var u,d,h,p=a===0&&s===0;if(this.strokeUniform?(d=this.width,h=this.height):(u=this._getNonTransformedDimensions(),d=u.x,h=u.y),p)return this._finalizeDimensions(d*this.scaleX,h*this.scaleY);var m=i.sizeAfterTransform(d,h,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:a,skewY:s});return this._finalizeDimensions(m.x,m.y)},_finalizeDimensions:function(a,s){return this.strokeUniform?{x:a+this.strokeWidth,y:s+this.strokeWidth}:{x:a,y:s}},_calculateCurrentDimensions:function(){var a=this.getViewportTransform(),s=this._getTransformedDimensions(),u=r(s,a,!0);return u.scalarAdd(2*this.padding)}})}(),t.util.object.extend(t.Object.prototype,{sendToBack:function(){return this.group?t.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?t.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(f){return this.group?t.StaticCanvas.prototype.sendBackwards.call(this.group,this,f):this.canvas&&this.canvas.sendBackwards(this,f),this},bringForward:function(f){return this.group?t.StaticCanvas.prototype.bringForward.call(this.group,this,f):this.canvas&&this.canvas.bringForward(this,f),this},moveTo:function(f){return this.group&&this.group.type!=="activeSelection"?t.StaticCanvas.prototype.moveTo.call(this.group,this,f):this.canvas&&this.canvas.moveTo(this,f),this}}),function(){function f(c,l){if(l){if(l.toLive)return c+": url(#SVGID_"+l.id+"); ";var r=new t.Color(l),a=c+": "+r.toRgb()+"; ",s=r.getAlpha();return s!==1&&(a+=c+"-opacity: "+s.toString()+"; "),a}else return c+": none; "}var i=t.util.toFixed;t.util.object.extend(t.Object.prototype,{getSvgStyles:function(c){var l=this.fillRule?this.fillRule:"nonzero",r=this.strokeWidth?this.strokeWidth:"0",a=this.strokeDashArray?this.strokeDashArray.join(" "):"none",s=this.strokeDashOffset?this.strokeDashOffset:"0",u=this.strokeLineCap?this.strokeLineCap:"butt",d=this.strokeLineJoin?this.strokeLineJoin:"miter",h=this.strokeMiterLimit?this.strokeMiterLimit:"4",p=typeof this.opacity!="undefined"?this.opacity:"1",m=this.visible?"":" visibility: hidden;",y=c?"":this.getSvgFilter(),_=f("fill",this.fill),C=f("stroke",this.stroke);return[C,"stroke-width: ",r,"; ","stroke-dasharray: ",a,"; ","stroke-linecap: ",u,"; ","stroke-dashoffset: ",s,"; ","stroke-linejoin: ",d,"; ","stroke-miterlimit: ",h,"; ",_,"fill-rule: ",l,"; ","opacity: ",p,";",y,m].join("")},getSvgSpanStyles:function(c,l){var r="; ",s=c.fontFamily?"font-family: "+(c.fontFamily.indexOf("'")===-1&&c.fontFamily.indexOf('"')===-1?"'"+c.fontFamily+"'":c.fontFamily)+r:"",a=c.strokeWidth?"stroke-width: "+c.strokeWidth+r:"",s=s,u=c.fontSize?"font-size: "+c.fontSize+"px"+r:"",d=c.fontStyle?"font-style: "+c.fontStyle+r:"",h=c.fontWeight?"font-weight: "+c.fontWeight+r:"",p=c.fill?f("fill",c.fill):"",m=c.stroke?f("stroke",c.stroke):"",y=this.getSvgTextDecoration(c),_=c.deltaY?"baseline-shift: "+-c.deltaY+"; ":"";return y&&(y="text-decoration: "+y+r),[m,a,s,u,d,h,y,p,_,l?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(c){return["overline","underline","line-through"].filter(function(l){return c[l.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(c,l){var r=c?this.calcTransformMatrix():this.calcOwnMatrix(),a='transform="'+t.util.matrixToSVG(r);return a+(l||"")+'" '},_setSVGBg:function(c){if(this.backgroundColor){var l=t.Object.NUM_FRACTION_DIGITS;c.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',i(-this.width/2,l),'" y="',i(-this.height/2,l),'" width="',i(this.width,l),'" height="',i(this.height,l),`"></rect>
`)}},toSVG:function(c){return this._createBaseSVGMarkup(this._toSVG(c),{reviver:c})},toClipPathSVG:function(c){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(c),{reviver:c})},_createBaseClipPathSVGMarkup:function(c,l){l=l||{};var r=l.reviver,a=l.additionalTransform||"",s=[this.getSvgTransform(!0,a),this.getSvgCommons()].join(""),u=c.indexOf("COMMON_PARTS");return c[u]=s,r?r(c.join("")):c.join("")},_createBaseSVGMarkup:function(c,l){l=l||{};var r=l.noStyle,a=l.reviver,s=r?"":'style="'+this.getSvgStyles()+'" ',u=l.withShadow?'style="'+this.getSvgFilter()+'" ':"",d=this.clipPath,h=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",p=d&&d.absolutePositioned,m=this.stroke,y=this.fill,_=this.shadow,C,w=[],b,S=c.indexOf("COMMON_PARTS"),F=l.additionalTransform;return d&&(d.clipPathId="CLIPPATH_"+t.Object.__uid++,b='<clipPath id="'+d.clipPathId+`" >
`+d.toClipPathSVG(a)+`</clipPath>
`),p&&w.push("<g ",u,this.getSvgCommons(),` >
`),w.push("<g ",this.getSvgTransform(!1),p?"":u+this.getSvgCommons(),` >
`),C=[s,h,r?"":this.addPaintOrder()," ",F?'transform="'+F+'" ':""].join(""),c[S]=C,y&&y.toLive&&w.push(y.toSVG(this)),m&&m.toLive&&w.push(m.toSVG(this)),_&&w.push(_.toSVG(this)),d&&w.push(b),w.push(c.join("")),w.push(`</g>
`),p&&w.push(`</g>
`),a?a(w.join("")):w.join("")},addPaintOrder:function(){return this.paintFirst!=="fill"?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var f=t.util.object.extend,i="stateProperties";function c(r,a,s){var u={},d=!0;s.forEach(function(h){u[h]=r[h]}),f(r[a],u,d)}function l(r,a,s){if(r===a)return!0;if(Array.isArray(r)){if(!Array.isArray(a)||r.length!==a.length)return!1;for(var u=0,d=r.length;u<d;u++)if(!l(r[u],a[u]))return!1;return!0}else if(r&&typeof r=="object"){var h=Object.keys(r),p;if(!a||typeof a!="object"||!s&&h.length!==Object.keys(a).length)return!1;for(var u=0,d=h.length;u<d;u++)if(p=h[u],!(p==="canvas"||p==="group")&&!l(r[p],a[p]))return!1;return!0}}t.util.object.extend(t.Object.prototype,{hasStateChanged:function(r){r=r||i;var a="_"+r;return Object.keys(this[a]).length<this[r].length?!0:!l(this[a],this,!0)},saveState:function(r){var a=r&&r.propertySet||i,s="_"+a;return this[s]?(c(this,s,this[a]),r&&r.stateProperties&&c(this,s,r.stateProperties),this):this.setupState(r)},setupState:function(r){r=r||{};var a=r.propertySet||i;return r.propertySet=a,this["_"+a]={},this.saveState(r),this}})}(),function(){var f=t.util.degreesToRadians;t.util.object.extend(t.Object.prototype,{_findTargetCorner:function(i,c){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var l=i.x,r=i.y,a,s,u=Object.keys(this.oCoords),d=u.length-1,h;for(this.__corner=0;d>=0;d--)if(h=u[d],!!this.isControlVisible(h)&&(s=this._getImageLines(c?this.oCoords[h].touchCorner:this.oCoords[h].corner),a=this._findCrossPoints({x:l,y:r},s),a!==0&&a%2===1))return this.__corner=h,h;return!1},forEachControl:function(i){for(var c in this.controls)i(this.controls[c],c,this)},_setCornerCoords:function(){var i=this.oCoords;for(var c in i){var l=this.controls[c];i[c].corner=l.calcCornerCoords(this.angle,this.cornerSize,i[c].x,i[c].y,!1),i[c].touchCorner=l.calcCornerCoords(this.angle,this.touchCornerSize,i[c].x,i[c].y,!0)}},drawSelectionBackground:function(i){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;i.save();var c=this.getCenterPoint(),l=this._calculateCurrentDimensions(),r=this.canvas.viewportTransform;return i.translate(c.x,c.y),i.scale(1/r[0],1/r[3]),i.rotate(f(this.angle)),i.fillStyle=this.selectionBackgroundColor,i.fillRect(-l.x/2,-l.y/2,l.x,l.y),i.restore(),this},drawBorders:function(i,c){c=c||{};var l=this._calculateCurrentDimensions(),r=this.borderScaleFactor,a=l.x+r,s=l.y+r,u=typeof c.hasControls!="undefined"?c.hasControls:this.hasControls,d=!1;return i.save(),i.strokeStyle=c.borderColor||this.borderColor,this._setLineDash(i,c.borderDashArray||this.borderDashArray),i.strokeRect(-a/2,-s/2,a,s),u&&(i.beginPath(),this.forEachControl(function(h,p,m){h.withConnection&&h.getVisibility(m,p)&&(d=!0,i.moveTo(h.x*a,h.y*s),i.lineTo(h.x*a+h.offsetX,h.y*s+h.offsetY))}),d&&i.stroke()),i.restore(),this},drawBordersInGroup:function(i,c,l){l=l||{};var r=t.util.sizeAfterTransform(this.width,this.height,c),a=this.strokeWidth,s=this.strokeUniform,u=this.borderScaleFactor,d=r.x+a*(s?this.canvas.getZoom():c.scaleX)+u,h=r.y+a*(s?this.canvas.getZoom():c.scaleY)+u;return i.save(),this._setLineDash(i,l.borderDashArray||this.borderDashArray),i.strokeStyle=l.borderColor||this.borderColor,i.strokeRect(-d/2,-h/2,d,h),i.restore(),this},drawControls:function(i,c){c=c||{},i.save();var l=this.canvas.getRetinaScaling(),r,a;return i.setTransform(l,0,0,l,0,0),i.strokeStyle=i.fillStyle=c.cornerColor||this.cornerColor,this.transparentCorners||(i.strokeStyle=c.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(i,c.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(r=this.group.calcTransformMatrix()),this.forEachControl(function(s,u,d){a=d.oCoords[u],s.getVisibility(d,u)&&(r&&(a=t.util.transformPoint(a,r)),s.render(i,a.x,a.y,c,d))}),i.restore(),this},isControlVisible:function(i){return this.controls[i]&&this.controls[i].getVisibility(this,i)},setControlVisible:function(i,c){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[i]=c,this},setControlsVisibility:function(i){i||(i={});for(var c in i)this.setControlVisible(c,i[c]);return this},onDeselect:function(){},onSelect:function(){}})}(),t.util.object.extend(t.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(f,i){i=i||{};var c=function(){},l=i.onComplete||c,r=i.onChange||c,a=this;return t.util.animate({target:this,startValue:f.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(s){f.set("left",s),a.requestRenderAll(),r()},onComplete:function(){f.setCoords(),l()}})},fxCenterObjectV:function(f,i){i=i||{};var c=function(){},l=i.onComplete||c,r=i.onChange||c,a=this;return t.util.animate({target:this,startValue:f.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(s){f.set("top",s),a.requestRenderAll(),r()},onComplete:function(){f.setCoords(),l()}})},fxRemove:function(f,i){i=i||{};var c=function(){},l=i.onComplete||c,r=i.onChange||c,a=this;return t.util.animate({target:this,startValue:f.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(s){f.set("opacity",s),a.requestRenderAll(),r()},onComplete:function(){a.remove(f),l()}})}}),t.util.object.extend(t.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]=="object"){var f=[],i,c,l=[];for(i in arguments[0])f.push(i);for(var r=0,a=f.length;r<a;r++)i=f[r],c=r!==a-1,l.push(this._animate(i,arguments[0][i],arguments[1],c));return l}else return this._animate.apply(this,arguments)},_animate:function(f,i,c,l){var r=this,a;i=i.toString(),c?c=t.util.object.clone(c):c={},~f.indexOf(".")&&(a=f.split("."));var s=r.colorProperties.indexOf(f)>-1||a&&r.colorProperties.indexOf(a[1])>-1,u=a?this.get(a[0])[a[1]]:this.get(f);"from"in c||(c.from=u),s||(~i.indexOf("=")?i=u+parseFloat(i.replace("=","")):i=parseFloat(i));var d={target:this,startValue:c.from,endValue:i,byValue:c.by,easing:c.easing,duration:c.duration,abort:c.abort&&function(h,p,m){return c.abort.call(r,h,p,m)},onChange:function(h,p,m){a?r[a[0]][a[1]]=h:r.set(f,h),!l&&c.onChange&&c.onChange(h,p,m)},onComplete:function(h,p,m){l||(r.setCoords(),c.onComplete&&c.onComplete(h,p,m))}};return s?t.util.animateColor(d.startValue,d.endValue,d.duration,d):t.util.animate(d)}}),function(f){var i=f.fabric||(f.fabric={}),c=i.util.object.extend,l=i.util.object.clone,r={x1:1,x2:1,y1:1,y2:1};if(i.Line){i.warn("fabric.Line is already defined");return}i.Line=i.util.createClass(i.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:i.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(s,u){s||(s=[0,0,0,0]),this.callSuper("initialize",u),this.set("x1",s[0]),this.set("y1",s[1]),this.set("x2",s[2]),this.set("y2",s[3]),this._setWidthHeight(u)},_setWidthHeight:function(s){s||(s={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in s?s.left:this._getLeftToOriginX(),this.top="top"in s?s.top:this._getTopToOriginY()},_set:function(s,u){return this.callSuper("_set",s,u),typeof r[s]!="undefined"&&this._setWidthHeight(),this},_getLeftToOriginX:a({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:a({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(s){s.beginPath();var u=this.calcLinePoints();s.moveTo(u.x1,u.y1),s.lineTo(u.x2,u.y2),s.lineWidth=this.strokeWidth;var d=s.strokeStyle;s.strokeStyle=this.stroke||s.fillStyle,this.stroke&&this._renderStroke(s),s.strokeStyle=d},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(s){return c(this.callSuper("toObject",s),this.calcLinePoints())},_getNonTransformedDimensions:function(){var s=this.callSuper("_getNonTransformedDimensions");return this.strokeLineCap==="butt"&&(this.width===0&&(s.y-=this.strokeWidth),this.height===0&&(s.x-=this.strokeWidth)),s},calcLinePoints:function(){var s=this.x1<=this.x2?-1:1,u=this.y1<=this.y2?-1:1,d=s*this.width*.5,h=u*this.height*.5,p=s*this.width*-.5,m=u*this.height*-.5;return{x1:d,x2:p,y1:h,y2:m}},_toSVG:function(){var s=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',s.x1,'" y1="',s.y1,'" x2="',s.x2,'" y2="',s.y2,`" />
`]}}),i.Line.ATTRIBUTE_NAMES=i.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),i.Line.fromElement=function(s,u,d){d=d||{};var h=i.parseAttributes(s,i.Line.ATTRIBUTE_NAMES),p=[h.x1||0,h.y1||0,h.x2||0,h.y2||0];u(new i.Line(p,c(h,d)))},i.Line.fromObject=function(s,u){function d(p){delete p.points,u&&u(p)}var h=l(s,!0);h.points=[s.x1,s.y1,s.x2,s.y2],i.Object._fromObject("Line",h,d,"points")};function a(s,u){var d=s.origin,h=s.axis1,p=s.axis2,m=s.dimension,y=u.nearest,_=u.center,C=u.farthest;return function(){switch(this.get(d)){case y:return Math.min(this.get(h),this.get(p));case _:return Math.min(this.get(h),this.get(p))+.5*this.get(m);case C:return Math.max(this.get(h),this.get(p))}}}}(e),function(f){var i=f.fabric||(f.fabric={}),c=i.util.degreesToRadians;if(i.Circle){i.warn("fabric.Circle is already defined.");return}i.Circle=i.util.createClass(i.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:i.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(r,a){return this.callSuper("_set",r,a),r==="radius"&&this.setRadius(a),this},toObject:function(r){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(r))},_toSVG:function(){var r,a=0,s=0,u=(this.endAngle-this.startAngle)%360;if(u===0)r=["<circle ","COMMON_PARTS",'cx="'+a+'" cy="'+s+'" ','r="',this.radius,`" />
`];else{var d=c(this.startAngle),h=c(this.endAngle),p=this.radius,m=i.util.cos(d)*p,y=i.util.sin(d)*p,_=i.util.cos(h)*p,C=i.util.sin(h)*p,w=u>180?"1":"0";r=['<path d="M '+m+" "+y," A "+p+" "+p," 0 ",+w+" 1"," "+_+" "+C,'" ',"COMMON_PARTS",` />
`]}return r},_render:function(r){r.beginPath(),r.arc(0,0,this.radius,c(this.startAngle),c(this.endAngle),!1),this._renderPaintInOrder(r)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(r){return this.radius=r,this.set("width",r*2).set("height",r*2)}}),i.Circle.ATTRIBUTE_NAMES=i.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),i.Circle.fromElement=function(r,a){var s=i.parseAttributes(r,i.Circle.ATTRIBUTE_NAMES);if(!l(s))throw new Error("value of `r` attribute is required and can not be negative");s.left=(s.left||0)-s.radius,s.top=(s.top||0)-s.radius,a(new i.Circle(s))};function l(r){return"radius"in r&&r.radius>=0}i.Circle.fromObject=function(r,a){i.Object._fromObject("Circle",r,a)}}(e),function(f){var i=f.fabric||(f.fabric={});if(i.Triangle){i.warn("fabric.Triangle is already defined");return}i.Triangle=i.util.createClass(i.Object,{type:"triangle",width:100,height:100,_render:function(c){var l=this.width/2,r=this.height/2;c.beginPath(),c.moveTo(-l,r),c.lineTo(0,-r),c.lineTo(l,r),c.closePath(),this._renderPaintInOrder(c)},_toSVG:function(){var c=this.width/2,l=this.height/2,r=[-c+" "+l,"0 "+-l,c+" "+l].join(",");return["<polygon ","COMMON_PARTS",'points="',r,'" />']}}),i.Triangle.fromObject=function(c,l){return i.Object._fromObject("Triangle",c,l)}}(e),function(f){var i=f.fabric||(f.fabric={}),c=Math.PI*2;if(i.Ellipse){i.warn("fabric.Ellipse is already defined.");return}i.Ellipse=i.util.createClass(i.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:i.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(l){this.callSuper("initialize",l),this.set("rx",l&&l.rx||0),this.set("ry",l&&l.ry||0)},_set:function(l,r){switch(this.callSuper("_set",l,r),l){case"rx":this.rx=r,this.set("width",r*2);break;case"ry":this.ry=r,this.set("height",r*2);break}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(l){return this.callSuper("toObject",["rx","ry"].concat(l))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,`" />
`]},_render:function(l){l.beginPath(),l.save(),l.transform(1,0,0,this.ry/this.rx,0,0),l.arc(0,0,this.rx,0,c,!1),l.restore(),this._renderPaintInOrder(l)}}),i.Ellipse.ATTRIBUTE_NAMES=i.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),i.Ellipse.fromElement=function(l,r){var a=i.parseAttributes(l,i.Ellipse.ATTRIBUTE_NAMES);a.left=(a.left||0)-a.rx,a.top=(a.top||0)-a.ry,r(new i.Ellipse(a))},i.Ellipse.fromObject=function(l,r){i.Object._fromObject("Ellipse",l,r)}}(e),function(f){var i=f.fabric||(f.fabric={}),c=i.util.object.extend;if(i.Rect){i.warn("fabric.Rect is already defined");return}i.Rect=i.util.createClass(i.Object,{stateProperties:i.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:i.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(l){this.callSuper("initialize",l),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(l){var r=this.rx?Math.min(this.rx,this.width/2):0,a=this.ry?Math.min(this.ry,this.height/2):0,s=this.width,u=this.height,d=-this.width/2,h=-this.height/2,p=r!==0||a!==0,m=1-.5522847498;l.beginPath(),l.moveTo(d+r,h),l.lineTo(d+s-r,h),p&&l.bezierCurveTo(d+s-m*r,h,d+s,h+m*a,d+s,h+a),l.lineTo(d+s,h+u-a),p&&l.bezierCurveTo(d+s,h+u-m*a,d+s-m*r,h+u,d+s-r,h+u),l.lineTo(d+r,h+u),p&&l.bezierCurveTo(d+m*r,h+u,d,h+u-m*a,d,h+u-a),l.lineTo(d,h+a),p&&l.bezierCurveTo(d,h+m*a,d+m*r,h,d+r,h),l.closePath(),this._renderPaintInOrder(l)},toObject:function(l){return this.callSuper("toObject",["rx","ry"].concat(l))},_toSVG:function(){var l=-this.width/2,r=-this.height/2;return["<rect ","COMMON_PARTS",'x="',l,'" y="',r,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,`" />
`]}}),i.Rect.ATTRIBUTE_NAMES=i.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),i.Rect.fromElement=function(l,r,a){if(!l)return r(null);a=a||{};var s=i.parseAttributes(l,i.Rect.ATTRIBUTE_NAMES);s.left=s.left||0,s.top=s.top||0,s.height=s.height||0,s.width=s.width||0;var u=new i.Rect(c(a?i.util.object.clone(a):{},s));u.visible=u.visible&&u.width>0&&u.height>0,r(u)},i.Rect.fromObject=function(l,r){return i.Object._fromObject("Rect",l,r)}}(e),function(f){var i=f.fabric||(f.fabric={}),c=i.util.object.extend,l=i.util.array.min,r=i.util.array.max,a=i.util.toFixed,s=i.util.projectStrokeOnPoints;if(i.Polyline){i.warn("fabric.Polyline is already defined");return}i.Polyline=i.util.createClass(i.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:i.Object.prototype.cacheProperties.concat("points"),initialize:function(u,d){d=d||{},this.points=u||[],this.callSuper("initialize",d),this._setPositionDimensions(d)},_projectStrokeOnPoints:function(){return s(this.points,this,!0)},_setPositionDimensions:function(u){var d=this._calcDimensions(u),h,p=this.exactBoundingBox?this.strokeWidth:0;this.width=d.width-p,this.height=d.height-p,u.fromSVG||(h=this.translateToGivenOrigin({x:d.left-this.strokeWidth/2+p/2,y:d.top-this.strokeWidth/2+p/2},"left","top",this.originX,this.originY)),typeof u.left=="undefined"&&(this.left=u.fromSVG?d.left:h.x),typeof u.top=="undefined"&&(this.top=u.fromSVG?d.top:h.y),this.pathOffset={x:d.left+this.width/2+p/2,y:d.top+this.height/2+p/2}},_calcDimensions:function(){var u=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,d=l(u,"x")||0,h=l(u,"y")||0,p=r(u,"x")||0,m=r(u,"y")||0,y=p-d,_=m-h;return{left:d,top:h,width:y,height:_}},toObject:function(u){return c(this.callSuper("toObject",u),{points:this.points.concat()})},_toSVG:function(){for(var u=[],d=this.pathOffset.x,h=this.pathOffset.y,p=i.Object.NUM_FRACTION_DIGITS,m=0,y=this.points.length;m<y;m++)u.push(a(this.points[m].x-d,p),",",a(this.points[m].y-h,p)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',u.join(""),`" />
`]},commonRender:function(u){var d,h=this.points.length,p=this.pathOffset.x,m=this.pathOffset.y;if(!h||isNaN(this.points[h-1].y))return!1;u.beginPath(),u.moveTo(this.points[0].x-p,this.points[0].y-m);for(var y=0;y<h;y++)d=this.points[y],u.lineTo(d.x-p,d.y-m);return!0},_render:function(u){this.commonRender(u)&&this._renderPaintInOrder(u)},complexity:function(){return this.get("points").length}}),i.Polyline.ATTRIBUTE_NAMES=i.SHARED_ATTRIBUTES.concat(),i.Polyline.fromElementGenerator=function(u){return function(d,h,p){if(!d)return h(null);p||(p={});var m=i.parsePointsAttribute(d.getAttribute("points")),y=i.parseAttributes(d,i[u].ATTRIBUTE_NAMES);y.fromSVG=!0,h(new i[u](m,c(y,p)))}},i.Polyline.fromElement=i.Polyline.fromElementGenerator("Polyline"),i.Polyline.fromObject=function(u,d){return i.Object._fromObject("Polyline",u,d,"points")}}(e),function(f){var i=f.fabric||(f.fabric={}),c=i.util.projectStrokeOnPoints;if(i.Polygon){i.warn("fabric.Polygon is already defined");return}i.Polygon=i.util.createClass(i.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return c(this.points,this)},_render:function(l){this.commonRender(l)&&(l.closePath(),this._renderPaintInOrder(l))}}),i.Polygon.ATTRIBUTE_NAMES=i.SHARED_ATTRIBUTES.concat(),i.Polygon.fromElement=i.Polyline.fromElementGenerator("Polygon"),i.Polygon.fromObject=function(l,r){i.Object._fromObject("Polygon",l,r,"points")}}(e),function(f){var i=f.fabric||(f.fabric={}),c=i.util.array.min,l=i.util.array.max,r=i.util.object.extend,a=i.util.object.clone,s=i.util.toFixed;if(i.Path){i.warn("fabric.Path is already defined");return}i.Path=i.util.createClass(i.Object,{type:"path",path:null,cacheProperties:i.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:i.Object.prototype.stateProperties.concat("path"),initialize:function(u,d){d=a(d||{}),delete d.path,this.callSuper("initialize",d),this._setPath(u||[],d)},_setPath:function(u,d){this.path=i.util.makePathSimpler(Array.isArray(u)?u:i.util.parsePath(u)),i.Polyline.prototype._setPositionDimensions.call(this,d||{})},_renderPathCommands:function(u){var d,h=0,p=0,m=0,y=0,_=0,C=0,w=-this.pathOffset.x,b=-this.pathOffset.y;u.beginPath();for(var S=0,F=this.path.length;S<F;++S)switch(d=this.path[S],d[0]){case"L":m=d[1],y=d[2],u.lineTo(m+w,y+b);break;case"M":m=d[1],y=d[2],h=m,p=y,u.moveTo(m+w,y+b);break;case"C":m=d[5],y=d[6],_=d[3],C=d[4],u.bezierCurveTo(d[1]+w,d[2]+b,_+w,C+b,m+w,y+b);break;case"Q":u.quadraticCurveTo(d[1]+w,d[2]+b,d[3]+w,d[4]+b),m=d[3],y=d[4],_=d[1],C=d[2];break;case"z":case"Z":m=h,y=p,u.closePath();break}},_render:function(u){this._renderPathCommands(u),this._renderPaintInOrder(u)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(u){return r(this.callSuper("toObject",u),{path:this.path.map(function(d){return d.slice()})})},toDatalessObject:function(u){var d=this.toObject(["sourcePath"].concat(u));return d.sourcePath&&delete d.path,d},_toSVG:function(){var u=i.util.joinPath(this.path);return["<path ","COMMON_PARTS",'d="',u,'" stroke-linecap="round" ',`/>
`]},_getOffsetTransform:function(){var u=i.Object.NUM_FRACTION_DIGITS;return" translate("+s(-this.pathOffset.x,u)+", "+s(-this.pathOffset.y,u)+")"},toClipPathSVG:function(u){var d=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:u,additionalTransform:d})},toSVG:function(u){var d=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:u,additionalTransform:d})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var u=[],d=[],h,p=0,m=0,y=0,_=0,C,w=0,b=this.path.length;w<b;++w){switch(h=this.path[w],h[0]){case"L":y=h[1],_=h[2],C=[];break;case"M":y=h[1],_=h[2],p=y,m=_,C=[];break;case"C":C=i.util.getBoundsOfCurve(y,_,h[1],h[2],h[3],h[4],h[5],h[6]),y=h[5],_=h[6];break;case"Q":C=i.util.getBoundsOfCurve(y,_,h[1],h[2],h[1],h[2],h[3],h[4]),y=h[3],_=h[4];break;case"z":case"Z":y=p,_=m;break}C.forEach(function(W){u.push(W.x),d.push(W.y)}),u.push(y),d.push(_)}var S=c(u)||0,F=c(d)||0,$=l(u)||0,Q=l(d)||0,R=$-S,H=Q-F;return{left:S,top:F,width:R,height:H}}}),i.Path.fromObject=function(u,d){if(typeof u.sourcePath=="string"){var h=u.sourcePath;i.loadSVGFromURL(h,function(p){var m=p[0];m.setOptions(u),u.clipPath?i.util.enlivenObjects([u.clipPath],function(y){m.clipPath=y[0],d&&d(m)}):d&&d(m)})}else i.Object._fromObject("Path",u,d,"path")},i.Path.ATTRIBUTE_NAMES=i.SHARED_ATTRIBUTES.concat(["d"]),i.Path.fromElement=function(u,d,h){var p=i.parseAttributes(u,i.Path.ATTRIBUTE_NAMES);p.fromSVG=!0,d(new i.Path(p.d,r(p,h)))}}(e),function(f){var i=f.fabric||(f.fabric={}),c=i.util.array.min,l=i.util.array.max;i.Group||(i.Group=i.util.createClass(i.Object,i.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(r,a,s){a=a||{},this._objects=[],s&&this.callSuper("initialize",a),this._objects=r||[];for(var u=this._objects.length;u--;)this._objects[u].group=this;if(s)this._updateObjectsACoords();else{var d=a&&a.centerPoint;a.originX!==void 0&&(this.originX=a.originX),a.originY!==void 0&&(this.originY=a.originY),d||this._calcBounds(),this._updateObjectsCoords(d),delete a.centerPoint,this.callSuper("initialize",a)}this.setCoords()},_updateObjectsACoords:function(){for(var r=!0,a=this._objects.length;a--;)this._objects[a].setCoords(r)},_updateObjectsCoords:function(a){for(var a=a||this.getCenterPoint(),s=this._objects.length;s--;)this._updateObjectCoords(this._objects[s],a)},_updateObjectCoords:function(r,a){var s=r.left,u=r.top,d=!0;r.set({left:s-a.x,top:u-a.y}),r.group=this,r.setCoords(d)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(r){var a=!!this.group;return this._restoreObjectsState(),i.util.resetObjectTransform(this),r&&(a&&i.util.removeTransformFromObject(r,this.group.calcTransformMatrix()),this._objects.push(r),r.group=this,r._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,a?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(r){return this._restoreObjectsState(),i.util.resetObjectTransform(this),this.remove(r),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(r){this.dirty=!0,r.group=this,r._set("canvas",this.canvas)},_onObjectRemoved:function(r){this.dirty=!0,delete r.group},_set:function(r,a){var s=this._objects.length;if(this.useSetOnGroup)for(;s--;)this._objects[s].setOnGroup(r,a);if(r==="canvas")for(;s--;)this._objects[s]._set(r,a);i.Object.prototype._set.call(this,r,a)},toObject:function(r){var a=this.includeDefaultValues,s=this._objects.filter(function(d){return!d.excludeFromExport}).map(function(d){var h=d.includeDefaultValues;d.includeDefaultValues=a;var p=d.toObject(r);return d.includeDefaultValues=h,p}),u=i.Object.prototype.toObject.call(this,r);return u.objects=s,u},toDatalessObject:function(r){var a,s=this.sourcePath;if(s)a=s;else{var u=this.includeDefaultValues;a=this._objects.map(function(h){var p=h.includeDefaultValues;h.includeDefaultValues=u;var m=h.toDatalessObject(r);return h.includeDefaultValues=p,m})}var d=i.Object.prototype.toDatalessObject.call(this,r);return d.objects=a,d},render:function(r){this._transformDone=!0,this.callSuper("render",r),this._transformDone=!1},shouldCache:function(){var r=i.Object.prototype.shouldCache.call(this);if(r){for(var a=0,s=this._objects.length;a<s;a++)if(this._objects[a].willDrawShadow())return this.ownCaching=!1,!1}return r},willDrawShadow:function(){if(i.Object.prototype.willDrawShadow.call(this))return!0;for(var r=0,a=this._objects.length;r<a;r++)if(this._objects[r].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(r){for(var a=0,s=this._objects.length;a<s;a++)this._objects[a].render(r);this._drawClipPath(r,this.clipPath)},isCacheDirty:function(r){if(this.callSuper("isCacheDirty",r))return!0;if(!this.statefullCache)return!1;for(var a=0,s=this._objects.length;a<s;a++)if(this._objects[a].isCacheDirty(!0)){if(this._cacheCanvas){var u=this.cacheWidth/this.zoomX,d=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-u/2,-d/2,u,d)}return!0}return!1},_restoreObjectsState:function(){var r=this.calcOwnMatrix();return this._objects.forEach(function(a){i.util.addTransformToObject(a,r),delete a.group,a.setCoords()}),this},destroy:function(){return this._objects.forEach(function(r){r.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function(r){r.dispose&&r.dispose()}),this._objects=[]},toActiveSelection:function(){if(this.canvas){var r=this._objects,a=this.canvas;this._objects=[];var s=this.toObject();delete s.objects;var u=new i.ActiveSelection([]);return u.set(s),u.type="activeSelection",a.remove(this),r.forEach(function(d){d.group=u,d.dirty=!0,a.add(d)}),u.canvas=a,u._objects=r,a._activeObject=u,u.setCoords(),u}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){var r=!0;return this.forEachObject(function(a){a.setCoords(r)}),this},_calcBounds:function(r){for(var a=[],s=[],u,d,h,p=["tr","br","bl","tl"],m=0,y=this._objects.length,_,C=p.length;m<y;++m){for(u=this._objects[m],h=u.calcACoords(),_=0;_<C;_++)d=p[_],a.push(h[d].x),s.push(h[d].y);u.aCoords=h}this._getBounds(a,s,r)},_getBounds:function(r,a,s){var u=new i.Point(c(r),c(a)),d=new i.Point(l(r),l(a)),h=u.y||0,p=u.x||0,m=d.x-u.x||0,y=d.y-u.y||0;this.width=m,this.height=y,s||this.setPositionByOrigin({x:p,y:h},"left","top")},_toSVG:function(r){for(var a=["<g ","COMMON_PARTS",` >
`],s=0,u=this._objects.length;s<u;s++)a.push("		",this._objects[s].toSVG(r));return a.push(`</g>
`),a},getSvgStyles:function(){var r=typeof this.opacity!="undefined"&&this.opacity!==1?"opacity: "+this.opacity+";":"",a=this.visible?"":" visibility: hidden;";return[r,this.getSvgFilter(),a].join("")},toClipPathSVG:function(r){for(var a=[],s=0,u=this._objects.length;s<u;s++)a.push("	",this._objects[s].toClipPathSVG(r));return this._createBaseClipPathSVGMarkup(a,{reviver:r})}}),i.Group.fromObject=function(r,a){var s=r.objects,u=i.util.object.clone(r,!0);if(delete u.objects,typeof s=="string"){i.loadSVGFromURL(s,function(d){var h=i.util.groupSVGElements(d,r,s),p=u.clipPath;delete u.clipPath,h.set(u),p?i.util.enlivenObjects([p],function(m){h.clipPath=m[0],a&&a(h)}):a&&a(h)});return}i.util.enlivenObjects(s,function(d){i.util.enlivenObjectEnlivables(r,u,function(){a&&a(new i.Group(d,u,!0))})})})}(e),function(f){var i=f.fabric||(f.fabric={});i.ActiveSelection||(i.ActiveSelection=i.util.createClass(i.Group,{type:"activeSelection",initialize:function(c,l){l=l||{},this._objects=c||[];for(var r=this._objects.length;r--;)this._objects[r].group=this;l.originX&&(this.originX=l.originX),l.originY&&(this.originY=l.originY),this._calcBounds(),this._updateObjectsCoords(),i.Object.prototype.initialize.call(this,l),this.setCoords()},toGroup:function(){var c=this._objects.concat();this._objects=[];var l=i.Object.prototype.toObject.call(this),r=new i.Group([]);if(delete l.type,r.set(l),c.forEach(function(s){s.canvas.remove(s),s.group=r}),r._objects=c,!this.canvas)return r;var a=this.canvas;return a.add(r),a._activeObject=r,r.setCoords(),r},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(c,l,r){c.save(),c.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",c,l),r=r||{},typeof r.hasControls=="undefined"&&(r.hasControls=!1),r.forActiveSelection=!0;for(var a=0,s=this._objects.length;a<s;a++)this._objects[a]._renderControls(c,r);c.restore()}}),i.ActiveSelection.fromObject=function(c,l){i.util.enlivenObjects(c.objects,function(r){delete c.objects,l&&l(new i.ActiveSelection(r,c,!0))})})}(e),function(f){var i=t.util.object.extend;if(f.fabric||(f.fabric={}),f.fabric.Image){t.warn("fabric.Image is already defined.");return}t.Image=t.util.createClass(t.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:t.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:t.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(c,l){l||(l={}),this.filters=[],this.cacheKey="texture"+t.Object.__uid++,this.callSuper("initialize",l),this._initElement(c,l)},getElement:function(){return this._element||{}},setElement:function(c,l){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=c,this._originalElement=c,this._initConfig(l),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(c){var l=t.filterBackend;l&&l.evictCachesForKey&&l.evictCachesForKey(c)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(function(c){t.util.cleanUpJsdomNode(this[c]),this[c]=void 0}.bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var c=this.getElement();return{width:c.naturalWidth||c.width,height:c.naturalHeight||c.height}},_stroke:function(c){if(!(!this.stroke||this.strokeWidth===0)){var l=this.width/2,r=this.height/2;c.beginPath(),c.moveTo(-l,-r),c.lineTo(l,-r),c.lineTo(l,r),c.lineTo(-l,r),c.lineTo(-l,-r),c.closePath()}},toObject:function(c){var l=[];this.filters.forEach(function(a){a&&l.push(a.toObject())});var r=i(this.callSuper("toObject",["cropX","cropY"].concat(c)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:l});return this.resizeFilter&&(r.resizeFilter=this.resizeFilter.toObject()),r},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var c=[],l=[],r,a=this._element,s=-this.width/2,u=-this.height/2,d="",h="";if(!a)return[];if(this.hasCrop()){var p=t.Object.__uid++;c.push('<clipPath id="imageCrop_'+p+`">
`,'	<rect x="'+s+'" y="'+u+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),d=' clip-path="url(#imageCrop_'+p+')" '}if(this.imageSmoothing||(h='" image-rendering="optimizeSpeed'),l.push("	<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',s-this.cropX,'" y="',u-this.cropY,'" width="',a.width||a.naturalWidth,'" height="',a.height||a.height,h,'"',d,`></image>
`),this.stroke||this.strokeDashArray){var m=this.fill;this.fill=null,r=["	<rect ",'x="',s,'" y="',u,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),`"/>
`],this.fill=m}return this.paintFirst!=="fill"?c=c.concat(r,l):c=c.concat(l,r),c},getSrc:function(c){var l=c?this._element:this._originalElement;return l?l.toDataURL?l.toDataURL():this.srcFromAttribute?l.getAttribute("src"):l.src:this.src||""},setSrc:function(c,l,r){return t.util.loadImage(c,function(a,s){this.setElement(a,r),this._setWidthHeight(),l&&l(this,s)},this,r&&r.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var c=this.resizeFilter,l=this.minimumScaleTrigger,r=this.getTotalObjectScaling(),a=r.scaleX,s=r.scaleY,u=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!c||a>l&&s>l){this._element=u,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=a,this._lastScaleY=s;return}t.filterBackend||(t.filterBackend=t.initFilterBackend());var d=t.util.createCanvasElement(),h=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,p=u.width,m=u.height;d.width=p,d.height=m,this._element=d,this._lastScaleX=c.scaleX=a,this._lastScaleY=c.scaleY=s,t.filterBackend.applyFilters([c],u,p,m,this._element,h),this._filterScalingX=d.width/this._originalElement.width,this._filterScalingY=d.height/this._originalElement.height},applyFilters:function(c){if(c=c||this.filters||[],c=c.filter(function(u){return u&&!u.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),c.length===0)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var l=this._originalElement,r=l.naturalWidth||l.width,a=l.naturalHeight||l.height;if(this._element===this._originalElement){var s=t.util.createCanvasElement();s.width=r,s.height=a,this._element=s,this._filteredEl=s}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,r,a),this._lastScaleX=1,this._lastScaleY=1;return t.filterBackend||(t.filterBackend=t.initFilterBackend()),t.filterBackend.applyFilters(c,this._originalElement,r,a,this._element,this.cacheKey),(this._originalElement.width!==this._element.width||this._originalElement.height!==this._element.height)&&(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(c){t.util.setImageSmoothing(c,this.imageSmoothing),this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(c),this._renderPaintInOrder(c)},drawCacheOnCanvas:function(c){t.util.setImageSmoothing(c,this.imageSmoothing),t.Object.prototype.drawCacheOnCanvas.call(this,c)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(c){var l=this._element;if(l){var r=this._filterScalingX,a=this._filterScalingY,s=this.width,u=this.height,d=Math.min,h=Math.max,p=h(this.cropX,0),m=h(this.cropY,0),y=l.naturalWidth||l.width,_=l.naturalHeight||l.height,C=p*r,w=m*a,b=d(s*r,y-C),S=d(u*a,_-w),F=-s/2,$=-u/2,Q=d(s,y/r-p),R=d(u,_/a-m);l&&c.drawImage(l,C,w,b,S,F,$,Q,R)}},_needsResize:function(){var c=this.getTotalObjectScaling();return c.scaleX!==this._lastScaleX||c.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(c,l){this.setElement(t.util.getById(c),l),t.util.addClass(this.getElement(),t.Image.CSS_CANVAS)},_initConfig:function(c){c||(c={}),this.setOptions(c),this._setWidthHeight(c)},_initFilters:function(c,l){c&&c.length?t.util.enlivenObjects(c,function(r){l&&l(r)},"fabric.Image.filters"):l&&l()},_setWidthHeight:function(c){c||(c={});var l=this.getElement();this.width=c.width||l.naturalWidth||l.width||0,this.height=c.height||l.naturalHeight||l.height||0},parsePreserveAspectRatioAttribute:function(){var c=t.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),l=this._element.width,r=this._element.height,a=1,s=1,u=0,d=0,h=0,p=0,m,y=this.width,_=this.height,C={width:y,height:_};return c&&(c.alignX!=="none"||c.alignY!=="none")?(c.meetOrSlice==="meet"&&(a=s=t.util.findScaleToFit(this._element,C),m=(y-l*a)/2,c.alignX==="Min"&&(u=-m),c.alignX==="Max"&&(u=m),m=(_-r*s)/2,c.alignY==="Min"&&(d=-m),c.alignY==="Max"&&(d=m)),c.meetOrSlice==="slice"&&(a=s=t.util.findScaleToCover(this._element,C),m=l-y/a,c.alignX==="Mid"&&(h=m/2),c.alignX==="Max"&&(h=m),m=r-_/s,c.alignY==="Mid"&&(p=m/2),c.alignY==="Max"&&(p=m),l=y/a,r=_/s)):(a=y/l,s=_/r),{width:l,height:r,scaleX:a,scaleY:s,offsetLeft:u,offsetTop:d,cropX:h,cropY:p}}}),t.Image.CSS_CANVAS="canvas-img",t.Image.prototype.getSvgSrc=t.Image.prototype.getSrc,t.Image.fromObject=function(c,l){var r=t.util.object.clone(c);t.util.loadImage(r.src,function(a,s){if(s){l&&l(null,!0);return}t.Image.prototype._initFilters.call(r,r.filters,function(u){r.filters=u||[],t.Image.prototype._initFilters.call(r,[r.resizeFilter],function(d){r.resizeFilter=d[0],t.util.enlivenObjectEnlivables(r,r,function(){var h=new t.Image(a,r);l(h,!1)})})})},null,r.crossOrigin)},t.Image.fromURL=function(c,l,r){t.util.loadImage(c,function(a,s){l&&l(new t.Image(a,r),s)},null,r&&r.crossOrigin)},t.Image.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),t.Image.fromElement=function(c,l,r){var a=t.parseAttributes(c,t.Image.ATTRIBUTE_NAMES);t.Image.fromURL(a["xlink:href"],l,i(r?t.util.object.clone(r):{},a))}}(e),t.util.object.extend(t.Object.prototype,{_getAngleValueForStraighten:function(){var f=this.angle%360;return f>0?Math.round((f-1)/90)*90:Math.round(f/90)*90},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(f){f=f||{};var i=function(){},c=f.onComplete||i,l=f.onChange||i,r=this;return t.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(a){r.rotate(a),l()},onComplete:function(){r.setCoords(),c()}})}}),t.util.object.extend(t.StaticCanvas.prototype,{straightenObject:function(f){return f.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(f){return f.fxStraighten({onChange:this.requestRenderAllBound})}}),function(){function f(c,l){var r="precision "+l+` float;
void main(){}`,a=c.createShader(c.FRAGMENT_SHADER);return c.shaderSource(a,r),c.compileShader(a),!!c.getShaderParameter(a,c.COMPILE_STATUS)}t.isWebglSupported=function(c){if(t.isLikelyNode)return!1;c=c||t.WebglFilterBackend.prototype.tileSize;var l=document.createElement("canvas"),r=l.getContext("webgl")||l.getContext("experimental-webgl"),a=!1;if(r){t.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),a=t.maxTextureSize>=c;for(var s=["highp","mediump","lowp"],u=0;u<3;u++)if(f(r,s[u])){t.webGlPrecision=s[u];break}}return this.isSupported=a,a},t.WebglFilterBackend=i;function i(c){c&&c.tileSize&&(this.tileSize=c.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}i.prototype={tileSize:2048,resources:{},setupGLContext:function(c,l){this.dispose(),this.createWebGLCanvas(c,l),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(c,l)},chooseFastestCopyGLTo2DMethod:function(c,l){var r=typeof window.performance!="undefined",a;try{new ImageData(1,1),a=!0}catch(C){a=!1}var s=typeof ArrayBuffer!="undefined",u=typeof Uint8ClampedArray!="undefined";if(r&&a&&s&&u){var d=t.util.createCanvasElement(),h=new ArrayBuffer(c*l*4);if(t.forceGLPutImageData){this.imageBuffer=h,this.copyGLTo2D=v;return}var p={imageBuffer:h,destinationWidth:c,destinationHeight:l,targetCanvas:d},m,y,_;d.width=c,d.height=l,m=window.performance.now(),A.call(p,this.gl,p),y=window.performance.now()-m,m=window.performance.now(),v.call(p,this.gl,p),_=window.performance.now()-m,y>_?(this.imageBuffer=h,this.copyGLTo2D=v):this.copyGLTo2D=A}},createWebGLCanvas:function(c,l){var r=t.util.createCanvasElement();r.width=c,r.height=l;var a={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},s=r.getContext("webgl",a);s||(s=r.getContext("experimental-webgl",a)),s&&(s.clearColor(0,0,0,0),this.canvas=r,this.gl=s)},applyFilters:function(c,l,r,a,s,u){var d=this.gl,h;u&&(h=this.getCachedTexture(u,l));var p={originalWidth:l.width||l.originalWidth,originalHeight:l.height||l.originalHeight,sourceWidth:r,sourceHeight:a,destinationWidth:r,destinationHeight:a,context:d,sourceTexture:this.createTexture(d,r,a,!h&&l),targetTexture:this.createTexture(d,r,a),originalTexture:h||this.createTexture(d,r,a,!h&&l),passes:c.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:s},m=d.createFramebuffer();return d.bindFramebuffer(d.FRAMEBUFFER,m),c.forEach(function(y){y&&y.applyTo(p)}),g(p),this.copyGLTo2D(d,p),d.bindTexture(d.TEXTURE_2D,null),d.deleteTexture(p.sourceTexture),d.deleteTexture(p.targetTexture),d.deleteFramebuffer(m),s.getContext("2d").setTransform(1,0,0,1,0,0),p},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(c,l,r,a,s){var u=c.createTexture();return c.bindTexture(c.TEXTURE_2D,u),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,s||c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,s||c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),a?c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,a):c.texImage2D(c.TEXTURE_2D,0,c.RGBA,l,r,0,c.RGBA,c.UNSIGNED_BYTE,null),u},getCachedTexture:function(c,l){if(this.textureCache[c])return this.textureCache[c];var r=this.createTexture(this.gl,l.width,l.height,l);return this.textureCache[c]=r,r},evictCachesForKey:function(c){this.textureCache[c]&&(this.gl.deleteTexture(this.textureCache[c]),delete this.textureCache[c])},copyGLTo2D:A,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var c=this.gl,l={renderer:"",vendor:""};if(!c)return l;var r=c.getExtension("WEBGL_debug_renderer_info");if(r){var a=c.getParameter(r.UNMASKED_RENDERER_WEBGL),s=c.getParameter(r.UNMASKED_VENDOR_WEBGL);a&&(l.renderer=a.toLowerCase()),s&&(l.vendor=s.toLowerCase())}return this.gpuInfo=l,l}}}();function g(f){var i=f.targetCanvas,c=i.width,l=i.height,r=f.destinationWidth,a=f.destinationHeight;(c!==r||l!==a)&&(i.width=r,i.height=a)}function A(f,i){var c=f.canvas,l=i.targetCanvas,r=l.getContext("2d");r.translate(0,l.height),r.scale(1,-1);var a=c.height-l.height;r.drawImage(c,0,a,l.width,l.height,0,0,l.width,l.height)}function v(f,i){var c=i.targetCanvas,l=c.getContext("2d"),r=i.destinationWidth,a=i.destinationHeight,s=r*a*4,u=new Uint8Array(this.imageBuffer,0,s),d=new Uint8ClampedArray(this.imageBuffer,0,s);f.readPixels(0,0,r,a,f.RGBA,f.UNSIGNED_BYTE,u);var h=new ImageData(d,r,a);l.putImageData(h,0,0)}(function(){var f=function(){};t.Canvas2dFilterBackend=i;function i(){}i.prototype={evictCachesForKey:f,dispose:f,clearWebGLCaches:f,resources:{},applyFilters:function(c,l,r,a,s){var u=s.getContext("2d");u.drawImage(l,0,0,r,a);var d=u.getImageData(0,0,r,a),h=u.getImageData(0,0,r,a),p={sourceWidth:r,sourceHeight:a,imageData:d,originalEl:l,originalImageData:h,canvasEl:s,ctx:u,filterBackend:this};return c.forEach(function(m){m.applyTo(p)}),(p.imageData.width!==r||p.imageData.height!==a)&&(s.width=p.imageData.width,s.height=p.imageData.height),u.putImageData(p.imageData,0,0),p}}})(),t.Image=t.Image||{},t.Image.filters=t.Image.filters||{},t.Image.filters.BaseFilter=t.util.createClass({type:"BaseFilter",vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
void main() {
vTexCoord = aPosition;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:`precision highp float;
varying vec2 vTexCoord;
uniform sampler2D uTexture;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
}`,initialize:function(f){f&&this.setOptions(f)},setOptions:function(f){for(var i in f)this[i]=f[i]},createProgram:function(f,i,c){i=i||this.fragmentSource,c=c||this.vertexSource,t.webGlPrecision!=="highp"&&(i=i.replace(/precision highp float/g,"precision "+t.webGlPrecision+" float"));var l=f.createShader(f.VERTEX_SHADER);if(f.shaderSource(l,c),f.compileShader(l),!f.getShaderParameter(l,f.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+f.getShaderInfoLog(l));var r=f.createShader(f.FRAGMENT_SHADER);if(f.shaderSource(r,i),f.compileShader(r),!f.getShaderParameter(r,f.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+f.getShaderInfoLog(r));var a=f.createProgram();if(f.attachShader(a,l),f.attachShader(a,r),f.linkProgram(a),!f.getProgramParameter(a,f.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+f.getProgramInfoLog(a));var s=this.getAttributeLocations(f,a),u=this.getUniformLocations(f,a)||{};return u.uStepW=f.getUniformLocation(a,"uStepW"),u.uStepH=f.getUniformLocation(a,"uStepH"),{program:a,attributeLocations:s,uniformLocations:u}},getAttributeLocations:function(f,i){return{aPosition:f.getAttribLocation(i,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(f,i,c){var l=i.aPosition,r=f.createBuffer();f.bindBuffer(f.ARRAY_BUFFER,r),f.enableVertexAttribArray(l),f.vertexAttribPointer(l,2,f.FLOAT,!1,0,0),f.bufferData(f.ARRAY_BUFFER,c,f.STATIC_DRAW)},_setupFrameBuffer:function(f){var i=f.context,c,l;f.passes>1?(c=f.destinationWidth,l=f.destinationHeight,(f.sourceWidth!==c||f.sourceHeight!==l)&&(i.deleteTexture(f.targetTexture),f.targetTexture=f.filterBackend.createTexture(i,c,l)),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,f.targetTexture,0)):(i.bindFramebuffer(i.FRAMEBUFFER,null),i.finish())},_swapTextures:function(f){f.passes--,f.pass++;var i=f.targetTexture;f.targetTexture=f.sourceTexture,f.sourceTexture=i},isNeutralState:function(){var f=this.mainParameter,i=t.Image.filters[this.type].prototype;if(f)if(Array.isArray(i[f])){for(var c=i[f].length;c--;)if(this[f][c]!==i[f][c])return!1;return!0}else return i[f]===this[f];else return!1},applyTo:function(f){f.webgl?(this._setupFrameBuffer(f),this.applyToWebGL(f),this._swapTextures(f)):this.applyTo2d(f)},retrieveShader:function(f){return f.programCache.hasOwnProperty(this.type)||(f.programCache[this.type]=this.createProgram(f.context)),f.programCache[this.type]},applyToWebGL:function(f){var i=f.context,c=this.retrieveShader(f);f.pass===0&&f.originalTexture?i.bindTexture(i.TEXTURE_2D,f.originalTexture):i.bindTexture(i.TEXTURE_2D,f.sourceTexture),i.useProgram(c.program),this.sendAttributeData(i,c.attributeLocations,f.aPosition),i.uniform1f(c.uniformLocations.uStepW,1/f.sourceWidth),i.uniform1f(c.uniformLocations.uStepH,1/f.sourceHeight),this.sendUniformData(i,c.uniformLocations),i.viewport(0,0,f.destinationWidth,f.destinationHeight),i.drawArrays(i.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(f,i,c){f.activeTexture(c),f.bindTexture(f.TEXTURE_2D,i),f.activeTexture(f.TEXTURE0)},unbindAdditionalTexture:function(f,i){f.activeTexture(i),f.bindTexture(f.TEXTURE_2D,null),f.activeTexture(f.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(f){this[this.mainParameter]=f},sendUniformData:function(){},createHelpLayer:function(f){if(!f.helpLayer){var i=document.createElement("canvas");i.width=f.sourceWidth,i.height=f.sourceHeight,f.helpLayer=i}},toObject:function(){var f={type:this.type},i=this.mainParameter;return i&&(f[i]=this[i]),f},toJSON:function(){return this.toObject()}}),t.Image.filters.BaseFilter.fromObject=function(f,i){var c=new t.Image.filters[f.type](f);return i&&i(c),c},function(f){var i=f.fabric||(f.fabric={}),c=i.Image.filters,l=i.util.createClass;c.ColorMatrix=l(c.BaseFilter,{type:"ColorMatrix",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
uniform mat4 uColorMatrix;
uniform vec4 uConstants;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color *= uColorMatrix;
color += uConstants;
gl_FragColor = color;
}`,matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(r){this.callSuper("initialize",r),this.matrix=this.matrix.slice(0)},applyTo2d:function(r){var a=r.imageData,s=a.data,u=s.length,d=this.matrix,h,p,m,y,_,C=this.colorsOnly;for(_=0;_<u;_+=4)h=s[_],p=s[_+1],m=s[_+2],C?(s[_]=h*d[0]+p*d[1]+m*d[2]+d[4]*255,s[_+1]=h*d[5]+p*d[6]+m*d[7]+d[9]*255,s[_+2]=h*d[10]+p*d[11]+m*d[12]+d[14]*255):(y=s[_+3],s[_]=h*d[0]+p*d[1]+m*d[2]+y*d[3]+d[4]*255,s[_+1]=h*d[5]+p*d[6]+m*d[7]+y*d[8]+d[9]*255,s[_+2]=h*d[10]+p*d[11]+m*d[12]+y*d[13]+d[14]*255,s[_+3]=h*d[15]+p*d[16]+m*d[17]+y*d[18]+d[19]*255)},getUniformLocations:function(r,a){return{uColorMatrix:r.getUniformLocation(a,"uColorMatrix"),uConstants:r.getUniformLocation(a,"uConstants")}},sendUniformData:function(r,a){var s=this.matrix,u=[s[0],s[1],s[2],s[3],s[5],s[6],s[7],s[8],s[10],s[11],s[12],s[13],s[15],s[16],s[17],s[18]],d=[s[4],s[9],s[14],s[19]];r.uniformMatrix4fv(a.uColorMatrix,!1,u),r.uniform4fv(a.uConstants,d)}}),i.Image.filters.ColorMatrix.fromObject=i.Image.filters.BaseFilter.fromObject}(e),function(f){var i=f.fabric||(f.fabric={}),c=i.Image.filters,l=i.util.createClass;c.Brightness=l(c.BaseFilter,{type:"Brightness",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBrightness;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += uBrightness;
gl_FragColor = color;
}`,brightness:0,mainParameter:"brightness",applyTo2d:function(r){if(this.brightness!==0){var a=r.imageData,s=a.data,u,d=s.length,h=Math.round(this.brightness*255);for(u=0;u<d;u+=4)s[u]=s[u]+h,s[u+1]=s[u+1]+h,s[u+2]=s[u+2]+h}},getUniformLocations:function(r,a){return{uBrightness:r.getUniformLocation(a,"uBrightness")}},sendUniformData:function(r,a){r.uniform1f(a.uBrightness,this.brightness)}}),i.Image.filters.Brightness.fromObject=i.Image.filters.BaseFilter.fromObject}(e),function(f){var i=f.fabric||(f.fabric={}),c=i.util.object.extend,l=i.Image.filters,r=i.util.createClass;l.Convolute=r(l.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_3_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_5_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_5_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_7_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_7_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_9_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_9_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`},retrieveShader:function(a){var s=Math.sqrt(this.matrix.length),u=this.type+"_"+s+"_"+(this.opaque?1:0),d=this.fragmentSource[u];return a.programCache.hasOwnProperty(u)||(a.programCache[u]=this.createProgram(a.context,d)),a.programCache[u]},applyTo2d:function(a){var s=a.imageData,u=s.data,d=this.matrix,h=Math.round(Math.sqrt(d.length)),p=Math.floor(h/2),m=s.width,y=s.height,_=a.ctx.createImageData(m,y),C=_.data,w=this.opaque?1:0,b,S,F,$,Q,R,H,W,G,V,st,et,x;for(st=0;st<y;st++)for(V=0;V<m;V++){for(Q=(st*m+V)*4,b=0,S=0,F=0,$=0,x=0;x<h;x++)for(et=0;et<h;et++)H=st+x-p,R=V+et-p,!(H<0||H>=y||R<0||R>=m)&&(W=(H*m+R)*4,G=d[x*h+et],b+=u[W]*G,S+=u[W+1]*G,F+=u[W+2]*G,w||($+=u[W+3]*G));C[Q]=b,C[Q+1]=S,C[Q+2]=F,w?C[Q+3]=u[Q+3]:C[Q+3]=$}a.imageData=_},getUniformLocations:function(a,s){return{uMatrix:a.getUniformLocation(s,"uMatrix"),uOpaque:a.getUniformLocation(s,"uOpaque"),uHalfSize:a.getUniformLocation(s,"uHalfSize"),uSize:a.getUniformLocation(s,"uSize")}},sendUniformData:function(a,s){a.uniform1fv(s.uMatrix,this.matrix)},toObject:function(){return c(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),i.Image.filters.Convolute.fromObject=i.Image.filters.BaseFilter.fromObject}(e),function(f){var i=f.fabric||(f.fabric={}),c=i.Image.filters,l=i.util.createClass;c.Grayscale=l(c.BaseFilter,{type:"Grayscale",fragmentSource:{average:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float average = (color.r + color.b + color.g) / 3.0;
gl_FragColor = vec4(average, average, average, color.a);
}`,lightness:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
gl_FragColor = vec4(average, average, average, col.a);
}`,luminosity:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
gl_FragColor = vec4(average, average, average, col.a);
}`},mode:"average",mainParameter:"mode",applyTo2d:function(r){var a=r.imageData,s=a.data,u,d=s.length,h,p=this.mode;for(u=0;u<d;u+=4)p==="average"?h=(s[u]+s[u+1]+s[u+2])/3:p==="lightness"?h=(Math.min(s[u],s[u+1],s[u+2])+Math.max(s[u],s[u+1],s[u+2]))/2:p==="luminosity"&&(h=.21*s[u]+.72*s[u+1]+.07*s[u+2]),s[u]=h,s[u+1]=h,s[u+2]=h},retrieveShader:function(r){var a=this.type+"_"+this.mode;if(!r.programCache.hasOwnProperty(a)){var s=this.fragmentSource[this.mode];r.programCache[a]=this.createProgram(r.context,s)}return r.programCache[a]},getUniformLocations:function(r,a){return{uMode:r.getUniformLocation(a,"uMode")}},sendUniformData:function(r,a){var s=1;r.uniform1i(a.uMode,s)},isNeutralState:function(){return!1}}),i.Image.filters.Grayscale.fromObject=i.Image.filters.BaseFilter.fromObject}(e),function(f){var i=f.fabric||(f.fabric={}),c=i.Image.filters,l=i.util.createClass;c.Invert=l(c.BaseFilter,{type:"Invert",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform int uInvert;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
if (uInvert == 1) {
gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
} else {
gl_FragColor = color;
}
}`,invert:!0,mainParameter:"invert",applyTo2d:function(r){var a=r.imageData,s=a.data,u,d=s.length;for(u=0;u<d;u+=4)s[u]=255-s[u],s[u+1]=255-s[u+1],s[u+2]=255-s[u+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(r,a){return{uInvert:r.getUniformLocation(a,"uInvert")}},sendUniformData:function(r,a){r.uniform1i(a.uInvert,this.invert)}}),i.Image.filters.Invert.fromObject=i.Image.filters.BaseFilter.fromObject}(e),function(f){var i=f.fabric||(f.fabric={}),c=i.util.object.extend,l=i.Image.filters,r=i.util.createClass;l.Noise=r(l.BaseFilter,{type:"Noise",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uStepH;
uniform float uNoise;
uniform float uSeed;
varying vec2 vTexCoord;
float rand(vec2 co, float seed, float vScale) {
return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
}
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
gl_FragColor = color;
}`,mainParameter:"noise",noise:0,applyTo2d:function(a){if(this.noise!==0){var s=a.imageData,u=s.data,d,h=u.length,p=this.noise,m;for(d=0,h=u.length;d<h;d+=4)m=(.5-Math.random())*p,u[d]+=m,u[d+1]+=m,u[d+2]+=m}},getUniformLocations:function(a,s){return{uNoise:a.getUniformLocation(s,"uNoise"),uSeed:a.getUniformLocation(s,"uSeed")}},sendUniformData:function(a,s){a.uniform1f(s.uNoise,this.noise/255),a.uniform1f(s.uSeed,Math.random())},toObject:function(){return c(this.callSuper("toObject"),{noise:this.noise})}}),i.Image.filters.Noise.fromObject=i.Image.filters.BaseFilter.fromObject}(e),function(f){var i=f.fabric||(f.fabric={}),c=i.Image.filters,l=i.util.createClass;c.Pixelate=l(c.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBlocksize;
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
float blockW = uBlocksize * uStepW;
float blockH = uBlocksize * uStepW;
int posX = int(vTexCoord.x / blockW);
int posY = int(vTexCoord.y / blockH);
float fposX = float(posX);
float fposY = float(posY);
vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
vec4 color = texture2D(uTexture, squareCoords);
gl_FragColor = color;
}`,applyTo2d:function(r){var a=r.imageData,s=a.data,u=a.height,d=a.width,h,p,m,y,_,C,w,b,S,F,$;for(p=0;p<u;p+=this.blocksize)for(m=0;m<d;m+=this.blocksize)for(h=p*4*d+m*4,y=s[h],_=s[h+1],C=s[h+2],w=s[h+3],F=Math.min(p+this.blocksize,u),$=Math.min(m+this.blocksize,d),b=p;b<F;b++)for(S=m;S<$;S++)h=b*4*d+S*4,s[h]=y,s[h+1]=_,s[h+2]=C,s[h+3]=w},isNeutralState:function(){return this.blocksize===1},getUniformLocations:function(r,a){return{uBlocksize:r.getUniformLocation(a,"uBlocksize"),uStepW:r.getUniformLocation(a,"uStepW"),uStepH:r.getUniformLocation(a,"uStepH")}},sendUniformData:function(r,a){r.uniform1f(a.uBlocksize,this.blocksize)}}),i.Image.filters.Pixelate.fromObject=i.Image.filters.BaseFilter.fromObject}(e),function(f){var i=f.fabric||(f.fabric={}),c=i.util.object.extend,l=i.Image.filters,r=i.util.createClass;l.RemoveColor=r(l.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
gl_FragColor.a = 0.0;
}
}`,distance:.02,useAlpha:!1,applyTo2d:function(a){var s=a.imageData,u=s.data,d,h=this.distance*255,p,m,y,_=new i.Color(this.color).getSource(),C=[_[0]-h,_[1]-h,_[2]-h],w=[_[0]+h,_[1]+h,_[2]+h];for(d=0;d<u.length;d+=4)p=u[d],m=u[d+1],y=u[d+2],p>C[0]&&m>C[1]&&y>C[2]&&p<w[0]&&m<w[1]&&y<w[2]&&(u[d+3]=0)},getUniformLocations:function(a,s){return{uLow:a.getUniformLocation(s,"uLow"),uHigh:a.getUniformLocation(s,"uHigh")}},sendUniformData:function(a,s){var u=new i.Color(this.color).getSource(),d=parseFloat(this.distance),h=[0+u[0]/255-d,0+u[1]/255-d,0+u[2]/255-d,1],p=[u[0]/255+d,u[1]/255+d,u[2]/255+d,1];a.uniform4fv(s.uLow,h),a.uniform4fv(s.uHigh,p)},toObject:function(){return c(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),i.Image.filters.RemoveColor.fromObject=i.Image.filters.BaseFilter.fromObject}(e),function(f){var i=f.fabric||(f.fabric={}),c=i.Image.filters,l=i.util.createClass,r={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var a in r)c[a]=l(c.ColorMatrix,{type:a,matrix:r[a],mainParameter:!1,colorsOnly:!0}),i.Image.filters[a].fromObject=i.Image.filters.BaseFilter.fromObject}(e),function(f){var i=f.fabric,c=i.Image.filters,l=i.util.createClass;c.BlendColor=l(c.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,diff:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`if (uColor.r < 0.5) {
gl_FragColor.r *= 2.0 * uColor.r;
} else {
gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
}
if (uColor.g < 0.5) {
gl_FragColor.g *= 2.0 * uColor.g;
} else {
gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
}
if (uColor.b < 0.5) {
gl_FragColor.b *= 2.0 * uColor.b;
} else {
gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
}
`,tint:`gl_FragColor.rgb *= (1.0 - uColor.a);
gl_FragColor.rgb += uColor.rgb;
`},buildSource:function(r){return`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uColor;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
gl_FragColor = color;
if (color.a > 0.0) {
`+this.fragmentSource[r]+`}
}`},retrieveShader:function(r){var a=this.type+"_"+this.mode,s;return r.programCache.hasOwnProperty(a)||(s=this.buildSource(this.mode),r.programCache[a]=this.createProgram(r.context,s)),r.programCache[a]},applyTo2d:function(r){var a=r.imageData,s=a.data,u=s.length,d,h,p,m,y,_,C,w=1-this.alpha;C=new i.Color(this.color).getSource(),d=C[0]*this.alpha,h=C[1]*this.alpha,p=C[2]*this.alpha;for(var b=0;b<u;b+=4)switch(m=s[b],y=s[b+1],_=s[b+2],this.mode){case"multiply":s[b]=m*d/255,s[b+1]=y*h/255,s[b+2]=_*p/255;break;case"screen":s[b]=255-(255-m)*(255-d)/255,s[b+1]=255-(255-y)*(255-h)/255,s[b+2]=255-(255-_)*(255-p)/255;break;case"add":s[b]=m+d,s[b+1]=y+h,s[b+2]=_+p;break;case"diff":case"difference":s[b]=Math.abs(m-d),s[b+1]=Math.abs(y-h),s[b+2]=Math.abs(_-p);break;case"subtract":s[b]=m-d,s[b+1]=y-h,s[b+2]=_-p;break;case"darken":s[b]=Math.min(m,d),s[b+1]=Math.min(y,h),s[b+2]=Math.min(_,p);break;case"lighten":s[b]=Math.max(m,d),s[b+1]=Math.max(y,h),s[b+2]=Math.max(_,p);break;case"overlay":s[b]=d<128?2*m*d/255:255-2*(255-m)*(255-d)/255,s[b+1]=h<128?2*y*h/255:255-2*(255-y)*(255-h)/255,s[b+2]=p<128?2*_*p/255:255-2*(255-_)*(255-p)/255;break;case"exclusion":s[b]=d+m-2*d*m/255,s[b+1]=h+y-2*h*y/255,s[b+2]=p+_-2*p*_/255;break;case"tint":s[b]=d+m*w,s[b+1]=h+y*w,s[b+2]=p+_*w}},getUniformLocations:function(r,a){return{uColor:r.getUniformLocation(a,"uColor")}},sendUniformData:function(r,a){var s=new i.Color(this.color).getSource();s[0]=this.alpha*s[0]/255,s[1]=this.alpha*s[1]/255,s[2]=this.alpha*s[2]/255,s[3]=this.alpha,r.uniform4fv(a.uColor,s)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),i.Image.filters.BlendColor.fromObject=i.Image.filters.BaseFilter.fromObject}(e),function(f){var i=f.fabric,c=i.Image.filters,l=i.util.createClass;c.BlendImage=l(c.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
uniform mat3 uTransformMatrix;
void main() {
vTexCoord = aPosition;
vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:{multiply:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.rgba *= color2.rgba;
gl_FragColor = color;
}`,mask:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.a = color2.a;
gl_FragColor = color;
}`},retrieveShader:function(r){var a=this.type+"_"+this.mode,s=this.fragmentSource[this.mode];return r.programCache.hasOwnProperty(a)||(r.programCache[a]=this.createProgram(r.context,s)),r.programCache[a]},applyToWebGL:function(r){var a=r.context,s=this.createTexture(r.filterBackend,this.image);this.bindAdditionalTexture(a,s,a.TEXTURE1),this.callSuper("applyToWebGL",r),this.unbindAdditionalTexture(a,a.TEXTURE1)},createTexture:function(r,a){return r.getCachedTexture(a.cacheKey,a._element)},calculateMatrix:function(){var r=this.image,a=r._element.width,s=r._element.height;return[1/r.scaleX,0,0,0,1/r.scaleY,0,-r.left/a,-r.top/s,1]},applyTo2d:function(r){var a=r.imageData,s=r.filterBackend.resources,u=a.data,d=u.length,h=a.width,p=a.height,m,y,_,C,w,b,S,F,$,Q,R=this.image,H;s.blendImage||(s.blendImage=i.util.createCanvasElement()),$=s.blendImage,Q=$.getContext("2d"),$.width!==h||$.height!==p?($.width=h,$.height=p):Q.clearRect(0,0,h,p),Q.setTransform(R.scaleX,0,0,R.scaleY,R.left,R.top),Q.drawImage(R._element,0,0,h,p),H=Q.getImageData(0,0,h,p).data;for(var W=0;W<d;W+=4)switch(w=u[W],b=u[W+1],S=u[W+2],F=u[W+3],m=H[W],y=H[W+1],_=H[W+2],C=H[W+3],this.mode){case"multiply":u[W]=w*m/255,u[W+1]=b*y/255,u[W+2]=S*_/255,u[W+3]=F*C/255;break;case"mask":u[W+3]=C;break}},getUniformLocations:function(r,a){return{uTransformMatrix:r.getUniformLocation(a,"uTransformMatrix"),uImage:r.getUniformLocation(a,"uImage")}},sendUniformData:function(r,a){var s=this.calculateMatrix();r.uniform1i(a.uImage,1),r.uniformMatrix3fv(a.uTransformMatrix,!1,s)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),i.Image.filters.BlendImage.fromObject=function(r,a){i.Image.fromObject(r.image,function(s){var u=i.util.object.clone(r);u.image=s,a(new i.Image.filters.BlendImage(u))})}}(e),function(f){var i=f.fabric||(f.fabric={}),c=Math.pow,l=Math.floor,r=Math.sqrt,a=Math.abs,s=Math.round,u=Math.sin,d=Math.ceil,h=i.Image.filters,p=i.util.createClass;h.Resize=p(h.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(m,y){return{uDelta:m.getUniformLocation(y,"uDelta"),uTaps:m.getUniformLocation(y,"uTaps")}},sendUniformData:function(m,y){m.uniform2fv(y.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),m.uniform1fv(y.uTaps,this.taps)},retrieveShader:function(m){var y=this.getFilterWindow(),_=this.type+"_"+y;if(!m.programCache.hasOwnProperty(_)){var C=this.generateShader(y);m.programCache[_]=this.createProgram(m.context,C)}return m.programCache[_]},getFilterWindow:function(){var m=this.tempScale;return Math.ceil(this.lanczosLobes/m)},getTaps:function(){for(var m=this.lanczosCreate(this.lanczosLobes),y=this.tempScale,_=this.getFilterWindow(),C=new Array(_),w=1;w<=_;w++)C[w-1]=m(w*y);return C},generateShader:function(C){for(var y=new Array(C),_=this.fragmentSourceTOP,C,w=1;w<=C;w++)y[w-1]=w+".0 * uDelta";return _+="uniform float uTaps["+C+`];
`,_+=`void main() {
`,_+=`  vec4 color = texture2D(uTexture, vTexCoord);
`,_+=`  float sum = 1.0;
`,y.forEach(function(b,S){_+="  color += texture2D(uTexture, vTexCoord + "+b+") * uTaps["+S+`];
`,_+="  color += texture2D(uTexture, vTexCoord - "+b+") * uTaps["+S+`];
`,_+="  sum += 2.0 * uTaps["+S+`];
`}),_+=`  gl_FragColor = color / sum;
`,_+="}",_},fragmentSourceTOP:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
`,applyTo:function(m){m.webgl?(m.passes++,this.width=m.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=m.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),m.destinationWidth=this.dW,this._setupFrameBuffer(m),this.applyToWebGL(m),this._swapTextures(m),m.sourceWidth=m.destinationWidth,this.height=m.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),m.destinationHeight=this.dH,this._setupFrameBuffer(m),this.applyToWebGL(m),this._swapTextures(m),m.sourceHeight=m.destinationHeight):this.applyTo2d(m)},isNeutralState:function(){return this.scaleX===1&&this.scaleY===1},lanczosCreate:function(m){return function(y){if(y>=m||y<=-m)return 0;if(y<11920929e-14&&y>-11920929e-14)return 1;y*=Math.PI;var _=y/m;return u(y)/y*u(_)/_}},applyTo2d:function(m){var y=m.imageData,_=this.scaleX,C=this.scaleY;this.rcpScaleX=1/_,this.rcpScaleY=1/C;var w=y.width,b=y.height,S=s(w*_),F=s(b*C),$;this.resizeType==="sliceHack"?$=this.sliceByTwo(m,w,b,S,F):this.resizeType==="hermite"?$=this.hermiteFastResize(m,w,b,S,F):this.resizeType==="bilinear"?$=this.bilinearFiltering(m,w,b,S,F):this.resizeType==="lanczos"&&($=this.lanczosResize(m,w,b,S,F)),m.imageData=$},sliceByTwo:function(m,y,_,C,w){var b=m.imageData,S=.5,F=!1,$=!1,Q=y*S,R=_*S,H=i.filterBackend.resources,W,G,V=0,st=0,et=y,x=0;for(H.sliceByTwo||(H.sliceByTwo=document.createElement("canvas")),W=H.sliceByTwo,(W.width<y*1.5||W.height<_)&&(W.width=y*1.5,W.height=_),G=W.getContext("2d"),G.clearRect(0,0,y*1.5,_),G.putImageData(b,0,0),C=l(C),w=l(w);!F||!$;)y=Q,_=R,C<l(Q*S)?Q=l(Q*S):(Q=C,F=!0),w<l(R*S)?R=l(R*S):(R=w,$=!0),G.drawImage(W,V,st,y,_,et,x,Q,R),V=et,st=x,x+=R;return G.getImageData(V,st,C,w)},lanczosResize:function(m,y,_,C,w){function b(k){var D,Y,I,E,P,N,q,J,rt,lt,dt;for(x.x=(k+.5)*R,B.x=l(x.x),D=0;D<w;D++){for(x.y=(D+.5)*H,B.y=l(x.y),P=0,N=0,q=0,J=0,rt=0,Y=B.x-V;Y<=B.x+V;Y++)if(!(Y<0||Y>=y)){lt=l(1e3*a(Y-x.x)),et[lt]||(et[lt]={});for(var U=B.y-st;U<=B.y+st;U++)U<0||U>=_||(dt=l(1e3*a(U-x.y)),et[lt][dt]||(et[lt][dt]=Q(r(c(lt*W,2)+c(dt*G,2))/1e3)),I=et[lt][dt],I>0&&(E=(U*y+Y)*4,P+=I,N+=I*S[E],q+=I*S[E+1],J+=I*S[E+2],rt+=I*S[E+3]))}E=(D*C+k)*4,$[E]=N/P,$[E+1]=q/P,$[E+2]=J/P,$[E+3]=rt/P}return++k<C?b(k):F}var S=m.imageData.data,F=m.ctx.createImageData(C,w),$=F.data,Q=this.lanczosCreate(this.lanczosLobes),R=this.rcpScaleX,H=this.rcpScaleY,W=2/this.rcpScaleX,G=2/this.rcpScaleY,V=d(R*this.lanczosLobes/2),st=d(H*this.lanczosLobes/2),et={},x={},B={};return b(0)},bilinearFiltering:function(m,y,_,C,w){var b,S,F,$,Q,R,H,W,G,V,st,et,x=0,B,k=this.rcpScaleX,D=this.rcpScaleY,Y=4*(y-1),I=m.imageData,E=I.data,P=m.ctx.createImageData(C,w),N=P.data;for(H=0;H<w;H++)for(W=0;W<C;W++)for(Q=l(k*W),R=l(D*H),G=k*W-Q,V=D*H-R,B=4*(R*y+Q),st=0;st<4;st++)b=E[B+st],S=E[B+4+st],F=E[B+Y+st],$=E[B+Y+4+st],et=b*(1-G)*(1-V)+S*G*(1-V)+F*V*(1-G)+$*G*V,N[x++]=et;return P},hermiteFastResize:function(m,y,_,C,w){for(var b=this.rcpScaleX,S=this.rcpScaleY,F=d(b/2),$=d(S/2),Q=m.imageData,R=Q.data,H=m.ctx.createImageData(C,w),W=H.data,G=0;G<w;G++)for(var V=0;V<C;V++){for(var st=(V+G*C)*4,et=0,x=0,B=0,k=0,D=0,Y=0,I=0,E=(G+.5)*S,P=l(G*S);P<(G+1)*S;P++)for(var N=a(E-(P+.5))/$,q=(V+.5)*b,J=N*N,rt=l(V*b);rt<(V+1)*b;rt++){var lt=a(q-(rt+.5))/F,dt=r(J+lt*lt);dt>1&&dt<-1||(et=2*dt*dt*dt-3*dt*dt+1,et>0&&(lt=4*(rt+P*y),I+=et*R[lt+3],B+=et,R[lt+3]<255&&(et=et*R[lt+3]/250),k+=et*R[lt],D+=et*R[lt+1],Y+=et*R[lt+2],x+=et))}W[st]=k/x,W[st+1]=D/x,W[st+2]=Y/x,W[st+3]=I/B}return H},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),i.Image.filters.Resize.fromObject=i.Image.filters.BaseFilter.fromObject}(e),function(f){var i=f.fabric||(f.fabric={}),c=i.Image.filters,l=i.util.createClass;c.Contrast=l(c.BaseFilter,{type:"Contrast",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uContrast;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
gl_FragColor = color;
}`,contrast:0,mainParameter:"contrast",applyTo2d:function(r){if(this.contrast!==0){var a=r.imageData,s,d,u=a.data,d=u.length,h=Math.floor(this.contrast*255),p=259*(h+255)/(255*(259-h));for(s=0;s<d;s+=4)u[s]=p*(u[s]-128)+128,u[s+1]=p*(u[s+1]-128)+128,u[s+2]=p*(u[s+2]-128)+128}},getUniformLocations:function(r,a){return{uContrast:r.getUniformLocation(a,"uContrast")}},sendUniformData:function(r,a){r.uniform1f(a.uContrast,this.contrast)}}),i.Image.filters.Contrast.fromObject=i.Image.filters.BaseFilter.fromObject}(e),function(f){var i=f.fabric||(f.fabric={}),c=i.Image.filters,l=i.util.createClass;c.Saturation=l(c.BaseFilter,{type:"Saturation",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uSaturation;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float rgMax = max(color.r, color.g);
float rgbMax = max(rgMax, color.b);
color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
gl_FragColor = color;
}`,saturation:0,mainParameter:"saturation",applyTo2d:function(r){if(this.saturation!==0){var a=r.imageData,s=a.data,u=s.length,d=-this.saturation,h,p;for(h=0;h<u;h+=4)p=Math.max(s[h],s[h+1],s[h+2]),s[h]+=p!==s[h]?(p-s[h])*d:0,s[h+1]+=p!==s[h+1]?(p-s[h+1])*d:0,s[h+2]+=p!==s[h+2]?(p-s[h+2])*d:0}},getUniformLocations:function(r,a){return{uSaturation:r.getUniformLocation(a,"uSaturation")}},sendUniformData:function(r,a){r.uniform1f(a.uSaturation,-this.saturation)}}),i.Image.filters.Saturation.fromObject=i.Image.filters.BaseFilter.fromObject}(e),function(f){var i=f.fabric||(f.fabric={}),c=i.Image.filters,l=i.util.createClass;c.Vibrance=l(c.BaseFilter,{type:"Vibrance",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uVibrance;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float max = max(color.r, max(color.g, color.b));
float avg = (color.r + color.g + color.b) / 3.0;
float amt = (abs(max - avg) * 2.0) * uVibrance;
color.r += max != color.r ? (max - color.r) * amt : 0.00;
color.g += max != color.g ? (max - color.g) * amt : 0.00;
color.b += max != color.b ? (max - color.b) * amt : 0.00;
gl_FragColor = color;
}`,vibrance:0,mainParameter:"vibrance",applyTo2d:function(r){if(this.vibrance!==0){var a=r.imageData,s=a.data,u=s.length,d=-this.vibrance,h,p,m,y;for(h=0;h<u;h+=4)p=Math.max(s[h],s[h+1],s[h+2]),m=(s[h]+s[h+1]+s[h+2])/3,y=Math.abs(p-m)*2/255*d,s[h]+=p!==s[h]?(p-s[h])*y:0,s[h+1]+=p!==s[h+1]?(p-s[h+1])*y:0,s[h+2]+=p!==s[h+2]?(p-s[h+2])*y:0}},getUniformLocations:function(r,a){return{uVibrance:r.getUniformLocation(a,"uVibrance")}},sendUniformData:function(r,a){r.uniform1f(a.uVibrance,-this.vibrance)}}),i.Image.filters.Vibrance.fromObject=i.Image.filters.BaseFilter.fromObject}(e),function(f){var i=f.fabric||(f.fabric={}),c=i.Image.filters,l=i.util.createClass;c.Blur=l(c.BaseFilter,{type:"Blur",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
const float nSamples = 15.0;
vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
float random(vec3 scale) {
return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
}
void main() {
vec4 color = vec4(0.0);
float total = 0.0;
float offset = random(v3offset);
for (float t = -nSamples; t <= nSamples; t++) {
float percent = (t + offset - 0.5) / nSamples;
float weight = 1.0 - abs(percent);
color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
total += weight;
}
gl_FragColor = color / total;
}`,blur:0,mainParameter:"blur",applyTo:function(r){r.webgl?(this.aspectRatio=r.sourceWidth/r.sourceHeight,r.passes++,this._setupFrameBuffer(r),this.horizontal=!0,this.applyToWebGL(r),this._swapTextures(r),this._setupFrameBuffer(r),this.horizontal=!1,this.applyToWebGL(r),this._swapTextures(r)):this.applyTo2d(r)},applyTo2d:function(r){r.imageData=this.simpleBlur(r)},simpleBlur:function(r){var a=r.filterBackend.resources,s,u,d=r.imageData.width,h=r.imageData.height;a.blurLayer1||(a.blurLayer1=i.util.createCanvasElement(),a.blurLayer2=i.util.createCanvasElement()),s=a.blurLayer1,u=a.blurLayer2,(s.width!==d||s.height!==h)&&(u.width=s.width=d,u.height=s.height=h);var p=s.getContext("2d"),m=u.getContext("2d"),y=15,_,C,w,b,S=this.blur*.06*.5;for(p.putImageData(r.imageData,0,0),m.clearRect(0,0,d,h),b=-y;b<=y;b++)_=(Math.random()-.5)/4,C=b/y,w=S*C*d+_,m.globalAlpha=1-Math.abs(C),m.drawImage(s,w,_),p.drawImage(u,0,0),m.globalAlpha=1,m.clearRect(0,0,u.width,u.height);for(b=-y;b<=y;b++)_=(Math.random()-.5)/4,C=b/y,w=S*C*h+_,m.globalAlpha=1-Math.abs(C),m.drawImage(s,_,w),p.drawImage(u,0,0),m.globalAlpha=1,m.clearRect(0,0,u.width,u.height);r.ctx.drawImage(s,0,0);var F=r.ctx.getImageData(0,0,s.width,s.height);return p.globalAlpha=1,p.clearRect(0,0,s.width,s.height),F},getUniformLocations:function(r,a){return{delta:r.getUniformLocation(a,"uDelta")}},sendUniformData:function(r,a){var s=this.chooseRightDelta();r.uniform2fv(a.delta,s)},chooseRightDelta:function(){var r=1,a=[0,0],s;return this.horizontal?this.aspectRatio>1&&(r=1/this.aspectRatio):this.aspectRatio<1&&(r=this.aspectRatio),s=r*this.blur*.12,this.horizontal?a[0]=s:a[1]=s,a}}),c.Blur.fromObject=i.Image.filters.BaseFilter.fromObject}(e),function(f){var i=f.fabric||(f.fabric={}),c=i.Image.filters,l=i.util.createClass;c.Gamma=l(c.BaseFilter,{type:"Gamma",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec3 uGamma;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec3 correction = (1.0 / uGamma);
color.r = pow(color.r, correction.r);
color.g = pow(color.g, correction.g);
color.b = pow(color.b, correction.b);
gl_FragColor = color;
gl_FragColor.rgb *= color.a;
}`,gamma:[1,1,1],mainParameter:"gamma",initialize:function(r){this.gamma=[1,1,1],c.BaseFilter.prototype.initialize.call(this,r)},applyTo2d:function(r){var a=r.imageData,s=a.data,u=this.gamma,d=s.length,h=1/u[0],p=1/u[1],m=1/u[2],y;for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),y=0,d=256;y<d;y++)this.rVals[y]=Math.pow(y/255,h)*255,this.gVals[y]=Math.pow(y/255,p)*255,this.bVals[y]=Math.pow(y/255,m)*255;for(y=0,d=s.length;y<d;y+=4)s[y]=this.rVals[s[y]],s[y+1]=this.gVals[s[y+1]],s[y+2]=this.bVals[s[y+2]]},getUniformLocations:function(r,a){return{uGamma:r.getUniformLocation(a,"uGamma")}},sendUniformData:function(r,a){r.uniform3fv(a.uGamma,this.gamma)}}),i.Image.filters.Gamma.fromObject=i.Image.filters.BaseFilter.fromObject}(e),function(f){var i=f.fabric||(f.fabric={}),c=i.Image.filters,l=i.util.createClass;c.Composed=l(c.BaseFilter,{type:"Composed",subFilters:[],initialize:function(r){this.callSuper("initialize",r),this.subFilters=this.subFilters.slice(0)},applyTo:function(r){r.passes+=this.subFilters.length-1,this.subFilters.forEach(function(a){a.applyTo(r)})},toObject:function(){return i.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(r){return r.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(r){return!r.isNeutralState()})}}),i.Image.filters.Composed.fromObject=function(r,a){var s=r.subFilters||[],u=s.map(function(h){return new i.Image.filters[h.type](h)}),d=new i.Image.filters.Composed({subFilters:u});return a&&a(d),d}}(e),function(f){var i=f.fabric||(f.fabric={}),c=i.Image.filters,l=i.util.createClass;c.HueRotation=l(c.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var r=this.rotation*Math.PI,a=i.util.cos(r),s=i.util.sin(r),u=1/3,d=Math.sqrt(u)*s,h=1-a;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=a+h/3,this.matrix[1]=u*h-d,this.matrix[2]=u*h+d,this.matrix[5]=u*h+d,this.matrix[6]=a+u*h,this.matrix[7]=u*h-d,this.matrix[10]=u*h-d,this.matrix[11]=u*h+d,this.matrix[12]=a+u*h},isNeutralState:function(r){return this.calculateMatrix(),c.BaseFilter.prototype.isNeutralState.call(this,r)},applyTo:function(r){this.calculateMatrix(),c.BaseFilter.prototype.applyTo.call(this,r)}}),i.Image.filters.HueRotation.fromObject=i.Image.filters.BaseFilter.fromObject}(e),function(f){var i=f.fabric||(f.fabric={}),c=i.util.object.clone;if(i.Text){i.warn("fabric.Text is already defined");return}var l="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");i.Text=i.util.createClass(i.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:i.Object.prototype.stateProperties.concat(l),cacheProperties:i.Object.prototype.cacheProperties.concat(l),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(r,a){this.styles=a?a.styles||{}:{},this.text=r,this.__skipDimension=!0,this.callSuper("initialize",a),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var r=this.path;r&&(r.segmentsInfo=i.util.getPathSegmentsInfo(r.path))},getMeasuringContext:function(){return i._measuringContext||(i._measuringContext=this.canvas&&this.canvas.contextCache||i.util.createCanvasElement().getContext("2d")),i._measuringContext},_splitText:function(){var r=this._splitTextIntoLines(this.text);return this.textLines=r.lines,this._textLines=r.graphemeLines,this._unwrappedTextLines=r._unwrappedLines,this._text=r.graphemeText,r},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var r,a,s,u,d,h,p,m=0,y=this._textLines.length;m<y;m++)if(!(this.textAlign!=="justify"&&(m===y-1||this.isEndOfWrapping(m)))&&(u=0,d=this._textLines[m],a=this.getLineWidth(m),a<this.width&&(p=this.textLines[m].match(this._reSpacesAndTabs)))){s=p.length,r=(this.width-a)/s;for(var _=0,C=d.length;_<=C;_++)h=this.__charBounds[m][_],this._reSpaceAndTab.test(d[_])?(h.width+=r,h.kernedWidth+=r,h.left+=u,u+=r):h.left+=u}},isEndOfWrapping:function(r){return r===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var r=this.callSuper("_getCacheCanvasDimensions"),a=this.fontSize;return r.width+=a*r.zoomX,r.height+=a*r.zoomY,r},_render:function(r){var a=this.path;a&&!a.isNotVisible()&&a._render(r),this._setTextStyles(r),this._renderTextLinesBackground(r),this._renderTextDecoration(r,"underline"),this._renderText(r),this._renderTextDecoration(r,"overline"),this._renderTextDecoration(r,"linethrough")},_renderText:function(r){this.paintFirst==="stroke"?(this._renderTextStroke(r),this._renderTextFill(r)):(this._renderTextFill(r),this._renderTextStroke(r))},_setTextStyles:function(r,a,s){if(r.textBaseline="alphabetical",this.path)switch(this.pathAlign){case"center":r.textBaseline="middle";break;case"ascender":r.textBaseline="top";break;case"descender":r.textBaseline="bottom";break}r.font=this._getFontDeclaration(a,s)},calcTextWidth:function(){for(var r=this.getLineWidth(0),a=1,s=this._textLines.length;a<s;a++){var u=this.getLineWidth(a);u>r&&(r=u)}return r},_renderTextLine:function(r,a,s,u,d,h){this._renderChars(r,a,s,u,d,h)},_renderTextLinesBackground:function(r){if(!(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))){for(var a,s,u=r.fillStyle,d,h,p=this._getLeftOffset(),m=this._getTopOffset(),y=0,_=0,C,w,b=this.path,S,F=0,$=this._textLines.length;F<$;F++){if(a=this.getHeightOfLine(F),!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",F)){m+=a;continue}d=this._textLines[F],s=this._getLineLeftOffset(F),_=0,y=0,h=this.getValueOfPropertyAt(F,0,"textBackgroundColor");for(var Q=0,R=d.length;Q<R;Q++)C=this.__charBounds[F][Q],w=this.getValueOfPropertyAt(F,Q,"textBackgroundColor"),b?(r.save(),r.translate(C.renderLeft,C.renderTop),r.rotate(C.angle),r.fillStyle=w,w&&r.fillRect(-C.width/2,-a/this.lineHeight*(1-this._fontSizeFraction),C.width,a/this.lineHeight),r.restore()):w!==h?(S=p+s+y,this.direction==="rtl"&&(S=this.width-S-_),r.fillStyle=h,h&&r.fillRect(S,m,_,a/this.lineHeight),y=C.left,_=C.width,h=w):_+=C.kernedWidth;w&&!b&&(S=p+s+y,this.direction==="rtl"&&(S=this.width-S-_),r.fillStyle=w,r.fillRect(S,m,_,a/this.lineHeight)),m+=a}r.fillStyle=u,this._removeShadow(r)}},getFontCache:function(r){var a=r.fontFamily.toLowerCase();i.charWidthsCache[a]||(i.charWidthsCache[a]={});var s=i.charWidthsCache[a],u=r.fontStyle.toLowerCase()+"_"+(r.fontWeight+"").toLowerCase();return s[u]||(s[u]={}),s[u]},_measureChar:function(r,a,s,u){var d=this.getFontCache(a),h=this._getFontDeclaration(a),p=this._getFontDeclaration(u),m=s+r,y=h===p,_,C,w,b=a.fontSize/this.CACHE_FONT_SIZE,S;if(s&&d[s]!==void 0&&(w=d[s]),d[r]!==void 0&&(S=_=d[r]),y&&d[m]!==void 0&&(C=d[m],S=C-w),_===void 0||w===void 0||C===void 0){var F=this.getMeasuringContext();this._setTextStyles(F,a,!0)}return _===void 0&&(S=_=F.measureText(r).width,d[r]=_),w===void 0&&y&&s&&(w=F.measureText(s).width,d[s]=w),y&&C===void 0&&(C=F.measureText(m).width,d[m]=C,S=C-w),{width:_*b,kernedWidth:S*b}},getHeightOfChar:function(r,a){return this.getValueOfPropertyAt(r,a,"fontSize")},measureLine:function(r){var a=this._measureLine(r);return this.charSpacing!==0&&(a.width-=this._getWidthOfCharSpacing()),a.width<0&&(a.width=0),a},_measureLine:function(r){var a=0,s,u,d=this._textLines[r],h,p,m=0,y=new Array(d.length),_=0,C,w,b=this.path,S=this.pathSide==="right";for(this.__charBounds[r]=y,s=0;s<d.length;s++)u=d[s],p=this._getGraphemeBox(u,r,s,h),y[s]=p,a+=p.kernedWidth,h=u;if(y[s]={left:p?p.left+p.width:0,width:0,kernedWidth:0,height:this.fontSize},b){switch(w=b.segmentsInfo[b.segmentsInfo.length-1].length,C=i.util.getPointOnPath(b.path,0,b.segmentsInfo),C.x+=b.pathOffset.x,C.y+=b.pathOffset.y,this.textAlign){case"left":_=S?w-a:0;break;case"center":_=(w-a)/2;break;case"right":_=S?0:w-a;break}for(_+=this.pathStartOffset*(S?-1:1),s=S?d.length-1:0;S?s>=0:s<d.length;S?s--:s++)p=y[s],_>w?_%=w:_<0&&(_+=w),this._setGraphemeOnPath(_,p,C),_+=p.kernedWidth}return{width:a,numOfSpaces:m}},_setGraphemeOnPath:function(r,a,s){var u=r+a.kernedWidth/2,d=this.path,h=i.util.getPointOnPath(d.path,u,d.segmentsInfo);a.renderLeft=h.x-s.x,a.renderTop=h.y-s.y,a.angle=h.angle+(this.pathSide==="right"?Math.PI:0)},_getGraphemeBox:function(r,a,s,u,d){var h=this.getCompleteStyleDeclaration(a,s),p=u?this.getCompleteStyleDeclaration(a,s-1):{},m=this._measureChar(r,h,u,p),y=m.kernedWidth,_=m.width,C;this.charSpacing!==0&&(C=this._getWidthOfCharSpacing(),_+=C,y+=C);var w={width:_,left:0,height:h.fontSize,kernedWidth:y,deltaY:h.deltaY};if(s>0&&!d){var b=this.__charBounds[a][s-1];w.left=b.left+b.width+m.kernedWidth-m.width}return w},getHeightOfLine:function(r){if(this.__lineHeights[r])return this.__lineHeights[r];for(var a=this._textLines[r],s=this.getHeightOfChar(r,0),u=1,d=a.length;u<d;u++)s=Math.max(this.getHeightOfChar(r,u),s);return this.__lineHeights[r]=s*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var r,a=0,s=0,u=this._textLines.length;s<u;s++)r=this.getHeightOfLine(s),a+=s===u-1?r/this.lineHeight:r;return a},_getLeftOffset:function(){return this.direction==="ltr"?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(r,a){r.save();for(var s=0,u=this._getLeftOffset(),d=this._getTopOffset(),h=0,p=this._textLines.length;h<p;h++){var m=this.getHeightOfLine(h),y=m/this.lineHeight,_=this._getLineLeftOffset(h);this._renderTextLine(a,r,this._textLines[h],u+_,d+s+y,h),s+=m}r.restore()},_renderTextFill:function(r){!this.fill&&!this.styleHas("fill")||this._renderTextCommon(r,"fillText")},_renderTextStroke:function(r){(!this.stroke||this.strokeWidth===0)&&this.isEmptyStyles()||(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(r),r.save(),this._setLineDash(r,this.strokeDashArray),r.beginPath(),this._renderTextCommon(r,"strokeText"),r.closePath(),r.restore())},_renderChars:function(r,a,s,u,d,h){var p=this.getHeightOfLine(h),m=this.textAlign.indexOf("justify")!==-1,y,_,C="",w,b=0,S,F=this.path,$=!m&&this.charSpacing===0&&this.isEmptyStyles(h)&&!F,Q=this.direction==="ltr",R=this.direction==="ltr"?1:-1,H,W=a.canvas.getAttribute("dir");if(a.save(),W!==this.direction&&(a.canvas.setAttribute("dir",Q?"ltr":"rtl"),a.direction=Q?"ltr":"rtl",a.textAlign=Q?"left":"right"),d-=p*this._fontSizeFraction/this.lineHeight,$){this._renderChar(r,a,h,0,s.join(""),u,d,p),a.restore();return}for(var G=0,V=s.length-1;G<=V;G++)S=G===V||this.charSpacing||F,C+=s[G],w=this.__charBounds[h][G],b===0?(u+=R*(w.kernedWidth-w.width),b+=w.width):b+=w.kernedWidth,m&&!S&&this._reSpaceAndTab.test(s[G])&&(S=!0),S||(y=y||this.getCompleteStyleDeclaration(h,G),_=this.getCompleteStyleDeclaration(h,G+1),S=i.util.hasStyleChanged(y,_,!1)),S&&(F?(a.save(),a.translate(w.renderLeft,w.renderTop),a.rotate(w.angle),this._renderChar(r,a,h,G,C,-b/2,0,p),a.restore()):(H=u,this._renderChar(r,a,h,G,C,H,d,p)),C="",y=_,u+=R*b,b=0);a.restore()},_applyPatternGradientTransformText:function(r){var a=i.util.createCanvasElement(),s,u=this.width+this.strokeWidth,d=this.height+this.strokeWidth;return a.width=u,a.height=d,s=a.getContext("2d"),s.beginPath(),s.moveTo(0,0),s.lineTo(u,0),s.lineTo(u,d),s.lineTo(0,d),s.closePath(),s.translate(u/2,d/2),s.fillStyle=r.toLive(s),this._applyPatternGradientTransform(s,r),s.fill(),s.createPattern(a,"no-repeat")},handleFiller:function(r,a,s){var u,d;return s.toLive?s.gradientUnits==="percentage"||s.gradientTransform||s.patternTransform?(u=-this.width/2,d=-this.height/2,r.translate(u,d),r[a]=this._applyPatternGradientTransformText(s),{offsetX:u,offsetY:d}):(r[a]=s.toLive(r,this),this._applyPatternGradientTransform(r,s)):(r[a]=s,{offsetX:0,offsetY:0})},_setStrokeStyles:function(r,a){return r.lineWidth=a.strokeWidth,r.lineCap=this.strokeLineCap,r.lineDashOffset=this.strokeDashOffset,r.lineJoin=this.strokeLineJoin,r.miterLimit=this.strokeMiterLimit,this.handleFiller(r,"strokeStyle",a.stroke)},_setFillStyles:function(r,a){return this.handleFiller(r,"fillStyle",a.fill)},_renderChar:function(r,a,s,u,d,h,p){var m=this._getStyleDeclaration(s,u),y=this.getCompleteStyleDeclaration(s,u),_=r==="fillText"&&y.fill,C=r==="strokeText"&&y.stroke&&y.strokeWidth,w,b;!C&&!_||(a.save(),_&&(w=this._setFillStyles(a,y)),C&&(b=this._setStrokeStyles(a,y)),a.font=this._getFontDeclaration(y),m&&m.textBackgroundColor&&this._removeShadow(a),m&&m.deltaY&&(p+=m.deltaY),_&&a.fillText(d,h-w.offsetX,p-w.offsetY),C&&a.strokeText(d,h-b.offsetX,p-b.offsetY),a.restore())},setSuperscript:function(r,a){return this._setScript(r,a,this.superscript)},setSubscript:function(r,a){return this._setScript(r,a,this.subscript)},_setScript:function(r,a,s){var u=this.get2DCursorLocation(r,!0),d=this.getValueOfPropertyAt(u.lineIndex,u.charIndex,"fontSize"),h=this.getValueOfPropertyAt(u.lineIndex,u.charIndex,"deltaY"),p={fontSize:d*s.size,deltaY:h+d*s.baseline};return this.setSelectionStyles(p,r,a),this},_getLineLeftOffset:function(r){var a=this.getLineWidth(r),s=this.width-a,u=this.textAlign,d=this.direction,p,h=0,p=this.isEndOfWrapping(r);return u==="justify"||u==="justify-center"&&!p||u==="justify-right"&&!p||u==="justify-left"&&!p?0:(u==="center"&&(h=s/2),u==="right"&&(h=s),u==="justify-center"&&(h=s/2),u==="justify-right"&&(h=s),d==="rtl"&&(h-=s),h)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var r=this._forceClearCache;return r||(r=this.hasStateChanged("_dimensionAffectingProps")),r&&(this.dirty=!0,this._forceClearCache=!1),r},getLineWidth:function(r){if(this.__lineWidths[r]!==void 0)return this.__lineWidths[r];var a=this.measureLine(r),s=a.width;return this.__lineWidths[r]=s,s},_getWidthOfCharSpacing:function(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(r,a,s){var u=this._getStyleDeclaration(r,a);return u&&typeof u[s]!="undefined"?u[s]:this[s]},_renderTextDecoration:function(r,a){if(!(!this[a]&&!this.styleHas(a))){for(var s,u,d,h,p,m,y,_,C=this._getLeftOffset(),w=this._getTopOffset(),b,S,F,$,Q,R,H,W,G=this.path,V=this._getWidthOfCharSpacing(),st=this.offsets[a],et=0,x=this._textLines.length;et<x;et++){if(s=this.getHeightOfLine(et),!this[a]&&!this.styleHas(a,et)){w+=s;continue}y=this._textLines[et],R=s/this.lineHeight,h=this._getLineLeftOffset(et),S=0,F=0,_=this.getValueOfPropertyAt(et,0,a),W=this.getValueOfPropertyAt(et,0,"fill"),b=w+R*(1-this._fontSizeFraction),u=this.getHeightOfChar(et,0),p=this.getValueOfPropertyAt(et,0,"deltaY");for(var B=0,k=y.length;B<k;B++)if($=this.__charBounds[et][B],Q=this.getValueOfPropertyAt(et,B,a),H=this.getValueOfPropertyAt(et,B,"fill"),d=this.getHeightOfChar(et,B),m=this.getValueOfPropertyAt(et,B,"deltaY"),G&&Q&&H)r.save(),r.fillStyle=W,r.translate($.renderLeft,$.renderTop),r.rotate($.angle),r.fillRect(-$.kernedWidth/2,st*d+m,$.kernedWidth,this.fontSize/15),r.restore();else if((Q!==_||H!==W||d!==u||m!==p)&&F>0){var D=C+h+S;this.direction==="rtl"&&(D=this.width-D-F),_&&W&&(r.fillStyle=W,r.fillRect(D,b+st*u+p,F,this.fontSize/15)),S=$.left,F=$.width,_=Q,W=H,u=d,p=m}else F+=$.kernedWidth;var D=C+h+S;this.direction==="rtl"&&(D=this.width-D-F),r.fillStyle=H,Q&&H&&r.fillRect(D,b+st*u+p,F-V,this.fontSize/15),w+=s}this._removeShadow(r)}},_getFontDeclaration:function(r,a){var s=r||this,u=this.fontFamily,d=i.Text.genericFonts.indexOf(u.toLowerCase())>-1,h=u===void 0||u.indexOf("'")>-1||u.indexOf(",")>-1||u.indexOf('"')>-1||d?s.fontFamily:'"'+s.fontFamily+'"';return[i.isLikelyNode?s.fontWeight:s.fontStyle,i.isLikelyNode?s.fontStyle:s.fontWeight,a?this.CACHE_FONT_SIZE+"px":s.fontSize+"px",h].join(" ")},render:function(r){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",r)))},_splitTextIntoLines:function(r){for(var a=r.split(this._reNewline),s=new Array(a.length),u=[`
`],d=[],h=0;h<a.length;h++)s[h]=i.util.string.graphemeSplit(a[h]),d=d.concat(s[h],u);return d.pop(),{_unwrappedLines:s,lines:a,graphemeText:d,graphemeLines:s}},toObject:function(r){var a=l.concat(r),s=this.callSuper("toObject",a);return s.styles=i.util.stylesToArray(this.styles,this.text),s.path&&(s.path=this.path.toObject()),s},set:function(r,a){this.callSuper("set",r,a);var s=!1,u=!1;if(typeof r=="object")for(var d in r)d==="path"&&this.setPathInfo(),s=s||this._dimensionAffectingProps.indexOf(d)!==-1,u=u||d==="path";else s=this._dimensionAffectingProps.indexOf(r)!==-1,u=r==="path";return u&&this.setPathInfo(),s&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),i.Text.ATTRIBUTE_NAMES=i.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),i.Text.DEFAULT_SVG_FONT_SIZE=16,i.Text.fromElement=function(r,a,s){if(!r)return a(null);var u=i.parseAttributes(r,i.Text.ATTRIBUTE_NAMES),d=u.textAnchor||"left";if(s=i.util.object.extend(s?c(s):{},u),s.top=s.top||0,s.left=s.left||0,u.textDecoration){var h=u.textDecoration;h.indexOf("underline")!==-1&&(s.underline=!0),h.indexOf("overline")!==-1&&(s.overline=!0),h.indexOf("line-through")!==-1&&(s.linethrough=!0),delete s.textDecoration}"dx"in u&&(s.left+=u.dx),"dy"in u&&(s.top+=u.dy),"fontSize"in s||(s.fontSize=i.Text.DEFAULT_SVG_FONT_SIZE);var p="";"textContent"in r?p=r.textContent:"firstChild"in r&&r.firstChild!==null&&"data"in r.firstChild&&r.firstChild.data!==null&&(p=r.firstChild.data),p=p.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var m=s.strokeWidth;s.strokeWidth=0;var y=new i.Text(p,s),_=y.getScaledHeight()/y.height,C=(y.height+y.strokeWidth)*y.lineHeight-y.height,w=C*_,b=y.getScaledHeight()+w,S=0;d==="center"&&(S=y.getScaledWidth()/2),d==="right"&&(S=y.getScaledWidth()),y.set({left:y.left-S,top:y.top-(b-y.fontSize*(.07+y._fontSizeFraction))/y.lineHeight,strokeWidth:typeof m!="undefined"?m:1}),a(y)},i.Text.fromObject=function(r,a){var s=c(r),u=r.path;return delete s.path,i.Object._fromObject("Text",s,function(d){d.styles=i.util.stylesFromArray(r.styles,r.text),u?i.Object._fromObject("Path",u,function(h){d.set("path",h),a(d)},"path"):a(d)},"text")},i.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],i.util.createAccessors&&i.util.createAccessors(i.Text)}(e),function(){t.util.object.extend(t.Text.prototype,{isEmptyStyles:function(f){if(!this.styles||typeof f!="undefined"&&!this.styles[f])return!0;var i=typeof f=="undefined"?this.styles:{line:this.styles[f]};for(var c in i)for(var l in i[c])for(var r in i[c][l])return!1;return!0},styleHas:function(f,i){if(!this.styles||!f||f===""||typeof i!="undefined"&&!this.styles[i])return!1;var c=typeof i=="undefined"?this.styles:{0:this.styles[i]};for(var l in c)for(var r in c[l])if(typeof c[l][r][f]!="undefined")return!0;return!1},cleanStyle:function(f){if(!this.styles||!f||f==="")return!1;var i=this.styles,c=0,l,r,a=!0,s=0,u;for(var d in i){l=0;for(var h in i[d]){var u=i[d][h],p=u.hasOwnProperty(f);c++,p?(r?u[f]!==r&&(a=!1):r=u[f],u[f]===this[f]&&delete u[f]):a=!1,Object.keys(u).length!==0?l++:delete i[d][h]}l===0&&delete i[d]}for(var m=0;m<this._textLines.length;m++)s+=this._textLines[m].length;a&&c===s&&(this[f]=r,this.removeStyle(f))},removeStyle:function(f){if(!(!this.styles||!f||f==="")){var i=this.styles,c,l,r;for(l in i){c=i[l];for(r in c)delete c[r][f],Object.keys(c[r]).length===0&&delete c[r];Object.keys(c).length===0&&delete i[l]}}},_extendStyles:function(f,i){var c=this.get2DCursorLocation(f);this._getLineStyle(c.lineIndex)||this._setLineStyle(c.lineIndex),this._getStyleDeclaration(c.lineIndex,c.charIndex)||this._setStyleDeclaration(c.lineIndex,c.charIndex,{}),t.util.object.extend(this._getStyleDeclaration(c.lineIndex,c.charIndex),i)},get2DCursorLocation:function(f,i){typeof f=="undefined"&&(f=this.selectionStart);for(var c=i?this._unwrappedTextLines:this._textLines,l=c.length,r=0;r<l;r++){if(f<=c[r].length)return{lineIndex:r,charIndex:f};f-=c[r].length+this.missingNewlineOffset(r)}return{lineIndex:r-1,charIndex:c[r-1].length<f?c[r-1].length:f}},getSelectionStyles:function(f,i,c){typeof f=="undefined"&&(f=this.selectionStart||0),typeof i=="undefined"&&(i=this.selectionEnd||f);for(var l=[],r=f;r<i;r++)l.push(this.getStyleAtPosition(r,c));return l},getStyleAtPosition:function(f,i){var c=this.get2DCursorLocation(f),l=i?this.getCompleteStyleDeclaration(c.lineIndex,c.charIndex):this._getStyleDeclaration(c.lineIndex,c.charIndex);return l||{}},setSelectionStyles:function(f,i,c){typeof i=="undefined"&&(i=this.selectionStart||0),typeof c=="undefined"&&(c=this.selectionEnd||i);for(var l=i;l<c;l++)this._extendStyles(l,f);return this._forceClearCache=!0,this},_getStyleDeclaration:function(f,i){var c=this.styles&&this.styles[f];return c?c[i]:null},getCompleteStyleDeclaration:function(f,i){for(var c=this._getStyleDeclaration(f,i)||{},l={},r,a=0;a<this._styleProperties.length;a++)r=this._styleProperties[a],l[r]=typeof c[r]=="undefined"?this[r]:c[r];return l},_setStyleDeclaration:function(f,i,c){this.styles[f][i]=c},_deleteStyleDeclaration:function(f,i){delete this.styles[f][i]},_getLineStyle:function(f){return!!this.styles[f]},_setLineStyle:function(f){this.styles[f]={}},_deleteLineStyle:function(f){delete this.styles[f]}})}(),function(){function f(i){i.textDecoration&&(i.textDecoration.indexOf("underline")>-1&&(i.underline=!0),i.textDecoration.indexOf("line-through")>-1&&(i.linethrough=!0),i.textDecoration.indexOf("overline")>-1&&(i.overline=!0),delete i.textDecoration)}t.IText=t.util.createClass(t.Text,t.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(i,c){this.callSuper("initialize",i,c),this.initBehavior()},setSelectionStart:function(i){i=Math.max(i,0),this._updateAndFire("selectionStart",i)},setSelectionEnd:function(i){i=Math.min(i,this.text.length),this._updateAndFire("selectionEnd",i)},_updateAndFire:function(i,c){this[i]!==c&&(this._fireSelectionChanged(),this[i]=c),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(i){this.clearContextTop(),this.callSuper("render",i),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(i){this.callSuper("_render",i)},clearContextTop:function(i){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var c=this.canvas.contextTop,l=this.canvas.viewportTransform;c.save(),c.transform(l[0],l[1],l[2],l[3],l[4],l[5]),this.transform(c),this._clearTextArea(c),i||c.restore()}},renderCursorOrSelection:function(){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var i=this._getCursorBoundaries(),c=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(i,c):this.renderSelection(i,c),c.restore()}},_clearTextArea:function(i){var c=this.width+4,l=this.height+4;i.clearRect(-c/2,-l/2,c,l)},_getCursorBoundaries:function(i){typeof i=="undefined"&&(i=this.selectionStart);var c=this._getLeftOffset(),l=this._getTopOffset(),r=this._getCursorBoundariesOffsets(i);return{left:c,top:l,leftOffset:r.left,topOffset:r.top}},_getCursorBoundariesOffsets:function(i){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var c,l,r,a=0,s=0,u,d=this.get2DCursorLocation(i);r=d.charIndex,l=d.lineIndex;for(var h=0;h<l;h++)a+=this.getHeightOfLine(h);c=this._getLineLeftOffset(l);var p=this.__charBounds[l][r];return p&&(s=p.left),this.charSpacing!==0&&r===this._textLines[l].length&&(s-=this._getWidthOfCharSpacing()),u={top:a,left:c+(s>0?s:0)},this.direction==="rtl"&&(u.left*=-1),this.cursorOffsetCache=u,this.cursorOffsetCache},renderCursor:function(i,c){var l=this.get2DCursorLocation(),r=l.lineIndex,a=l.charIndex>0?l.charIndex-1:0,s=this.getValueOfPropertyAt(r,a,"fontSize"),u=this.scaleX*this.canvas.getZoom(),d=this.cursorWidth/u,h=i.topOffset,p=this.getValueOfPropertyAt(r,a,"deltaY");h+=(1-this._fontSizeFraction)*this.getHeightOfLine(r)/this.lineHeight-s*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(i,c),c.fillStyle=this.cursorColor||this.getValueOfPropertyAt(r,a,"fill"),c.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,c.fillRect(i.left+i.leftOffset-d/2,h+i.top+p,d,s)},renderSelection:function(i,c){for(var l=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,r=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,a=this.textAlign.indexOf("justify")!==-1,s=this.get2DCursorLocation(l),u=this.get2DCursorLocation(r),d=s.lineIndex,h=u.lineIndex,p=s.charIndex<0?0:s.charIndex,m=u.charIndex<0?0:u.charIndex,y=d;y<=h;y++){var _=this._getLineLeftOffset(y)||0,C=this.getHeightOfLine(y),w=0,b=0,S=0;if(y===d&&(b=this.__charBounds[d][p].left),y>=d&&y<h)S=a&&!this.isEndOfWrapping(y)?this.width:this.getLineWidth(y)||5;else if(y===h)if(m===0)S=this.__charBounds[h][m].left;else{var F=this._getWidthOfCharSpacing();S=this.__charBounds[h][m-1].left+this.__charBounds[h][m-1].width-F}w=C,(this.lineHeight<1||y===h&&this.lineHeight>1)&&(C/=this.lineHeight);var $=i.left+_+b,Q=S-b,R=C,H=0;this.inCompositionMode?(c.fillStyle=this.compositionColor||"black",R=1,H=C):c.fillStyle=this.selectionColor,this.direction==="rtl"&&($=this.width-$-Q),c.fillRect($,i.top+i.topOffset+H,Q,R),i.topOffset+=w}},getCurrentCharFontSize:function(){var i=this._getCurrentCharIndex();return this.getValueOfPropertyAt(i.l,i.c,"fontSize")},getCurrentCharColor:function(){var i=this._getCurrentCharIndex();return this.getValueOfPropertyAt(i.l,i.c,"fill")},_getCurrentCharIndex:function(){var i=this.get2DCursorLocation(this.selectionStart,!0),c=i.charIndex>0?i.charIndex-1:0;return{l:i.lineIndex,c}}}),t.IText.fromObject=function(i,c){var l=t.util.stylesFromArray(i.styles,i.text),r=Object.assign({},i,{styles:l});if(f(r),r.styles)for(var a in r.styles)for(var s in r.styles[a])f(r.styles[a][s]);t.Object._fromObject("IText",r,c,"text")}}(),function(){var f=t.util.object.clone;t.util.object.extend(t.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var i=this;this.on("added",function(){var c=i.canvas;c&&(c._hasITextHandlers||(c._hasITextHandlers=!0,i._initCanvasHandlers(c)),c._iTextInstances=c._iTextInstances||[],c._iTextInstances.push(i))})},initRemovedHandler:function(){var i=this;this.on("removed",function(){var c=i.canvas;c&&(c._iTextInstances=c._iTextInstances||[],t.util.removeFromArray(c._iTextInstances,i),c._iTextInstances.length===0&&(c._hasITextHandlers=!1,i._removeCanvasHandlers(c)))})},_initCanvasHandlers:function(i){i._mouseUpITextHandler=function(){i._iTextInstances&&i._iTextInstances.forEach(function(c){c.__isMousedown=!1})},i.on("mouse:up",i._mouseUpITextHandler)},_removeCanvasHandlers:function(i){i.off("mouse:up",i._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(i,c,l,r){var a;return a={isAborted:!1,abort:function(){this.isAborted=!0}},i.animate("_currentCursorOpacity",c,{duration:l,onComplete:function(){a.isAborted||i[r]()},onChange:function(){i.canvas&&i.selectionStart===i.selectionEnd&&i.renderCursorOrSelection()},abort:function(){return a.isAborted}}),a},_onTickComplete:function(){var i=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){i._currentTickCompleteState=i._animateCursor(i,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(i){var c=this,l=i?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){c._tick()},l)},abortCursorAnimation:function(){var i=this._currentTickState||this._currentTickCompleteState,c=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,i&&c&&c.clearContext(c.contextTop||c.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(i){var c=0,l=i-1;if(this._reSpace.test(this._text[l]))for(;this._reSpace.test(this._text[l]);)c++,l--;for(;/\S/.test(this._text[l])&&l>-1;)c++,l--;return i-c},findWordBoundaryRight:function(i){var c=0,l=i;if(this._reSpace.test(this._text[l]))for(;this._reSpace.test(this._text[l]);)c++,l++;for(;/\S/.test(this._text[l])&&l<this._text.length;)c++,l++;return i+c},findLineBoundaryLeft:function(i){for(var c=0,l=i-1;!/\n/.test(this._text[l])&&l>-1;)c++,l--;return i-c},findLineBoundaryRight:function(i){for(var c=0,l=i;!/\n/.test(this._text[l])&&l<this._text.length;)c++,l++;return i+c},searchWordBoundary:function(i,c){for(var l=this._text,r=this._reSpace.test(l[i])?i-1:i,a=l[r],s=t.reNonWord;!s.test(a)&&r>0&&r<l.length;)r+=c,a=l[r];return s.test(a)&&(r+=c===1?0:1),r},selectWord:function(i){i=i||this.selectionStart;var c=this.searchWordBoundary(i,-1),l=this.searchWordBoundary(i,1);this.selectionStart=c,this.selectionEnd=l,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(i){i=i||this.selectionStart;var c=this.findLineBoundaryLeft(i),l=this.findLineBoundaryRight(i);return this.selectionStart=c,this.selectionEnd=l,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(i){if(!(this.isEditing||!this.editable))return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(i),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(i){i._iTextInstances&&i._iTextInstances.forEach(function(c){c.selected=!1,c.isEditing&&c.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(i){if(!(!this.__isMousedown||!this.isEditing)){document.activeElement!==this.hiddenTextarea&&this.hiddenTextarea.focus();var c=this.getSelectionStartFromPointer(i.e),l=this.selectionStart,r=this.selectionEnd;(c!==this.__selectionStartOnMouseDown||l===r)&&(l===c||r===c)||(c>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=c):(this.selectionStart=c,this.selectionEnd=this.__selectionStartOnMouseDown),(this.selectionStart!==l||this.selectionEnd!==r)&&(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(i,c,l){var r=l.slice(0,i),a=t.util.string.graphemeSplit(r).length;if(i===c)return{selectionStart:a,selectionEnd:a};var s=l.slice(i,c),u=t.util.string.graphemeSplit(s).length;return{selectionStart:a,selectionEnd:a+u}},fromGraphemeToStringSelection:function(i,c,l){var r=l.slice(0,i),a=r.join("").length;if(i===c)return{selectionStart:a,selectionEnd:a};var s=l.slice(i,c),u=s.join("").length;return{selectionStart:a,selectionEnd:a+u}},_updateTextarea:function(){if(this.cursorOffsetCache={},!!this.hiddenTextarea){if(!this.inCompositionMode){var i=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=i.selectionStart,this.hiddenTextarea.selectionEnd=i.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var i=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=i.selectionEnd,this.inCompositionMode||(this.selectionStart=i.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var i=this._calcTextareaPosition();this.hiddenTextarea.style.left=i.left,this.hiddenTextarea.style.top=i.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var i=this.inCompositionMode?this.compositionStart:this.selectionStart,c=this._getCursorBoundaries(i),l=this.get2DCursorLocation(i),r=l.lineIndex,a=l.charIndex,s=this.getValueOfPropertyAt(r,a,"fontSize")*this.lineHeight,u=c.leftOffset,d=this.calcTransformMatrix(),h={x:c.left+u,y:c.top+c.topOffset+s},p=this.canvas.getRetinaScaling(),m=this.canvas.upperCanvasEl,y=m.width/p,_=m.height/p,C=y-s,w=_-s,b=m.clientWidth/y,S=m.clientHeight/_;return h=t.util.transformPoint(h,d),h=t.util.transformPoint(h,this.canvas.viewportTransform),h.x*=b,h.y*=S,h.x<0&&(h.x=0),h.x>C&&(h.x=C),h.y<0&&(h.y=0),h.y>w&&(h.y=w),h.x+=this.canvas._offset.left,h.y+=this.canvas._offset.top,{left:h.x+"px",top:h.y+"px",fontSize:s+"px",charHeight:s}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var i=this._textBeforeEdit!==this.text,c=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,c&&(c.blur&&c.blur(),c.parentNode&&c.parentNode.removeChild(c)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),i&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),i&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var i in this.styles)this._textLines[i]||delete this.styles[i]},removeStyleFromTo:function(i,c){var l=this.get2DCursorLocation(i,!0),r=this.get2DCursorLocation(c,!0),a=l.lineIndex,s=l.charIndex,u=r.lineIndex,d=r.charIndex,h,p;if(a!==u){if(this.styles[a])for(h=s;h<this._unwrappedTextLines[a].length;h++)delete this.styles[a][h];if(this.styles[u])for(h=d;h<this._unwrappedTextLines[u].length;h++)p=this.styles[u][h],p&&(this.styles[a]||(this.styles[a]={}),this.styles[a][s+h-d]=p);for(h=a+1;h<=u;h++)delete this.styles[h];this.shiftLineStyles(u,a-u)}else if(this.styles[a]){p=this.styles[a];var m=d-s,y,_;for(h=s;h<d;h++)delete p[h];for(_ in this.styles[a])y=parseInt(_,10),y>=d&&(p[y-m]=p[_],delete p[_])}},shiftLineStyles:function(i,c){var l=f(this.styles);for(var r in this.styles){var a=parseInt(r,10);a>i&&(this.styles[a+c]=l[a],l[a-c]||delete this.styles[a])}},restartCursorIfNeeded:function(){(!this._currentTickState||this._currentTickState.isAborted||!this._currentTickCompleteState||this._currentTickCompleteState.isAborted)&&this.initDelayedCursor()},insertNewlineStyleObject:function(i,c,l,r){var a,s={},u=!1,d=this._unwrappedTextLines[i].length===c;l||(l=1),this.shiftLineStyles(i,l),this.styles[i]&&(a=this.styles[i][c===0?c:c-1]);for(var h in this.styles[i]){var p=parseInt(h,10);p>=c&&(u=!0,s[p-c]=this.styles[i][h],d&&c===0||delete this.styles[i][h])}var m=!1;for(u&&!d&&(this.styles[i+l]=s,m=!0),m&&l--;l>0;)r&&r[l-1]?this.styles[i+l]={0:f(r[l-1])}:a?this.styles[i+l]={0:f(a)}:delete this.styles[i+l],l--;this._forceClearCache=!0},insertCharStyleObject:function(i,c,l,r){this.styles||(this.styles={});var a=this.styles[i],s=a?f(a):{};l||(l=1);for(var u in s){var d=parseInt(u,10);d>=c&&(a[d+l]=s[d],s[d-l]||delete a[d])}if(this._forceClearCache=!0,r){for(;l--;)Object.keys(r[l]).length&&(this.styles[i]||(this.styles[i]={}),this.styles[i][c+l]=f(r[l]));return}if(a)for(var h=a[c?c-1:1];h&&l--;)this.styles[i][c+l]=f(h)},insertNewStyleBlock:function(i,c,l){for(var r=this.get2DCursorLocation(c,!0),a=[0],s=0,u=0;u<i.length;u++)i[u]===`
`?(s++,a[s]=0):a[s]++;a[0]>0&&(this.insertCharStyleObject(r.lineIndex,r.charIndex,a[0],l),l=l&&l.slice(a[0]+1)),s&&this.insertNewlineStyleObject(r.lineIndex,r.charIndex+a[0],s);for(var u=1;u<s;u++)a[u]>0?this.insertCharStyleObject(r.lineIndex+u,0,a[u],l):l&&this.styles[r.lineIndex+u]&&l[0]&&(this.styles[r.lineIndex+u][0]=l[0]),l=l&&l.slice(a[u]+1);a[u]>0&&this.insertCharStyleObject(r.lineIndex+u,0,a[u],l)},setSelectionStartEndWithShift:function(i,c,l){l<=i?(c===i?this._selectionDirection="left":this._selectionDirection==="right"&&(this._selectionDirection="left",this.selectionEnd=i),this.selectionStart=l):l>i&&l<c?this._selectionDirection==="right"?this.selectionEnd=l:this.selectionStart=l:(c===i?this._selectionDirection="right":this._selectionDirection==="left"&&(this._selectionDirection="right",this.selectionStart=c),this.selectionEnd=l)},setSelectionInBoundaries:function(){var i=this.text.length;this.selectionStart>i?this.selectionStart=i:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>i?this.selectionEnd=i:this.selectionEnd<0&&(this.selectionEnd=0)}})}(),t.util.object.extend(t.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(f){if(this.canvas){this.__newClickTime=+new Date;var i=f.pointer;this.isTripleClick(i)&&(this.fire("tripleclick",f),this._stopEvent(f.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=i,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(f){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===f.x&&this.__lastPointer.y===f.y},_stopEvent:function(f){f.preventDefault&&f.preventDefault(),f.stopPropagation&&f.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(f){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(f.e))},tripleClickHandler:function(f){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(f.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(f){!this.canvas||!this.editable||f.e.button&&f.e.button!==1||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(f.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(f){!this.canvas||!this.editable||f.e.button&&f.e.button!==1||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(f){if(this.__isMousedown=!1,!(!this.editable||this.group||f.transform&&f.transform.actionPerformed||f.e.button&&f.e.button!==1)){if(this.canvas){var i=this.canvas._activeObject;if(i&&i!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(f.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(f){var i=this.getSelectionStartFromPointer(f),c=this.selectionStart,l=this.selectionEnd;f.shiftKey?this.setSelectionStartEndWithShift(c,l,i):(this.selectionStart=i,this.selectionEnd=i),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(f){for(var i=this.getLocalPointer(f),c=0,l=0,r=0,a=0,s=0,u,d,h=0,p=this._textLines.length;h<p&&r<=i.y;h++)r+=this.getHeightOfLine(h)*this.scaleY,s=h,h>0&&(a+=this._textLines[h-1].length+this.missingNewlineOffset(h-1));u=this._getLineLeftOffset(s),l=u*this.scaleX,d=this._textLines[s],this.direction==="rtl"&&(i.x=this.width*this.scaleX-i.x+l);for(var m=0,y=d.length;m<y&&(c=l,l+=this.__charBounds[s][m].kernedWidth*this.scaleX,l<=i.x);m++)a++;return this._getNewSelectionStartFromOffset(i,c,l,a,y)},_getNewSelectionStartFromOffset:function(f,i,c,l,r){var a=f.x-i,s=c-f.x,u=s>a||s<0?0:1,d=l+u;return this.flipX&&(d=r-d),d>this._text.length&&(d=this._text.length),d}}),t.util.object.extend(t.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=t.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var f=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+f.top+"; left: "+f.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: "+f.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):t.document.body.appendChild(this.hiddenTextarea),t.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),t.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),t.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),t.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),t.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),t.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),t.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),t.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),t.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(t.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(f){if(this.isEditing){var i=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(f.keyCode in i)this[i[f.keyCode]](f);else if(f.keyCode in this.ctrlKeysMapDown&&(f.ctrlKey||f.metaKey))this[this.ctrlKeysMapDown[f.keyCode]](f);else return;f.stopImmediatePropagation(),f.preventDefault(),f.keyCode>=33&&f.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(f){if(!this.isEditing||this._copyDone||this.inCompositionMode){this._copyDone=!1;return}if(f.keyCode in this.ctrlKeysMapUp&&(f.ctrlKey||f.metaKey))this[this.ctrlKeysMapUp[f.keyCode]](f);else return;f.stopImmediatePropagation(),f.preventDefault(),this.canvas&&this.canvas.requestRenderAll()},onInput:function(f){var i=this.fromPaste;if(this.fromPaste=!1,f&&f.stopPropagation(),!!this.isEditing){var c=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,l=this._text.length,r=c.length,a,s,u=r-l,d=this.selectionStart,h=this.selectionEnd,p=d!==h,m,y,_;if(this.hiddenTextarea.value===""){this.styles={},this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll());return}var C=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),w=d>C.selectionStart;p?(a=this._text.slice(d,h),u+=h-d):r<l&&(w?a=this._text.slice(h+u,h):a=this._text.slice(d,d-u)),s=c.slice(C.selectionEnd-u,C.selectionEnd),a&&a.length&&(s.length&&(m=this.getSelectionStyles(d,d+1,!1),m=s.map(function(){return m[0]})),p?(y=d,_=h):w?(y=h-a.length,_=h):(y=h,_=h+a.length),this.removeStyleFromTo(y,_)),s.length&&(i&&s.join("")===t.copiedText&&!t.disableStyleCopyPaste&&(m=t.copiedTextStyle),this.insertNewStyleBlock(s,d,m)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(f){this.compositionStart=f.target.selectionStart,this.compositionEnd=f.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(t.copiedText=this.getSelectedText(),t.disableStyleCopyPaste?t.copiedTextStyle=null:t.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(f){return f&&f.clipboardData||t.window.clipboardData},_getWidthBeforeCursor:function(f,i){var c=this._getLineLeftOffset(f),l;return i>0&&(l=this.__charBounds[f][i-1],c+=l.left+l.width),c},getDownCursorOffset:function(f,i){var c=this._getSelectionForOffset(f,i),l=this.get2DCursorLocation(c),r=l.lineIndex;if(r===this._textLines.length-1||f.metaKey||f.keyCode===34)return this._text.length-c;var a=l.charIndex,s=this._getWidthBeforeCursor(r,a),u=this._getIndexOnLine(r+1,s),d=this._textLines[r].slice(a);return d.length+u+1+this.missingNewlineOffset(r)},_getSelectionForOffset:function(f,i){return f.shiftKey&&this.selectionStart!==this.selectionEnd&&i?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(f,i){var c=this._getSelectionForOffset(f,i),l=this.get2DCursorLocation(c),r=l.lineIndex;if(r===0||f.metaKey||f.keyCode===33)return-c;var a=l.charIndex,s=this._getWidthBeforeCursor(r,a),u=this._getIndexOnLine(r-1,s),d=this._textLines[r].slice(0,a),h=this.missingNewlineOffset(r-1);return-this._textLines[r-1].length+u-d.length+(1-h)},_getIndexOnLine:function(f,i){for(var c=this._textLines[f],l=this._getLineLeftOffset(f),r=l,a=0,s,u,d=0,h=c.length;d<h;d++)if(s=this.__charBounds[f][d].width,r+=s,r>i){u=!0;var p=r-s,m=r,y=Math.abs(p-i),_=Math.abs(m-i);a=_<y?d:d-1;break}return u||(a=c.length-1),a},moveCursorDown:function(f){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",f)},moveCursorUp:function(f){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",f)},_moveCursorUpOrDown:function(f,i){var c="get"+f+"CursorOffset",l=this[c](i,this._selectionDirection==="right");i.shiftKey?this.moveCursorWithShift(l):this.moveCursorWithoutShift(l),l!==0&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(f){var i=this._selectionDirection==="left"?this.selectionStart+f:this.selectionEnd+f;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,i),f!==0},moveCursorWithoutShift:function(f){return f<0?(this.selectionStart+=f,this.selectionEnd=this.selectionStart):(this.selectionEnd+=f,this.selectionStart=this.selectionEnd),f!==0},moveCursorLeft:function(f){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",f)},_move:function(f,i,c){var l;if(f.altKey)l=this["findWordBoundary"+c](this[i]);else if(f.metaKey||f.keyCode===35||f.keyCode===36)l=this["findLineBoundary"+c](this[i]);else return this[i]+=c==="Left"?-1:1,!0;if(typeof l!="undefined"&&this[i]!==l)return this[i]=l,!0},_moveLeft:function(f,i){return this._move(f,i,"Left")},_moveRight:function(f,i){return this._move(f,i,"Right")},moveCursorLeftWithoutShift:function(f){var i=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(i=this._moveLeft(f,"selectionStart")),this.selectionEnd=this.selectionStart,i},moveCursorLeftWithShift:function(f){if(this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd)return this._moveLeft(f,"selectionEnd");if(this.selectionStart!==0)return this._selectionDirection="left",this._moveLeft(f,"selectionStart")},moveCursorRight:function(f){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",f)},_moveCursorLeftOrRight:function(f,i){var c="moveCursor"+f+"With";this._currentCursorOpacity=1,i.shiftKey?c+="Shift":c+="outShift",this[c](i)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(f){if(this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd)return this._moveRight(f,"selectionStart");if(this.selectionEnd!==this._text.length)return this._selectionDirection="right",this._moveRight(f,"selectionEnd")},moveCursorRightWithoutShift:function(f){var i=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(i=this._moveRight(f,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,i},removeChars:function(f,i){typeof i=="undefined"&&(i=f+1),this.removeStyleFromTo(f,i),this._text.splice(f,i-f),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(f,i,c,l){typeof l=="undefined"&&(l=c),l>c&&this.removeStyleFromTo(c,l);var r=t.util.string.graphemeSplit(f);this.insertNewStyleBlock(r,c,i),this._text=[].concat(this._text.slice(0,c),r,this._text.slice(l)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),function(){var f=t.util.toFixed,i=/  +/g;t.util.object.extend(t.Text.prototype,{_toSVG:function(){var c=this._getSVGLeftTopOffsets(),l=this._getSVGTextAndBg(c.textTop,c.textLeft);return this._wrapSVGTextAndBg(l)},toSVG:function(c){return this._createBaseSVGMarkup(this._toSVG(),{reviver:c,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(c){var l=!0,r=this.getSvgTextDecoration(this);return[c.textBgRects.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",r?'text-decoration="'+r+'" ':"",'style="',this.getSvgStyles(l),'"',this.addPaintOrder()," >",c.textSpans.join(""),`</text>
`]},_getSVGTextAndBg:function(c,l){var r=[],a=[],s=c,u;this._setSVGBg(a);for(var d=0,h=this._textLines.length;d<h;d++)u=this._getLineLeftOffset(d),(this.textBackgroundColor||this.styleHas("textBackgroundColor",d))&&this._setSVGTextLineBg(a,d,l+u,s),this._setSVGTextLineText(r,d,l+u,s),s+=this.getHeightOfLine(d);return{textSpans:r,textBgRects:a}},_createTextCharSpan:function(c,l,r,a){var s=c!==c.trim()||c.match(i),u=this.getSvgSpanStyles(l,s),d=u?'style="'+u+'"':"",h=l.deltaY,p="",m=t.Object.NUM_FRACTION_DIGITS;return h&&(p=' dy="'+f(h,m)+'" '),['<tspan x="',f(r,m),'" y="',f(a,m),'" ',p,d,">",t.util.string.escapeXml(c),"</tspan>"].join("")},_setSVGTextLineText:function(c,l,r,a){var s=this.getHeightOfLine(l),u=this.textAlign.indexOf("justify")!==-1,d,h,p="",m,y,_=0,C=this._textLines[l],w;a+=s*(1-this._fontSizeFraction)/this.lineHeight;for(var b=0,S=C.length-1;b<=S;b++)w=b===S||this.charSpacing,p+=C[b],m=this.__charBounds[l][b],_===0?(r+=m.kernedWidth-m.width,_+=m.width):_+=m.kernedWidth,u&&!w&&this._reSpaceAndTab.test(C[b])&&(w=!0),w||(d=d||this.getCompleteStyleDeclaration(l,b),h=this.getCompleteStyleDeclaration(l,b+1),w=t.util.hasStyleChanged(d,h,!0)),w&&(y=this._getStyleDeclaration(l,b)||{},c.push(this._createTextCharSpan(p,y,r,a)),p="",d=h,r+=_,_=0)},_pushTextBgRect:function(c,l,r,a,s,u){var d=t.Object.NUM_FRACTION_DIGITS;c.push("		<rect ",this._getFillAttributes(l),' x="',f(r,d),'" y="',f(a,d),'" width="',f(s,d),'" height="',f(u,d),`"></rect>
`)},_setSVGTextLineBg:function(c,l,r,a){for(var s=this._textLines[l],u=this.getHeightOfLine(l)/this.lineHeight,d=0,h=0,p,m,y=this.getValueOfPropertyAt(l,0,"textBackgroundColor"),_=0,C=s.length;_<C;_++)p=this.__charBounds[l][_],m=this.getValueOfPropertyAt(l,_,"textBackgroundColor"),m!==y?(y&&this._pushTextBgRect(c,y,r+h,a,d,u),h=p.left,d=p.width,y=m):d+=p.kernedWidth;m&&this._pushTextBgRect(c,m,r+h,a,d,u)},_getFillAttributes:function(c){var l=c&&typeof c=="string"?new t.Color(c):"";return!l||!l.getSource()||l.getAlpha()===1?'fill="'+c+'"':'opacity="'+l.getAlpha()+'" fill="'+l.setAlpha(1).toRgb()+'"'},_getSVGLineTopOffset:function(c){for(var l=0,r=0,a=0;a<c;a++)l+=this.getHeightOfLine(a);return r=this.getHeightOfLine(a),{lineTop:l,offset:(this._fontSizeMult-this._fontSizeFraction)*r/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(c){var l=t.Object.prototype.getSvgStyles.call(this,c);return l+" white-space: pre;"}})}(),function(f){var i=f.fabric||(f.fabric={});i.Textbox=i.util.createClass(i.IText,i.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:i.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(c){for(var l=0,r=0,a=0,s={},u=0;u<c.graphemeLines.length;u++)c.graphemeText[a]===`
`&&u>0?(r=0,a++,l++):!this.splitByGrapheme&&this._reSpaceAndTab.test(c.graphemeText[a])&&u>0&&(r++,a++),s[u]={line:l,offset:r},a+=c.graphemeLines[u].length,r+=c.graphemeLines[u].length;return s},styleHas:function(c,l){if(this._styleMap&&!this.isWrapping){var r=this._styleMap[l];r&&(l=r.line)}return i.Text.prototype.styleHas.call(this,c,l)},isEmptyStyles:function(c){if(!this.styles)return!0;var l=0,r=c+1,a,s,u=!1,d=this._styleMap[c],h=this._styleMap[c+1];d&&(c=d.line,l=d.offset),h&&(r=h.line,u=r===c,a=h.offset),s=typeof c=="undefined"?this.styles:{line:this.styles[c]};for(var p in s)for(var m in s[p])if(m>=l&&(!u||m<a))for(var y in s[p][m])return!1;return!0},_getStyleDeclaration:function(c,l){if(this._styleMap&&!this.isWrapping){var r=this._styleMap[c];if(!r)return null;c=r.line,l=r.offset+l}return this.callSuper("_getStyleDeclaration",c,l)},_setStyleDeclaration:function(c,l,r){var a=this._styleMap[c];c=a.line,l=a.offset+l,this.styles[c][l]=r},_deleteStyleDeclaration:function(c,l){var r=this._styleMap[c];c=r.line,l=r.offset+l,delete this.styles[c][l]},_getLineStyle:function(c){var l=this._styleMap[c];return!!this.styles[l.line]},_setLineStyle:function(c){var l=this._styleMap[c];this.styles[l.line]={}},_wrapText:function(c,l){var r=[],a;for(this.isWrapping=!0,a=0;a<c.length;a++)r=r.concat(this._wrapLine(c[a],a,l));return this.isWrapping=!1,r},_measureWord:function(c,l,r){var a=0,s,u=!0;r=r||0;for(var d=0,h=c.length;d<h;d++){var p=this._getGraphemeBox(c[d],l,d+r,s,u);a+=p.kernedWidth,s=c[d]}return a},_wrapLine:function(c,l,r,$){var s=0,u=this.splitByGrapheme,d=[],h=[],p=u?i.util.string.graphemeSplit(c):c.split(this._wordJoiners),m="",y=0,_=u?"":" ",C=0,w=0,b=0,S=!0,F=this._getWidthOfCharSpacing(),$=$||0;p.length===0&&p.push([]),r-=$;for(var Q=0;Q<p.length;Q++)m=u?p[Q]:i.util.string.graphemeSplit(p[Q]),C=this._measureWord(m,l,y),y+=m.length,s+=w+C-F,s>r&&!S?(d.push(h),h=[],s=C,S=!0):s+=F,!S&&!u&&h.push(_),h=h.concat(m),w=u?0:this._measureWord([_],l,y),y++,S=!1,C>b&&(b=C);return Q&&d.push(h),b+$>this.dynamicMinWidth&&(this.dynamicMinWidth=b-F+$),d},isEndOfWrapping:function(c){return!this._styleMap[c+1]||this._styleMap[c+1].line!==this._styleMap[c].line},missingNewlineOffset:function(c){return this.splitByGrapheme?this.isEndOfWrapping(c)?1:0:1},_splitTextIntoLines:function(c){for(var l=i.Text.prototype._splitTextIntoLines.call(this,c),r=this._wrapText(l.lines,this.width),a=new Array(r.length),s=0;s<r.length;s++)a[s]=r[s].join("");return l.lines=a,l.graphemeLines=r,l},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var c={};for(var l in this._styleMap)this._textLines[l]&&(c[this._styleMap[l].line]=1);for(var l in this.styles)c[l]||delete this.styles[l]},toObject:function(c){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(c))}}),i.Textbox.fromObject=function(c,l){var r=i.util.stylesFromArray(c.styles,c.text),a=Object.assign({},c,{styles:r});return i.Object._fromObject("Textbox",a,l,"text")}}(e),function(){var f=t.controlsUtils,i=f.scaleSkewCursorStyleHandler,c=f.scaleCursorStyleHandler,l=f.scalingEqually,r=f.scalingYOrSkewingX,a=f.scalingXOrSkewingY,s=f.scaleOrSkewActionName,u=t.Object.prototype.controls;if(u.ml=new t.Control({x:-.5,y:0,cursorStyleHandler:i,actionHandler:a,getActionName:s}),u.mr=new t.Control({x:.5,y:0,cursorStyleHandler:i,actionHandler:a,getActionName:s}),u.mb=new t.Control({x:0,y:.5,cursorStyleHandler:i,actionHandler:r,getActionName:s}),u.mt=new t.Control({x:0,y:-.5,cursorStyleHandler:i,actionHandler:r,getActionName:s}),u.tl=new t.Control({x:-.5,y:-.5,cursorStyleHandler:c,actionHandler:l}),u.tr=new t.Control({x:.5,y:-.5,cursorStyleHandler:c,actionHandler:l}),u.bl=new t.Control({x:-.5,y:.5,cursorStyleHandler:c,actionHandler:l}),u.br=new t.Control({x:.5,y:.5,cursorStyleHandler:c,actionHandler:l}),u.mtr=new t.Control({x:0,y:-.5,actionHandler:f.rotationWithSnapping,cursorStyleHandler:f.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),t.Textbox){var d=t.Textbox.prototype.controls={};d.mtr=u.mtr,d.tr=u.tr,d.br=u.br,d.tl=u.tl,d.bl=u.bl,d.mt=u.mt,d.mb=u.mb,d.mr=new t.Control({x:.5,y:0,actionHandler:f.changeWidth,cursorStyleHandler:i,actionName:"resizing"}),d.ml=new t.Control({x:-.5,y:0,actionHandler:f.changeWidth,cursorStyleHandler:i,actionName:"resizing"})}}()})(nt);var en=(e=>(e.EMPTY="",e.ONE="one",e.MULTI="multiple",e))(en||{}),xn=(e=>(e.ONE="selectOne",e.MULTI="selectMultiple",e.CANCEL="selectCancel",e))(xn||{});const op={SelectMode:en,SelectEvent:xn};function su(e){e&&e.forEach(t=>{t.objects?su(t.objects):t.type==="text"&&(t.type="textbox")})}class Ri{constructor(t,n){X(this,"canvas");X(this,"editor");X(this,"selectedMode");this.canvas=t,this.editor=n,this.selectedMode=en.EMPTY,this._initSelectEvent()}_initSelectEvent(){this.canvas.on("selection:created",()=>this._emitSelectEvent()),this.canvas.on("selection:updated",()=>this._emitSelectEvent()),this.canvas.on("selection:cleared",()=>this._emitSelectEvent())}_emitSelectEvent(){if(!this.canvas)throw TypeError("还未初始化");const t=this.canvas.getActiveObjects().filter(n=>!(n instanceof nt.fabric.GuideLine));t&&t.length===1?(this.selectedMode=en.ONE,this.editor.emit(xn.ONE,t)):t&&t.length>1?(this.selectedMode=en.MULTI,this.editor.emit(xn.MULTI,t)):this.editor.emit(xn.CANCEL)}getSelectMode(){return String(this.selectedMode)}insert(t){wo({accept:".json"}).then(n=>{if(n&&n.length>0){const o=n[0],g=new FileReader;g.readAsText(o,"UTF-8"),g.onload=()=>{this.loadJSON(g.result,t)}}})}loadJSON(t,n){const o=typeof t=="string"?JSON.parse(t):t;o.objects.forEach(g=>{!g.id&&(g.id=Mt())}),t=JSON.stringify(o),this.editor.hooksEntity.hookImportBefore.callAsync(t,()=>{this.canvas.loadFromJSON(t,()=>{this.canvas.renderAll(),this.editor.hooksEntity.hookImportAfter.callAsync(t,()=>{var g;(g=this.editor)==null||g.updateDrawStatus(!!o.overlayImage),this.canvas.renderAll(),n&&n(),this.editor.emit("loadJson")})})})}getJson(){return this.canvas.toJSON(["id","gradientAngle","selectable","hasControls","linkData"])}dragAddItem(t,n){if(n){const{left:g,top:A}=this.canvas.getSelectionElement().getBoundingClientRect();if(n.x<g||n.y<A||t.width===void 0)return;const v={x:n.x-g,y:n.y-A},f=this.canvas.restorePointerVpt(v);t.left=f.x-t.width/2,t.top=f.y}const{width:o}=this._getSaveOption();o&&t.scaleToWidth(o/2),this.canvas.add(t),this.canvas.requestRenderAll()}clipboard(){const t=this.getJson();ys(JSON.stringify(t,null,"	"))}clipboardBase64(){this.preview().then(t=>{ys(t)})}saveJson(){return _t(this,null,function*(){const t=this.getJson();yield su(t.objects);const n=`data:text/json;charset=utf-8,${encodeURIComponent(JSON.stringify(t,null,"	"))}`;Dn(n,"json")})}saveSvg(){this.editor.hooksEntity.hookSaveBefore.callAsync("",()=>{const t=this._getSaveSvgOption(),n=this.canvas.toSVG(t),o=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(n)}`;this.editor.hooksEntity.hookSaveAfter.callAsync(o,()=>{Dn(o,"svg")})})}saveImg(){this.editor.hooksEntity.hookSaveBefore.callAsync("",()=>{const t=this._getSaveOption();this.canvas.setViewportTransform([1,0,0,1,0,0]);const n=this.canvas.toDataURL(t);this.editor.hooksEntity.hookSaveAfter.callAsync(n,()=>{Dn(n,"png")})})}preview(){return new Promise(t=>{this.editor.hooksEntity.hookSaveBefore.callAsync("",()=>{const n=this._getSaveOption();this.canvas.setViewportTransform([1,0,0,1,0,0]),this.canvas.renderAll();const o=this.canvas.toDataURL(n);this.editor.hooksEntity.hookSaveAfter.callAsync(o,()=>{t(o)})})})}_getSaveSvgOption(){const t=this.canvas.getObjects().find(v=>v.id==="workspace"),{left:n,top:o,width:g,height:A}=t;return{width:g,height:A,viewBox:{x:n,y:o,width:g,height:A}}}_getSaveOption(){const t=this.canvas.getObjects().find(f=>f.id==="workspace"),{left:n,top:o,width:g,height:A}=t;return{name:"New Image",format:"png",quality:1,width:g,height:A,left:n,top:o}}addImgByElement(t){this.getImageExtension(t.src)==="svg"?nt.fabric.loadSVGFromURL(t.src,o=>{const g=nt.fabric.util.groupSVGElements(o,{shadow:"",fontFamily:"arial",id:Mt(),name:"svg元素"});this.dragAddItem(g)}):nt.fabric.Image.fromURL(t.src,o=>{o.set({left:100,top:100}),this.dragAddItem(o)},{crossOrigin:"anonymous"})}getImageExtension(t){const n=t.split("/"),g=n[n.length-1].split(".");return g[g.length-1]}clear(){var t;this.canvas.getObjects().forEach(n=>{n.id!=="workspace"&&this.canvas.remove(n)}),(t=this.editor)==null||t.setWorkspaseBg("#fff"),this.canvas.discardActiveObject(),this.canvas.renderAll()}destroy(){console.log("pluginDestroy")}}X(Ri,"pluginName","ServersPlugin"),X(Ri,"apis",["insert","loadJSON","getJson","dragAddItem","clipboard","clipboardBase64","saveJson","saveSvg","saveImg","clear","preview","addImgByElement","getImageExtension","getSelectMode"]),X(Ri,"events",[en.ONE,en.MULTI,xn.CANCEL]);var bo={};bo.deprecate=(e,t)=>{let n=!0;return function(){return n&&(console.warn("DeprecationWarning: "+t),n=!1),e.apply(this,arguments)}};const ap=bo,lp=ap.deprecate(()=>{},"Hook.context is deprecated and will be removed"),xa=function(...e){return this.call=this._createCall("sync"),this.call(...e)},Ba=function(...e){return this.callAsync=this._createCall("async"),this.callAsync(...e)},Ta=function(...e){return this.promise=this._createCall("promise"),this.promise(...e)};let ou=class{constructor(t=[],n=void 0){this._args=t,this.name=n,this.taps=[],this.interceptors=[],this._call=xa,this.call=xa,this._callAsync=Ba,this.callAsync=Ba,this._promise=Ta,this.promise=Ta,this._x=void 0,this.compile=this.compile,this.tap=this.tap,this.tapAsync=this.tapAsync,this.tapPromise=this.tapPromise}compile(t){throw new Error("Abstract: should be overridden")}_createCall(t){return this.compile({taps:this.taps,interceptors:this.interceptors,args:this._args,type:t})}_tap(t,n,o){if(typeof n=="string")n={name:n.trim()};else if(typeof n!="object"||n===null)throw new Error("Invalid tap options");if(typeof n.name!="string"||n.name==="")throw new Error("Missing name for tap");typeof n.context!="undefined"&&lp(),n=Object.assign({type:t,fn:o},n),n=this._runRegisterInterceptors(n),this._insert(n)}tap(t,n){this._tap("sync",t,n)}tapAsync(t,n){this._tap("async",t,n)}tapPromise(t,n){this._tap("promise",t,n)}_runRegisterInterceptors(t){for(const n of this.interceptors)if(n.register){const o=n.register(t);o!==void 0&&(t=o)}return t}withOptions(t){const n=o=>Object.assign({},t,typeof o=="string"?{name:o}:o);return{name:this.name,tap:(o,g)=>this.tap(n(o),g),tapAsync:(o,g)=>this.tapAsync(n(o),g),tapPromise:(o,g)=>this.tapPromise(n(o),g),intercept:o=>this.intercept(o),isUsed:()=>this.isUsed(),withOptions:o=>this.withOptions(n(o))}}isUsed(){return this.taps.length>0||this.interceptors.length>0}intercept(t){if(this._resetCompilation(),this.interceptors.push(Object.assign({},t)),t.register)for(let n=0;n<this.taps.length;n++)this.taps[n]=t.register(this.taps[n])}_resetCompilation(){this.call=this._call,this.callAsync=this._callAsync,this.promise=this._promise}_insert(t){this._resetCompilation();let n;typeof t.before=="string"?n=new Set([t.before]):Array.isArray(t.before)&&(n=new Set(t.before));let o=0;typeof t.stage=="number"&&(o=t.stage);let g=this.taps.length;for(;g>0;){g--;const A=this.taps[g];this.taps[g+1]=A;const v=A.stage||0;if(n){if(n.has(A.name)){n.delete(A.name);continue}if(n.size>0)continue}if(!(v>o)){g++;break}}this.taps[g]=t}};Object.setPrototypeOf(ou.prototype,null);var Ue=ou;let cp=class{constructor(t){this.config=t,this.options=void 0,this._args=void 0}create(t){this.init(t);let n;switch(this.options.type){case"sync":n=new Function(this.args(),`"use strict";
`+this.header()+this.contentWithInterceptors({onError:v=>`throw ${v};
`,onResult:v=>`return ${v};
`,resultReturns:!0,onDone:()=>"",rethrowIfPossible:!0}));break;case"async":n=new Function(this.args({after:"_callback"}),`"use strict";
`+this.header()+this.contentWithInterceptors({onError:v=>`_callback(${v});
`,onResult:v=>`_callback(null, ${v});
`,onDone:()=>`_callback();
`}));break;case"promise":let o=!1;const g=this.contentWithInterceptors({onError:v=>(o=!0,`_error(${v});
`),onResult:v=>`_resolve(${v});
`,onDone:()=>`_resolve();
`});let A="";A+=`"use strict";
`,A+=this.header(),A+=`return new Promise((function(_resolve, _reject) {
`,o&&(A+=`var _sync = true;
`,A+=`function _error(_err) {
`,A+=`if(_sync)
`,A+=`_resolve(Promise.resolve().then((function() { throw _err; })));
`,A+=`else
`,A+=`_reject(_err);
`,A+=`};
`),A+=g,o&&(A+=`_sync = false;
`),A+=`}));
`,n=new Function(this.args(),A);break}return this.deinit(),n}setup(t,n){t._x=n.taps.map(o=>o.fn)}init(t){this.options=t,this._args=t.args.slice()}deinit(){this.options=void 0,this._args=void 0}contentWithInterceptors(t){if(this.options.interceptors.length>0){const n=t.onError,o=t.onResult,g=t.onDone;let A="";for(let v=0;v<this.options.interceptors.length;v++){const f=this.options.interceptors[v];f.call&&(A+=`${this.getInterceptor(v)}.call(${this.args({before:f.context?"_context":void 0})});
`)}return A+=this.content(Object.assign(t,{onError:n&&(v=>{let f="";for(let i=0;i<this.options.interceptors.length;i++)this.options.interceptors[i].error&&(f+=`${this.getInterceptor(i)}.error(${v});
`);return f+=n(v),f}),onResult:o&&(v=>{let f="";for(let i=0;i<this.options.interceptors.length;i++)this.options.interceptors[i].result&&(f+=`${this.getInterceptor(i)}.result(${v});
`);return f+=o(v),f}),onDone:g&&(()=>{let v="";for(let f=0;f<this.options.interceptors.length;f++)this.options.interceptors[f].done&&(v+=`${this.getInterceptor(f)}.done();
`);return v+=g(),v})})),A}else return this.content(t)}header(){let t="";return this.needContext()?t+=`var _context = {};
`:t+=`var _context;
`,t+=`var _x = this._x;
`,this.options.interceptors.length>0&&(t+=`var _taps = this.taps;
`,t+=`var _interceptors = this.interceptors;
`),t}needContext(){for(const t of this.options.taps)if(t.context)return!0;return!1}callTap(t,{onError:n,onResult:o,onDone:g,rethrowIfPossible:A}){let v="",f=!1;for(let c=0;c<this.options.interceptors.length;c++){const l=this.options.interceptors[c];l.tap&&(f||(v+=`var _tap${t} = ${this.getTap(t)};
`,f=!0),v+=`${this.getInterceptor(c)}.tap(${l.context?"_context, ":""}_tap${t});
`)}v+=`var _fn${t} = ${this.getTapFn(t)};
`;const i=this.options.taps[t];switch(i.type){case"sync":A||(v+=`var _hasError${t} = false;
`,v+=`try {
`),o?v+=`var _result${t} = _fn${t}(${this.args({before:i.context?"_context":void 0})});
`:v+=`_fn${t}(${this.args({before:i.context?"_context":void 0})});
`,A||(v+=`} catch(_err) {
`,v+=`_hasError${t} = true;
`,v+=n("_err"),v+=`}
`,v+=`if(!_hasError${t}) {
`),o&&(v+=o(`_result${t}`)),g&&(v+=g()),A||(v+=`}
`);break;case"async":let c="";o?c+=`(function(_err${t}, _result${t}) {
`:c+=`(function(_err${t}) {
`,c+=`if(_err${t}) {
`,c+=n(`_err${t}`),c+=`} else {
`,o&&(c+=o(`_result${t}`)),g&&(c+=g()),c+=`}
`,c+="})",v+=`_fn${t}(${this.args({before:i.context?"_context":void 0,after:c})});
`;break;case"promise":v+=`var _hasResult${t} = false;
`,v+=`var _promise${t} = _fn${t}(${this.args({before:i.context?"_context":void 0})});
`,v+=`if (!_promise${t} || !_promise${t}.then)
`,v+=`  throw new Error('Tap function (tapPromise) did not return promise (returned ' + _promise${t} + ')');
`,v+=`_promise${t}.then((function(_result${t}) {
`,v+=`_hasResult${t} = true;
`,o&&(v+=o(`_result${t}`)),g&&(v+=g()),v+=`}), function(_err${t}) {
`,v+=`if(_hasResult${t}) throw _err${t};
`,v+=n(`_err${t}`),v+=`});
`;break}return v}callTapsSeries({onError:t,onResult:n,resultReturns:o,onDone:g,doneReturns:A,rethrowIfPossible:v}){if(this.options.taps.length===0)return g();const f=this.options.taps.findIndex(a=>a.type!=="sync"),i=o||A;let c="",l=g,r=0;for(let a=this.options.taps.length-1;a>=0;a--){const s=a;l!==g&&(this.options.taps[s].type!=="sync"||r++>20)&&(r=0,c+=`function _next${s}() {
`,c+=l(),c+=`}
`,l=()=>`${i?"return ":""}_next${s}();
`);const d=l,h=m=>m?"":g(),p=this.callTap(s,{onError:m=>t(s,m,d,h),onResult:n&&(m=>n(s,m,d,h)),onDone:!n&&d,rethrowIfPossible:v&&(f<0||s<f)});l=()=>p}return c+=l(),c}callTapsLooping({onError:t,onDone:n,rethrowIfPossible:o}){if(this.options.taps.length===0)return n();const g=this.options.taps.every(v=>v.type==="sync");let A="";g||(A+=`var _looper = (function() {
`,A+=`var _loopAsync = false;
`),A+=`var _loop;
`,A+=`do {
`,A+=`_loop = false;
`;for(let v=0;v<this.options.interceptors.length;v++){const f=this.options.interceptors[v];f.loop&&(A+=`${this.getInterceptor(v)}.loop(${this.args({before:f.context?"_context":void 0})});
`)}return A+=this.callTapsSeries({onError:t,onResult:(v,f,i,c)=>{let l="";return l+=`if(${f} !== undefined) {
`,l+=`_loop = true;
`,g||(l+=`if(_loopAsync) _looper();
`),l+=c(!0),l+=`} else {
`,l+=i(),l+=`}
`,l},onDone:n&&(()=>{let v="";return v+=`if(!_loop) {
`,v+=n(),v+=`}
`,v}),rethrowIfPossible:o&&g}),A+=`} while(_loop);
`,g||(A+=`_loopAsync = true;
`,A+=`});
`,A+=`_looper();
`),A}callTapsParallel({onError:t,onResult:n,onDone:o,rethrowIfPossible:g,onTap:A=(v,f)=>f()}){if(this.options.taps.length<=1)return this.callTapsSeries({onError:t,onResult:n,onDone:o,rethrowIfPossible:g});let v="";v+=`do {
`,v+=`var _counter = ${this.options.taps.length};
`,o&&(v+=`var _done = (function() {
`,v+=o(),v+=`});
`);for(let f=0;f<this.options.taps.length;f++){const i=()=>o?`if(--_counter === 0) _done();
`:"--_counter;",c=l=>l||!o?`_counter = 0;
`:`_counter = 0;
_done();
`;v+=`if(_counter <= 0) break;
`,v+=A(f,()=>this.callTap(f,{onError:l=>{let r="";return r+=`if(_counter > 0) {
`,r+=t(f,l,i,c),r+=`}
`,r},onResult:n&&(l=>{let r="";return r+=`if(_counter > 0) {
`,r+=n(f,l,i,c),r+=`}
`,r}),onDone:!n&&(()=>i()),rethrowIfPossible:g}),i,c)}return v+=`} while(false);
`,v}args({before:t,after:n}={}){let o=this._args;return t&&(o=[t].concat(o)),n&&(o=o.concat(n)),o.length===0?"":o.join(", ")}getTapFn(t){return`_x[${t}]`}getTap(t){return`_taps[${t}]`}getInterceptor(t){return`_interceptors[${t}]`}};var He=cp;const up=Ue,hp=He;class fp extends hp{content({onError:t,onDone:n,rethrowIfPossible:o}){return this.callTapsSeries({onError:(g,A)=>t(A),onDone:n,rethrowIfPossible:o})}}const Oa=new fp,dp=()=>{throw new Error("tapAsync is not supported on a SyncHook")},gp=()=>{throw new Error("tapPromise is not supported on a SyncHook")},pp=function(e){return Oa.setup(this,e),Oa.create(e)};function au(e=[],t=void 0){const n=new up(e,t);return n.constructor=au,n.tapAsync=dp,n.tapPromise=gp,n.compile=pp,n}au.prototype=null;const Ap=Ue,mp=He;class vp extends mp{content({onError:t,onResult:n,resultReturns:o,onDone:g,rethrowIfPossible:A}){return this.callTapsSeries({onError:(v,f)=>t(f),onResult:(v,f,i)=>`if(${f} !== undefined) {
${n(f)};
} else {
${i()}}
`,resultReturns:o,onDone:g,rethrowIfPossible:A})}}const ka=new vp,yp=()=>{throw new Error("tapAsync is not supported on a SyncBailHook")},_p=()=>{throw new Error("tapPromise is not supported on a SyncBailHook")},Cp=function(e){return ka.setup(this,e),ka.create(e)};function lu(e=[],t=void 0){const n=new Ap(e,t);return n.constructor=lu,n.tapAsync=yp,n.tapPromise=_p,n.compile=Cp,n}lu.prototype=null;const wp=Ue,bp=He;class Sp extends bp{content({onError:t,onResult:n,resultReturns:o,rethrowIfPossible:g}){return this.callTapsSeries({onError:(A,v)=>t(v),onResult:(A,v,f)=>{let i="";return i+=`if(${v} !== undefined) {
`,i+=`${this._args[0]} = ${v};
`,i+=`}
`,i+=f(),i},onDone:()=>n(this._args[0]),doneReturns:o,rethrowIfPossible:g})}}const Da=new Sp,Ep=()=>{throw new Error("tapAsync is not supported on a SyncWaterfallHook")},Ip=()=>{throw new Error("tapPromise is not supported on a SyncWaterfallHook")},xp=function(e){return Da.setup(this,e),Da.create(e)};function cu(e=[],t=void 0){if(e.length<1)throw new Error("Waterfall hooks must have at least one argument");const n=new wp(e,t);return n.constructor=cu,n.tapAsync=Ep,n.tapPromise=Ip,n.compile=xp,n}cu.prototype=null;const Bp=Ue,Tp=He;class Op extends Tp{content({onError:t,onDone:n,rethrowIfPossible:o}){return this.callTapsLooping({onError:(g,A)=>t(A),onDone:n,rethrowIfPossible:o})}}const Ma=new Op,kp=()=>{throw new Error("tapAsync is not supported on a SyncLoopHook")},Dp=()=>{throw new Error("tapPromise is not supported on a SyncLoopHook")},Mp=function(e){return Ma.setup(this,e),Ma.create(e)};function uu(e=[],t=void 0){const n=new Bp(e,t);return n.constructor=uu,n.tapAsync=kp,n.tapPromise=Dp,n.compile=Mp,n}uu.prototype=null;const Pp=Ue,Qp=He;class Lp extends Qp{content({onError:t,onDone:n}){return this.callTapsParallel({onError:(o,g,A,v)=>t(g)+v(!0),onDone:n})}}const Pa=new Lp,Fp=function(e){return Pa.setup(this,e),Pa.create(e)};function hu(e=[],t=void 0){const n=new Pp(e,t);return n.constructor=hu,n.compile=Fp,n._call=void 0,n.call=void 0,n}hu.prototype=null;const Rp=Ue,jp=He;class $p extends jp{content({onError:t,onResult:n,onDone:o}){let g="";return g+=`var _results = new Array(${this.options.taps.length});
`,g+=`var _checkDone = function() {
`,g+=`for(var i = 0; i < _results.length; i++) {
`,g+=`var item = _results[i];
`,g+=`if(item === undefined) return false;
`,g+=`if(item.result !== undefined) {
`,g+=n("item.result"),g+=`return true;
`,g+=`}
`,g+=`if(item.error) {
`,g+=t("item.error"),g+=`return true;
`,g+=`}
`,g+=`}
`,g+=`return false;
`,g+=`}
`,g+=this.callTapsParallel({onError:(A,v,f,i)=>{let c="";return c+=`if(${A} < _results.length && ((_results.length = ${A+1}), (_results[${A}] = { error: ${v} }), _checkDone())) {
`,c+=i(!0),c+=`} else {
`,c+=f(),c+=`}
`,c},onResult:(A,v,f,i)=>{let c="";return c+=`if(${A} < _results.length && (${v} !== undefined && (_results.length = ${A+1}), (_results[${A}] = { result: ${v} }), _checkDone())) {
`,c+=i(!0),c+=`} else {
`,c+=f(),c+=`}
`,c},onTap:(A,v,f,i)=>{let c="";return A>0&&(c+=`if(${A} >= _results.length) {
`,c+=f(),c+=`} else {
`),c+=v(),A>0&&(c+=`}
`),c},onDone:o}),g}}const Qa=new $p,Np=function(e){return Qa.setup(this,e),Qa.create(e)};function fu(e=[],t=void 0){const n=new Rp(e,t);return n.constructor=fu,n.compile=Np,n._call=void 0,n.call=void 0,n}fu.prototype=null;const Up=Ue,Hp=He;class Gp extends Hp{content({onError:t,onDone:n}){return this.callTapsSeries({onError:(o,g,A,v)=>t(g)+v(!0),onDone:n})}}const La=new Gp,zp=function(e){return La.setup(this,e),La.create(e)};function So(e=[],t=void 0){const n=new Up(e,t);return n.constructor=So,n.compile=zp,n._call=void 0,n.call=void 0,n}So.prototype=null;var Yp=So;const Vp=Ue,Wp=He;class Xp extends Wp{content({onError:t,onResult:n,resultReturns:o,onDone:g}){return this.callTapsSeries({onError:(A,v,f,i)=>t(v)+i(!0),onResult:(A,v,f)=>`if(${v} !== undefined) {
${n(v)}
} else {
${f()}}
`,resultReturns:o,onDone:g})}}const Fa=new Xp,Jp=function(e){return Fa.setup(this,e),Fa.create(e)};function du(e=[],t=void 0){const n=new Vp(e,t);return n.constructor=du,n.compile=Jp,n._call=void 0,n.call=void 0,n}du.prototype=null;const Kp=Ue,qp=He;class Zp extends qp{content({onError:t,onDone:n}){return this.callTapsLooping({onError:(o,g,A,v)=>t(g)+v(!0),onDone:n})}}const Ra=new Zp,tA=function(e){return Ra.setup(this,e),Ra.create(e)};function gu(e=[],t=void 0){const n=new Kp(e,t);return n.constructor=gu,n.compile=tA,n._call=void 0,n.call=void 0,n}gu.prototype=null;const eA=Ue,nA=He;class iA extends nA{content({onError:t,onResult:n,onDone:o}){return this.callTapsSeries({onError:(g,A,v,f)=>t(A)+f(!0),onResult:(g,A,v)=>{let f="";return f+=`if(${A} !== undefined) {
`,f+=`${this._args[0]} = ${A};
`,f+=`}
`,f+=v(),f},onDone:()=>n(this._args[0])})}}const ja=new iA,rA=function(e){return ja.setup(this,e),ja.create(e)};function pu(e=[],t=void 0){if(e.length<1)throw new Error("Waterfall hooks must have at least one argument");const n=new eA(e,t);return n.constructor=pu,n.compile=rA,n._call=void 0,n.call=void 0,n}pu.prototype=null;const Eo=bo,sA=(e,t)=>t;class Io{constructor(t,n=void 0){this._map=new Map,this.name=n,this._factory=t,this._interceptors=[]}get(t){return this._map.get(t)}for(t){const n=this.get(t);if(n!==void 0)return n;let o=this._factory(t);const g=this._interceptors;for(let A=0;A<g.length;A++)o=g[A].factory(t,o);return this._map.set(t,o),o}intercept(t){this._interceptors.push(Object.assign({factory:sA},t))}}Io.prototype.tap=Eo.deprecate(function(e,t,n){return this.for(e).tap(t,n)},"HookMap#tap(key,…) is deprecated. Use HookMap#for(key).tap(…) instead.");Io.prototype.tapAsync=Eo.deprecate(function(e,t,n){return this.for(e).tapAsync(t,n)},"HookMap#tapAsync(key,…) is deprecated. Use HookMap#for(key).tapAsync(…) instead.");Io.prototype.tapPromise=Eo.deprecate(function(e,t,n){return this.for(e).tapPromise(t,n)},"HookMap#tapPromise(key,…) is deprecated. Use HookMap#for(key).tapPromise(…) instead.");var oA=Yp;class aA extends yg{constructor(){super(...arguments);X(this,"canvas",null);X(this,"contextMenu",null);X(this,"pluginMap",{});X(this,"customEvents",[]);X(this,"customApis",[]);X(this,"hooks",["hookImportBefore","hookImportAfter","hookSaveBefore","hookSaveAfter"]);X(this,"hooksEntity",{})}init(n){this.canvas=n,this._initContextMenu(),this._bindContextMenu(),this._initActionHooks(),this._initServersPlugin()}get fabricCanvas(){return this.canvas}use(n,o){if(this._checkPlugin(n)&&this.canvas){this._saveCustomAttr(n);const g=new n(this.canvas,this,o||{});g.pluginName=n.pluginName,this.pluginMap[n.pluginName]=g,this._bindingHooks(g),this._bindingHotkeys(g),this._bindingApis(g)}}destory(){this.canvas=null,this.contextMenu=null,this.pluginMap={},this.customEvents=[],this.customApis=[],this.hooksEntity={}}getPlugin(n){if(this.pluginMap[n])return this.pluginMap[n]}_checkPlugin(n){const{pluginName:o,events:g=[],apis:A=[]}=n;if(this.pluginMap[o])throw new Error(o+"插件重复初始化");return g.forEach(v=>{if(this.customEvents.find(f=>f===v))throw new Error(o+"插件中"+v+"重复")}),A.forEach(v=>{if(this.customApis.find(f=>f===v))throw new Error(o+"插件中"+v+"重复")}),!0}_bindingHooks(n){this.hooks.forEach(o=>{const g=n[o];g&&this.hooksEntity[o].tapPromise(n.pluginName+o,function(){const A=g.apply(n,[...arguments]);return A instanceof Promise?A:Promise.resolve(A)})})}_bindingHotkeys(n){var o;(o=n==null?void 0:n.hotkeys)==null||o.forEach(g=>{Ve(g,{keyup:!0},A=>{n.hotkeyEvent&&n.hotkeyEvent(g,A)})})}_saveCustomAttr(n){const{events:o=[],apis:g=[]}=n;this.customApis=this.customApis.concat(g),this.customEvents=this.customEvents.concat(o)}_bindingApis(n){const{apis:o=[]}=n.constructor||{};o.forEach(g=>{this[g]=function(){return n[g].apply(n,[...arguments])}})}_bindContextMenu(){this.canvas&&this.canvas.on("mouse:down",n=>{if(n.button===3){let o=[];Object.keys(this.pluginMap).forEach(g=>{const A=this.pluginMap[g],v=A.contextMenu&&A.contextMenu();v&&(o=o.concat(v))}),this._renderMenu(n,o)}})}_renderMenu(n,o){o.length!==0&&this.contextMenu&&(this.contextMenu.hideAll(),this.contextMenu.setData(o),this.contextMenu.show(n.e.clientX,n.e.clientY))}_initActionHooks(){this.hooks.forEach(n=>{this.hooksEntity[n]=new oA(["data"])})}_initContextMenu(){this.contextMenu=new qi(this.canvas.wrapperEl,[]),this.contextMenu.install()}_initServersPlugin(){this.use(Ri)}off(n,o){return o?super.off(n,o):this}}class ji{constructor(t,n){X(this,"canvas");X(this,"editor");X(this,"defautOption",{});X(this,"hotkeys",["space"]);X(this,"dragMode",!1);this.canvas=t,this.editor=n,this.dragMode=!1,this.init()}init(){this._initDring()}startDring(){this.dragMode=!0,this.canvas.defaultCursor="grab",this.editor.emit("startDring"),this.canvas.renderAll()}endDring(){this.dragMode=!1,this.canvas.defaultCursor="default",this.canvas.isDragging=!1,this.editor.emit("endDring"),this.canvas.renderAll()}_initDring(){const t=this;this.canvas.on("mouse:down",function(n){const o=n.e;(o.altKey||t.dragMode)&&(t.canvas.defaultCursor="grabbing",t.canvas.discardActiveObject(),t._setDring(),this.selection=!1,this.isDragging=!0,this.lastPosX=o.clientX,this.lastPosY=o.clientY,this.requestRenderAll())}),this.canvas.on("mouse:move",function(n){if(this.isDragging){t.canvas.discardActiveObject(),t.canvas.defaultCursor="grabbing";const{e:o}=n;if(!this.viewportTransform)return;const g=this.viewportTransform;g[4]+=o.clientX-this.lastPosX,g[5]+=o.clientY-this.lastPosY,this.lastPosX=o.clientX,this.lastPosY=o.clientY,this.requestRenderAll()}}),this.canvas.on("mouse:up",function(){this.viewportTransform&&(this.setViewportTransform(this.viewportTransform),this.isDragging=!1,this.selection=!0,this.getObjects().forEach(n=>{n.id!=="workspace"&&n.hasControls&&(n.selectable=!0)}),t.canvas.defaultCursor="default",this.requestRenderAll())})}_setDring(){this.canvas.selection=!1,this.canvas.defaultCursor="grab",this.canvas.getObjects().forEach(t=>{t.selectable=!1}),this.canvas.requestRenderAll()}destroy(){console.log("pluginDestroy")}hotkeyEvent(t,n){n.code==="Space"&&n.type==="keydown"&&(this.dragMode||this.startDring()),n.code==="Space"&&n.type==="keyup"&&this.endDring()}}X(ji,"pluginName","DringPlugin"),X(ji,"events",["startDring","endDring"]),X(ji,"apis",["startDring","endDring"]);class $i{constructor(t,n){X(this,"canvas");X(this,"editor");X(this,"defautOption",{color:"rgba(255,95,95,1)",width:1});X(this,"hotkeys",[""]);X(this,"dragMode",!1);this.canvas=t,this.editor=n,this.dragMode=!1,this.init()}init(){const{canvas:t}=this,n=t.getSelectionContext(),o=5,g=4,A=this;let v,f=1;function i(u){l(u.x+.5,u.y1>u.y2?u.y2:u.y1,u.x+.5,u.y2>u.y1?u.y2:u.y1)}function c(u){l(u.x1>u.x2?u.x2:u.x1,u.y+.5,u.x2>u.x1?u.x2:u.x1,u.y+.5)}function l(u,d,h,p){v!=null&&(n.moveTo(u*f+v[4],d*f+v[5]),n.lineTo(h*f+v[4],p*f+v[5]))}function r(u,d){u=Math.round(u),d=Math.round(d);for(let h=u-g,p=u+g;h<=p;h++)if(h===d)return!0;return!1}const a=[],s=[];t.on("mouse:down",()=>{v=t.viewportTransform,f=t.getZoom()}),t.on("object:moving",u=>{if(v===void 0||u.target===void 0)return;const d=u.target,h=t.getObjects(),p=d.getCenterPoint(),m=p.x,y=p.y,_=d.getBoundingRect(),C=_.height/v[3],w=_.width/v[0];let b=!1,S=!1;if(t._currentTransform){for(let $=h.length;$--;){if(h[$]===d||d instanceof nt.fabric.GuideLine&&h[$]instanceof nt.fabric.GuideLine)continue;const Q=h[$].getCenterPoint(),R=Q.x,H=Q.y,W=h[$].getBoundingRect(),G=W.height/v[3],V=W.width/v[0];r(R,m)&&(S=!0,a.push({x:R,y1:H<y?H-G/2-o:H+G/2+o,y2:y>H?y+C/2+o:y-C/2-o}),d.setPositionByOrigin(new nt.fabric.Point(R,y),"center","center")),r(R-V/2,m-w/2)&&(S=!0,a.push({x:R-V/2,y1:H<y?H-G/2-o:H+G/2+o,y2:y>H?y+C/2+o:y-C/2-o}),d.setPositionByOrigin(new nt.fabric.Point(R-V/2+w/2,y),"center","center")),r(R+V/2,m+w/2)&&(S=!0,a.push({x:R+V/2,y1:H<y?H-G/2-o:H+G/2+o,y2:y>H?y+C/2+o:y-C/2-o}),d.setPositionByOrigin(new nt.fabric.Point(R+V/2-w/2,y),"center","center")),r(H,y)&&(b=!0,s.push({y:H,x1:R<m?R-V/2-o:R+V/2+o,x2:m>R?m+w/2+o:m-w/2-o}),d.setPositionByOrigin(new nt.fabric.Point(m,H),"center","center")),r(H-G/2,y-C/2)&&(b=!0,s.push({y:H-G/2,x1:R<m?R-V/2-o:R+V/2+o,x2:m>R?m+w/2+o:m-w/2-o}),d.setPositionByOrigin(new nt.fabric.Point(m,H-G/2+C/2),"center","center")),r(H+G/2,y+C/2)&&(b=!0,s.push({y:H+G/2,x1:R<m?R-V/2-o:R+V/2+o,x2:m>R?m+w/2+o:m-w/2-o}),d.setPositionByOrigin(new nt.fabric.Point(m,H+G/2-C/2),"center","center"))}b||(s.length=0),S||(a.length=0)}}),t.on("before:render",()=>{if(t.contextTop!==null)try{t.clearContext(t.contextTop)}catch(u){console.log(u)}}),t.on("after:render",()=>{n.save(),n.beginPath(),n.lineWidth=A.defautOption.width,n.strokeStyle=A.defautOption.color;for(let u=a.length;u--;)i(a[u]);for(let u=s.length;u--;)c(s[u]);n.stroke(),n.restore(),a.length=0,s.length=0}),t.on("mouse:up",()=>{a.length=0,s.length=0,t.renderAll()})}destroy(){console.log("pluginDestroy")}}X($i,"pluginName","AlignGuidLinePlugin"),X($i,"events",["",""]),X($i,"apis",[]);const lA="/vue-fabric-editor/assets/middlecontrol-a163c615.svg",cA="/vue-fabric-editor/assets/middlecontrolhoz-9b7cc4b3.svg",Au="/vue-fabric-editor/assets/edgecontrol-dbe38ac6.svg",uA="/vue-fabric-editor/assets/rotateicon-ec6729f2.svg";nt.fabric.Object.NUM_FRACTION_DIGITS=4;function Zi(e,t,n,o,g,A,v){v!==void 0&&(e.save(),e.translate(t,n),e.rotate(nt.fabric.util.degreesToRadians(v)),e.drawImage(o,-g/2,-A/2,g,A),e.restore())}function hA(){const e=document.createElement("img");e.src=lA;const t=document.createElement("img");t.src=cA;function n(g,A,v,f,i){Zi(g,A,v,e,20,25,i.angle)}function o(g,A,v,f,i){Zi(g,A,v,t,25,20,i.angle)}nt.fabric.Object.prototype.controls.ml=new nt.fabric.Control({x:-.5,y:0,offsetX:-1,cursorStyleHandler:nt.fabric.controlsUtils.scaleSkewCursorStyleHandler,actionHandler:nt.fabric.controlsUtils.scalingXOrSkewingY,getActionName:nt.fabric.controlsUtils.scaleOrSkewActionName,render:n}),nt.fabric.Object.prototype.controls.mr=new nt.fabric.Control({x:.5,y:0,offsetX:1,cursorStyleHandler:nt.fabric.controlsUtils.scaleSkewCursorStyleHandler,actionHandler:nt.fabric.controlsUtils.scalingXOrSkewingY,getActionName:nt.fabric.controlsUtils.scaleOrSkewActionName,render:n}),nt.fabric.Object.prototype.controls.mb=new nt.fabric.Control({x:0,y:.5,offsetY:1,cursorStyleHandler:nt.fabric.controlsUtils.scaleSkewCursorStyleHandler,actionHandler:nt.fabric.controlsUtils.scalingYOrSkewingX,getActionName:nt.fabric.controlsUtils.scaleOrSkewActionName,render:o}),nt.fabric.Object.prototype.controls.mt=new nt.fabric.Control({x:0,y:-.5,offsetY:-1,cursorStyleHandler:nt.fabric.controlsUtils.scaleSkewCursorStyleHandler,actionHandler:nt.fabric.controlsUtils.scalingYOrSkewingX,getActionName:nt.fabric.controlsUtils.scaleOrSkewActionName,render:o})}function fA(){const e=document.createElement("img");e.src=Au;function t(n,o,g,A,v){Zi(n,o,g,e,25,25,v.angle)}nt.fabric.Object.prototype.controls.tl=new nt.fabric.Control({x:-.5,y:-.5,cursorStyleHandler:nt.fabric.controlsUtils.scaleCursorStyleHandler,actionHandler:nt.fabric.controlsUtils.scalingEqually,render:t}),nt.fabric.Object.prototype.controls.bl=new nt.fabric.Control({x:-.5,y:.5,cursorStyleHandler:nt.fabric.controlsUtils.scaleCursorStyleHandler,actionHandler:nt.fabric.controlsUtils.scalingEqually,render:t}),nt.fabric.Object.prototype.controls.tr=new nt.fabric.Control({x:.5,y:-.5,cursorStyleHandler:nt.fabric.controlsUtils.scaleCursorStyleHandler,actionHandler:nt.fabric.controlsUtils.scalingEqually,render:t}),nt.fabric.Object.prototype.controls.br=new nt.fabric.Control({x:.5,y:.5,cursorStyleHandler:nt.fabric.controlsUtils.scaleCursorStyleHandler,actionHandler:nt.fabric.controlsUtils.scalingEqually,render:t})}function dA(){const e=document.createElement("img");e.src=uA;function t(n,o,g,A,v){Zi(n,o,g,e,40,40,v.angle)}nt.fabric.Object.prototype.controls.mtr=new nt.fabric.Control({x:0,y:.5,cursorStyleHandler:nt.fabric.controlsUtils.rotationStyleHandler,actionHandler:nt.fabric.controlsUtils.rotationWithSnapping,offsetY:30,actionName:"rotate",render:t})}class mu{constructor(t,n){X(this,"canvas");X(this,"editor");this.canvas=t,this.editor=n,this.init()}init(){fA(),hA(),dA(),nt.fabric.Object.prototype.set({transparentCorners:!1,borderColor:"#51B9F9",cornerColor:"#FFF",borderScaleFactor:2.5,cornerStyle:"circle",cornerStrokeColor:"#0E98FC",borderOpacityWhenMoving:1})}destroy(){console.log("pluginDestroy")}}X(mu,"pluginName","ControlsPlugin");class _s{constructor(t,n){X(this,"canvas");X(this,"editor");this.canvas=t,this.editor=n}center(t,n){const o=t.getCenterPoint();return this.canvas._centerObject(n,o)}centerV(t,n){return this.canvas._centerObject(n,new nt.fabric.Point(n.getCenterPoint().x,t.getCenterPoint().y))}centerH(t,n){return this.canvas._centerObject(n,new nt.fabric.Point(t.getCenterPoint().x,n.getCenterPoint().y))}position(t){const n=["centerH","center","centerV"],o=this.canvas.getActiveObject();if(n.includes(t)&&o){const g=this.canvas.getObjects().find(A=>A.id==="workspace");g&&(console.log(this[t]),this[t](g,o)),this.canvas.renderAll()}}contextMenu(){if(this.canvas.getActiveObject())return[{text:"水平垂直居中",hotkey:"Ctrl+V",disabled:!1,onclick:()=>this.position("center")}]}destroy(){console.log("pluginDestroy")}}X(_s,"pluginName","CenterAlignPlugin"),X(_s,"apis",["centerH","center","position","centerV"]);class Cs{constructor(t,n){X(this,"canvas");X(this,"editor");this.canvas=t,this.editor=n}_getWorkspace(){return this.canvas.getObjects().find(t=>t.id==="workspace")}_workspaceSendToBack(){const t=this._getWorkspace();t&&t.sendToBack()}up(){const t=this.canvas.getActiveObjects();if(t&&t.length===1){const n=this.canvas.getActiveObjects()[0];n&&n.bringForward(),this.canvas.renderAll(),this._workspaceSendToBack()}}upTop(){const t=this.canvas.getActiveObjects();if(t&&t.length===1){const n=this.canvas.getActiveObjects()[0];n&&n.bringToFront(),this.canvas.renderAll(),console.log(this),this._workspaceSendToBack()}}down(){const t=this.canvas.getActiveObjects();if(t&&t.length===1){const n=this.canvas.getActiveObjects()[0];n&&n.sendBackwards(),this.canvas.renderAll(),this._workspaceSendToBack()}}downTop(){const t=this.canvas.getActiveObjects();if(t&&t.length===1){const n=this.canvas.getActiveObjects()[0];n&&n.sendToBack(),this.canvas.renderAll(),this._workspaceSendToBack()}}contextMenu(){if(this.canvas.getActiveObject())return[{text:"图层管理",hotkey:"❯",subitems:[{text:"上一个",hotkey:"key",onclick:()=>this.up()},{text:"下一个",hotkey:"key",onclick:()=>this.down()},{text:"置顶",hotkey:"key",onclick:()=>this.upTop()},{text:"置底",hotkey:"key",onclick:()=>this.downTop()}]}]}destroy(){console.log("pluginDestroy")}}X(Cs,"pluginName","LayerPlugin"),X(Cs,"apis",["up","upTop","down","downTop"]);class ws{constructor(t,n){X(this,"canvas");X(this,"editor");X(this,"hotkeys",["ctrl+v","ctrl+c"]);X(this,"cache");this.canvas=t,this.editor=n,this.cache=null,this.initPaste()}_copyActiveSelection(t){const o=this.canvas;t==null||t.clone(g=>{g.clone(A=>{o.discardActiveObject(),!(A.left===void 0||A.top===void 0)&&(A.canvas=o,A.set({left:A.left+10,top:A.top+10,evented:!0,id:Mt()}),A.forEachObject(v=>{v.id=Mt(),o.add(v)}),A.setCoords(),o.setActiveObject(A),o.requestRenderAll())})})}_copyObject(t){const o=this.canvas;t==null||t.clone(g=>{g.left===void 0||g.top===void 0||(o.discardActiveObject(),g.set({left:g.left+10,top:g.top+10,evented:!0,id:Mt()}),o.add(g),o.setActiveObject(g),o.requestRenderAll())})}clone(t){const n=t||this.canvas.getActiveObject();n&&((n==null?void 0:n.type)==="activeSelection"?this._copyActiveSelection(n):this._copyObject(n))}hotkeyEvent(t,n){if(t==="ctrl+c"&&n.type==="keydown"){const o=this.canvas.getActiveObject();this.cache=o}t==="ctrl+v"&&n.type==="keydown"&&this.cache&&this.clone(this.cache)}contextMenu(){if(this.canvas.getActiveObject())return[{text:"复制",hotkey:"Ctrl+V",disabled:!1,onclick:()=>this.clone()}]}destroy(){console.log("pluginDestroy"),window.removeEventListener("paste",t=>this.pasteListener(t))}initPaste(){window.addEventListener("paste",t=>this.pasteListener(t))}pasteListener(t){return _t(this,null,function*(){const n=this.canvas;if(document.activeElement===document.body)t.preventDefault();else return;const o=(t.clipboardData||t.originalEvent.clipboardData).items,g=".pdf,.psd,.cdr,.ai,.svg,.jpg,.jpeg,.png,.webp,.json";for(const A of o)if(A.kind==="file"){const v=A.getAsFile(),f=v.name.split(".").pop();if(!g.split(",").includes(`.${f}`))return;if(f==="svg"){const i=yield iu(v);if(!i)throw new Error("file is undefined");nt.fabric.loadSVGFromURL(i,(c,l)=>{const r=nt.fabric.util.groupSVGElements(c,Ft(pt({},l),{name:"defaultSVG",id:Mt()}));n.add(r).centerObject(r).renderAll()})}if(A.type.indexOf("image/")===0){const i=URL.createObjectURL(v),c=document.createElement("img");c.src=i,document.body.appendChild(c),c.onload=()=>{const l=new nt.fabric.Image(c,{id:Mt(),name:"图片1",left:100,top:100});n.add(l),n.setActiveObject(l),n.renderAll(),c.remove()}}}else A.kind==="string"&&A.type.indexOf("text/plain")===0&&A.getAsString(v=>{const f=n.getActiveObject();if(f&&(f.type==="textbox"||f.type==="i-text")&&f.text){const i=f.selectionStart,c=f.text.substring(0,i),l=f.text.substring(i);f.set("text",c+v+l),f.selectionStart=i+v.length,f.selectionEnd=i+v.length,f.dirty=!0,n.renderAll()}else{const i=new nt.fabric.IText(v,{left:100,top:100,fontSize:80,id:Mt()});n.add(i),n.setActiveObject(i)}});o.length||this.cache&&this.clone(this.cache)})}}X(ws,"pluginName","CopyPlugin"),X(ws,"apis",["clone"]);class vu{constructor(t,n){X(this,"canvas");X(this,"editor");X(this,"hotkeys",["left","right","down","up"]);this.canvas=t,this.editor=n}hotkeyEvent(t,n){if(n.type==="keydown"){const{canvas:o}=this,g=o.getActiveObject();if(!g)return;switch(t){case"left":if(g.left===void 0)return;g.set("left",g.left-1);break;case"right":if(g.left===void 0)return;g.set("left",g.left+1);break;case"down":if(g.top===void 0)return;g.set("top",g.top+1);break;case"up":if(g.top===void 0)return;g.set("top",g.top-1);break}o.renderAll()}}destroy(){console.log("pluginDestroy")}}X(vu,"pluginName","MoveHotKeyPlugin");class bs{constructor(t,n){X(this,"canvas");X(this,"editor");X(this,"hotkeys",["backspace"]);this.canvas=t,this.editor=n}hotkeyEvent(t,n){n.type==="keydown"&&t==="backspace"&&this.del()}del(){const{canvas:t}=this,n=t.getActiveObjects();n&&(n.map(o=>t.remove(o)),t.requestRenderAll(),t.discardActiveObject())}contextMenu(){if(this.canvas.getActiveObject())return[null,{text:"删除",hotkey:"Ctrl+V",disabled:!1,onclick:()=>this.del()}]}destroy(){console.log("pluginDestroy")}}X(bs,"pluginName","DeleteHotKeyPlugin"),X(bs,"apis",["del"]);class Ss{constructor(t,n){X(this,"canvas");X(this,"editor");this.canvas=t,this.editor=n}unGroup(){const t=this.canvas.getActiveObject();if(!t)return;const n=t.getObjects();t.toActiveSelection();for(const o of n)o.set("id",Mt());this.canvas.discardActiveObject().renderAll()}group(){const t=this.canvas.getActiveObject();if(!t)return;const n=t.toGroup(),o=n.getObjects();n.clone(g=>{g.set("id",Mt()),this.canvas.remove(n),o.forEach(A=>{this.canvas.remove(A)}),this.canvas.add(g),this.canvas.setActiveObject(g)})}contextMenu(){const t=this.canvas.getActiveObject();if(t&&t.type==="group")return[{text:"拆分组合",hotkey:"Ctrl+V",disabled:!1,onclick:()=>this.unGroup()}];if(this.canvas.getActiveObjects().length>1)return[{text:"组合",hotkey:"Ctrl+V",disabled:!1,onclick:()=>this.group()}]}destroy(){console.log("pluginDestroy")}}X(Ss,"pluginName","GroupPlugin"),X(Ss,"apis",["unGroup","group"]);nt.fabric.Arrow=nt.fabric.util.createClass(nt.fabric.Line,{type:"arrow",superType:"drawing",initialize(e,t){if(!e){const{x1:n,x2:o,y1:g,y2:A}=t;e=[n,g,o,A]}t=t||{},this.callSuper("initialize",e,t)},_render(e){this.callSuper("_render",e),e.save(),e.scale(1/this.scaleX,1/this.scaleY);const t=(this.x2-this.x1)*this.scaleX,n=(this.y2-this.y1)*this.scaleY,o=Math.atan2(n,t);e.translate((this.x2-this.x1)/2*this.scaleX,(this.y2-this.y1)/2*this.scaleY),e.rotate(o),e.beginPath(),e.moveTo(5,0),e.lineTo(-5,5),e.lineTo(-5,-5),e.closePath(),e.lineWidth=this.lineWidth,e.strokeStyle=this.stroke,e.fillStyle=this.fill,e.stroke(),e.fill(),e.restore()}});nt.fabric.Arrow.fromObject=(e,t)=>{const{x1:n,x2:o,y1:g,y2:A}=e;return t(new nt.fabric.Arrow([n,g,o,A],e))};const gA=nt.fabric.Arrow;nt.fabric.ThinTailArrow=nt.fabric.util.createClass(nt.fabric.Line,{type:"thinTailArrow",superType:"drawing",initialize(e,t){if(!e){const{x1:n,x2:o,y1:g,y2:A}=t;e=[n,g,o,A]}t=t||{},this.callSuper("initialize",e,t)},_render(e){e.save(),e.scale(1/this.scaleX,1/this.scaleY);const t=(this.x2-this.x1)*this.scaleX,n=(this.y2-this.y1)*this.scaleY;e.translate(-t/2,-n/2);const o=Math.atan2(n,t);e.rotate(o);let g=Math.hypot(t,n);g=g<20?20:g,e.beginPath(),e.moveTo(0,0),e.lineTo(g-18,-5),e.lineTo(g-20,-12),e.lineTo(g,0),e.lineTo(g-20,12),e.lineTo(g-18,5),e.lineTo(0,0),e.lineWidth=this.strokeWidth,e.strokeStyle=this.stroke,e.fillStyle=this.fill,e.stroke(),e.fill(),e.restore()}});nt.fabric.ThinTailArrow.fromObject=(e,t)=>{const{x1:n,x2:o,y1:g,y2:A}=e;return t(new nt.fabric.ThinTailArrow([n,g,o,A],e))};const pA=nt.fabric.ThinTailArrow;class Es{constructor(t,n){X(this,"canvas");X(this,"editor");X(this,"isDrawingLineMode");X(this,"lineType");X(this,"lineToDraw");X(this,"pointer");X(this,"pointerPoints");X(this,"isDrawingLine");this.canvas=t,this.editor=n,this.isDrawingLine=!1,this.isDrawingLineMode=!1,this.lineType="",this.lineToDraw=null,this.pointer=null,this.pointerPoints=null,this.init()}init(){const{canvas:t}=this;t.on("mouse:down",n=>{if(!this.isDrawingLineMode)return;t.discardActiveObject(),t.getObjects().forEach(A=>{A.selectable=!1,A.hasControls=!1}),t.requestRenderAll(),this.isDrawingLine=!0,this.pointer=t.getPointer(n.e),this.pointerPoints=[this.pointer.x,this.pointer.y,this.pointer.x,this.pointer.y];let o,g={strokeWidth:2,stroke:"#000000",id:Mt()};switch(this.lineType){case"line":o=nt.fabric.Line;break;case"arrow":o=gA;break;case"thinTailArrow":o=pA,g={strokeWidth:2,stroke:"#ff0000",fill:"#ff0000",id:Mt()};break}if(!o)throw new Error("Draw failed: invalid lineType.");this.lineToDraw=new o(this.pointerPoints,g),this.lineToDraw.selectable=!1,this.lineToDraw.evented=!1,this.lineToDraw.strokeUniform=!0,t.add(this.lineToDraw)}),t.on("mouse:move",n=>{if(!(!this.isDrawingLine||!["line","arrow","thinTailArrow"].includes(this.lineType)||(t.discardActiveObject(),t.getActiveObject()))){if(this.pointer=t.getPointer(n.e),n.e.shiftKey){const g=this.pointerPoints[0],A=this.pointerPoints[1],v=this.pointer.x-g,f=this.pointer.y-A,i=Math.sqrt(v*v+f*f);let c=Math.atan2(f,v)/Math.PI*180;c=~~((c+7.5)%360/15)*15;const l=i*Math.cos(c*Math.PI/180),r=i*Math.sin(c*Math.PI/180);this.lineToDraw.set({x2:l+g,y2:r+A})}else this.lineToDraw.set({x2:this.pointer.x,y2:this.pointer.y});t.renderAll()}}),t.on("mouse:up",()=>{this.isDrawingLine&&(this.lineToDraw.setCoords(),this.isDrawingLine=!1,t.discardActiveObject())})}setLineType(t){this.lineType=t}setMode(t){this.isDrawingLineMode=t,this.isDrawingLineMode||this.endRest()}endRest(){this.canvas.getObjects().forEach(t=>{t.id!=="workspace"&&(t.selectable=!0,t.hasControls=!0)})}destroy(){console.log("pluginDestroy")}}X(Es,"pluginName","DrawLinePlugin"),X(Es,"apis",["setLineType","setMode"]);class yu{constructor(t,n){X(this,"canvas");X(this,"editor");X(this,"isDown",!1);this.canvas=t,this.editor=n,this._init()}_init(){this.canvas.on("mouse:down",t=>{this.isDown=!0,t.target&&!t.target.lockMovementX&&!t.target.lockMovementY&&!t.target.lockRotation&&!t.target.lockScalingX&&!t.target.lockScalingY&&(t.target.hasControls=!0)}),this.canvas.on("mouse:up",()=>{this.isDown=!1}),this.canvas.on("mouse:dblclick",t=>{if(t.target&&t.target.type==="group"){const n=this._getGroupObj(t);if(!n)return;if(n.selectable=!0,n.hasControls&&(n.hasControls=!1),this.isText(n)){this._bedingTextEditingEvent(n,t);return}this.canvas.setActiveObject(n),this.canvas.renderAll()}})}_getGroupTextObj(t){var g;const n=this.canvas.getPointer(t.e,!0),o=this.canvas._searchPossibleTargets((g=t.target)==null?void 0:g._objects,n);return o&&this.isText(o)?o:!1}_getGroupObj(t){var g;const n=this.canvas.getPointer(t.e,!0);return this.canvas._searchPossibleTargets((g=t.target)==null?void 0:g._objects,n)}_bedingTextEditingEvent(t,n){if(!n.target)return;const o=t.toObject(),g=n.target,v={"i-text":"IText",text:"Text",textbox:"Textbox"}[o.type],f=g.calcTransformMatrix(),i=f[0],c=f[1],l=f[2],r=f[3],a=f[4],s=f[5],u=i*t.left+l*t.top+a,d=c*t.left+r*t.top+s,h=new nt.fabric[v](t.text,Ft(pt({},o),{scaleX:o.scaleX*i,scaleY:o.scaleY*i,textAlign:t.textAlign,left:u,top:d,styles:t.styles,groupCopyed:t.group}));h.id=Mt(),t.visible=!1,n.target.addWithUpdate(),h.visible=!0,h.selectable=!0,h.hasConstrols=!1,h.editable=!0,this.canvas.add(h),this.canvas.setActiveObject(h),h.enterEditing(),h.selectAll(),h.on("editing:exited",()=>{t.set({text:h.text,visible:!0}),n.target.addWithUpdate(),h.visible=!1,this.canvas.remove(h),this.canvas.setActiveObject(n.target)})}_bedingEditingEvent(t,n){if(!n.target)return;const o=n.target.left,g=n.target.top,A=this._unGroup()||[],v=()=>{const f=this.canvas.getObjects().filter(c=>c.id&&A.includes(c.id));f.forEach(c=>this.canvas.remove(c));const i=new nt.fabric.Group([...f]);i.set("left",o),i.set("top",g),i.set("id",Mt()),t.off("editing:exited",v),this.canvas.add(i),this.canvas.discardActiveObject().renderAll()};t.on("editing:exited",v)}_unGroup(){const t=[],n=this.canvas.getActiveObject();if(n)return n.getObjects().forEach(o=>{const g=Mt();t.push(g),o.set("id",g)}),n.toActiveSelection(),t}isText(t){return t.type&&["i-text","text","textbox"].includes(t.type)}destroy(){console.log("pluginDestroy")}}X(yu,"pluginName","GroupTextEditorPlugin");class Is{constructor(t,n){X(this,"canvas");X(this,"editor");this.canvas=t,this.editor=n}left(){const{canvas:t}=this,n=t.getActiveObject(),o=t.getActiveObjects();if(n){const{left:g=0}=n;t.discardActiveObject(),o.forEach(v=>{const f=v.getBoundingRect(!0);v.set({left:g-f.left+Number(v.left)}),v.setCoords()});const A=new nt.fabric.ActiveSelection(o,{canvas:t});t.setActiveObject(A),t.requestRenderAll()}}right(){const{canvas:t}=this,n=t.getActiveObject(),o=t.getActiveObjects();if(n){const{left:g=0,width:A=0}=n;t.discardActiveObject(),o.forEach(f=>{const i=f.getBoundingRect(!0);f.set({left:g+A-(i.left+i.width)+Number(f.left)})});const v=new nt.fabric.ActiveSelection(o,{canvas:t});t.setActiveObject(v),t.requestRenderAll()}}xcenter(){const{canvas:t}=this,n=t.getActiveObject(),o=t.getActiveObjects();if(n){const{left:g=0,width:A=0}=n;t.discardActiveObject(),o.forEach(f=>{const i=f.getBoundingRect(!0);f.set({left:g+A/2-(i.left+i.width/2)+Number(f.left)})});const v=new nt.fabric.ActiveSelection(o,{canvas:t});t.setActiveObject(v),t.requestRenderAll()}}ycenter(){const{canvas:t}=this,n=t.getActiveObject(),o=t.getActiveObjects();if(n){const{top:g=0,height:A=0}=n;t.discardActiveObject(),o.forEach(f=>{const i=f.getBoundingRect(!0);f.set({top:g+A/2-(i.top+i.height/2)+Number(f.top)})});const v=new nt.fabric.ActiveSelection(o,{canvas:t});t.setActiveObject(v),t.requestRenderAll()}}top(){const{canvas:t}=this,n=t.getActiveObject(),o=t.getActiveObjects();if(n){const{top:g=0}=n;t.discardActiveObject(),o.forEach(v=>{const f=v.getBoundingRect(!0);v.set({top:g-f.top+Number(v.top)})});const A=new nt.fabric.ActiveSelection(o,{canvas:t});t.setActiveObject(A),t.requestRenderAll()}}bottom(){const{canvas:t}=this,n=t.getActiveObject(),o=t.getActiveObjects();if(n){const{top:g=0,height:A=0}=n;t.discardActiveObject(),o.forEach(f=>{const i=f.getBoundingRect(!0);f.set({top:g+A-(i.top+i.height)+Number(f.top)})});const v=new nt.fabric.ActiveSelection(o,{canvas:t});t.setActiveObject(v),t.requestRenderAll()}}xequation(){const{canvas:t}=this,n=t.getActiveObject();function o(f){return f.aCoords.tr.x-f.aCoords.tl.x}function g(){let f=0;return n&&n.forEachObject(i=>{f+=o(i)}),f}function A(){const f=g();if(n)return(Number(n.width)-f)/(n._objects.length-1)}function v(f){if(f===0)return 0;let i=0;if(n)for(let c=0;c<f;c++)i+=o(n._objects[c]);return i}if(n&&n.type==="activeSelection"){n._objects.sort((l,r)=>l.left-r.left);const i=A(),c=Number(n.width)/2;n.forEachObject((l,r)=>{const a=v(r),s=i*r+a-c;l.set("left",s)}),t.renderAll()}}yequation(){const{canvas:t}=this,n=t.getActiveObject()||{top:0,height:0};function o(f){return f.aCoords.bl.y-f.aCoords.tl.y}function g(){let f=0;return n.forEachObject(i=>{f+=o(i)}),f}function A(){const f=g();return(n.height-f)/(n._objects.length-1)}function v(f){if(f===0)return 0;let i=0;for(let c=0;c<f;c++)i+=o(n._objects[c]);return i}if(n&&n.type==="activeSelection"){n._objects.sort((l,r)=>l.top-r.top);const i=A(),c=Number(n.height)/2;n.forEachObject((l,r)=>{const a=v(r),s=i*r+a-c;l.set("top",s)}),t.renderAll()}}destroy(){console.log("pluginDestroy")}}X(Is,"pluginName","GroupAlignPlugin"),X(Is,"apis",["left","right","xcenter","ycenter","top","bottom","xequation","yequation"]);var AA=typeof global=="object"&&global&&global.Object===Object&&global;const _u=AA;var mA=typeof self=="object"&&self&&self.Object===Object&&self,vA=_u||mA||Function("return this")();const xe=vA;var yA=xe.Symbol;const Fe=yA;var Cu=Object.prototype,_A=Cu.hasOwnProperty,CA=Cu.toString,qn=Fe?Fe.toStringTag:void 0;function wA(e){var t=_A.call(e,qn),n=e[qn];try{e[qn]=void 0;var o=!0}catch(A){}var g=CA.call(e);return o&&(t?e[qn]=n:delete e[qn]),g}var bA=Object.prototype,SA=bA.toString;function EA(e){return SA.call(e)}var IA="[object Null]",xA="[object Undefined]",$a=Fe?Fe.toStringTag:void 0;function mn(e){return e==null?e===void 0?xA:IA:$a&&$a in Object(e)?wA(e):EA(e)}function We(e){return e!=null&&typeof e=="object"}var BA="[object Symbol]";function vr(e){return typeof e=="symbol"||We(e)&&mn(e)==BA}function TA(e,t){for(var n=-1,o=e==null?0:e.length,g=Array(o);++n<o;)g[n]=t(e[n],n,e);return g}var OA=Array.isArray;const Re=OA;var kA=1/0,Na=Fe?Fe.prototype:void 0,Ua=Na?Na.toString:void 0;function wu(e){if(typeof e=="string")return e;if(Re(e))return TA(e,wu)+"";if(vr(e))return Ua?Ua.call(e):"";var t=e+"";return t=="0"&&1/e==-kA?"-0":t}var DA=/\s/;function MA(e){for(var t=e.length;t--&&DA.test(e.charAt(t)););return t}var PA=/^\s+/;function QA(e){return e&&e.slice(0,MA(e)+1).replace(PA,"")}function je(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Ha=0/0,LA=/^[-+]0x[0-9a-f]+$/i,FA=/^0b[01]+$/i,RA=/^0o[0-7]+$/i,jA=parseInt;function Ga(e){if(typeof e=="number")return e;if(vr(e))return Ha;if(je(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=je(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=QA(e);var n=FA.test(e);return n||RA.test(e)?jA(e.slice(2),n?2:8):LA.test(e)?Ha:+e}function $A(e){return e}var NA="[object AsyncFunction]",UA="[object Function]",HA="[object GeneratorFunction]",GA="[object Proxy]";function bu(e){if(!je(e))return!1;var t=mn(e);return t==UA||t==HA||t==NA||t==GA}var zA=xe["__core-js_shared__"];const Rr=zA;var za=function(){var e=/[^.]+$/.exec(Rr&&Rr.keys&&Rr.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function YA(e){return!!za&&za in e}var VA=Function.prototype,WA=VA.toString;function vn(e){if(e!=null){try{return WA.call(e)}catch(t){}try{return e+""}catch(t){}}return""}var XA=/[\\^$.*+?()[\]{}|]/g,JA=/^\[object .+?Constructor\]$/,KA=Function.prototype,qA=Object.prototype,ZA=KA.toString,t1=qA.hasOwnProperty,e1=RegExp("^"+ZA.call(t1).replace(XA,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function n1(e){if(!je(e)||YA(e))return!1;var t=bu(e)?e1:JA;return t.test(vn(e))}function i1(e,t){return e==null?void 0:e[t]}function yn(e,t){var n=i1(e,t);return n1(n)?n:void 0}var r1=yn(xe,"WeakMap");const xs=r1;var Ya=Object.create,s1=function(){function e(){}return function(t){if(!je(t))return{};if(Ya)return Ya(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();const o1=s1;function Bs(){}function a1(e,t){var n=-1,o=e.length;for(t||(t=Array(o));++n<o;)t[n]=e[n];return t}var l1=function(){try{var e=yn(Object,"defineProperty");return e({},"",{}),e}catch(t){}}();const Va=l1;function c1(e,t){for(var n=-1,o=e==null?0:e.length;++n<o&&t(e[n],n,e)!==!1;);return e}function u1(e,t,n,o){for(var g=e.length,A=n+(o?1:-1);o?A--:++A<g;)if(t(e[A],A,e))return A;return-1}function h1(e){return e!==e}function f1(e,t,n){for(var o=n-1,g=e.length;++o<g;)if(e[o]===t)return o;return-1}function d1(e,t,n){return t===t?f1(e,t,n):u1(e,h1,n)}function g1(e,t){var n=e==null?0:e.length;return!!n&&d1(e,t,0)>-1}var p1=9007199254740991,A1=/^(?:0|[1-9]\d*)$/;function Su(e,t){var n=typeof e;return t=t==null?p1:t,!!t&&(n=="number"||n!="symbol"&&A1.test(e))&&e>-1&&e%1==0&&e<t}function Eu(e,t,n){t=="__proto__"&&Va?Va(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function xo(e,t){return e===t||e!==e&&t!==t}var m1=Object.prototype,v1=m1.hasOwnProperty;function Iu(e,t,n){var o=e[t];(!(v1.call(e,t)&&xo(o,n))||n===void 0&&!(t in e))&&Eu(e,t,n)}function yr(e,t,n,o){var g=!n;n||(n={});for(var A=-1,v=t.length;++A<v;){var f=t[A],i=o?o(n[f],e[f],f,n,e):void 0;i===void 0&&(i=e[f]),g?Eu(n,f,i):Iu(n,f,i)}return n}var y1=9007199254740991;function Bo(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=y1}function xu(e){return e!=null&&Bo(e.length)&&!bu(e)}var _1=Object.prototype;function To(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||_1;return e===n}function C1(e,t){for(var n=-1,o=Array(e);++n<e;)o[n]=t(n);return o}var w1="[object Arguments]";function Wa(e){return We(e)&&mn(e)==w1}var Bu=Object.prototype,b1=Bu.hasOwnProperty,S1=Bu.propertyIsEnumerable,E1=Wa(function(){return arguments}())?Wa:function(e){return We(e)&&b1.call(e,"callee")&&!S1.call(e,"callee")};const Tu=E1;function I1(){return!1}var Ou=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Xa=Ou&&typeof module=="object"&&module&&!module.nodeType&&module,x1=Xa&&Xa.exports===Ou,Ja=x1?xe.Buffer:void 0,B1=Ja?Ja.isBuffer:void 0,T1=B1||I1;const tr=T1;var O1="[object Arguments]",k1="[object Array]",D1="[object Boolean]",M1="[object Date]",P1="[object Error]",Q1="[object Function]",L1="[object Map]",F1="[object Number]",R1="[object Object]",j1="[object RegExp]",$1="[object Set]",N1="[object String]",U1="[object WeakMap]",H1="[object ArrayBuffer]",G1="[object DataView]",z1="[object Float32Array]",Y1="[object Float64Array]",V1="[object Int8Array]",W1="[object Int16Array]",X1="[object Int32Array]",J1="[object Uint8Array]",K1="[object Uint8ClampedArray]",q1="[object Uint16Array]",Z1="[object Uint32Array]",Ht={};Ht[z1]=Ht[Y1]=Ht[V1]=Ht[W1]=Ht[X1]=Ht[J1]=Ht[K1]=Ht[q1]=Ht[Z1]=!0;Ht[O1]=Ht[k1]=Ht[H1]=Ht[D1]=Ht[G1]=Ht[M1]=Ht[P1]=Ht[Q1]=Ht[L1]=Ht[F1]=Ht[R1]=Ht[j1]=Ht[$1]=Ht[N1]=Ht[U1]=!1;function tm(e){return We(e)&&Bo(e.length)&&!!Ht[mn(e)]}function Oo(e){return function(t){return e(t)}}var ku=typeof exports=="object"&&exports&&!exports.nodeType&&exports,ni=ku&&typeof module=="object"&&module&&!module.nodeType&&module,em=ni&&ni.exports===ku,jr=em&&_u.process,nm=function(){try{var e=ni&&ni.require&&ni.require("util").types;return e||jr&&jr.binding&&jr.binding("util")}catch(t){}}();const Fn=nm;var Ka=Fn&&Fn.isTypedArray,im=Ka?Oo(Ka):tm;const Du=im;var rm=Object.prototype,sm=rm.hasOwnProperty;function Mu(e,t){var n=Re(e),o=!n&&Tu(e),g=!n&&!o&&tr(e),A=!n&&!o&&!g&&Du(e),v=n||o||g||A,f=v?C1(e.length,String):[],i=f.length;for(var c in e)(t||sm.call(e,c))&&!(v&&(c=="length"||g&&(c=="offset"||c=="parent")||A&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||Su(c,i)))&&f.push(c);return f}function Pu(e,t){return function(n){return e(t(n))}}var om=Pu(Object.keys,Object);const am=om;var lm=Object.prototype,cm=lm.hasOwnProperty;function um(e){if(!To(e))return am(e);var t=[];for(var n in Object(e))cm.call(e,n)&&n!="constructor"&&t.push(n);return t}function _r(e){return xu(e)?Mu(e):um(e)}function hm(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t}var fm=Object.prototype,dm=fm.hasOwnProperty;function gm(e){if(!je(e))return hm(e);var t=To(e),n=[];for(var o in e)o=="constructor"&&(t||!dm.call(e,o))||n.push(o);return n}function ko(e){return xu(e)?Mu(e,!0):gm(e)}var pm=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Am=/^\w*$/;function Do(e,t){if(Re(e))return!1;var n=typeof e;return n=="number"||n=="symbol"||n=="boolean"||e==null||vr(e)?!0:Am.test(e)||!pm.test(e)||t!=null&&e in Object(t)}var mm=yn(Object,"create");const ui=mm;function vm(){this.__data__=ui?ui(null):{},this.size=0}function ym(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var _m="__lodash_hash_undefined__",Cm=Object.prototype,wm=Cm.hasOwnProperty;function bm(e){var t=this.__data__;if(ui){var n=t[e];return n===_m?void 0:n}return wm.call(t,e)?t[e]:void 0}var Sm=Object.prototype,Em=Sm.hasOwnProperty;function Im(e){var t=this.__data__;return ui?t[e]!==void 0:Em.call(t,e)}var xm="__lodash_hash_undefined__";function Bm(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=ui&&t===void 0?xm:t,this}function An(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}An.prototype.clear=vm;An.prototype.delete=ym;An.prototype.get=bm;An.prototype.has=Im;An.prototype.set=Bm;function Tm(){this.__data__=[],this.size=0}function Cr(e,t){for(var n=e.length;n--;)if(xo(e[n][0],t))return n;return-1}var Om=Array.prototype,km=Om.splice;function Dm(e){var t=this.__data__,n=Cr(t,e);if(n<0)return!1;var o=t.length-1;return n==o?t.pop():km.call(t,n,1),--this.size,!0}function Mm(e){var t=this.__data__,n=Cr(t,e);return n<0?void 0:t[n][1]}function Pm(e){return Cr(this.__data__,e)>-1}function Qm(e,t){var n=this.__data__,o=Cr(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this}function Xe(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}Xe.prototype.clear=Tm;Xe.prototype.delete=Dm;Xe.prototype.get=Mm;Xe.prototype.has=Pm;Xe.prototype.set=Qm;var Lm=yn(xe,"Map");const hi=Lm;function Fm(){this.size=0,this.__data__={hash:new An,map:new(hi||Xe),string:new An}}function Rm(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function wr(e,t){var n=e.__data__;return Rm(t)?n[typeof t=="string"?"string":"hash"]:n.map}function jm(e){var t=wr(this,e).delete(e);return this.size-=t?1:0,t}function $m(e){return wr(this,e).get(e)}function Nm(e){return wr(this,e).has(e)}function Um(e,t){var n=wr(this,e),o=n.size;return n.set(e,t),this.size+=n.size==o?0:1,this}function Je(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}Je.prototype.clear=Fm;Je.prototype.delete=jm;Je.prototype.get=$m;Je.prototype.has=Nm;Je.prototype.set=Um;var Hm="Expected a function";function Mo(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(Hm);var n=function(){var o=arguments,g=t?t.apply(this,o):o[0],A=n.cache;if(A.has(g))return A.get(g);var v=e.apply(this,o);return n.cache=A.set(g,v)||A,v};return n.cache=new(Mo.Cache||Je),n}Mo.Cache=Je;var Gm=500;function zm(e){var t=Mo(e,function(o){return n.size===Gm&&n.clear(),o}),n=t.cache;return t}var Ym=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Vm=/\\(\\)?/g,Wm=zm(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Ym,function(n,o,g,A){t.push(g?A.replace(Vm,"$1"):o||n)}),t});const Xm=Wm;function Jm(e){return e==null?"":wu(e)}function Qu(e,t){return Re(e)?e:Do(e,t)?[e]:Xm(Jm(e))}var Km=1/0;function br(e){if(typeof e=="string"||vr(e))return e;var t=e+"";return t=="0"&&1/e==-Km?"-0":t}function Lu(e,t){t=Qu(t,e);for(var n=0,o=t.length;e!=null&&n<o;)e=e[br(t[n++])];return n&&n==o?e:void 0}function qm(e,t,n){var o=e==null?void 0:Lu(e,t);return o===void 0?n:o}function Fu(e,t){for(var n=-1,o=t.length,g=e.length;++n<o;)e[g+n]=t[n];return e}var Zm=Pu(Object.getPrototypeOf,Object);const Ru=Zm;function tv(){this.__data__=new Xe,this.size=0}function ev(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function nv(e){return this.__data__.get(e)}function iv(e){return this.__data__.has(e)}var rv=200;function sv(e,t){var n=this.__data__;if(n instanceof Xe){var o=n.__data__;if(!hi||o.length<rv-1)return o.push([e,t]),this.size=++n.size,this;n=this.__data__=new Je(o)}return n.set(e,t),this.size=n.size,this}function Me(e){var t=this.__data__=new Xe(e);this.size=t.size}Me.prototype.clear=tv;Me.prototype.delete=ev;Me.prototype.get=nv;Me.prototype.has=iv;Me.prototype.set=sv;function ov(e,t){return e&&yr(t,_r(t),e)}function av(e,t){return e&&yr(t,ko(t),e)}var ju=typeof exports=="object"&&exports&&!exports.nodeType&&exports,qa=ju&&typeof module=="object"&&module&&!module.nodeType&&module,lv=qa&&qa.exports===ju,Za=lv?xe.Buffer:void 0,tl=Za?Za.allocUnsafe:void 0;function cv(e,t){if(t)return e.slice();var n=e.length,o=tl?tl(n):new e.constructor(n);return e.copy(o),o}function uv(e,t){for(var n=-1,o=e==null?0:e.length,g=0,A=[];++n<o;){var v=e[n];t(v,n,e)&&(A[g++]=v)}return A}function $u(){return[]}var hv=Object.prototype,fv=hv.propertyIsEnumerable,el=Object.getOwnPropertySymbols,dv=el?function(e){return e==null?[]:(e=Object(e),uv(el(e),function(t){return fv.call(e,t)}))}:$u;const Po=dv;function gv(e,t){return yr(e,Po(e),t)}var pv=Object.getOwnPropertySymbols,Av=pv?function(e){for(var t=[];e;)Fu(t,Po(e)),e=Ru(e);return t}:$u;const Nu=Av;function mv(e,t){return yr(e,Nu(e),t)}function Uu(e,t,n){var o=t(e);return Re(e)?o:Fu(o,n(e))}function Ts(e){return Uu(e,_r,Po)}function vv(e){return Uu(e,ko,Nu)}var yv=yn(xe,"DataView");const Os=yv;var _v=yn(xe,"Promise");const ks=_v;var Cv=yn(xe,"Set");const Mn=Cv;var nl="[object Map]",wv="[object Object]",il="[object Promise]",rl="[object Set]",sl="[object WeakMap]",ol="[object DataView]",bv=vn(Os),Sv=vn(hi),Ev=vn(ks),Iv=vn(Mn),xv=vn(xs),ln=mn;(Os&&ln(new Os(new ArrayBuffer(1)))!=ol||hi&&ln(new hi)!=nl||ks&&ln(ks.resolve())!=il||Mn&&ln(new Mn)!=rl||xs&&ln(new xs)!=sl)&&(ln=function(e){var t=mn(e),n=t==wv?e.constructor:void 0,o=n?vn(n):"";if(o)switch(o){case bv:return ol;case Sv:return nl;case Ev:return il;case Iv:return rl;case xv:return sl}return t});const fi=ln;var Bv=Object.prototype,Tv=Bv.hasOwnProperty;function Ov(e){var t=e.length,n=new e.constructor(t);return t&&typeof e[0]=="string"&&Tv.call(e,"index")&&(n.index=e.index,n.input=e.input),n}var kv=xe.Uint8Array;const er=kv;function Qo(e){var t=new e.constructor(e.byteLength);return new er(t).set(new er(e)),t}function Dv(e,t){var n=t?Qo(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}var Mv=/\w*$/;function Pv(e){var t=new e.constructor(e.source,Mv.exec(e));return t.lastIndex=e.lastIndex,t}var al=Fe?Fe.prototype:void 0,ll=al?al.valueOf:void 0;function Qv(e){return ll?Object(ll.call(e)):{}}function Lv(e,t){var n=t?Qo(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}var Fv="[object Boolean]",Rv="[object Date]",jv="[object Map]",$v="[object Number]",Nv="[object RegExp]",Uv="[object Set]",Hv="[object String]",Gv="[object Symbol]",zv="[object ArrayBuffer]",Yv="[object DataView]",Vv="[object Float32Array]",Wv="[object Float64Array]",Xv="[object Int8Array]",Jv="[object Int16Array]",Kv="[object Int32Array]",qv="[object Uint8Array]",Zv="[object Uint8ClampedArray]",t0="[object Uint16Array]",e0="[object Uint32Array]";function n0(e,t,n){var o=e.constructor;switch(t){case zv:return Qo(e);case Fv:case Rv:return new o(+e);case Yv:return Dv(e,n);case Vv:case Wv:case Xv:case Jv:case Kv:case qv:case Zv:case t0:case e0:return Lv(e,n);case jv:return new o;case $v:case Hv:return new o(e);case Nv:return Pv(e);case Uv:return new o;case Gv:return Qv(e)}}function i0(e){return typeof e.constructor=="function"&&!To(e)?o1(Ru(e)):{}}var r0="[object Map]";function s0(e){return We(e)&&fi(e)==r0}var cl=Fn&&Fn.isMap,o0=cl?Oo(cl):s0;const a0=o0;var l0="[object Set]";function c0(e){return We(e)&&fi(e)==l0}var ul=Fn&&Fn.isSet,u0=ul?Oo(ul):c0;const h0=u0;var f0=1,d0=2,g0=4,Hu="[object Arguments]",p0="[object Array]",A0="[object Boolean]",m0="[object Date]",v0="[object Error]",Gu="[object Function]",y0="[object GeneratorFunction]",_0="[object Map]",C0="[object Number]",zu="[object Object]",w0="[object RegExp]",b0="[object Set]",S0="[object String]",E0="[object Symbol]",I0="[object WeakMap]",x0="[object ArrayBuffer]",B0="[object DataView]",T0="[object Float32Array]",O0="[object Float64Array]",k0="[object Int8Array]",D0="[object Int16Array]",M0="[object Int32Array]",P0="[object Uint8Array]",Q0="[object Uint8ClampedArray]",L0="[object Uint16Array]",F0="[object Uint32Array]",$t={};$t[Hu]=$t[p0]=$t[x0]=$t[B0]=$t[A0]=$t[m0]=$t[T0]=$t[O0]=$t[k0]=$t[D0]=$t[M0]=$t[_0]=$t[C0]=$t[zu]=$t[w0]=$t[b0]=$t[S0]=$t[E0]=$t[P0]=$t[Q0]=$t[L0]=$t[F0]=!0;$t[v0]=$t[Gu]=$t[I0]=!1;function Ni(e,t,n,o,g,A){var v,f=t&f0,i=t&d0,c=t&g0;if(n&&(v=g?n(e,o,g,A):n(e)),v!==void 0)return v;if(!je(e))return e;var l=Re(e);if(l){if(v=Ov(e),!f)return a1(e,v)}else{var r=fi(e),a=r==Gu||r==y0;if(tr(e))return cv(e,f);if(r==zu||r==Hu||a&&!g){if(v=i||a?{}:i0(e),!f)return i?mv(e,av(v,e)):gv(e,ov(v,e))}else{if(!$t[r])return g?e:{};v=n0(e,r,f)}}A||(A=new Me);var s=A.get(e);if(s)return s;A.set(e,v),h0(e)?e.forEach(function(h){v.add(Ni(h,t,n,h,e,A))}):a0(e)&&e.forEach(function(h,p){v.set(p,Ni(h,t,n,p,e,A))});var u=c?i?vv:Ts:i?ko:_r,d=l?void 0:u(e);return c1(d||e,function(h,p){d&&(p=h,h=e[p]),Iu(v,p,Ni(h,t,n,p,e,A))}),v}var R0=1,j0=4;function Yu(e){return Ni(e,R0|j0)}var $0="__lodash_hash_undefined__";function N0(e){return this.__data__.set(e,$0),this}function U0(e){return this.__data__.has(e)}function di(e){var t=-1,n=e==null?0:e.length;for(this.__data__=new Je;++t<n;)this.add(e[t])}di.prototype.add=di.prototype.push=N0;di.prototype.has=U0;function H0(e,t){for(var n=-1,o=e==null?0:e.length;++n<o;)if(t(e[n],n,e))return!0;return!1}function Vu(e,t){return e.has(t)}var G0=1,z0=2;function Wu(e,t,n,o,g,A){var v=n&G0,f=e.length,i=t.length;if(f!=i&&!(v&&i>f))return!1;var c=A.get(e),l=A.get(t);if(c&&l)return c==t&&l==e;var r=-1,a=!0,s=n&z0?new di:void 0;for(A.set(e,t),A.set(t,e);++r<f;){var u=e[r],d=t[r];if(o)var h=v?o(d,u,r,t,e,A):o(u,d,r,e,t,A);if(h!==void 0){if(h)continue;a=!1;break}if(s){if(!H0(t,function(p,m){if(!Vu(s,m)&&(u===p||g(u,p,n,o,A)))return s.push(m)})){a=!1;break}}else if(!(u===d||g(u,d,n,o,A))){a=!1;break}}return A.delete(e),A.delete(t),a}function Y0(e){var t=-1,n=Array(e.size);return e.forEach(function(o,g){n[++t]=[g,o]}),n}function Lo(e){var t=-1,n=Array(e.size);return e.forEach(function(o){n[++t]=o}),n}var V0=1,W0=2,X0="[object Boolean]",J0="[object Date]",K0="[object Error]",q0="[object Map]",Z0="[object Number]",ty="[object RegExp]",ey="[object Set]",ny="[object String]",iy="[object Symbol]",ry="[object ArrayBuffer]",sy="[object DataView]",hl=Fe?Fe.prototype:void 0,$r=hl?hl.valueOf:void 0;function oy(e,t,n,o,g,A,v){switch(n){case sy:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case ry:return!(e.byteLength!=t.byteLength||!A(new er(e),new er(t)));case X0:case J0:case Z0:return xo(+e,+t);case K0:return e.name==t.name&&e.message==t.message;case ty:case ny:return e==t+"";case q0:var f=Y0;case ey:var i=o&V0;if(f||(f=Lo),e.size!=t.size&&!i)return!1;var c=v.get(e);if(c)return c==t;o|=W0,v.set(e,t);var l=Wu(f(e),f(t),o,g,A,v);return v.delete(e),l;case iy:if($r)return $r.call(e)==$r.call(t)}return!1}var ay=1,ly=Object.prototype,cy=ly.hasOwnProperty;function uy(e,t,n,o,g,A){var v=n&ay,f=Ts(e),i=f.length,c=Ts(t),l=c.length;if(i!=l&&!v)return!1;for(var r=i;r--;){var a=f[r];if(!(v?a in t:cy.call(t,a)))return!1}var s=A.get(e),u=A.get(t);if(s&&u)return s==t&&u==e;var d=!0;A.set(e,t),A.set(t,e);for(var h=v;++r<i;){a=f[r];var p=e[a],m=t[a];if(o)var y=v?o(m,p,a,t,e,A):o(p,m,a,e,t,A);if(!(y===void 0?p===m||g(p,m,n,o,A):y)){d=!1;break}h||(h=a=="constructor")}if(d&&!h){var _=e.constructor,C=t.constructor;_!=C&&"constructor"in e&&"constructor"in t&&!(typeof _=="function"&&_ instanceof _&&typeof C=="function"&&C instanceof C)&&(d=!1)}return A.delete(e),A.delete(t),d}var hy=1,fl="[object Arguments]",dl="[object Array]",Si="[object Object]",fy=Object.prototype,gl=fy.hasOwnProperty;function dy(e,t,n,o,g,A){var v=Re(e),f=Re(t),i=v?dl:fi(e),c=f?dl:fi(t);i=i==fl?Si:i,c=c==fl?Si:c;var l=i==Si,r=c==Si,a=i==c;if(a&&tr(e)){if(!tr(t))return!1;v=!0,l=!1}if(a&&!l)return A||(A=new Me),v||Du(e)?Wu(e,t,n,o,g,A):oy(e,t,i,n,o,g,A);if(!(n&hy)){var s=l&&gl.call(e,"__wrapped__"),u=r&&gl.call(t,"__wrapped__");if(s||u){var d=s?e.value():e,h=u?t.value():t;return A||(A=new Me),g(d,h,n,o,A)}}return a?(A||(A=new Me),uy(e,t,n,o,g,A)):!1}function Fo(e,t,n,o,g){return e===t?!0:e==null||t==null||!We(e)&&!We(t)?e!==e&&t!==t:dy(e,t,n,o,Fo,g)}var gy=1,py=2;function Ay(e,t,n,o){var g=n.length,A=g,v=!o;if(e==null)return!A;for(e=Object(e);g--;){var f=n[g];if(v&&f[2]?f[1]!==e[f[0]]:!(f[0]in e))return!1}for(;++g<A;){f=n[g];var i=f[0],c=e[i],l=f[1];if(v&&f[2]){if(c===void 0&&!(i in e))return!1}else{var r=new Me;if(o)var a=o(c,l,i,e,t,r);if(!(a===void 0?Fo(l,c,gy|py,o,r):a))return!1}}return!0}function Xu(e){return e===e&&!je(e)}function my(e){for(var t=_r(e),n=t.length;n--;){var o=t[n],g=e[o];t[n]=[o,g,Xu(g)]}return t}function Ju(e,t){return function(n){return n==null?!1:n[e]===t&&(t!==void 0||e in Object(n))}}function vy(e){var t=my(e);return t.length==1&&t[0][2]?Ju(t[0][0],t[0][1]):function(n){return n===e||Ay(n,e,t)}}function yy(e,t){return e!=null&&t in Object(e)}function _y(e,t,n){t=Qu(t,e);for(var o=-1,g=t.length,A=!1;++o<g;){var v=br(t[o]);if(!(A=e!=null&&n(e,v)))break;e=e[v]}return A||++o!=g?A:(g=e==null?0:e.length,!!g&&Bo(g)&&Su(v,g)&&(Re(e)||Tu(e)))}function Cy(e,t){return e!=null&&_y(e,t,yy)}var wy=1,by=2;function Sy(e,t){return Do(e)&&Xu(t)?Ju(br(e),t):function(n){var o=qm(n,e);return o===void 0&&o===t?Cy(n,e):Fo(t,o,wy|by)}}function Ey(e){return function(t){return t==null?void 0:t[e]}}function Iy(e){return function(t){return Lu(t,e)}}function xy(e){return Do(e)?Ey(br(e)):Iy(e)}function By(e){return typeof e=="function"?e:e==null?$A:typeof e=="object"?Re(e)?Sy(e[0],e[1]):vy(e):xy(e)}var Ty=function(){return xe.Date.now()};const Nr=Ty;var Oy="Expected a function",ky=Math.max,Dy=Math.min;function _n(e,t,n){var o,g,A,v,f,i,c=0,l=!1,r=!1,a=!0;if(typeof e!="function")throw new TypeError(Oy);t=Ga(t)||0,je(n)&&(l=!!n.leading,r="maxWait"in n,A=r?ky(Ga(n.maxWait)||0,t):A,a="trailing"in n?!!n.trailing:a);function s(w){var b=o,S=g;return o=g=void 0,c=w,v=e.apply(S,b),v}function u(w){return c=w,f=setTimeout(p,t),l?s(w):v}function d(w){var b=w-i,S=w-c,F=t-b;return r?Dy(F,A-S):F}function h(w){var b=w-i,S=w-c;return i===void 0||b>=t||b<0||r&&S>=A}function p(){var w=Nr();if(h(w))return m(w);f=setTimeout(p,d(w))}function m(w){return f=void 0,a&&o?s(w):(o=g=void 0,v)}function y(){f!==void 0&&clearTimeout(f),c=0,o=i=g=f=void 0}function _(){return f===void 0?v:m(Nr())}function C(){var w=Nr(),b=h(w);if(o=arguments,g=this,i=w,b){if(f===void 0)return u(i);if(r)return clearTimeout(f),f=setTimeout(p,t),s(i)}return f===void 0&&(f=setTimeout(p,t)),v}return C.cancel=y,C.flush=_,C}function My(e,t,n){for(var o=-1,g=e==null?0:e.length;++o<g;)if(n(t,e[o]))return!0;return!1}var Py="[object Number]";function le(e){return typeof e=="number"||We(e)&&mn(e)==Py}function Qy(e){return e===void 0}var Ly="Expected a function";function Ds(e,t,n){var o=!0,g=!0;if(typeof e!="function")throw new TypeError(Ly);return je(n)&&(o="leading"in n?!!n.leading:o,g="trailing"in n?!!n.trailing:g),_n(e,t,{leading:o,maxWait:t,trailing:g})}var Fy=1/0,Ry=Mn&&1/Lo(new Mn([,-0]))[1]==Fy?function(e){return new Mn(e)}:Bs;const jy=Ry;var $y=200;function Ny(e,t,n){var o=-1,g=g1,A=e.length,v=!0,f=[],i=f;if(n)v=!1,g=My;else if(A>=$y){var c=t?null:jy(e);if(c)return Lo(c);v=!1,g=Vu,i=new di}else i=t?[]:f;t:for(;++o<A;){var l=e[o],r=t?t(l):l;if(l=n||l!==0?l:0,v&&r===r){for(var a=i.length;a--;)if(i[a]===r)continue t;t&&i.push(r),f.push(l)}else g(i,r,n)||(i!==f&&i.push(r),f.push(l))}return f}function Uy(e,t){return e&&e.length?Ny(e,By(t)):[]}class Ui{constructor(t,n){X(this,"canvas");X(this,"editor");X(this,"workspaceEl");X(this,"workspace");X(this,"option");X(this,"zoomRatio");this.canvas=t,this.editor=n,this.workspace=null,this.init({width:900,height:2e3}),this.zoomRatio=.85}init(t){const n=document.querySelector("#workspace");if(!n)throw new Error("element #workspace is missing, plz check!");this.workspaceEl=n,this.workspace=null,this.option=t,this._initBackground(),this._initWorkspace(),this._initResizeObserve(),this._bindWheel()}hookImportAfter(){return new Promise(t=>{const n=this.canvas.getObjects().find(o=>o.id==="workspace");n&&(n.set("selectable",!1),n.set("hasControls",!1),this.setSize(n.width,n.height),this.editor.emit("sizeChange",n.width,n.height)),t("")})}hookSaveAfter(){return new Promise(t=>{this.auto(),t(!0)})}_initBackground(){this.canvas.backgroundImage="",this.canvas.setWidth(this.workspaceEl.offsetWidth),this.canvas.setHeight(this.workspaceEl.offsetHeight)}_initWorkspace(){const{width:t,height:n}=this.option,o=new nt.fabric.Rect({fill:"rgba(255,255,255,1)",width:t,height:n,id:"workspace",strokeWidth:0});o.set("selectable",!1),o.set("hasControls",!1),o.hoverCursor="default",this.canvas.add(o),this.canvas.renderAll(),this.workspace=o,this.canvas.clearHistory&&this.canvas.clearHistory(),this.auto()}getWorkspase(){return this.canvas.getObjects().find(t=>t.id==="workspace")}setCenterFromObject(t){const{canvas:n}=this,o=t.getCenterPoint(),g=n.viewportTransform;n.width===void 0||n.height===void 0||!g||(g[4]=n.width/2-o.x*g[0],g[5]=n.height/2-o.y*g[3],n.setViewportTransform(g),n.renderAll())}_initResizeObserve(){new ResizeObserver(Ds(()=>{this.auto()},50)).observe(this.workspaceEl)}setSize(t,n){this._initBackground(),this.option.width=t,this.option.height=n,this.workspace=this.canvas.getObjects().find(o=>o.id==="workspace"),this.workspace.set("width",t),this.workspace.set("height",n),this.editor.emit("sizeChange",this.workspace.width,this.workspace.height),this.auto()}setZoomAuto(t,n){const{workspaceEl:o}=this,g=o.offsetWidth,A=o.offsetHeight;this.canvas.setWidth(g),this.canvas.setHeight(A);const v=this.canvas.getCenter();this.canvas.setViewportTransform(nt.fabric.iMatrix.concat()),this.canvas.zoomToPoint(new nt.fabric.Point(v.left,v.top),t),this.workspace&&(this.setCenterFromObject(this.workspace),this.workspace.clone(f=>{this.canvas.clipPath=f,this.canvas.requestRenderAll()}),n&&n(this.workspace.left,this.workspace.top))}_getScale(){return nt.fabric.util.findScaleToFit(this.getWorkspase(),{width:this.workspaceEl.offsetWidth,height:this.workspaceEl.offsetHeight})}big(){let t=this.canvas.getZoom();t+=.05;const n=this.canvas.getCenter();this.canvas.zoomToPoint(new nt.fabric.Point(n.left,n.top),t)}small(){let t=this.canvas.getZoom();t-=.05;const n=this.canvas.getCenter();this.canvas.zoomToPoint(new nt.fabric.Point(n.left,n.top),t<0?.01:t)}auto(){const t=this._getScale();this.setZoomAuto(t*this.zoomRatio)}one(){this.setZoomAuto(1*this.zoomRatio),this.canvas.requestRenderAll()}setWorkspaseBg(t){const n=this.getWorkspase();n==null||n.set("fill",t)}_bindWheel(){this.canvas.on("mouse:wheel",function(t){const n=t.e.deltaY;let o=this.getZoom();o*=Wn(.999,n),o>20&&(o=20),o<.01&&(o=.01);const g=this.getCenter();this.zoomToPoint(new nt.fabric.Point(g.left,g.top),o),t.e.preventDefault(),t.e.stopPropagation()})}destroy(){console.log("pluginDestroy")}}X(Ui,"pluginName","WorkspacePlugin"),X(Ui,"events",["sizeChange"]),X(Ui,"apis",["big","small","auto","one","setSize","getWorkspase","setWorkspaseBg"]);fabric.Canvas.prototype.initialize=function(e){return function(...t){return e.call(this,...t),this._historyInit(),this}}(fabric.Canvas.prototype.initialize),fabric.Canvas.prototype.dispose=function(e){return function(...t){return e.call(this,...t),this._historyDispose(),this}}(fabric.Canvas.prototype.dispose),fabric.Canvas.prototype._historyNext=function(){return JSON.stringify(this.toDatalessJSON(this.extraProps))},fabric.Canvas.prototype._historyEvents=function(){return{"object:added":this._historySaveAction,"object:removed":this._historySaveAction,"object:modified":this._historySaveAction,"object:skewing":this._historySaveAction}},fabric.Canvas.prototype._historyInit=function(){this.historyUndo=[],this.historyRedo=[],this.extraProps=["selectable","editable"],this.historyNextState=this._historyNext(),this.on(this._historyEvents())},fabric.Canvas.prototype._historyDispose=function(){this.off(this._historyEvents())},fabric.Canvas.prototype._historySaveAction=function(){if(this.historyProcessing)return;const e=this.historyNextState;this.historyUndo.push(e),this.historyNextState=this._historyNext(),this.fire("history:append",{json:e})},fabric.Canvas.prototype.undo=function(e){this.historyProcessing=!0;const t=this.historyUndo.pop();t?(this.historyRedo.push(this._historyNext()),this.historyNextState=t,this._loadHistory(t,"history:undo",e)):this.historyProcessing=!1},fabric.Canvas.prototype.redo=function(e){this.historyProcessing=!0;const t=this.historyRedo.pop();t?(this.historyUndo.push(this._historyNext()),this.historyNextState=t,this._loadHistory(t,"history:redo",e)):this.historyProcessing=!1},fabric.Canvas.prototype._loadHistory=function(e,t,n){var o=this;this.loadFromJSON(e,function(){o.renderAll(),o.fire(t),o.historyProcessing=!1,n&&typeof n=="function"&&n()})},fabric.Canvas.prototype.clearHistory=function(){this.historyUndo=[],this.historyRedo=[],this.fire("history:clear")},fabric.Canvas.prototype.onHistory=function(){this.historyProcessing=!1,this._historySaveAction()},fabric.Canvas.prototype.offHistory=function(){this.historyProcessing=!0};class Hi{constructor(t,n){X(this,"canvas");X(this,"editor");X(this,"hotkeys",["ctrl+z","ctrl+shift+z","⌘+z","⌘+shift+z"]);this.canvas=t,this.editor=n,nt.fabric.Canvas.prototype._historyNext=()=>this.editor.getJson(),this._init()}_init(){this.canvas.on("history:append",()=>{this.historyUpdate()}),window.addEventListener("beforeunload",t=>{this.canvas.historyUndo.length>0&&((t||window.event).returnValue="确认离开")})}historyUpdate(){const{historyUndo:t,historyRedo:n}=this.canvas;this.editor.emit("historyUpdate",t.length,n.length)}hookImportAfter(){return this.canvas.clearHistory(),this.historyUpdate(),Promise.resolve()}undo(){if(this.canvas.historyUndo.length===1){this.editor.clear(),this.canvas.clearHistory();return}this.canvas.undo(),this.historyUpdate()}redo(){this.canvas.redo(),this.historyUpdate()}hotkeyEvent(t,n){if(n.type==="keydown")switch(t){case"ctrl+z":case"⌘+z":this.undo();break;case"ctrl+shift+z":case"⌘+shift+z":this.redo();break}}}X(Hi,"pluginName","HistoryPlugin"),X(Hi,"apis",["undo","redo"]),X(Hi,"events",["historyUpdate"]);const pl=e=>e;class Ms{constructor(t,n){X(this,"canvas");X(this,"editor");this.canvas=t,this.editor=n}flip(t){const n=this.canvas.getActiveObject();n&&(n.set(`flip${t}`,!n[`flip${t}`]).setCoords(),this.canvas.requestRenderAll())}contextMenu(){if(this.editor.getSelectMode()===en.ONE)return[{text:"翻转",hotkey:"❯",subitems:[{text:pl("flip.x"),hotkey:"|",onclick:()=>this.flip("X")},{text:pl("flip.y"),hotkey:"-",onclick:()=>this.flip("Y")}]}]}destroy(){console.log("pluginDestroy")}}X(Ms,"pluginName","FlipPlugin"),X(Ms,"apis",["flip"]);const Hy=e=>{const t=[.02,.03,.05,.1,.2,.5,1,2,5,10,18],n=[5e3,2500,1e3,500,250,100,50,25,10,5,2];let o=0;for(;o<t.length&&t[o]<e;)o++;return n[o-1]||5e3},Al=(e,t)=>{const n=t?"left":"top",o=t?"width":"height";e.sort((v,f)=>v[n]-f[n]);const g=[];let A=Object.assign({},e[0]);for(const v of e){const f=Object.assign({},v);A[n]+A[o]>=f[n]?A[o]=Math.max(A[n]+A[o],f[n]+f[o])-A[n]:(g.push(A),A=Object.assign({},f))}return g.push(A),g},Ur=(e,t)=>{e.save();const{left:n,top:o,width:g,height:A,stroke:v,lineWidth:f}=t;e.beginPath(),v&&(e.strokeStyle=v),e.lineWidth=f!=null?f:1,e.moveTo(n,o),e.lineTo(n+g,o+A),e.stroke(),e.restore()},Hr=(e,t)=>{e.save();const{left:n,top:o,text:g,fill:A,align:v,angle:f,fontSize:i}=t;A&&(e.fillStyle=A),e.textAlign=v!=null?v:"left",e.textBaseline="top",e.font=`${i!=null?i:10}px sans-serif`,f&&(e.translate(n,o),e.rotate(Math.PI/180*f),e.translate(-n,-o)),e.fillText(g,n,o),e.restore()},Ps=(e,t)=>{e.save();const{left:n,top:o,width:g,height:A,fill:v,stroke:f,strokeWidth:i}=t;e.beginPath(),v&&(e.fillStyle=v),e.rect(n,o,g,A),e.fill(),f&&(e.strokeStyle=f,e.lineWidth=i!=null?i:1,e.stroke()),e.restore()},Ei=(e,t)=>{e.save();const{isHorizontal:n,left:o,top:g,width:A,height:v,backgroundColor:f}=t,i=n?e.createLinearGradient(o,v/2,o+A,v/2):e.createLinearGradient(A/2,g,A/2,v+g),c=new nt.fabric.Color(f);c.setAlpha(0),i.addColorStop(0,c.toRgba()),i.addColorStop(.33,f),i.addColorStop(.67,f),i.addColorStop(1,c.toRgba()),Ps(e,{left:o,top:g,width:A,height:v,fill:i}),e.restore()};function Gy(){nt.fabric.GuideLine||(nt.fabric.GuideLine=nt.fabric.util.createClass(nt.fabric.Line,{type:"GuideLine",selectable:!1,hasControls:!1,hasBorders:!1,stroke:"#4bec13",originX:"center",originY:"center",padding:4,globalCompositeOperation:"difference",axis:"horizontal",initialize(e,t){const n=t.axis==="horizontal";this.hoverCursor=n?"ns-resize":"ew-resize";const o=n?[-999999,e,999999,e]:[e,-999999,e,999999];t[n?"lockMovementX":"lockMovementY"]=!0,this.callSuper("initialize",o,t),this.on("mousedown:before",g=>{this.activeOn==="down"&&this.canvas&&this.canvas.setActiveObject(this,g.e)}),this.on("moving",g=>{this.canvas&&this.canvas.ruler.options.enabled&&this.isPointOnRuler(g.e)?this.moveCursor="not-allowed":this.moveCursor=this.isHorizontal()?"ns-resize":"ew-resize",this.canvas&&this.canvas.fire("guideline:moving",{target:this,e:g.e})}),this.on("mouseup",g=>{if(this.canvas&&this.canvas.ruler.options.enabled&&this.isPointOnRuler(g.e)){this.canvas.remove(this);return}this.moveCursor=this.isHorizontal()?"ns-resize":"ew-resize",this.canvas&&this.canvas.fire("guideline:mouseup",{target:this,e:g.e})}),this.on("removed",()=>{this.off("removed"),this.off("mousedown:before"),this.off("moving"),this.off("mouseup")})},getBoundingRect(e,t){this.bringToFront();const n=this.isHorizontal(),o=this.callSuper("getBoundingRect",e,t);return o[n?"top":"left"]+=o[n?"height":"width"]/2,o[n?"height":"width"]=0,o},isPointOnRuler(e){const t=this.isHorizontal(),n=this.canvas&&this.canvas.ruler.isPointOnRuler(new nt.fabric.Point(e.offsetX,e.offsetY));return t&&n==="horizontal"||!t&&n==="vertical"?n:!1},isHorizontal(){return this.height===0}}),nt.fabric.GuideLine.fromObject=function(e,t){const n=nt.fabric.util.object.clone;function o(v){delete v.xy,t&&t(v)}const g=n(e,!0),A=g.height===0;g.xy=A?g.y1:g.x1,g.axis=A?"horizontal":"vertical",nt.fabric.Object._fromObject(g.type,g,o,"xy")})}nt.fabric.GuideLine;class zy{constructor(t){X(this,"ctx");X(this,"options");X(this,"startCalibration");X(this,"activeOn","up");X(this,"objectRect");X(this,"eventHandler",{calcObjectRect:Ds(this.calcObjectRect.bind(this),15),clearStatus:this.clearStatus.bind(this),canvasMouseDown:this.canvasMouseDown.bind(this),canvasMouseMove:Ds(this.canvasMouseMove.bind(this),15),canvasMouseUp:this.canvasMouseUp.bind(this),render:t=>{t.ctx&&this.render()}});X(this,"lastAttr",{status:"out",cursor:void 0,selection:void 0});X(this,"tempGuidelLine");X(this,"getCommonEventInfo",t=>{if(!(!this.tempGuidelLine||!t.absolutePointer))return{e:t.e,transform:this.tempGuidelLine.get("transform"),pointer:{x:t.absolutePointer.x,y:t.absolutePointer.y},target:this.tempGuidelLine}});this.options=Object.assign({ruleSize:20,fontSize:10,enabled:!1,backgroundColor:"#fff",borderColor:"#ddd",highlightColor:"#007fff",textColor:"#888"},t),this.ctx=this.options.canvas.getContext(),nt.fabric.util.object.extend(this.options.canvas,{ruler:this}),Gy(),this.options.enabled&&this.enable()}destroy(){this.disable()}clearGuideline(){this.options.canvas.remove(...this.options.canvas.getObjects(nt.fabric.GuideLine.prototype.type))}showGuideline(){this.options.canvas.getObjects(nt.fabric.GuideLine.prototype.type).forEach(t=>{t.set("visible",!0)}),this.options.canvas.renderAll()}hideGuideline(){this.options.canvas.getObjects(nt.fabric.GuideLine.prototype.type).forEach(t=>{t.set("visible",!1)}),this.options.canvas.renderAll()}enable(){this.options.enabled=!0,this.options.canvas.on("after:render",this.eventHandler.calcObjectRect),this.options.canvas.on("after:render",this.eventHandler.render),this.options.canvas.on("mouse:down",this.eventHandler.canvasMouseDown),this.options.canvas.on("mouse:move",this.eventHandler.canvasMouseMove),this.options.canvas.on("mouse:up",this.eventHandler.canvasMouseUp),this.options.canvas.on("selection:cleared",this.eventHandler.clearStatus),this.showGuideline(),this.render()}disable(){this.options.canvas.off("after:render",this.eventHandler.calcObjectRect),this.options.canvas.off("after:render",this.eventHandler.render),this.options.canvas.off("mouse:down",this.eventHandler.canvasMouseDown),this.options.canvas.off("mouse:move",this.eventHandler.canvasMouseMove),this.options.canvas.off("mouse:up",this.eventHandler.canvasMouseUp),this.options.canvas.off("selection:cleared",this.eventHandler.clearStatus),this.hideGuideline(),this.options.enabled=!1}render(){var n,o;const t=this.options.canvas.viewportTransform;t&&(this.draw({isHorizontal:!0,rulerLength:this.getSize().width,startCalibration:(n=this.startCalibration)!=null&&n.x?this.startCalibration.x:-(t[4]/t[0])}),this.draw({isHorizontal:!1,rulerLength:this.getSize().height,startCalibration:(o=this.startCalibration)!=null&&o.y?this.startCalibration.y:-(t[5]/t[3])}),Ei(this.ctx,{isHorizontal:!0,left:-10,top:-10,width:this.options.ruleSize*2+10,height:this.options.ruleSize+10,backgroundColor:this.options.backgroundColor}),Ei(this.ctx,{isHorizontal:!1,left:-10,top:-10,width:this.options.ruleSize+10,height:this.options.ruleSize*2+10,backgroundColor:this.options.backgroundColor}))}getSize(){var t,n;return{width:(t=this.options.canvas.width)!=null?t:0,height:(n=this.options.canvas.height)!=null?n:0}}getZoom(){return this.options.canvas.getZoom()}draw(t){const{isHorizontal:n,rulerLength:o,startCalibration:g}=t,A=this.getZoom(),v=Hy(A),f=o/A,i=Math[g>0?"floor":"ceil"](g/v)*v,c=i-g,l=this.getSize();Ps(this.ctx,{left:0,top:0,width:n?l.width:this.options.ruleSize,height:n?this.options.ruleSize:l.height,fill:this.options.backgroundColor,stroke:this.options.borderColor});const r=new nt.fabric.Color(this.options.textColor);for(let a=0;a+c<=Math.ceil(f);a+=v){const s=(c+a)*A,u=i+a+"",d=10*u.length/4,h=n?s-d-1:this.options.ruleSize/2-this.options.fontSize/2-4,p=n?this.options.ruleSize/2-this.options.fontSize/2-4:s+d;Hr(this.ctx,{text:u,left:h,top:p,fill:r.toRgb(),angle:n?0:-90})}for(let a=0;a+c<=Math.ceil(f);a+=v){const s=Math.round((c+a)*A),u=n?s:this.options.ruleSize-8,d=n?this.options.ruleSize-8:s,h=n?0:8,p=n?8:0;Ur(this.ctx,{left:u,top:d,width:h,height:p,stroke:r.toRgb()})}if(this.objectRect){const a=n?"x":"y";this.objectRect[a].forEach(s=>{if(s.skip===a)return;const u=S=>Math.round(S/A+g)+"",d=u(n?s.left:s.top),h=u(n?s.left+s.width:s.top+s.height),p=d===h,m={isHorizontal:n,width:n?160:this.options.ruleSize-8,height:n?this.options.ruleSize-8:160,backgroundColor:this.options.backgroundColor};Ei(this.ctx,Ft(pt({},m),{left:n?s.left-80:0,top:n?0:s.top-80})),p||Ei(this.ctx,Ft(pt({},m),{left:n?s.width+s.left-80:0,top:n?0:s.height+s.top-80}));const y=new nt.fabric.Color(this.options.highlightColor);y.setAlpha(.5),Ps(this.ctx,{left:n?s.left:this.options.ruleSize-8,top:n?this.options.ruleSize-8:s.top,width:n?s.width:8,height:n?8:s.height,fill:y.toRgba()});const _=this.options.ruleSize/2-this.options.fontSize/2-4,C={fill:y.toRgba(),angle:n?0:-90};Hr(this.ctx,Ft(pt({},C),{text:d,left:n?s.left-2:_,top:n?_:s.top-2,align:p?"center":n?"right":"left"})),p||Hr(this.ctx,Ft(pt({},C),{text:h,left:n?s.left+s.width+2:_,top:n?_:s.top+s.height+2,align:n?"left":"right"}));const w=p?8:14;y.setAlpha(1);const b={width:n?0:w,height:n?w:0,stroke:y.toRgba()};Ur(this.ctx,Ft(pt({},b),{left:n?s.left:this.options.ruleSize-w,top:n?this.options.ruleSize-w:s.top})),p||Ur(this.ctx,Ft(pt({},b),{left:n?s.left+s.width:this.options.ruleSize-w,top:n?this.options.ruleSize-w:s.top+s.height}))})}}calcObjectRect(){const t=this.options.canvas.getActiveObjects();if(t.length===0)return;const n=t.reduce((o,g)=>{var v,f;const A=g.getBoundingRect(!1,!0);if(g.group){const i=pt({top:0,left:0,width:0,height:0,scaleX:1,scaleY:1},g.group);A.width*=i.scaleX,A.height*=i.scaleY;const c=i.width/2+i.left,l=(i.width/2+((v=g.left)!=null?v:0))*(1-i.scaleX);A.left+=(c-l)*this.getZoom();const r=i.height/2+i.top,a=(i.height/2+((f=g.top)!=null?f:0))*(1-i.scaleY);A.top+=(r-a)*this.getZoom()}return g instanceof nt.fabric.GuideLine&&(A.skip=g.isHorizontal()?"x":"y"),o.push(A),o},[]);n.length!==0&&(this.objectRect={x:Al(n,!0),y:Al(n,!1)})}clearStatus(){this.objectRect=void 0}isPointOnRuler(t){return new nt.fabric.Rect({left:0,top:0,width:this.options.ruleSize,height:this.options.canvas.height}).containsPoint(t)?"vertical":new nt.fabric.Rect({left:0,top:0,width:this.options.canvas.width,height:this.options.ruleSize}).containsPoint(t)?"horizontal":!1}canvasMouseDown(t){if(!t.pointer||!t.absolutePointer)return;const n=this.isPointOnRuler(t.pointer);n&&this.activeOn==="up"&&(this.lastAttr.selection=this.options.canvas.selection,this.options.canvas.selection=!1,this.activeOn="down",this.tempGuidelLine=new nt.fabric.GuideLine(n==="horizontal"?t.absolutePointer.y:t.absolutePointer.x,{axis:n,visible:!1}),this.options.canvas.add(this.tempGuidelLine),this.options.canvas.setActiveObject(this.tempGuidelLine),this.options.canvas._setupCurrentTransform(t.e,this.tempGuidelLine,!0),this.tempGuidelLine.fire("down",this.getCommonEventInfo(t)))}canvasMouseMove(t){if(!t.pointer)return;if(this.tempGuidelLine&&t.absolutePointer){const o={};this.tempGuidelLine.axis==="horizontal"?o.top=t.absolutePointer.y:o.left=t.absolutePointer.x,this.tempGuidelLine.set(Ft(pt({},o),{visible:!0})),this.options.canvas.requestRenderAll();const g=this.getCommonEventInfo(t);this.options.canvas.fire("object:moving",g),this.tempGuidelLine.fire("moving",g)}const n=this.isPointOnRuler(t.pointer);if(!n){this.lastAttr.status!=="out"&&(this.options.canvas.defaultCursor=this.lastAttr.cursor,this.lastAttr.status="out");return}(this.lastAttr.status==="out"||n!==this.lastAttr.status)&&(this.lastAttr.cursor=this.options.canvas.defaultCursor,this.options.canvas.defaultCursor=n==="horizontal"?"ns-resize":"ew-resize",this.lastAttr.status=n)}canvasMouseUp(t){var n;this.activeOn==="down"&&(this.options.canvas.selection=this.lastAttr.selection,this.activeOn="up",(n=this.tempGuidelLine)==null||n.fire("up",this.getCommonEventInfo(t)),this.tempGuidelLine=void 0)}}function Yy(e,t){const n=new zy(pt({canvas:e},t));let o;const g=()=>{o=e.getObjects().find(v=>v.id==="workspace")},A=(v,f)=>{const{top:i,height:c,left:l,width:r}=v;if(i===void 0||c===void 0||l===void 0||r===void 0)return!1;const a=f.getBoundingRect(!0,!0),{top:s,height:u,left:d,width:h}=a;return f.isHorizontal()&&(i>s+1||i+c<s+u-1)?!0:!f.isHorizontal()&&(l>d+1||l+r<d+h-1)};return e.on("guideline:moving",v=>{if(!o){g();return}const{target:f}=v;A(o,f)&&(f.moveCursor="not-allowed")}),e.on("guideline:mouseup",v=>{var i;if(!o){g();return}const{target:f}=v;A(o,f)&&(e.remove(f),e.setCursor((i=e.defaultCursor)!=null?i:""))}),n}class Qs{constructor(t,n){X(this,"canvas");X(this,"editor");X(this,"ruler");this.canvas=t,this.editor=n,this.init()}hookSaveBefore(){return new Promise(t=>{this.hideGuideline(),t(!0)})}hookSaveAfter(){return new Promise(t=>{this.showGuideline(),t(!0)})}init(){this.ruler=Yy(this.canvas)}hideGuideline(){this.ruler.hideGuideline()}showGuideline(){this.ruler.showGuideline()}rulerEnable(){this.ruler.enable()}rulerDisable(){this.ruler.disable()}destroy(){console.log("pluginDestroy")}}X(Qs,"pluginName","RulerPlugin"),X(Qs,"apis",["hideGuideline","showGuideline","rulerEnable","rulerDisable"]);var Vy=Error,Wy=EvalError,Xy=RangeError,Jy=ReferenceError,Ku=SyntaxError,yi=TypeError,Ky=URIError,qy=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},n=Symbol("test"),o=Object(n);if(typeof n=="string"||Object.prototype.toString.call(n)!=="[object Symbol]"||Object.prototype.toString.call(o)!=="[object Symbol]")return!1;var g=42;t[n]=g;for(n in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var A=Object.getOwnPropertySymbols(t);if(A.length!==1||A[0]!==n||!Object.prototype.propertyIsEnumerable.call(t,n))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var v=Object.getOwnPropertyDescriptor(t,n);if(v.value!==g||v.enumerable!==!0)return!1}return!0},ml=typeof Symbol!="undefined"&&Symbol,Zy=qy,t2=function(){return typeof ml!="function"||typeof Symbol!="function"||typeof ml("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:Zy()},Gr={__proto__:null,foo:{}},e2=Object,n2=function(){return{__proto__:Gr}.foo===Gr.foo&&!(Gr instanceof e2)},i2="Function.prototype.bind called on incompatible ",r2=Object.prototype.toString,s2=Math.max,o2="[object Function]",vl=function(t,n){for(var o=[],g=0;g<t.length;g+=1)o[g]=t[g];for(var A=0;A<n.length;A+=1)o[A+t.length]=n[A];return o},a2=function(t,n){for(var o=[],g=n||0,A=0;g<t.length;g+=1,A+=1)o[A]=t[g];return o},l2=function(e,t){for(var n="",o=0;o<e.length;o+=1)n+=e[o],o+1<e.length&&(n+=t);return n},c2=function(t){var n=this;if(typeof n!="function"||r2.apply(n)!==o2)throw new TypeError(i2+n);for(var o=a2(arguments,1),g,A=function(){if(this instanceof g){var l=n.apply(this,vl(o,arguments));return Object(l)===l?l:this}return n.apply(t,vl(o,arguments))},v=s2(0,n.length-o.length),f=[],i=0;i<v;i++)f[i]="$"+i;if(g=Function("binder","return function ("+l2(f,",")+"){ return binder.apply(this,arguments); }")(A),n.prototype){var c=function(){};c.prototype=n.prototype,g.prototype=new c,c.prototype=null}return g},u2=c2,Ro=Function.prototype.bind||u2,h2=Function.prototype.call,f2=Object.prototype.hasOwnProperty,d2=Ro,g2=d2.call(h2,f2),Ot,p2=Vy,A2=Wy,m2=Xy,v2=Jy,Rn=Ku,Pn=yi,y2=Ky,qu=Function,zr=function(e){try{return qu('"use strict"; return ('+e+").constructor;")()}catch(t){}},dn=Object.getOwnPropertyDescriptor;if(dn)try{dn({},"")}catch(e){dn=null}var Yr=function(){throw new Pn},_2=dn?function(){try{return arguments.callee,Yr}catch(e){try{return dn(arguments,"callee").get}catch(t){return Yr}}}():Yr,wn=t2(),C2=n2(),re=Object.getPrototypeOf||(C2?function(e){return e.__proto__}:null),En={},w2=typeof Uint8Array=="undefined"||!re?Ot:re(Uint8Array),gn={__proto__:null,"%AggregateError%":typeof AggregateError=="undefined"?Ot:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer=="undefined"?Ot:ArrayBuffer,"%ArrayIteratorPrototype%":wn&&re?re([][Symbol.iterator]()):Ot,"%AsyncFromSyncIteratorPrototype%":Ot,"%AsyncFunction%":En,"%AsyncGenerator%":En,"%AsyncGeneratorFunction%":En,"%AsyncIteratorPrototype%":En,"%Atomics%":typeof Atomics=="undefined"?Ot:Atomics,"%BigInt%":typeof BigInt=="undefined"?Ot:BigInt,"%BigInt64Array%":typeof BigInt64Array=="undefined"?Ot:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array=="undefined"?Ot:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView=="undefined"?Ot:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":p2,"%eval%":eval,"%EvalError%":A2,"%Float32Array%":typeof Float32Array=="undefined"?Ot:Float32Array,"%Float64Array%":typeof Float64Array=="undefined"?Ot:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry=="undefined"?Ot:FinalizationRegistry,"%Function%":qu,"%GeneratorFunction%":En,"%Int8Array%":typeof Int8Array=="undefined"?Ot:Int8Array,"%Int16Array%":typeof Int16Array=="undefined"?Ot:Int16Array,"%Int32Array%":typeof Int32Array=="undefined"?Ot:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":wn&&re?re(re([][Symbol.iterator]())):Ot,"%JSON%":typeof JSON=="object"?JSON:Ot,"%Map%":typeof Map=="undefined"?Ot:Map,"%MapIteratorPrototype%":typeof Map=="undefined"||!wn||!re?Ot:re(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise=="undefined"?Ot:Promise,"%Proxy%":typeof Proxy=="undefined"?Ot:Proxy,"%RangeError%":m2,"%ReferenceError%":v2,"%Reflect%":typeof Reflect=="undefined"?Ot:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set=="undefined"?Ot:Set,"%SetIteratorPrototype%":typeof Set=="undefined"||!wn||!re?Ot:re(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer=="undefined"?Ot:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":wn&&re?re(""[Symbol.iterator]()):Ot,"%Symbol%":wn?Symbol:Ot,"%SyntaxError%":Rn,"%ThrowTypeError%":_2,"%TypedArray%":w2,"%TypeError%":Pn,"%Uint8Array%":typeof Uint8Array=="undefined"?Ot:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray=="undefined"?Ot:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array=="undefined"?Ot:Uint16Array,"%Uint32Array%":typeof Uint32Array=="undefined"?Ot:Uint32Array,"%URIError%":y2,"%WeakMap%":typeof WeakMap=="undefined"?Ot:WeakMap,"%WeakRef%":typeof WeakRef=="undefined"?Ot:WeakRef,"%WeakSet%":typeof WeakSet=="undefined"?Ot:WeakSet};if(re)try{null.error}catch(e){var b2=re(re(e));gn["%Error.prototype%"]=b2}var S2=function e(t){var n;if(t==="%AsyncFunction%")n=zr("async function () {}");else if(t==="%GeneratorFunction%")n=zr("function* () {}");else if(t==="%AsyncGeneratorFunction%")n=zr("async function* () {}");else if(t==="%AsyncGenerator%"){var o=e("%AsyncGeneratorFunction%");o&&(n=o.prototype)}else if(t==="%AsyncIteratorPrototype%"){var g=e("%AsyncGenerator%");g&&re&&(n=re(g.prototype))}return gn[t]=n,n},yl={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},_i=Ro,nr=g2,E2=_i.call(Function.call,Array.prototype.concat),I2=_i.call(Function.apply,Array.prototype.splice),_l=_i.call(Function.call,String.prototype.replace),ir=_i.call(Function.call,String.prototype.slice),x2=_i.call(Function.call,RegExp.prototype.exec),B2=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,T2=/\\(\\)?/g,O2=function(t){var n=ir(t,0,1),o=ir(t,-1);if(n==="%"&&o!=="%")throw new Rn("invalid intrinsic syntax, expected closing `%`");if(o==="%"&&n!=="%")throw new Rn("invalid intrinsic syntax, expected opening `%`");var g=[];return _l(t,B2,function(A,v,f,i){g[g.length]=f?_l(i,T2,"$1"):v||A}),g},k2=function(t,n){var o=t,g;if(nr(yl,o)&&(g=yl[o],o="%"+g[0]+"%"),nr(gn,o)){var A=gn[o];if(A===En&&(A=S2(o)),typeof A=="undefined"&&!n)throw new Pn("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:g,name:o,value:A}}throw new Rn("intrinsic "+t+" does not exist!")},Gn=function(t,n){if(typeof t!="string"||t.length===0)throw new Pn("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof n!="boolean")throw new Pn('"allowMissing" argument must be a boolean');if(x2(/^%?[^%]*%?$/,t)===null)throw new Rn("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var o=O2(t),g=o.length>0?o[0]:"",A=k2("%"+g+"%",n),v=A.name,f=A.value,i=!1,c=A.alias;c&&(g=c[0],I2(o,E2([0,1],c)));for(var l=1,r=!0;l<o.length;l+=1){var a=o[l],s=ir(a,0,1),u=ir(a,-1);if((s==='"'||s==="'"||s==="`"||u==='"'||u==="'"||u==="`")&&s!==u)throw new Rn("property names with quotes must have matching quotes");if((a==="constructor"||!r)&&(i=!0),g+="."+a,v="%"+g+"%",nr(gn,v))f=gn[v];else if(f!=null){if(!(a in f)){if(!n)throw new Pn("base intrinsic for "+t+" exists, but the property is not available.");return}if(dn&&l+1>=o.length){var d=dn(f,a);r=!!d,r&&"get"in d&&!("originalValue"in d.get)?f=d.get:f=f[a]}else r=nr(f,a),f=f[a];r&&!i&&(gn[v]=f)}}return f},Zu={exports:{}},Vr,Cl;function jo(){if(Cl)return Vr;Cl=1;var e=Gn,t=e("%Object.defineProperty%",!0)||!1;if(t)try{t({},"a",{value:1})}catch(n){t=!1}return Vr=t,Vr}var D2=Gn,Gi=D2("%Object.getOwnPropertyDescriptor%",!0);if(Gi)try{Gi([],"length")}catch(e){Gi=null}var th=Gi,wl=jo(),M2=Ku,bn=yi,bl=th,P2=function(t,n,o){if(!t||typeof t!="object"&&typeof t!="function")throw new bn("`obj` must be an object or a function`");if(typeof n!="string"&&typeof n!="symbol")throw new bn("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new bn("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new bn("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new bn("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new bn("`loose`, if provided, must be a boolean");var g=arguments.length>3?arguments[3]:null,A=arguments.length>4?arguments[4]:null,v=arguments.length>5?arguments[5]:null,f=arguments.length>6?arguments[6]:!1,i=!!bl&&bl(t,n);if(wl)wl(t,n,{configurable:v===null&&i?i.configurable:!v,enumerable:g===null&&i?i.enumerable:!g,value:o,writable:A===null&&i?i.writable:!A});else if(f||!g&&!A&&!v)t[n]=o;else throw new M2("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},Ls=jo(),eh=function(){return!!Ls};eh.hasArrayLengthDefineBug=function(){if(!Ls)return null;try{return Ls([],"length",{value:1}).length!==1}catch(t){return!0}};var Q2=eh,L2=Gn,Sl=P2,F2=Q2(),El=th,Il=yi,R2=L2("%Math.floor%"),j2=function(t,n){if(typeof t!="function")throw new Il("`fn` is not a function");if(typeof n!="number"||n<0||n>4294967295||R2(n)!==n)throw new Il("`length` must be a positive 32-bit integer");var o=arguments.length>2&&!!arguments[2],g=!0,A=!0;if("length"in t&&El){var v=El(t,"length");v&&!v.configurable&&(g=!1),v&&!v.writable&&(A=!1)}return(g||A||!o)&&(F2?Sl(t,"length",n,!0,!0):Sl(t,"length",n)),t};(function(e){var t=Ro,n=Gn,o=j2,g=yi,A=n("%Function.prototype.apply%"),v=n("%Function.prototype.call%"),f=n("%Reflect.apply%",!0)||t.call(v,A),i=jo(),c=n("%Math.max%");e.exports=function(a){if(typeof a!="function")throw new g("a function is required");var s=f(t,v,arguments);return o(s,1+c(0,a.length-(arguments.length-1)),!0)};var l=function(){return f(t,A,arguments)};i?i(e.exports,"apply",{value:l}):e.exports.apply=l})(Zu);var $2=Zu.exports,nh=Gn,ih=$2,N2=ih(nh("String.prototype.indexOf")),U2=function(t,n){var o=nh(t,!!n);return typeof o=="function"&&N2(t,".prototype.")>-1?ih(o):o},$o=typeof Map=="function"&&Map.prototype,Wr=Object.getOwnPropertyDescriptor&&$o?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,rr=$o&&Wr&&typeof Wr.get=="function"?Wr.get:null,xl=$o&&Map.prototype.forEach,No=typeof Set=="function"&&Set.prototype,Xr=Object.getOwnPropertyDescriptor&&No?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,sr=No&&Xr&&typeof Xr.get=="function"?Xr.get:null,Bl=No&&Set.prototype.forEach,H2=typeof WeakMap=="function"&&WeakMap.prototype,ii=H2?WeakMap.prototype.has:null,G2=typeof WeakSet=="function"&&WeakSet.prototype,ri=G2?WeakSet.prototype.has:null,z2=typeof WeakRef=="function"&&WeakRef.prototype,Tl=z2?WeakRef.prototype.deref:null,Y2=Boolean.prototype.valueOf,V2=Object.prototype.toString,W2=Function.prototype.toString,X2=String.prototype.match,Uo=String.prototype.slice,nn=String.prototype.replace,J2=String.prototype.toUpperCase,Ol=String.prototype.toLowerCase,rh=RegExp.prototype.test,kl=Array.prototype.concat,De=Array.prototype.join,K2=Array.prototype.slice,Dl=Math.floor,Fs=typeof BigInt=="function"?BigInt.prototype.valueOf:null,Jr=Object.getOwnPropertySymbols,Rs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,jn=typeof Symbol=="function"&&typeof Symbol.iterator=="object",ue=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===jn||"symbol")?Symbol.toStringTag:null,sh=Object.prototype.propertyIsEnumerable,Ml=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function Pl(e,t){if(e===1/0||e===-1/0||e!==e||e&&e>-1e3&&e<1e3||rh.call(/e/,t))return t;var n=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof e=="number"){var o=e<0?-Dl(-e):Dl(e);if(o!==e){var g=String(o),A=Uo.call(t,g.length+1);return nn.call(g,n,"$&_")+"."+nn.call(nn.call(A,/([0-9]{3})/g,"$&_"),/_$/,"")}}return nn.call(t,n,"$&_")}var js=Fi,Ql=js.custom,Ll=ah(Ql)?Ql:null,q2=function e(t,n,o,g){var A=n||{};if(tn(A,"quoteStyle")&&A.quoteStyle!=="single"&&A.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(tn(A,"maxStringLength")&&(typeof A.maxStringLength=="number"?A.maxStringLength<0&&A.maxStringLength!==1/0:A.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var v=tn(A,"customInspect")?A.customInspect:!0;if(typeof v!="boolean"&&v!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(tn(A,"indent")&&A.indent!==null&&A.indent!=="	"&&!(parseInt(A.indent,10)===A.indent&&A.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(tn(A,"numericSeparator")&&typeof A.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var f=A.numericSeparator;if(typeof t=="undefined")return"undefined";if(t===null)return"null";if(typeof t=="boolean")return t?"true":"false";if(typeof t=="string")return ch(t,A);if(typeof t=="number"){if(t===0)return 1/0/t>0?"0":"-0";var i=String(t);return f?Pl(t,i):i}if(typeof t=="bigint"){var c=String(t)+"n";return f?Pl(t,c):c}var l=typeof A.depth=="undefined"?5:A.depth;if(typeof o=="undefined"&&(o=0),o>=l&&l>0&&typeof t=="object")return $s(t)?"[Array]":"[Object]";var r=A3(A,o);if(typeof g=="undefined")g=[];else if(lh(g,t)>=0)return"[Circular]";function a(H,W,G){if(W&&(g=K2.call(g),g.push(W)),G){var V={depth:A.depth};return tn(A,"quoteStyle")&&(V.quoteStyle=A.quoteStyle),e(H,V,o+1,g)}return e(H,A,o+1,g)}if(typeof t=="function"&&!Fl(t)){var s=a3(t),u=Ii(t,a);return"[Function"+(s?": "+s:" (anonymous)")+"]"+(u.length>0?" { "+De.call(u,", ")+" }":"")}if(ah(t)){var d=jn?nn.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):Rs.call(t);return typeof t=="object"&&!jn?Zn(d):d}if(d3(t)){for(var h="<"+Ol.call(String(t.nodeName)),p=t.attributes||[],m=0;m<p.length;m++)h+=" "+p[m].name+"="+oh(Z2(p[m].value),"double",A);return h+=">",t.childNodes&&t.childNodes.length&&(h+="..."),h+="</"+Ol.call(String(t.nodeName))+">",h}if($s(t)){if(t.length===0)return"[]";var y=Ii(t,a);return r&&!p3(y)?"["+Ns(y,r)+"]":"[ "+De.call(y,", ")+" ]"}if(e3(t)){var _=Ii(t,a);return!("cause"in Error.prototype)&&"cause"in t&&!sh.call(t,"cause")?"{ ["+String(t)+"] "+De.call(kl.call("[cause]: "+a(t.cause),_),", ")+" }":_.length===0?"["+String(t)+"]":"{ ["+String(t)+"] "+De.call(_,", ")+" }"}if(typeof t=="object"&&v){if(Ll&&typeof t[Ll]=="function"&&js)return js(t,{depth:l-o});if(v!=="symbol"&&typeof t.inspect=="function")return t.inspect()}if(l3(t)){var C=[];return xl&&xl.call(t,function(H,W){C.push(a(W,t,!0)+" => "+a(H,t))}),Rl("Map",rr.call(t),C,r)}if(h3(t)){var w=[];return Bl&&Bl.call(t,function(H){w.push(a(H,t))}),Rl("Set",sr.call(t),w,r)}if(c3(t))return Kr("WeakMap");if(f3(t))return Kr("WeakSet");if(u3(t))return Kr("WeakRef");if(i3(t))return Zn(a(Number(t)));if(s3(t))return Zn(a(Fs.call(t)));if(r3(t))return Zn(Y2.call(t));if(n3(t))return Zn(a(String(t)));if(typeof window!="undefined"&&t===window)return"{ [object Window] }";if(t===hc)return"{ [object globalThis] }";if(!t3(t)&&!Fl(t)){var b=Ii(t,a),S=Ml?Ml(t)===Object.prototype:t instanceof Object||t.constructor===Object,F=t instanceof Object?"":"null prototype",$=!S&&ue&&Object(t)===t&&ue in t?Uo.call(on(t),8,-1):F?"Object":"",Q=S||typeof t.constructor!="function"?"":t.constructor.name?t.constructor.name+" ":"",R=Q+($||F?"["+De.call(kl.call([],$||[],F||[]),": ")+"] ":"");return b.length===0?R+"{}":r?R+"{"+Ns(b,r)+"}":R+"{ "+De.call(b,", ")+" }"}return String(t)};function oh(e,t,n){var o=(n.quoteStyle||t)==="double"?'"':"'";return o+e+o}function Z2(e){return nn.call(String(e),/"/g,"&quot;")}function $s(e){return on(e)==="[object Array]"&&(!ue||!(typeof e=="object"&&ue in e))}function t3(e){return on(e)==="[object Date]"&&(!ue||!(typeof e=="object"&&ue in e))}function Fl(e){return on(e)==="[object RegExp]"&&(!ue||!(typeof e=="object"&&ue in e))}function e3(e){return on(e)==="[object Error]"&&(!ue||!(typeof e=="object"&&ue in e))}function n3(e){return on(e)==="[object String]"&&(!ue||!(typeof e=="object"&&ue in e))}function i3(e){return on(e)==="[object Number]"&&(!ue||!(typeof e=="object"&&ue in e))}function r3(e){return on(e)==="[object Boolean]"&&(!ue||!(typeof e=="object"&&ue in e))}function ah(e){if(jn)return e&&typeof e=="object"&&e instanceof Symbol;if(typeof e=="symbol")return!0;if(!e||typeof e!="object"||!Rs)return!1;try{return Rs.call(e),!0}catch(t){}return!1}function s3(e){if(!e||typeof e!="object"||!Fs)return!1;try{return Fs.call(e),!0}catch(t){}return!1}var o3=Object.prototype.hasOwnProperty||function(e){return e in this};function tn(e,t){return o3.call(e,t)}function on(e){return V2.call(e)}function a3(e){if(e.name)return e.name;var t=X2.call(W2.call(e),/^function\s*([\w$]+)/);return t?t[1]:null}function lh(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,o=e.length;n<o;n++)if(e[n]===t)return n;return-1}function l3(e){if(!rr||!e||typeof e!="object")return!1;try{rr.call(e);try{sr.call(e)}catch(t){return!0}return e instanceof Map}catch(t){}return!1}function c3(e){if(!ii||!e||typeof e!="object")return!1;try{ii.call(e,ii);try{ri.call(e,ri)}catch(t){return!0}return e instanceof WeakMap}catch(t){}return!1}function u3(e){if(!Tl||!e||typeof e!="object")return!1;try{return Tl.call(e),!0}catch(t){}return!1}function h3(e){if(!sr||!e||typeof e!="object")return!1;try{sr.call(e);try{rr.call(e)}catch(t){return!0}return e instanceof Set}catch(t){}return!1}function f3(e){if(!ri||!e||typeof e!="object")return!1;try{ri.call(e,ri);try{ii.call(e,ii)}catch(t){return!0}return e instanceof WeakSet}catch(t){}return!1}function d3(e){return!e||typeof e!="object"?!1:typeof HTMLElement!="undefined"&&e instanceof HTMLElement?!0:typeof e.nodeName=="string"&&typeof e.getAttribute=="function"}function ch(e,t){if(e.length>t.maxStringLength){var n=e.length-t.maxStringLength,o="... "+n+" more character"+(n>1?"s":"");return ch(Uo.call(e,0,t.maxStringLength),t)+o}var g=nn.call(nn.call(e,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,g3);return oh(g,"single",t)}function g3(e){var t=e.charCodeAt(0),n={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return n?"\\"+n:"\\x"+(t<16?"0":"")+J2.call(t.toString(16))}function Zn(e){return"Object("+e+")"}function Kr(e){return e+" { ? }"}function Rl(e,t,n,o){var g=o?Ns(n,o):De.call(n,", ");return e+" ("+t+") {"+g+"}"}function p3(e){for(var t=0;t<e.length;t++)if(lh(e[t],`
`)>=0)return!1;return!0}function A3(e,t){var n;if(e.indent==="	")n="	";else if(typeof e.indent=="number"&&e.indent>0)n=De.call(Array(e.indent+1)," ");else return null;return{base:n,prev:De.call(Array(t+1),n)}}function Ns(e,t){if(e.length===0)return"";var n=`
`+t.prev+t.base;return n+De.call(e,","+n)+`
`+t.prev}function Ii(e,t){var n=$s(e),o=[];if(n){o.length=e.length;for(var g=0;g<e.length;g++)o[g]=tn(e,g)?t(e[g],e):""}var A=typeof Jr=="function"?Jr(e):[],v;if(jn){v={};for(var f=0;f<A.length;f++)v["$"+A[f]]=A[f]}for(var i in e)tn(e,i)&&(n&&String(Number(i))===i&&i<e.length||jn&&v["$"+i]instanceof Symbol||(rh.call(/[^\w$]/,i)?o.push(t(i,e)+": "+t(e[i],e)):o.push(i+": "+t(e[i],e))));if(typeof Jr=="function")for(var c=0;c<A.length;c++)sh.call(e,A[c])&&o.push("["+t(A[c])+"]: "+t(e[A[c]],e));return o}var uh=Gn,zn=U2,m3=q2,v3=yi,xi=uh("%WeakMap%",!0),Bi=uh("%Map%",!0),y3=zn("WeakMap.prototype.get",!0),_3=zn("WeakMap.prototype.set",!0),C3=zn("WeakMap.prototype.has",!0),w3=zn("Map.prototype.get",!0),b3=zn("Map.prototype.set",!0),S3=zn("Map.prototype.has",!0),Ho=function(e,t){for(var n=e,o;(o=n.next)!==null;n=o)if(o.key===t)return n.next=o.next,o.next=e.next,e.next=o,o},E3=function(e,t){var n=Ho(e,t);return n&&n.value},I3=function(e,t,n){var o=Ho(e,t);o?o.value=n:e.next={key:t,next:e.next,value:n}},x3=function(e,t){return!!Ho(e,t)},B3=function(){var t,n,o,g={assert:function(A){if(!g.has(A))throw new v3("Side channel does not contain "+m3(A))},get:function(A){if(xi&&A&&(typeof A=="object"||typeof A=="function")){if(t)return y3(t,A)}else if(Bi){if(n)return w3(n,A)}else if(o)return E3(o,A)},has:function(A){if(xi&&A&&(typeof A=="object"||typeof A=="function")){if(t)return C3(t,A)}else if(Bi){if(n)return S3(n,A)}else if(o)return x3(o,A);return!1},set:function(A,v){xi&&A&&(typeof A=="object"||typeof A=="function")?(t||(t=new xi),_3(t,A,v)):Bi?(n||(n=new Bi),b3(n,A,v)):(o||(o={key:{},next:null}),I3(o,A,v))}};return g},T3=String.prototype.replace,O3=/%20/g,qr={RFC1738:"RFC1738",RFC3986:"RFC3986"},Go={default:qr.RFC3986,formatters:{RFC1738:function(e){return T3.call(e,O3,"+")},RFC3986:function(e){return String(e)}},RFC1738:qr.RFC1738,RFC3986:qr.RFC3986},k3=Go,Zr=Object.prototype.hasOwnProperty,cn=Array.isArray,Te=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),D3=function(t){for(;t.length>1;){var n=t.pop(),o=n.obj[n.prop];if(cn(o)){for(var g=[],A=0;A<o.length;++A)typeof o[A]!="undefined"&&g.push(o[A]);n.obj[n.prop]=g}}},hh=function(t,n){for(var o=n&&n.plainObjects?Object.create(null):{},g=0;g<t.length;++g)typeof t[g]!="undefined"&&(o[g]=t[g]);return o},M3=function e(t,n,o){if(!n)return t;if(typeof n!="object"){if(cn(t))t.push(n);else if(t&&typeof t=="object")(o&&(o.plainObjects||o.allowPrototypes)||!Zr.call(Object.prototype,n))&&(t[n]=!0);else return[t,n];return t}if(!t||typeof t!="object")return[t].concat(n);var g=t;return cn(t)&&!cn(n)&&(g=hh(t,o)),cn(t)&&cn(n)?(n.forEach(function(A,v){if(Zr.call(t,v)){var f=t[v];f&&typeof f=="object"&&A&&typeof A=="object"?t[v]=e(f,A,o):t.push(A)}else t[v]=A}),t):Object.keys(n).reduce(function(A,v){var f=n[v];return Zr.call(A,v)?A[v]=e(A[v],f,o):A[v]=f,A},g)},P3=function(t,n){return Object.keys(n).reduce(function(o,g){return o[g]=n[g],o},t)},Q3=function(e,t,n){var o=e.replace(/\+/g," ");if(n==="iso-8859-1")return o.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(o)}catch(g){return o}},ts=1024,L3=function(t,n,o,g,A){if(t.length===0)return t;var v=t;if(typeof t=="symbol"?v=Symbol.prototype.toString.call(t):typeof t!="string"&&(v=String(t)),o==="iso-8859-1")return escape(v).replace(/%u[0-9a-f]{4}/gi,function(s){return"%26%23"+parseInt(s.slice(2),16)+"%3B"});for(var f="",i=0;i<v.length;i+=ts){for(var c=v.length>=ts?v.slice(i,i+ts):v,l=[],r=0;r<c.length;++r){var a=c.charCodeAt(r);if(a===45||a===46||a===95||a===126||a>=48&&a<=57||a>=65&&a<=90||a>=97&&a<=122||A===k3.RFC1738&&(a===40||a===41)){l[l.length]=c.charAt(r);continue}if(a<128){l[l.length]=Te[a];continue}if(a<2048){l[l.length]=Te[192|a>>6]+Te[128|a&63];continue}if(a<55296||a>=57344){l[l.length]=Te[224|a>>12]+Te[128|a>>6&63]+Te[128|a&63];continue}r+=1,a=65536+((a&1023)<<10|c.charCodeAt(r)&1023),l[l.length]=Te[240|a>>18]+Te[128|a>>12&63]+Te[128|a>>6&63]+Te[128|a&63]}f+=l.join("")}return f},F3=function(t){for(var n=[{obj:{o:t},prop:"o"}],o=[],g=0;g<n.length;++g)for(var A=n[g],v=A.obj[A.prop],f=Object.keys(v),i=0;i<f.length;++i){var c=f[i],l=v[c];typeof l=="object"&&l!==null&&o.indexOf(l)===-1&&(n.push({obj:v,prop:c}),o.push(l))}return D3(n),t},R3=function(t){return Object.prototype.toString.call(t)==="[object RegExp]"},j3=function(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))},$3=function(t,n){return[].concat(t,n)},N3=function(t,n){if(cn(t)){for(var o=[],g=0;g<t.length;g+=1)o.push(n(t[g]));return o}return n(t)},fh={arrayToObject:hh,assign:P3,combine:$3,compact:F3,decode:Q3,encode:L3,isBuffer:j3,isRegExp:R3,maybeMap:N3,merge:M3},dh=B3,zi=fh,si=Go,U3=Object.prototype.hasOwnProperty,gh={brackets:function(t){return t+"[]"},comma:"comma",indices:function(t,n){return t+"["+n+"]"},repeat:function(t){return t}},ke=Array.isArray,H3=Array.prototype.push,ph=function(e,t){H3.apply(e,ke(t)?t:[t])},G3=Date.prototype.toISOString,jl=si.default,ne={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:zi.encode,encodeValuesOnly:!1,format:jl,formatter:si.formatters[jl],indices:!1,serializeDate:function(t){return G3.call(t)},skipNulls:!1,strictNullHandling:!1},z3=function(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"},es={},Y3=function e(t,n,o,g,A,v,f,i,c,l,r,a,s,u,d,h,p,m){for(var y=t,_=m,C=0,w=!1;(_=_.get(es))!==void 0&&!w;){var b=_.get(t);if(C+=1,typeof b!="undefined"){if(b===C)throw new RangeError("Cyclic object value");w=!0}typeof _.get(es)=="undefined"&&(C=0)}if(typeof l=="function"?y=l(n,y):y instanceof Date?y=s(y):o==="comma"&&ke(y)&&(y=zi.maybeMap(y,function(B){return B instanceof Date?s(B):B})),y===null){if(v)return c&&!h?c(n,ne.encoder,p,"key",u):n;y=""}if(z3(y)||zi.isBuffer(y)){if(c){var S=h?n:c(n,ne.encoder,p,"key",u);return[d(S)+"="+d(c(y,ne.encoder,p,"value",u))]}return[d(n)+"="+d(String(y))]}var F=[];if(typeof y=="undefined")return F;var $;if(o==="comma"&&ke(y))h&&c&&(y=zi.maybeMap(y,c)),$=[{value:y.length>0?y.join(",")||null:void 0}];else if(ke(l))$=l;else{var Q=Object.keys(y);$=r?Q.sort(r):Q}var R=i?n.replace(/\./g,"%2E"):n,H=g&&ke(y)&&y.length===1?R+"[]":R;if(A&&ke(y)&&y.length===0)return H+"[]";for(var W=0;W<$.length;++W){var G=$[W],V=typeof G=="object"&&typeof G.value!="undefined"?G.value:y[G];if(!(f&&V===null)){var st=a&&i?G.replace(/\./g,"%2E"):G,et=ke(y)?typeof o=="function"?o(H,st):H:H+(a?"."+st:"["+st+"]");m.set(t,C);var x=dh();x.set(es,m),ph(F,e(V,et,o,g,A,v,f,i,o==="comma"&&h&&ke(y)?null:c,l,r,a,s,u,d,h,p,x))}}return F},V3=function(t){if(!t)return ne;if(typeof t.allowEmptyArrays!="undefined"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.encodeDotInKeys!="undefined"&&typeof t.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(t.encoder!==null&&typeof t.encoder!="undefined"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");var n=t.charset||ne.charset;if(typeof t.charset!="undefined"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var o=si.default;if(typeof t.format!="undefined"){if(!U3.call(si.formatters,t.format))throw new TypeError("Unknown format option provided.");o=t.format}var g=si.formatters[o],A=ne.filter;(typeof t.filter=="function"||ke(t.filter))&&(A=t.filter);var v;if(t.arrayFormat in gh?v=t.arrayFormat:"indices"in t?v=t.indices?"indices":"repeat":v=ne.arrayFormat,"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var f=typeof t.allowDots=="undefined"?t.encodeDotInKeys===!0?!0:ne.allowDots:!!t.allowDots;return{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:ne.addQueryPrefix,allowDots:f,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:ne.allowEmptyArrays,arrayFormat:v,charset:n,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:ne.charsetSentinel,commaRoundTrip:t.commaRoundTrip,delimiter:typeof t.delimiter=="undefined"?ne.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:ne.encode,encodeDotInKeys:typeof t.encodeDotInKeys=="boolean"?t.encodeDotInKeys:ne.encodeDotInKeys,encoder:typeof t.encoder=="function"?t.encoder:ne.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:ne.encodeValuesOnly,filter:A,format:o,formatter:g,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:ne.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:ne.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:ne.strictNullHandling}},W3=function(e,t){var n=e,o=V3(t),g,A;typeof o.filter=="function"?(A=o.filter,n=A("",n)):ke(o.filter)&&(A=o.filter,g=A);var v=[];if(typeof n!="object"||n===null)return"";var f=gh[o.arrayFormat],i=f==="comma"&&o.commaRoundTrip;g||(g=Object.keys(n)),o.sort&&g.sort(o.sort);for(var c=dh(),l=0;l<g.length;++l){var r=g[l];o.skipNulls&&n[r]===null||ph(v,Y3(n[r],r,f,i,o.allowEmptyArrays,o.strictNullHandling,o.skipNulls,o.encodeDotInKeys,o.encode?o.encoder:null,o.filter,o.sort,o.allowDots,o.serializeDate,o.format,o.formatter,o.encodeValuesOnly,o.charset,c))}var a=v.join(o.delimiter),s=o.addQueryPrefix===!0?"?":"";return o.charsetSentinel&&(o.charset==="iso-8859-1"?s+="utf8=%26%2310003%3B&":s+="utf8=%E2%9C%93&"),a.length>0?s+a:""},$n=fh,Us=Object.prototype.hasOwnProperty,X3=Array.isArray,Kt={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:$n.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},J3=function(e){return e.replace(/&#(\d+);/g,function(t,n){return String.fromCharCode(parseInt(n,10))})},Ah=function(e,t){return e&&typeof e=="string"&&t.comma&&e.indexOf(",")>-1?e.split(","):e},K3="utf8=%26%2310003%3B",q3="utf8=%E2%9C%93",Z3=function(t,n){var o={__proto__:null},g=n.ignoreQueryPrefix?t.replace(/^\?/,""):t,A=n.parameterLimit===1/0?void 0:n.parameterLimit,v=g.split(n.delimiter,A),f=-1,i,c=n.charset;if(n.charsetSentinel)for(i=0;i<v.length;++i)v[i].indexOf("utf8=")===0&&(v[i]===q3?c="utf-8":v[i]===K3&&(c="iso-8859-1"),f=i,i=v.length);for(i=0;i<v.length;++i)if(i!==f){var l=v[i],r=l.indexOf("]="),a=r===-1?l.indexOf("="):r+1,s,u;a===-1?(s=n.decoder(l,Kt.decoder,c,"key"),u=n.strictNullHandling?null:""):(s=n.decoder(l.slice(0,a),Kt.decoder,c,"key"),u=$n.maybeMap(Ah(l.slice(a+1),n),function(h){return n.decoder(h,Kt.decoder,c,"value")})),u&&n.interpretNumericEntities&&c==="iso-8859-1"&&(u=J3(u)),l.indexOf("[]=")>-1&&(u=X3(u)?[u]:u);var d=Us.call(o,s);d&&n.duplicates==="combine"?o[s]=$n.combine(o[s],u):(!d||n.duplicates==="last")&&(o[s]=u)}return o},t_=function(e,t,n,o){for(var g=o?t:Ah(t,n),A=e.length-1;A>=0;--A){var v,f=e[A];if(f==="[]"&&n.parseArrays)v=n.allowEmptyArrays&&g===""?[]:[].concat(g);else{v=n.plainObjects?Object.create(null):{};var i=f.charAt(0)==="["&&f.charAt(f.length-1)==="]"?f.slice(1,-1):f,c=n.decodeDotInKeys?i.replace(/%2E/g,"."):i,l=parseInt(c,10);!n.parseArrays&&c===""?v={0:g}:!isNaN(l)&&f!==c&&String(l)===c&&l>=0&&n.parseArrays&&l<=n.arrayLimit?(v=[],v[l]=g):c!=="__proto__"&&(v[c]=g)}g=v}return g},e_=function(t,n,o,g){if(t){var A=o.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,v=/(\[[^[\]]*])/,f=/(\[[^[\]]*])/g,i=o.depth>0&&v.exec(A),c=i?A.slice(0,i.index):A,l=[];if(c){if(!o.plainObjects&&Us.call(Object.prototype,c)&&!o.allowPrototypes)return;l.push(c)}for(var r=0;o.depth>0&&(i=f.exec(A))!==null&&r<o.depth;){if(r+=1,!o.plainObjects&&Us.call(Object.prototype,i[1].slice(1,-1))&&!o.allowPrototypes)return;l.push(i[1])}return i&&l.push("["+A.slice(i.index)+"]"),t_(l,n,o,g)}},n_=function(t){if(!t)return Kt;if(typeof t.allowEmptyArrays!="undefined"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.decodeDotInKeys!="undefined"&&typeof t.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(t.decoder!==null&&typeof t.decoder!="undefined"&&typeof t.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof t.charset!="undefined"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=typeof t.charset=="undefined"?Kt.charset:t.charset,o=typeof t.duplicates=="undefined"?Kt.duplicates:t.duplicates;if(o!=="combine"&&o!=="first"&&o!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var g=typeof t.allowDots=="undefined"?t.decodeDotInKeys===!0?!0:Kt.allowDots:!!t.allowDots;return{allowDots:g,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:Kt.allowEmptyArrays,allowPrototypes:typeof t.allowPrototypes=="boolean"?t.allowPrototypes:Kt.allowPrototypes,allowSparse:typeof t.allowSparse=="boolean"?t.allowSparse:Kt.allowSparse,arrayLimit:typeof t.arrayLimit=="number"?t.arrayLimit:Kt.arrayLimit,charset:n,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:Kt.charsetSentinel,comma:typeof t.comma=="boolean"?t.comma:Kt.comma,decodeDotInKeys:typeof t.decodeDotInKeys=="boolean"?t.decodeDotInKeys:Kt.decodeDotInKeys,decoder:typeof t.decoder=="function"?t.decoder:Kt.decoder,delimiter:typeof t.delimiter=="string"||$n.isRegExp(t.delimiter)?t.delimiter:Kt.delimiter,depth:typeof t.depth=="number"||t.depth===!1?+t.depth:Kt.depth,duplicates:o,ignoreQueryPrefix:t.ignoreQueryPrefix===!0,interpretNumericEntities:typeof t.interpretNumericEntities=="boolean"?t.interpretNumericEntities:Kt.interpretNumericEntities,parameterLimit:typeof t.parameterLimit=="number"?t.parameterLimit:Kt.parameterLimit,parseArrays:t.parseArrays!==!1,plainObjects:typeof t.plainObjects=="boolean"?t.plainObjects:Kt.plainObjects,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:Kt.strictNullHandling}},i_=function(e,t){var n=n_(t);if(e===""||e===null||typeof e=="undefined")return n.plainObjects?Object.create(null):{};for(var o=typeof e=="string"?Z3(e,n):e,g=n.plainObjects?Object.create(null):{},A=Object.keys(o),v=0;v<A.length;++v){var f=A[v],i=e_(f,o[f],n,typeof e=="string");g=$n.merge(g,i,n)}return n.allowSparse===!0?g:$n.compact(g)},r_=W3,s_=i_,o_=Go,a_={formats:o_,parse:s_,stringify:r_};const zo=ar(a_);class Hs{constructor(t,n,o){X(this,"canvas");X(this,"editor");X(this,"apiMapUrl");X(this,"repoSrc");this.canvas=t,this.editor=n,this.repoSrc=o.repoSrc,this.apiMapUrl={template:o.repoSrc+"/template/type.json",svg:o.repoSrc+"/svg/type.json"}}getTemplTypeList(){return Ce.get(`${this.repoSrc}/api/templ-types?pagination[pageSize]=100`).then(t=>t.data.data.map(o=>({value:o.id,label:o.attributes.name})))}getTemplList(t="",n=1,o=""){const g={fields:"*",populate:{img:"*"},filters:{},pagination:{page:n,pageSize:10}},A=this._getQueryParams(g,[{key:"templ_type",value:t,type:"$eq"},{key:"name",value:o,type:"$contains"}]);return Ce.get(`${this.repoSrc}/api/templs?${A}`).then(v=>{var i,c;return{list:v.data.data.map(l=>({name:l.attributes.name,desc:l.attributes.desc,src:this._getMaterialPreviewUrl(l.attributes.img),json:l.attributes.json})),pagination:(c=(i=v==null?void 0:v.data)==null?void 0:i.meta)==null?void 0:c.pagination}})}getMaterialTypeList(){return Ce.get(`${this.repoSrc}/api/material-types?pagination[pageSize]=100`).then(t=>t.data.data.map(o=>({value:o.id,label:o.attributes.name})))}getMaterialList(t="",n=1,o=""){const g={populate:{img:"*"},filters:{},pagination:{page:n,pageSize:50}},A=this._getQueryParams(g,[{key:"material_type",value:t,type:"$eq"},{key:"name",value:o,type:"$contains"}]);return Ce.get(`${this.repoSrc}/api/materials?${A}`).then(v=>{var i,c;return{list:v.data.data.map(l=>({name:l.attributes.name,desc:l.attributes.desc,src:this._getMaterialInfoUrl(l.attributes.img),previewSrc:this._getMaterialPreviewUrl(l.attributes.img)})),pagination:(c=(i=v==null?void 0:v.data)==null?void 0:i.meta)==null?void 0:c.pagination}})}getSizeList(){return Ce.get(`${this.repoSrc}/api/sizes?pagination[pageSize]=100`).then(t=>t.data.data.map(o=>({value:o.id,name:o.attributes.name,width:Number(o.attributes.width),height:Number(o.attributes.height),unit:o.attributes.unit})))}getFontList(){return Ce.get(`${this.repoSrc}/api/fonts?pagination[pageSize]=100`).then(t=>t.data.data.map(o=>({value:o.id,label:o.attributes.name})))}_getMaterialInfoUrl(t){var o,g;const n=((g=(o=t==null?void 0:t.data)==null?void 0:o.attributes)==null?void 0:g.url)||"";return this.repoSrc+n}_getMaterialPreviewUrl(t){var o,g,A,v,f,i;const n=((v=(A=(g=(o=t==null?void 0:t.data)==null?void 0:o.attributes)==null?void 0:g.formats)==null?void 0:A.small)==null?void 0:v.url)||((i=(f=t==null?void 0:t.data)==null?void 0:f.attributes)==null?void 0:i.url)||"";return this.repoSrc+n}_getQueryParams(t,n){return n.forEach(o=>{const{key:g,value:A,type:v}=o;A&&(t.filters[g]={[v]:A})}),zo.stringify(t)}getMaterialInfo(t){return _t(this,null,function*(){const n=this.apiMapUrl[t];return(yield Ce.get(n,{params:{typeId:t}})).data.data})}}X(Hs,"pluginName","MaterialPlugin"),X(Hs,"apis",["getTemplTypeList","getTemplList","getMaterialTypeList","getMaterialList","getSizeList"]);const $l={text:"",size:24,isRotate:!1,fontFamily:"汉体",color:"#ccc",position:"Left_Top"};class Gs{constructor(t,n){X(this,"canvas");X(this,"editor");X(this,"hadDraw",!1);X(this,"drawOps",$l);X(this,"drawing",{Left_Top:(t,n,o)=>{let g=this.createCanvas(t,n);const A=g.width||t;let v=g.getContext("2d");v.fillStyle=this.drawOps.color,v.font=`${this.drawOps.size}px ${this.drawOps.fontFamily}`,v.fillText(this.drawOps.text,10,this.drawOps.size+10,A-20),o&&o(g.toDataURL()),g=null,v=null},Right_Top:(t,n,o)=>{let g=this.createCanvas(t,n),A=g.getContext("2d");const v=g.width||t;A.fillStyle=this.drawOps.color,A.font=`${this.drawOps.size}px ${this.drawOps.fontFamily}`,A.fillText(this.drawOps.text,v-A.measureText(this.drawOps.text).width-20,this.drawOps.size+10,v-20),o&&o(g.toDataURL()),g=null,A=null},Left_Right:(t,n,o)=>{let g=this.createCanvas(t,n),A=g.getContext("2d");const v=g.width||t,f=g.height||n;A.fillStyle=this.drawOps.color,A.font=`${this.drawOps.size}px ${this.drawOps.fontFamily}`,A.fillText(this.drawOps.text,10,f-this.drawOps.size,v-20),o&&o(g.toDataURL()),g=null,A=null},Right_Bottom:(t,n,o)=>{let g=this.createCanvas(t,n),A=g.getContext("2d");const v=g.width||t;A.fillStyle=this.drawOps.color,A.font=`${this.drawOps.size}px ${this.drawOps.fontFamily}`,A.fillText(this.drawOps.text,v-A.measureText(this.drawOps.text).width-20,n-this.drawOps.size,t-20),o&&o(g.toDataURL()),g=null,A=null},Full:(t,n,o)=>{const A=-30*Math.PI/180,v=`${this.drawOps.size}px ${this.drawOps.fontFamily}`;let f=this.createCanvas(t,n),i=f.getContext("2d");i.font=v;const c=i.measureText(this.drawOps.text).width+40;let l=this.createCanvas(this.drawOps.isRotate?c*Math.abs(Math.cos(A))+this.drawOps.size:c,this.drawOps.isRotate?c*Math.abs(Math.sin(A))+this.drawOps.size:this.drawOps.size+20);document.body.appendChild(l);let r=l.getContext("2d");r.textAlign="left",r.textBaseline="top",r.font=v,r.fillStyle=`${this.drawOps.color}`,this.drawOps.isRotate?(r.translate(0,c*Math.abs(Math.sin(A))),r.rotate(A),r.fillText(this.drawOps.text,0,0)):r.fillText(this.drawOps.text,10,10),i.fillStyle=i.createPattern(l,"repeat"),i.fillRect(0,0,t,n),o&&o(f.toDataURL()),f=null,l=null,i=null,r=null}});this.canvas=t,this.editor=n,this.init()}createCanvas(t,n){const o=document.createElement("canvas");return o.width=t,o.height=n,o.style.position="fixed",o.style.opacity="0",o.style.zIndex="-1",o}drawWaterMark(t){var f;if(this.drawOps=Object.assign(Yu(this.drawOps),t),!this.drawOps.text)return;const n=this.canvas.getObjects().find(i=>i.id==="workspace"),{width:o,height:g,left:A,top:v}=n;this.drawing[(f=this.drawOps)==null?void 0:f.position](o,g,i=>{this.canvas.overlayImage=void 0,this.hadDraw=!0,this.canvas.setOverlayImage(i,this.canvas.renderAll.bind(this.canvas),{left:A||0,top:v||0,originX:"left",originY:"top"})})}updateDrawStatus(t){this.hadDraw=t}clearWaterMMatk(){this.hadDraw&&(this.canvas.overlayImage=void 0,this.canvas.renderAll(),this.hadDraw=!1,this.drawOps=$l)}init(){this.editor.on("sizeChange",this.drawWaterMark.bind(this))}destroy(){this.editor.off("sizeChange",this.drawWaterMark)}}X(Gs,"pluginName","WaterMarkPlugin"),X(Gs,"apis",["drawWaterMark","clearWaterMMatk","updateDrawStatus"]);var mh={exports:{}};(function(e){(function(){function t(d,h){document.addEventListener?d.addEventListener("scroll",h,!1):d.attachEvent("scroll",h)}function n(d){document.body?d():document.addEventListener?document.addEventListener("DOMContentLoaded",function h(){document.removeEventListener("DOMContentLoaded",h),d()}):document.attachEvent("onreadystatechange",function h(){(document.readyState=="interactive"||document.readyState=="complete")&&(document.detachEvent("onreadystatechange",h),d())})}function o(d){this.g=document.createElement("div"),this.g.setAttribute("aria-hidden","true"),this.g.appendChild(document.createTextNode(d)),this.h=document.createElement("span"),this.i=document.createElement("span"),this.m=document.createElement("span"),this.j=document.createElement("span"),this.l=-1,this.h.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.i.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.j.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.m.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;",this.h.appendChild(this.m),this.i.appendChild(this.j),this.g.appendChild(this.h),this.g.appendChild(this.i)}function g(d,h){d.g.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;white-space:nowrap;font-synthesis:none;font:"+h+";"}function A(d){var h=d.g.offsetWidth,p=h+100;return d.j.style.width=p+"px",d.i.scrollLeft=p,d.h.scrollLeft=d.h.scrollWidth+100,d.l!==h?(d.l=h,!0):!1}function v(d,h){function p(){var y=m;A(y)&&y.g.parentNode!==null&&h(y.l)}var m=d;t(d.h,p),t(d.i,p),A(d)}function f(d,h,p){h=h||{},p=p||window,this.family=d,this.style=h.style||"normal",this.weight=h.weight||"normal",this.stretch=h.stretch||"normal",this.context=p}var i=null,c=null,l=null,r=null;function a(d){return c===null&&(s(d)&&/Apple/.test(window.navigator.vendor)?(d=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(window.navigator.userAgent),c=!!d&&603>parseInt(d[1],10)):c=!1),c}function s(d){return r===null&&(r=!!d.document.fonts),r}function u(d,h){var p=d.style,m=d.weight;if(l===null){var y=document.createElement("div");try{y.style.font="condensed 100px sans-serif"}catch(_){}l=y.style.font!==""}return[p,m,l?d.stretch:"","100px",h].join(" ")}f.prototype.load=function(d,h){var p=this,m=d||"BESbswy",y=0,_=h||3e3,C=new Date().getTime();return new Promise(function(w,b){if(s(p.context)&&!a(p.context)){var S=new Promise(function($,Q){function R(){new Date().getTime()-C>=_?Q(Error(""+_+"ms timeout exceeded")):p.context.document.fonts.load(u(p,'"'+p.family+'"'),m).then(function(H){1<=H.length?$():setTimeout(R,25)},Q)}R()}),F=new Promise(function($,Q){y=setTimeout(function(){Q(Error(""+_+"ms timeout exceeded"))},_)});Promise.race([F,S]).then(function(){clearTimeout(y),w(p)},b)}else n(function(){function $(){var D;(D=G!=-1&&V!=-1||G!=-1&&st!=-1||V!=-1&&st!=-1)&&((D=G!=V&&G!=st&&V!=st)||(i===null&&(D=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),i=!!D&&(536>parseInt(D[1],10)||parseInt(D[1],10)===536&&11>=parseInt(D[2],10))),D=i&&(G==et&&V==et&&st==et||G==x&&V==x&&st==x||G==B&&V==B&&st==B)),D=!D),D&&(k.parentNode!==null&&k.parentNode.removeChild(k),clearTimeout(y),w(p))}function Q(){if(new Date().getTime()-C>=_)k.parentNode!==null&&k.parentNode.removeChild(k),b(Error(""+_+"ms timeout exceeded"));else{var D=p.context.document.hidden;(D===!0||D===void 0)&&(G=R.g.offsetWidth,V=H.g.offsetWidth,st=W.g.offsetWidth,$()),y=setTimeout(Q,50)}}var R=new o(m),H=new o(m),W=new o(m),G=-1,V=-1,st=-1,et=-1,x=-1,B=-1,k=document.createElement("div");k.dir="ltr",g(R,u(p,"sans-serif")),g(H,u(p,"serif")),g(W,u(p,"monospace")),k.appendChild(R.g),k.appendChild(H.g),k.appendChild(W.g),p.context.document.body.appendChild(k),et=R.g.offsetWidth,x=H.g.offsetWidth,B=W.g.offsetWidth,Q(),v(R,function(D){G=D,$()}),g(R,u(p,'"'+p.family+'",sans-serif')),v(H,function(D){V=D,$()}),g(H,u(p,'"'+p.family+'",serif')),v(W,function(D){st=D,$()}),g(W,u(p,'"'+p.family+'",monospace'))})})},e.exports=f})()})(mh);var l_=mh.exports;const Nl=ar(l_);class zs{constructor(t,n,o){X(this,"canvas");X(this,"editor");X(this,"tempPromise");X(this,"repoSrc");X(this,"cacheList");this.canvas=t,this.editor=n,this.repoSrc=o.repoSrc,this.cacheList=[],this.tempPromise=null}hookImportBefore(t){return this.downFontByJSON(t)}getFontList(){return this.cacheList.length?Promise.resolve(this.cacheList):this.tempPromise?this.tempPromise:(this.tempPromise=Ce.get(`${this.repoSrc}/api/fonts?populate=*&pagination[pageSize]=100`).then(t=>{const n=t.data.data.map(o=>({name:o.attributes.name,type:o.attributes.type,file:this.repoSrc+o.attributes.file.data.attributes.url,img:this.repoSrc+o.attributes.img.data.attributes.url}));return this.cacheList=n,this.createFontCSS(n),n}),this.tempPromise)}downFontByJSON(t){const n=JSON.parse(t);let o=[];const g=["arial"];n.objects?o=JSON.parse(t).objects.filter(v=>v.type.includes("text")&&!g.includes(v.fontFamily)).map(v=>v.fontFamily):o=g.includes(n.fontFamily)?[]:[n.fontFamily];const A=o.map(v=>new Nl(v).load(null,15e4));return Promise.all(A)}getFontJson(){const t=this.canvas.getActiveObject();if(t){const n=t.toJSON(["id","gradientAngle","selectable","hasControls"]),o=`data:text/json;charset=utf-8,${encodeURIComponent(JSON.stringify(n,null,"	"))}`,g=t.toDataURL();Dn(o,"font.json"),Dn(g,"font.png")}}loadFont(t){return new Nl(t).load(null,15e4).then(()=>{const o=this.canvas.getActiveObjects()[0];o&&(o.set("fontFamily",t),this.canvas.renderAll())})}createFontCSS(t){let n="";t.forEach(A=>{n=n+`
    @font-face {
      font-family: ${A.name};
      src: url('${A.file}');
    }
    `});const o=document.createElement("style");try{o.appendChild(document.createTextNode(n))}catch(A){}document.getElementsByTagName("head")[0].appendChild(o)}destroy(){console.log("pluginDestroy")}}X(zs,"pluginName","FontPlugin"),X(zs,"apis",["getFontList","loadFont","getFontJson","downFontByJSON"]);const c_=function(e,t,n,o){const g=t.target,A=g.controls[g.__corner],v=g.toLocalPoint(new nt.fabric.Point(n,o),"center","center"),f=vh(g),i=g._getTransformedDimensions(0,0);return g.points==null?!1:(g.points[A.pointIndex]=new nt.fabric.Point(v.x*f.x/i.x+g.pathOffset.x,v.y*f.y/i.y+g.pathOffset.y),!0)},u_=function(e,t){return function(n,o,g,A){const v=o.target;if(v.points==null)return!1;const f=nt.fabric.util.transformPoint(new nt.fabric.Point(v.points[e].x-v.pathOffset.x,v.points[e].y-v.pathOffset.y),v.calcTransformMatrix()),i=t(n,o,g,A);v._setPositionDimensions({});const c=vh(v),l=(v.points[e].x-v.pathOffset.x)/c.x,r=(v.points[e].y-v.pathOffset.y)/c.y,a=l+.5,s=r+.5;return v.setPositionByOrigin(f,a,s),i}},vh=function(e){const t=new nt.fabric.Point(e.strokeUniform?1/e.scaleX:1,e.strokeUniform?1/e.scaleY:1).multiply(e.strokeWidth);return new nt.fabric.Point(e.width+t.x,e.height+t.y)},h_=function(e,t,n){const o=n.points[this.pointIndex].x-n.pathOffset.x,g=n.points[this.pointIndex].y-n.pathOffset.y;return nt.fabric.util.transformPoint(new nt.fabric.Point(o,g),nt.fabric.util.multiplyTransformMatrices(n.canvas.viewportTransform,n.calcTransformMatrix()))};function f_(e,t,n,o,g,A){ru(e,t,n,A,25,25,nt.fabric.util.degreesToRadians(g.angle||0))}class Yi{constructor(t,n){X(this,"isEdit");X(this,"img");X(this,"_onDeselected",Bs);this.canvas=t,this.editor=n,this.isEdit=!1;const o=document.createElement("img");o.src=Au,this.img=o,this.init()}init(){console.info("[PolygonModifyPlugin]: init")}_ensureEvent(t){t.off("deselected",this._onDeselected)}toggleEdit(){this.isEdit?this.inActiveEdit():this.activeEdit()}activeEdit(){this.isEdit=!0;const t=this.canvas.getActiveObject();if(t&&t.type==="polygon"){if(this._ensureEvent(t),t.points==null)return;const n=t.points.length-1,o=this;t.controls=t.points.reduce(function(g,A,v){return g["p"+v]=new nt.fabric.Control({positionHandler:h_,actionHandler:u_(v>0?v-1:n,c_),actionName:"modifyPolygon",render:(...f)=>f_(...f,o.img)}),Object.defineProperty(g["p"+v],"pointIndex",{value:v}),g},{}),t.set({objectCaching:!1}),t.hasBorders=!this.isEdit,this.canvas.requestRenderAll(),this._onDeselected=()=>this.inActiveEdit(t),t.on("deselected",this._onDeselected)}}inActiveEdit(t){this.isEdit=!1,t=t||this.canvas.getActiveObject(),t&&t.type==="polygon"&&(t.cornerColor="blue",t.cornerStyle="rect",t.controls=nt.fabric.Object.prototype.controls,t.hasBorders=!this.isEdit,t.set({objectCaching:!0}),this._onDeselected&&(t.off("deselected",this._onDeselected),this._onDeselected=Bs)),this.canvas.requestRenderAll()}}X(Yi,"pluginName","PolygonModifyPlugin"),X(Yi,"events",[]),X(Yi,"apis",["toggleEdit","activeEdit","inActiveEdit"]);class Ys{constructor(t,n){X(this,"isDrawingPolygon",!1);X(this,"points",[]);X(this,"lines",[]);X(this,"anchors",[]);X(this,"tempPoint");X(this,"tempLine");X(this,"lastPoint");X(this,"onEnd");X(this,"delta",5);X(this,"_escListener",t=>{(t.key==="Escape"||t.keyCode===27)&&this._confirmBuildPolygon()});X(this,"_downHandler",t=>{if(!this.isDrawingPolygon)return;const n=t.absolutePointer,o=new nt.fabric.Point(n.x,n.y),g=this._mackAnchor(n);if(this.anchors.push(g),this.tempLine==null){const A=new nt.fabric.Point(n.x,n.y);this.tempLine=this._makeLine([A,A]),this.canvas.add(this.tempLine)}else t.e.shiftKey&&o.setXY(this.tempLine.x2,this.tempLine.y2),g.set({left:o.x,top:o.y}),this.tempLine.set({x1:o.x,y1:o.y,x2:o.x,y2:o.y});if(this.lastPoint){const A=this._makeLine([this.lastPoint,o]);if(this.lines.push(A),this.canvas.add(A),this.points[0].distanceFrom(o)/this.canvas.getZoom()<=this.delta){this._confirmBuildPolygon();return}}this.canvas.add(g),this.lastPoint=o,this.points.push(o),this._ensureAnchorsForward()});X(this,"_moveHandler",t=>{if(!this.isDrawingPolygon||!this.tempLine)return;const n=t.absolutePointer;if(t.e.shiftKey&&this.lastPoint){const o=ip(this.lastPoint,n);this.tempLine.set({x2:o.x,y2:o.y})}else this.tempLine.set({x2:n.x,y2:n.y});this.canvas.renderAll()});this.canvas=t,this.editor=n}_isUsingHistory(){return this.canvas.offHistory&&typeof this.canvas.offHistory=="function"}_bindEvent(){window.addEventListener("keydown",this._escListener),this.canvas.on("mouse:down",this._downHandler),this.canvas.on("mouse:move",this._moveHandler)}_ensureAnchorsForward(){this.anchors.forEach(t=>{t.bringForward()})}_unbindEvent(){window.removeEventListener("keydown",this._escListener),this.canvas.off("mouse:down",this._downHandler),this.canvas.off("mouse:move",this._moveHandler)}_createPolygon(t){return new nt.fabric.Polygon(t,{fill:"#ccc",id:Mt()})}_makeLine(t){const[n,o]=t;return new nt.fabric.Line([n.x,n.y,o.x,o.y],{fill:"#000",stroke:"#000",strokeWidth:1,selectable:!1,evented:!1})}_mackAnchor(t){return new nt.fabric.Circle({radius:5,left:t.x,top:t.y,fill:"rgb(178, 53, 84)",scaleX:1/this.canvas.getZoom(),scaleY:1/this.canvas.getZoom(),strokeWidth:1/this.canvas.getZoom(),originX:"center",originY:"center",evented:!1,selectable:!1})}_confirmBuildPolygon(){const t=this.points;if(this.discardPolygon(),this._isUsingHistory()&&(this.canvas.historyProcessing=!1),t.length>=3){const n=this._createPolygon(t);this.canvas.add(n)}}_prepare(){this.canvas.discardActiveObject(),this.canvas.getObjects().forEach(t=>{t.selectable=!1,t.hasControls=!1})}beginDrawPolygon(t){this._prepare(),this.onEnd=t,this._isUsingHistory()&&(this.canvas.historyProcessing=!0),this.canvas.requestRenderAll(),this.isDrawingPolygon=!0,this._bindEvent()}endDrawPolygon(){this.canvas.discardActiveObject(),this.isDrawingPolygon=!1,this.lastPoint=void 0,this.tempPoint=void 0,this._unbindEvent(),this.onEnd&&this.onEnd(),this.onEnd=void 0}discardPolygon(){this.lines.forEach(t=>{this.canvas.remove(t)}),this.anchors.forEach(t=>{this.canvas.remove(t)}),this.tempLine&&this.canvas.remove(this.tempLine),this.tempLine=void 0,this.anchors=[],this.lines=[],this.points=[],this.endDrawPolygon()}}X(Ys,"pluginName","DrawPolygonPlugin"),X(Ys,"apis",["beginDrawPolygon","endDrawPolygon","discardPolygon"]);class Vs{constructor(t,n){this.canvas=t,this.editor=n}startDraw(t){this.canvas.isDrawingMode=!0,this.canvas.freeDrawingBrush=new nt.fabric.PencilBrush(this.canvas),this.canvas.freeDrawingBrush.width=t.width}endDraw(){if(this.canvas.isDrawingMode){this.canvas.isDrawingMode=!1;return}}}X(Vs,"pluginName","FreeDrawPlugin"),X(Vs,"apis",["startDraw","endDraw"]);class Ws{constructor(t,n){X(this,"options");X(this,"_beforeHandler",t=>{if(this.options==null)return;const n=t.path,o=nt.fabric.util.getPathSegmentsInfo;n.segmentsInfo=o(n.path),n.set({stroke:this.options.lineColor});const g=this.options.defaultText,A=this.options.defaultFontSize,v=new nt.fabric.Text(g,{fontSize:A,top:n.top,left:n.left,fill:this.options.color,path:n});this.canvas.add(v)});X(this,"_createdHandler",t=>{this.canvas.remove(t.path)});this.canvas=t,this.editor=n}_bindEvent(){this.canvas.on("before:path:created",this._beforeHandler),this.canvas.on("path:created",this._createdHandler)}_unbindEvent(){this.canvas.off("before:path:created",this._beforeHandler),this.canvas.off("path:created",this._createdHandler)}startTextPathDraw(t={}){const n={decimate:8,width:2,defaultText:"诸事顺遂 万事大吉",color:"#000000",lineColor:"#000000",defaultFontSize:20};this.options=pt(pt({},n),t),this.canvas.isDrawingMode=!0;const o=this.canvas.freeDrawingBrush=new nt.fabric.PencilBrush(this.canvas);o.decimate=this.options.decimate,o.width=this.options.width,o.color=this.options.color,this._bindEvent()}endTextPathDraw(){this.canvas.isDrawingMode=!1,this._unbindEvent()}}X(Ws,"pluginName","PathTextPlugin"),X(Ws,"apis",["startTextPathDraw","endTextPathDraw"]);class d_{constructor(t,n){this.layerFrame=t,this.parent=n,this.type="Group",this.children=[]}get name(){var t,n;return(n=(t=this.layerFrame)===null||t===void 0?void 0:t.layerProperties.name)!==null&&n!==void 0?n:""}get opacity(){var t,n;return(n=(t=this.layerFrame)===null||t===void 0?void 0:t.layerProperties.opacity)!==null&&n!==void 0?n:0}get composedOpacity(){return this.parent.composedOpacity*(this.opacity/255)}get additionalProperties(){var t;return(t=this.layerFrame)===null||t===void 0?void 0:t.layerProperties.additionalLayerProperties}addChild(t){this.children.push(t)}hasChildren(){return this.children.length!==0}freeze(){this.children.forEach(t=>{var n,o;return(o=(n=t).freeze)===null||o===void 0?void 0:o.call(n)}),Object.freeze(this.children)}}var Nt;(function(e){e.SectionDividerSetting="lsct",e.TypeToolObjectSetting="TySh",e.UnicodeLayerName="luni",e.VectorStrokeData="vstk",e.ObjectBasedEffects="lfx2",e.GradientFillSetting="GdFl",e.SolidColorSheetSetting="SoCo",e.PatternFillSetting="PtFl",e.VectorStrokeContentData="vscg",e.BlendOptionsCapacity="iOpa",e.VectorMaskSetting1="vmsk",e.VectorMaskSetting2="vsms",e.HueSaturation="hue2",e.NestedSectionDividerSetting="lsdk",e.LayerId="lyid",e.ArtboardData="artb",e.SmartObjectPlacedLayerData="SoLE",e.PlacedLayerData="SoLd",e.LinkedLayer="lnkD",e.LinkedLayer2="lnk2",e.LinkedLayer3="lnk3"})(Nt||(Nt={}));var Xs;(function(e){e[e.Normal=0]="Normal",e[e.SceneGroup=1]="SceneGroup"})(Xs||(Xs={}));var _e;(function(e){e[e.ClosedSubpathLength=0]="ClosedSubpathLength",e[e.ClosedSubpathBezierKnotLinked=1]="ClosedSubpathBezierKnotLinked",e[e.ClosedSubpathBezierKnotUnlinked=2]="ClosedSubpathBezierKnotUnlinked",e[e.OpenSubpathLength=3]="OpenSubpathLength",e[e.OpenSubpathBezierKnotLinked=4]="OpenSubpathBezierKnotLinked",e[e.OpenSubpathBezierKnotUnlinked=5]="OpenSubpathBezierKnotUnlinked",e[e.PathFillRule=6]="PathFillRule",e[e.Clipboard=7]="Clipboard",e[e.InitialFillRule=8]="InitialFillRule"})(_e||(_e={}));const Js=(e,t)=>{const n=Math.max(e.length,t.length);for(let o=0;o<n;o++)if(e[o]!==t[o])return!1;return!0};class Et extends Error{constructor(t){super(t),Object.setPrototypeOf(this,new.target.prototype),this.name=new.target.name}}class g_ extends Et{}class yh extends Et{}class p_ extends Et{}class A_ extends Et{}class m_ extends Et{}class v_ extends Et{}class y_ extends Et{}class __ extends Et{}class C_ extends Et{}class w_ extends Et{}class _h extends Et{}class Ch extends Et{}class b_ extends Et{}class S_ extends Et{}class E_ extends Et{}class I_ extends Et{}class x_ extends Et{}class B_ extends Et{}class T_ extends Et{}class O_ extends Et{}class k_ extends Et{}class D_ extends Et{}class M_ extends Et{}class P_ extends Et{}class oi extends Et{}class wh extends Et{}class Q_ extends Et{}class Ul extends Et{}class ns extends Et{}class L_ extends Et{}class F_ extends Et{}class R_ extends Et{}class j_ extends Et{}class $_ extends Et{}class N_ extends Et{}class U_ extends Et{}class H_ extends Et{}class G_ extends Et{}class z_ extends Et{}class Y_ extends Et{}class Hl extends Et{}class is extends Et{}class V_ extends Et{}class W_ extends Et{}function bh(e,t){const n=e.getUint32(t),o=e.getUint32(t+4);if(n>=2097152)throw new wh;return n*4294967296+o}function X_(e,t){const n=e.getInt32(t),o=e.getUint32(t+4);if(n>=2097152||n<-2097152||n===-2097152&&o===0)throw new wh;return n*4294967296+o}const J_={u8:1,i8:1,u16:2,i16:2,u32:4,i32:4,f32:4,u64:8,i64:8,f64:8};class rn{static from(t){return new rn(new DataView(t.buffer,t.byteOffset,t.byteLength))}constructor(t,n=0){this.dataView=t,this.position=n}get length(){return this.dataView.byteLength}clone(t){const n=t!==void 0?t:this.position;return new rn(new DataView(this.dataView.buffer,this.dataView.byteOffset,this.dataView.byteLength),n)}pass(t){this.position+=t}unpass(t){this.position-=t}extract(t){if(this.position+t>this.dataView.byteLength)throw new O_;return new Uint8Array(this.dataView.buffer,this.dataView.byteOffset+this.position,t)}iter(){return new Uint8Array(this.dataView.buffer,this.dataView.byteOffset+this.position)}take(t){const n=this.extract(t);return this.pass(t),n}peek(){return this.dataView.getUint8(this.position)}one(){const t=this.dataView.getUint8(this.position);return this.position+=1,t}read(t){const{dataView:n,position:o}=this;switch(this.pass(J_[t]),t){case"u8":return n.getUint8(o);case"u16":return n.getUint16(o);case"u32":return n.getUint32(o);case"u64":return bh(n,o);case"i8":return n.getInt8(o);case"i16":return n.getInt16(o);case"i32":return n.getInt32(o);case"i64":return X_(n,o);case"f32":return n.getFloat32(o);case"f64":return n.getFloat64(o);default:throw new TypeError(`Invalid ReadType: ${t}`)}}readString(t){const n=this.take(t);return new TextDecoder().decode(n)}readUnicodeString(t=4){const n=this.read("u32")*2,o=this.take(n),g=new TextDecoder("utf-16be").decode(o);return this.padding(4+n,t),g.charCodeAt(g.length-1)===0?g.slice(0,-1):g}readFixedPoint32bit(){return this.read("u32")/65536}readIdString(){const t=this.read("u32");return this.readString(t||4)}padding(t,n){const o=t%n;o>0&&this.pass(n-o)}}const rs=(e,t,n)=>t<=e&&e<=n;function Vi(e){return e.bottom-e.top}function K_(e){return e.right-e.left}function Gl(e){return K_(e)*Vi(e)}var or;(function(e){e.PassThrough="pass",e.Normal="norm",e.Dissolve="diss",e.Darken="dark",e.Multiply="mul ",e.ColorBurn="idiv",e.LinearBurn="lbrn",e.DarkerColor="dkCl",e.Lighten="lite",e.Screen="scrn",e.ColorDodge="div ",e.LinearDodge="lddg",e.LighterColor="lgCl",e.Overlay="over",e.SoftLight="sLit",e.HardLight="hLit",e.VividLight="vLit",e.LinearLight="lLit",e.PinLight="pLit",e.HardMix="hMix",e.Difference="diff",e.Exclusion="smud",e.Subtract="fsub",e.Divide="fdiv",e.Hue="hue ",e.Saturation="sat ",e.Color="colr",e.Luminosity="lum "})(or||(or={}));function Sh(e){const t=Object.keys(or);for(const n of t)if(or[n]===e)return e;throw new w_}var Bn;(function(e){e[e.Base=0]="Base",e[e.NonBase=1]="NonBase"})(Bn||(Bn={}));function q_(e){if(e===Bn.Base)return Bn.Base;if(e===Bn.NonBase)return Bn.NonBase;throw new I_}var Ks;(function(e){e[e.Bitmap=0]="Bitmap",e[e.Grayscale=1]="Grayscale",e[e.Indexed=2]="Indexed",e[e.Rgb=3]="Rgb",e[e.Cmyk=4]="Cmyk",e[e.Multichannel=7]="Multichannel",e[e.Duotone=8]="Duotone",e[e.Lab=9]="Lab"})(Ks||(Ks={}));var qs;(function(e){e[e.One=1]="One",e[e.Eight=8]="Eight",e[e.Sixteen=16]="Sixteen",e[e.ThirtyTwo=32]="ThirtyTwo"})(qs||(qs={}));var Lt;(function(e){e.Alias="alis",e.Boolean="bool",e.Class="type",e.Descriptor="Objc",e.Double="doub",e.Enumerated="enum",e.GlobalClass="GlbC",e.GlobalObject="GlbO",e.Integer="long",e.LargeInteger="comp",e.List="VlLs",e.RawData="tdta",e.Reference="obj ",e.String="TEXT",e.UnitFloat="UntF",e.UnitFloats="UnFl",e.ObjectArray="ObAr"})(Lt||(Lt={}));var Zs;(function(e){e.Angle="#Ang",e.Density="#Rsl",e.Distance="#Rlt",e.Millimeters="#Mlm",e.None="#Nne",e.Percent="#Prc",e.Pixels="#Pxl",e.Points="#Pnt"})(Zs||(Zs={}));function In(e,t,n){const o=e.items.get(t);if(!o)throw new $_(`Cannot find key "${t}" in descriptor`);if(o.type!==n)throw new N_(`Unexpected descriptor value type: expected "${n}" but got "${o.type}"`);return o}var Nn;(function(e){e[e.PSD=1]="PSD",e[e.PSB=2]="PSB"})(Nn||(Nn={}));const Z_=[56,66,80,83],tC=[0,0,0,0,0,0],eC=[1,8,16,32],nC=1,iC=56,zl=1;function rC(e){const t=new rn(e),n=t.take(4);if(!Js(n,Z_))throw new g_;const o=t.read("u16");if(!(o===Nn.PSD||o===Nn.PSB))throw new yh;const g=Wo(o),A=t.take(6);if(!Js(A,tC))throw new p_;const v=t.read("u16");if(!rs(v,nC,iC))throw new v_;const f=t.read("u32"),i=t.read("u32");if(!rs(f,zl,g.maxPixels)||!rs(i,zl,g.maxPixels))throw new y_;const c=t.read("u16");if(!eC.includes(c))throw new m_;const l=t.read("u16");if(!(l in Ks))throw new A_;return{channelCount:v,version:o,width:i,height:f,depth:c,colorMode:l}}function sC(e,t,n){const o=(e.length-2)/n,g=e.extract(o),A=n>=2?e.extract(o):void 0,v=n>=3?e.extract(o):void 0,f=n>=4?e.extract(o):void 0;if(t===qs.Eight)return{red:g,green:A,blue:v,alpha:f};throw new b_(`Unsupported image bit depth: ${t}`)}function oC(e,t,n,o){let g=0,A=0,v=0,f=0;const i=o.rleScanlineLengthFieldReadType;for(let d=0;d<n;d++)g+=e.read(i);if(t>=2)for(let d=0;d<n;d++)A+=e.read(i);if(t>=3)for(let d=0;d<n;d++)v+=e.read(i);if(t===4)for(let d=0;d<n;d++)f+=e.read(i);const c=2+t*n*o.rleScanlineLengthFieldSize,l=e.clone(c),r=l.take(g),a=A?l.take(A):void 0,s=v?l.take(v):void 0,u=f?l.take(f):void 0;return{red:r,green:a,blue:s,alpha:u}}function aC(e,t,n,o,g){const A=new rn(e),v=A.read("u16");if(!(v in Pe))throw new _h;const{red:f,green:i,blue:c,alpha:l}=(()=>{switch(v){case Pe.RawData:return sC(A,t,o);case Pe.RleCompressed:return oC(A,o,n,g);default:throw new Ch}})();return{compression:v,red:f,green:i,blue:c,alpha:l}}function lC(e){const t=e.read("u32");if(t!==1)throw new k_;const n=e.read("u32"),o=e.read("u32"),g=e.read("u32"),A=[];for(let v=0;v<g;++v){const f=e.read("i32"),i=hw(e.read("u8"));A.push({position:f,direction:i})}return{version:t,gridSizeX:n,gridSizeY:o,guides:A}}function cC(e,t){return e.take(t-e.position)}function uC(e){const t=e.readFixedPoint32bit(),n=e.read("u16"),o=e.read("u16"),g=e.readFixedPoint32bit(),A=e.read("u16"),v=e.read("u16");return{horizontal:t,horizontalUnit:n,widthUnit:o,vertical:g,verticalUnit:A,heightUnit:v}}function hC(e,t){const n=e.read("u32");if(n===6){const o=e.read("i32"),g=e.read("i32"),A=e.read("i32"),v=e.read("i32"),f=e.readUnicodeString(0),i=e.read("u32"),c=[];for(;c.length<i;){const r=e.read("u32"),a=e.read("u32"),s=fw(e.read("u32")),u=s===1?e.read("u32"):void 0;c.push({id:r,groupId:a,origin:s,associatedLayerId:u,name:e.readUnicodeString(0),type:e.read("u32"),left:e.read("i32"),top:e.read("i32"),right:e.read("i32"),bottom:e.read("i32"),url:e.readUnicodeString(0),target:e.readUnicodeString(0),message:e.readUnicodeString(0),altTag:e.readUnicodeString(0),isCellTextHtml:!!e.read("u8"),cellText:e.readUnicodeString(0),horizontalAlignment:e.read("i32"),verticalAlignment:e.read("i32"),alpha:e.read("u8"),red:e.read("u8"),green:e.read("u8"),blue:e.read("u8")})}const l=e.position<t?Ee(e):void 0;return{version:n,boundTop:o,boundLeft:g,boundBottom:A,boundRight:v,sliceGroupName:f,slices:c,descriptor:l}}else if(n===7||n===8){const o=Ee(e);return{version:n,descriptor:o}}else throw new M_(`Invalid Slices section version: ${n}`)}const fC=[56,66,73,77];function dC(e){const t=new rn(e),n=[],o=t.read("u32");for(;t.position<o;){const g=gC(t);n.push(g)}return{resources:n}}function gC(e){const t=e.take(4);if(!Js(t,fC))throw new T_;const n=e.read("i16"),o=pC(e,2),g=e.read("u32"),A=e.position+g,v=g+g%2,f=e.position;let i=null;switch(n){case fe.GridAndGuides:i=lC(e);break;case fe.Slices:i=hC(e,A);break;case fe.ICCProfile:i=cC(e,A);break;case fe.ResolutionInfo:i=uC(e);break;case fe.GlobalLightAltitude:i=e.read("i32");break;case fe.GlobalLightAngle:i=e.read("i32");break}const c=e.position,l=f+v-c;return l>0&&e.pass(l),{id:n,name:o,resource:i}}function pC(e,t=0){const n=e.read("u8"),o=e.readString(n);if(t){const g=(n+1)%t;g>0&&e.pass(t-g)}return o}function Eh(e){const t={};for(const[n,o]of e)t[n]=o;return t}const Ih=(e,t,n)=>{const{top:o,left:g,bottom:A,right:v,opacity:f,clipping:i,hidden:c,transparencyLocked:l,blendMode:r,layerText:a,engineData:s,maskData:u,additionalLayerInfos:d}=t,h=Eh(d.map(p=>[p.key,p]));return{name:e,top:o,left:g,bottom:A,right:v,opacity:f,clippingMask:i,hidden:c,transparencyLocked:l,blendMode:r,groupId:n,text:a,textProperties:s,maskData:u,additionalLayerProperties:h}};class Yo{static create(t,n,o){const g=Ih(t.name,t,o);return new Yo(n,g)}constructor(t,n){this.channels=t,this.layerProperties=n}get red(){const t=this.channels.get(he.Red);if(t===void 0)throw new E_;return t}get green(){return this.channels.get(he.Green)}get blue(){return this.channels.get(he.Blue)}get alpha(){return this.channels.get(he.TransparencyMask)}get userMask(){return this.channels.get(he.UserSuppliedLayerMask)}get realUserMask(){return this.channels.get(he.RealUserSuppliedLayerMask)}get width(){const{right:t,left:n}=this.layerProperties;return t-n+1}get height(){const{bottom:t,top:n}=this.layerProperties;return t-n+1}}class Vo{static create(t,n,o,g){const A=Ih(t,o,g);return new Vo(n,A)}constructor(t,n){this.id=t,this.layerProperties=n}}function AC(e){return{data:Ee(e)}}function mC(e){return{fillOpacity:e.read("u8")}}function vC(e){return{data:Ee(e)}}function to(e){const t=e.read("i16"),n=e.read("i16"),o=e.read("i16");return{hue:t,saturation:n,lightness:o}}function yC(e){const t=e.read("i16"),n=e.read("i16"),o=e.read("i16"),g=e.read("i16");return pt({beginRamp:t,beginSustain:n,endSustain:o,endRamp:g},to(e))}function _C(e){return Array.from(Array(6),()=>yC(e))}function CC(e){const t=e.read("u16"),n=e.read("u8");e.pass(1);const o=to(e),g=to(e);return{version:t,colorize:n,colorization:o,master:g,adjustment:n?void 0:_C(e)}}function wC(e){return{value:e.read("u32")}}function bC(e,t){const n=[];let o=0;const g=e.position+t;for(;e.position<g&&(o=e.read("u64"));){const A=e.position,v=SC(e);n.push(v);const f=e.position-A,i=o-f;e.pass(i),e.padding(e.position,4)}return{layers:n}}function SC(e){const t=e.readString(4);if(t!=="liFD")throw new L_(`unknown layer type: '${t}'`);const n=e.read("i32"),o=EC(e),g=e.readUnicodeString(0),A=e.readString(4),v=e.readString(4),f=e.read("u64"),i=e.read("u8")?Ee(e):void 0,c=e.take(f),l=n>5?e.readUnicodeString():void 0;return{layerType:t,version:n,uniqueId:o,filename:g,filetype:A,creator:v,data:i,contents:c,uuid:l}}function EC(e){const t=e.read("u8");return e.readString(t)}function IC(e){const t=e.read("u32"),n=e.read("u32"),o=Sr(e);return{version:t,descriptor:o,descriptorVersion:n}}function xC(e){return{data:Ee(e)}}function BC(e,t){const n=uw(e.read("u32"));if(t<12)return{dividerType:n};const o=e.readString(4);if(o!=="8BIM")throw new Ul(`Invalid Section Divider Setting signature: ${o}`);const g=Sh(e.readString(4));if(t<16)return{dividerType:n,dividerSignature:o,blendMode:g};const A=e.read("u32");if(!(A in Xs))throw new Ul(`Invalid Section Divider Setting subtype: ${A}`);return{dividerType:n,dividerSignature:o,blendMode:g,subType:A}}function TC(e){const t=e.readString(4),n=e.read("u32");return{data:Ee(e),version:n,identifier:t}}function OC(e){const t=e.read("u32"),n=Sr(e);return{version:t,data:n}}function kC(e){const t=e.read("u16");if(t!==1)throw new ns(`Invalid type tool object setting version: ${t}`);const n=e.read("f64"),o=e.read("f64"),g=e.read("f64"),A=e.read("f64"),v=e.read("f64"),f=e.read("f64"),i=e.read("u16");if(i!==50)throw new ns(`Invalid text version: ${i}`);const c=Ee(e),l=e.read("u16");if(l!==1)throw new ns(`Invalid warp version: ${l}`);const r=Ee(e),a=e.read("f64"),s=e.read("f64"),u=e.read("f64"),d=e.read("f64");return{version:t,transformXX:n,transformXY:o,transformYX:g,transformYY:A,transformTX:v,transformTY:f,textVersion:i,textData:c,warpVersion:l,warpData:r,left:a,top:s,right:u,bottom:d}}function DC(e){return{name:e.readUnicodeString(0)}}function Yl(e){const[t,...n]=e.take(4),o=n[0]*Wn(2,16)+n[1]*Wn(2,8)+n[2];return t+o/Wn(2,24)}function ss(e){const t=Yl(e),n=Yl(e);return{vert:t,horiz:n}}function MC(e,t){const n=e.read("i16"),o=e.read("i16"),g=e.read("i16");e.pass(6);const A=e.read("i16");return e.pass(10),{type:t,length:n,operation:o,subpathType:g,index:A}}function PC(e,t){const n=Array(4).map(()=>e.read("f32")),o=e.read("f32");return e.pass(6),{type:t,bounds:n,resolution:o}}function QC(e,t){const n=!!(e.read("i16")&1);return e.pass(22),{type:t,fill:n}}function LC(e,t){const n=ss(e),o=ss(e),g=ss(e);return{type:t,preceding:n,anchor:o,leaving:g}}function FC(e){const t=e.read("u16");switch(t){case _e.OpenSubpathLength:case _e.ClosedSubpathLength:return MC(e,t);case _e.PathFillRule:return e.pass(24),{type:t};case _e.Clipboard:return PC(e,t);case _e.InitialFillRule:return QC(e,t);case _e.ClosedSubpathBezierKnotLinked:case _e.ClosedSubpathBezierKnotUnlinked:case _e.OpenSubpathBezierKnotLinked:case _e.OpenSubpathBezierKnotUnlinked:return LC(e,t);default:throw new Error(`Unknown PathRecordType: ${t} (bug in offsets?)`)}}function RC(e,t){const n=Math.floor(t/26);return Array.from(Array(n),()=>FC(e))}function jC(e,t){const n=e.read("u32"),o=e.read("u32"),g=RC(e,t);return{version:n,pathRecords:g,invert:!!(o&1),notLink:!!(o&2),disable:!!(o&4)}}function $C(e){const t=e.read("u32"),n=Ee(e);return{version:t,data:n}}function NC(e){return{data:Ee(e)}}function xh(e,t,n=0){const o=e.readString(4);if(o!=="8BIM"&&o!=="8B64")throw new Q_(`Invalid signature: ${o}`);const g=e.readString(4),A=e.read(HC(g,t)),v=e.position,f=UC(e,o,g,A),i=A-(e.position-v);return e.pass(i),e.padding(A,n),f}function UC(e,t,n,o){switch(n){case Nt.NestedSectionDividerSetting:case Nt.SectionDividerSetting:return pt({signature:t,key:n},BC(e,o));case Nt.TypeToolObjectSetting:return pt({signature:t,key:n},kC(e));case Nt.UnicodeLayerName:return pt({signature:t,key:n},DC(e));case Nt.VectorStrokeData:return pt({signature:t,key:n},NC(e));case Nt.ObjectBasedEffects:return pt({signature:t,key:n},IC(e));case Nt.GradientFillSetting:return pt({signature:t,key:n},vC(e));case Nt.SolidColorSheetSetting:return pt({signature:t,key:n},OC(e));case Nt.PatternFillSetting:return pt({signature:t,key:n},xC(e));case Nt.VectorStrokeContentData:return pt({signature:t,key:n},$C(e));case Nt.BlendOptionsCapacity:return pt({signature:t,key:n},mC(e));case Nt.VectorMaskSetting1:case Nt.VectorMaskSetting2:return pt({signature:t,key:n},jC(e,o));case Nt.HueSaturation:return pt({signature:t,key:n},CC(e));case Nt.LayerId:return pt({signature:t,key:n},wC(e));case Nt.ArtboardData:return pt({signature:t,key:n},AC(e));case Nt.PlacedLayerData:case Nt.SmartObjectPlacedLayerData:return pt({signature:t,key:n},TC(e));case Nt.LinkedLayer:case Nt.LinkedLayer2:case Nt.LinkedLayer3:return pt({signature:t,key:n},bC(e,o));default:{const g=e.take(o);return{signature:t,key:n,_isUnknown:!0,data:g}}}}function HC(e,t){if(t.aliLengthFieldSizeIsVariable)switch(e){case"LMsk":case"Lr16":case"Lr32":case"Layr":case"Mt16":case"Mt32":case"Mtrn":case"Alph":case"FMsk":case"Ink2":case"FEid":case"FXid":case"PxSD":case"cinf":return"u64"}return"u32"}const GC="8BIM";function zC(e,t,n){const o=[];for(;o.length<t;)o.push(YC(e,n));return o.map(g=>{const A=qC(e,g.channelInformation,g,n);return[g,A]}).reverse()}function YC(e,t){const[n,o,g,A]=WC(e),v=e.read("u16"),f=[];for(;f.length<v;){const w=e.read("i16"),b=e.read(t.layerRecordSectionChannelLengthFieldReadType)-2;f.push([w,b])}if(e.readString(4)!==GC)throw new __;const i=Sh(e.readString(4)),c=e.read("u8"),l=q_(e.read("u8")),{hidden:r,transparencyLocked:a}=XC(e);e.pass(1);const s=e.read("u32"),u=e.position,d=tw(e);e.pass(e.read("u32"));const h=e.read("u8");let p=e.readString(h);e.padding(h+1,4);const m=[];for(;e.position-u<s;)m.push(xh(e,t));let y,_,C;for(const w of m)if(!w._isUnknown)switch(w.key){case Nt.SectionDividerSetting:({dividerType:y}=w);break;case Nt.TypeToolObjectSetting:{const b=w.textData.descriptor.items.get("Txt ");b&&b.type===Lt.String&&(_=b.value);const S=w.textData.descriptor.items.get("EngineData");S&&S.type===Lt.RawData&&(C=Ew(S.data));break}case Nt.UnicodeLayerName:({name:p}=w);break}return{name:p,channelInformation:f,top:n,left:o,bottom:g,right:A,hidden:r,transparencyLocked:a,opacity:c,clipping:l,blendMode:i,additionalLayerInfos:m,dividerType:y,layerText:_,engineData:C,maskData:d}}function VC(e,t){const n=[];for(;e.position<e.length;)n.push(xh(e,t,4));return Eh(n.map(o=>[o.key,o]))}function WC(e){const t=e.read("i32"),n=e.read("i32");let o=e.read("i32");o!==0&&(o-=1);let g=e.read("i32");return g!==0&&(g-=1),[t,n,o,g]}function XC(e){const t=e.read("u8");return{transparencyLocked:!!(t&1),hidden:!!(t&2)}}function JC(e){const t=e.maskData.realData;if(!t)throw new Error("missing real mask data");return t}function KC(e,t){switch(t){case he.UserSuppliedLayerMask:return Vi(e.maskData);case he.RealUserSuppliedLayerMask:return Vi(JC(e));default:return Vi(e)+1}}function qC(e,t,n,o){const g=new Map,{length:A}=t;for(let v=0;v<A;v++){const[f,i]=t[v],c=lw(e.read("u16"));switch(c){case Pe.RawData:{const l=e.take(i);g.set(f,{compression:c,data:l});break}case Pe.RleCompressed:{const l=e.take(i>0?ZC(e,KC(n,f),o.rleScanlineLengthFieldReadType):i);g.set(f,{compression:c,data:l});break}}}return g}function ZC(e,t,n){return Array.from(Array(t),()=>e.read(n)).reduce((o,g)=>o+g)}function tw(e){const t=e.read("u32"),n=e.position,[o,g,A,v]=Bh(e),f=e.read("u8"),i=Th(e),c=t>=36?nw(e):void 0,l=i.masksHaveParametersApplied?ew(e):void 0,r=t-(e.position-n);return e.pass(r),{top:o,left:g,bottom:A,right:v,backgroundColor:f,flags:i,parameters:l,realData:c}}function Bh(e){return Array.from(Array(4),()=>e.read("i32"))}var un;(function(e){e[e.PositionRelativeToLayer=1]="PositionRelativeToLayer",e[e.LayerMaskDisabled=2]="LayerMaskDisabled",e[e.InvertMaskWhenBlending=4]="InvertMaskWhenBlending",e[e.UserMaskFromRenderingOtherData=8]="UserMaskFromRenderingOtherData",e[e.MasksHaveParametersApplied=16]="MasksHaveParametersApplied"})(un||(un={}));function Th(e){const t=e.read("u8");return{positionRelativeToLayer:!!(t&un.PositionRelativeToLayer),layerMaskDisabled:!!(t&un.LayerMaskDisabled),invertMaskWhenBlending:!!(t&un.InvertMaskWhenBlending),userMaskFromRenderingOtherData:!!(t&un.UserMaskFromRenderingOtherData),masksHaveParametersApplied:!!(t&un.MasksHaveParametersApplied)}}var Tn;(function(e){e[e.UserMaskDensity=1]="UserMaskDensity",e[e.UserMaskFeather=2]="UserMaskFeather",e[e.VectorMaskDensity=4]="VectorMaskDensity",e[e.VectorMaskFeather=8]="VectorMaskFeather"})(Tn||(Tn={}));function ew(e){const t=e.read("u8");return{userMaskDensity:t&Tn.UserMaskDensity?e.read("u8"):void 0,userMaskFeather:t&Tn.UserMaskFeather?e.read("f64"):void 0,vectorMaskDensity:t&Tn.VectorMaskDensity?e.read("u8"):void 0,vectorMaskFeather:t&Tn.VectorMaskFeather?e.read("f64"):void 0}}function nw(e){const t=Th(e),n=e.read("u8"),[o,g,A,v]=Bh(e);return{top:o,left:g,bottom:A,right:v,flags:t,backgroundColor:n}}function iw(e,t){const n=new rn(e);n.pass(t.layerAndMaskSectionLengthFieldSize),n.pass(t.layerInfoSectionLengthFieldSize);const o=n.read("i16"),g=Math.abs(o),A=zC(n,g,t);n.padding(n.position,4),n.pass(n.read("u32"));const v=VC(n,t),f=[],i=[],c=[],l=[{startIndex:0,groupId:0,parentGroupId:0}];let r=0;for(let a=0;a<g;a++){const[s,u]=A[a],d=l[l.length-1].groupId,{dividerType:h}=s;if(h===Qn.CloseFolder||h===Qn.OpenFolder)r+=1,l.push({startIndex:f.length,groupId:r,parentGroupId:d,layerRecord:s}),c.push("G");else if(h===Qn.BoundingSection){const p=l.pop();if(p===void 0)throw new x_;const m=p.groupId>0?p.groupId:void 0,y=p.layerRecord||s;i.push(Vo.create(y.name,p.groupId,y,m)),c.push("D")}else f.push(Yo.create(s,u,d)),c.push("L")}return i.sort((a,s)=>a.id-s.id),{layers:f,groups:i,orders:c,globalAdditionalLayerInformation:v}}const rw=26;function os(e,t,n=4){const o=(n===4?e.getUint32(t):bh(e,t))+n;return{start:t,end:t+o,size:o}}function sw(e){const t=new DataView(e),n=0,o=rw,g=new DataView(e,n,o),A=rC(g),v=Wo(A.version),f=os(t,n+o),i=os(t,f.end),c=os(t,i.end,v.layerAndMaskSectionLengthFieldSize);return{fileHeader:A,colorModeData:new DataView(e,f.size),imageResources:new DataView(e,i.start,i.size),layerAndMaskInformation:new DataView(e,c.start,c.size),imageData:new DataView(e,c.end)}}const ow={maxPixels:3e4,rleScanlineLengthFieldSize:2,rleScanlineLengthFieldReadType:"u16",layerAndMaskSectionLengthFieldSize:4,layerInfoSectionLengthFieldSize:4,layerRecordSectionChannelLengthFieldReadType:"u32",aliLengthFieldSizeIsVariable:!1},aw={maxPixels:3e5,rleScanlineLengthFieldSize:4,rleScanlineLengthFieldReadType:"u32",layerAndMaskSectionLengthFieldSize:8,layerInfoSectionLengthFieldSize:8,layerRecordSectionChannelLengthFieldReadType:"u64",aliLengthFieldSizeIsVariable:!0};function Wo(e){switch(e){case Nn.PSD:return ow;case Nn.PSB:return aw;default:throw new yh}}var Pe;(function(e){e[e.RawData=0]="RawData",e[e.RleCompressed=1]="RleCompressed",e[e.ZipWithoutPrediction=2]="ZipWithoutPrediction",e[e.ZipWithPrediction=3]="ZipWithPrediction"})(Pe||(Pe={}));function lw(e){if(!(e in Pe))throw new _h;return e}var he;(function(e){e[e.Red=0]="Red",e[e.Green=1]="Green",e[e.Blue=2]="Blue",e[e.TransparencyMask=-1]="TransparencyMask",e[e.UserSuppliedLayerMask=-2]="UserSuppliedLayerMask",e[e.RealUserSuppliedLayerMask=-3]="RealUserSuppliedLayerMask"})(he||(he={}));function cw(e){switch(e){case he.Red:return 0;case he.Green:return 1;case he.Blue:return 2;case he.TransparencyMask:return 3;default:throw new S_}}var Qn;(function(e){e[e.Other=0]="Other",e[e.OpenFolder=1]="OpenFolder",e[e.CloseFolder=2]="CloseFolder",e[e.BoundingSection=3]="BoundingSection"})(Qn||(Qn={}));function uw(e){if(e in Qn)return e;throw new C_}var eo;(function(e){e[e.Vertical=0]="Vertical",e[e.Horizontal=1]="Horizontal"})(eo||(eo={}));function hw(e){if(!(e in eo))throw new D_;return e}var fe;(function(e){e[e.GridAndGuides=1032]="GridAndGuides",e[e.Slices=1050]="Slices",e[e.ICCProfile=1039]="ICCProfile",e[e.GlobalLightAngle=1037]="GlobalLightAngle",e[e.GlobalLightAltitude=1049]="GlobalLightAltitude",e[e.ResolutionInfo=1005]="ResolutionInfo"})(fe||(fe={}));var Ln;(function(e){e[e.AutoGenerated=0]="AutoGenerated",e[e.LayerGenerated=1]="LayerGenerated",e[e.UserGenerated=2]="UserGenerated"})(Ln||(Ln={}));function fw(e){if(!(e in Ln))throw new P_(`Invalid slice origin: ${e}`);return e}var Vl;(function(e){e[e.PixelsPerInch=1]="PixelsPerInch",e[e.PixelsPerCM=2]="PixelsPerCM"})(Vl||(Vl={}));var Wl;(function(e){e[e.Inch=1]="Inch",e[e.CM=2]="CM",e[e.Point=3]="Point",e[e.Pica=4]="Pica",e[e.Column=5]="Column"})(Wl||(Wl={}));var Ye;(function(e){e.Class="Clss",e.Enumerated="Enmr",e.Identifier="Idnt",e.Index="indx",e.Name="name",e.Offset="rele",e.Property="prop"})(Ye||(Ye={}));function Xl(e,t=255){if(!(0<=t&&t<=255))throw new B_;const n=e.length/4,o=cw(he.TransparencyMask),g=t/255;for(let A=0;A<n;A++){const v=A*4+o;e[v]=Math.floor(g*e[v])}return e}let Jl,Kl,ql,Zl,tc,ec,Oh,kh,Dh,Mh,Ph=(()=>_t(void 0,null,function*(){const e="data:application/wasm;base64,AGFzbQEAAAABbw9gAn9/AX9gAn9/AGADf39/AX9gAX8Bf2ABfwBgA39/fwBgAX8BfmAAAX9gBX9/f39/AGAAAGAEf39/fwF/YA5/f39/f39/f39/f39/fwBgC39/f39/f39/f39/AGAEf39/fwBgCH9/f39/f39/AAKYAgUbLi93ZWJ0b29uX3BzZF9kZWNvZGVyX2JnLmpzGl9fd2JnX25ld19hYmRhNzZlODgzYmE4YTVmAAcbLi93ZWJ0b29uX3BzZF9kZWNvZGVyX2JnLmpzHF9fd2JnX3N0YWNrXzY1ODI3OWZlNDQ1NDFjZjYAARsuL3dlYnRvb25fcHNkX2RlY29kZXJfYmcuanMcX193YmdfZXJyb3JfZjg1MTY2N2FmNzFiY2ZjNgABGy4vd2VidG9vbl9wc2RfZGVjb2Rlcl9iZy5qcxpfX3diaW5kZ2VuX29iamVjdF9kcm9wX3JlZgAEGy4vd2VidG9vbl9wc2RfZGVjb2Rlcl9iZy5qcxBfX3diaW5kZ2VuX3Rocm93AAEDVVQDBAICAQAAAAAEAQcICwUMAQEIDQ4BCAEAAAAFAQICCQAJAQoBCgMBBAUBBAMDAQAKBQMAAAAAAAEDAAMDAQMAAAMJAwMDAwECAgcAAAMDAQYGBgQEBQFwASUlBQMBABEGCQF/AUGAgMAACwfHAQsGbWVtb3J5AgAHbWFpbl9qcwAkCmRlY29kZV9yZ2IAFAtkZWNvZGVfcmdiYQASEGRlY29kZV9ncmF5c2NhbGUAGxJkZWNvZGVfZ3JheXNjYWxlX2EAGR9fX3diaW5kZ2VuX2FkZF90b19zdGFja19wb2ludGVyAEYRX193YmluZGdlbl9tYWxsb2MAJQ9fX3diaW5kZ2VuX2ZyZWUANhJfX3diaW5kZ2VuX3JlYWxsb2MAKhBfX3diaW5kZ2VuX3N0YXJ0ACQJKgEAQQELJFhUVFRYIgsdMCMNH1g5RRpYIgweMFZVLRYcJz1XRDs/OjhYVwr0lwFU/CACD38BfiMAQRBrIgskAAJAAkACQAJAAkACQCAAQfUBTwRAQQhBCBA0IQZBFEEIEDQhBUEQQQgQNCEBQQBBEEEIEDRBAnRrIgJBgIB8IAEgBSAGamprQXdxQQNrIgEgASACSxsgAE0NBiAAQQRqQQgQNCEEQdiQwAAoAgBFDQVBACAEayEDAn9BACAEQYACSQ0AGkEfIARB////B0sNABogBEEGIARBCHZnIgBrdkEBcSAAQQF0a0E+agsiBkECdEG8jcAAaigCACIBDQFBACEAQQAhBQwCC0EQIABBBGpBEEEIEDRBBWsgAEsbQQgQNCEEAkACQAJAAn8CQAJAQdSQwAAoAgAiASAEQQN2IgB2IgJBA3FFBEAgBEHckMAAKAIATQ0LIAINAUHYkMAAKAIAIgBFDQsgABBAaEECdEG8jcAAaigCACIBEEggBGshAyABEDEiAARAA0AgABBIIARrIgIgAyACIANJIgIbIQMgACABIAIbIQEgABAxIgANAAsLIAEgBBBQIQUgARAOQRBBCBA0IANLDQUgASAEEEIgBSADEDNB3JDAACgCACIARQ0EIABBeHFBzI7AAGohB0HkkMAAKAIAIQZB1JDAACgCACICQQEgAEEDdnQiAHFFDQIgBygCCAwDCwJAIAJBf3NBAXEgAGoiA0EDdCIAQdSOwABqKAIAIgVBCGooAgAiAiAAQcyOwABqIgBHBEAgAiAANgIMIAAgAjYCCAwBC0HUkMAAIAFBfiADd3E2AgALIAUgA0EDdBAvIAUQUiEDDAsLAkBBASAAQR9xIgB0EDcgAiAAdHEQQGgiAkEDdCIAQdSOwABqKAIAIgNBCGooAgAiASAAQcyOwABqIgBHBEAgASAANgIMIAAgATYCCAwBC0HUkMAAQdSQwAAoAgBBfiACd3E2AgALIAMgBBBCIAMgBBBQIgUgAkEDdCAEayICEDNB3JDAACgCACIABEAgAEF4cUHMjsAAaiEHQeSQwAAoAgAhBgJ/QdSQwAAoAgAiAUEBIABBA3Z0IgBxBEAgBygCCAwBC0HUkMAAIAAgAXI2AgAgBwshACAHIAY2AgggACAGNgIMIAYgBzYCDCAGIAA2AggLQeSQwAAgBTYCAEHckMAAIAI2AgAgAxBSIQMMCgtB1JDAACAAIAJyNgIAIAcLIQAgByAGNgIIIAAgBjYCDCAGIAc2AgwgBiAANgIIC0HkkMAAIAU2AgBB3JDAACADNgIADAELIAEgAyAEahAvCyABEFIiAw0FDAQLIAQgBhAydCEHQQAhAEEAIQUDQAJAIAEQSCICIARJDQAgAiAEayICIANPDQAgASEFIAIiAw0AQQAhAyABIQAMAwsgAUEUaigCACICIAAgAiABIAdBHXZBBHFqQRBqKAIAIgFHGyAAIAIbIQAgB0EBdCEHIAENAAsLIAAgBXJFBEBBACEFQQEgBnQQN0HYkMAAKAIAcSIARQ0DIAAQQGhBAnRBvI3AAGooAgAhAAsgAEUNAQsDQCAAIAUgABBIIgEgBE8gASAEayICIANJcSIBGyEFIAIgAyABGyEDIAAQMSIADQALCyAFRQ0AIARB3JDAACgCACIATSADIAAgBGtPcQ0AIAUgBBBQIQYgBRAOAkBBEEEIEDQgA00EQCAFIAQQQiAGIAMQMyADQYACTwRAIAYgAxAPDAILIANBeHFBzI7AAGohAgJ/QdSQwAAoAgAiAUEBIANBA3Z0IgBxBEAgAigCCAwBC0HUkMAAIAAgAXI2AgAgAgshACACIAY2AgggACAGNgIMIAYgAjYCDCAGIAA2AggMAQsgBSADIARqEC8LIAUQUiIDDQELAkACQAJAAkACQAJAAkAgBEHckMAAKAIAIgBLBEBB4JDAACgCACIAIARLDQJBCEEIEDQgBGpBFEEIEDRqQRBBCBA0akGAgAQQNCIAQRB2QAAhASALQQA2AgggC0EAIABBgIB8cSABQX9GIgAbNgIEIAtBACABQRB0IAAbNgIAIAsoAgAiCA0BQQAhAwwIC0HkkMAAKAIAIQJBEEEIEDQgACAEayIBSwRAQeSQwABBADYCAEHckMAAKAIAIQBB3JDAAEEANgIAIAIgABAvIAIQUiEDDAgLIAIgBBBQIQBB3JDAACABNgIAQeSQwAAgADYCACAAIAEQMyACIAQQQiACEFIhAwwHCyALKAIIIQxB7JDAACALKAIEIgpB7JDAACgCAGoiATYCAEHwkMAAQfCQwAAoAgAiACABIAAgAUsbNgIAAkACQAJAQeiQwAAoAgAEQEG8jsAAIQADQCAAEEMgCEYNAiAAKAIIIgANAAsMAgtB+JDAACgCACIARSAAIAhLcg0FDAcLIAAQSg0AIAAQSyAMRw0AIAAoAgAiAkHokMAAKAIAIgFNBH8gAiAAKAIEaiABSwVBAAsNAQtB+JDAAEH4kMAAKAIAIgAgCCAAIAhJGzYCACAIIApqIQFBvI7AACEAAkACQANAIAEgACgCAEcEQCAAKAIIIgANAQwCCwsgABBKDQAgABBLIAxGDQELQeiQwAAoAgAhCUG8jsAAIQACQANAIAkgACgCAE8EQCAAEEMgCUsNAgsgACgCCCIADQALQQAhAAsgCSAAEEMiBkEUQQgQNCIPa0EXayIBEFIiAEEIEDQgAGsgAWoiACAAQRBBCBA0IAlqSRsiDRBSIQ4gDSAPEFAhAEEIQQgQNCEDQRRBCBA0IQVBEEEIEDQhAkHokMAAIAggCBBSIgFBCBA0IAFrIgEQUCIHNgIAQeCQwAAgCkEIaiACIAMgBWpqIAFqayIDNgIAIAcgA0EBcjYCBEEIQQgQNCEFQRRBCBA0IQJBEEEIEDQhASAHIAMQUCABIAIgBUEIa2pqNgIEQfSQwABBgICAATYCACANIA8QQkG8jsAAKQIAIRAgDkEIakHEjsAAKQIANwIAIA4gEDcCAEHIjsAAIAw2AgBBwI7AACAKNgIAQbyOwAAgCDYCAEHEjsAAIA42AgADQCAAQQQQUCAAQQc2AgQiAEEEaiAGSQ0ACyAJIA1GDQcgCSANIAlrIgAgCSAAEFAQLiAAQYACTwRAIAkgABAPDAgLIABBeHFBzI7AAGohAgJ/QdSQwAAoAgAiAUEBIABBA3Z0IgBxBEAgAigCCAwBC0HUkMAAIAAgAXI2AgAgAgshACACIAk2AgggACAJNgIMIAkgAjYCDCAJIAA2AggMBwsgACgCACEDIAAgCDYCACAAIAAoAgQgCmo2AgQgCBBSIgVBCBA0IQIgAxBSIgFBCBA0IQAgCCACIAVraiIGIAQQUCEHIAYgBBBCIAMgACABa2oiACAEIAZqayEEQeiQwAAoAgAgAEcEQCAAQeSQwAAoAgBGDQMgACgCBEEDcUEBRw0FAkAgABBIIgVBgAJPBEAgABAODAELIABBDGooAgAiAiAAQQhqKAIAIgFHBEAgASACNgIMIAIgATYCCAwBC0HUkMAAQdSQwAAoAgBBfiAFQQN2d3E2AgALIAQgBWohBCAAIAUQUCEADAULQeiQwAAgBzYCAEHgkMAAQeCQwAAoAgAgBGoiADYCACAHIABBAXI2AgQgBhBSIQMMBwsgACAAKAIEIApqNgIEQeCQwAAoAgAgCmohAUHokMAAKAIAIgAgABBSIgBBCBA0IABrIgAQUCEDQeCQwAAgASAAayIFNgIAQeiQwAAgAzYCACADIAVBAXI2AgRBCEEIEDQhAkEUQQgQNCEBQRBBCBA0IQAgAyAFEFAgACABIAJBCGtqajYCBEH0kMAAQYCAgAE2AgAMBQtB4JDAACAAIARrIgE2AgBB6JDAAEHokMAAKAIAIgIgBBBQIgA2AgAgACABQQFyNgIEIAIgBBBCIAIQUiEDDAULQeSQwAAgBzYCAEHckMAAQdyQwAAoAgAgBGoiADYCACAHIAAQMyAGEFIhAwwEC0H4kMAAIAg2AgAMAQsgByAEIAAQLiAEQYACTwRAIAcgBBAPIAYQUiEDDAMLIARBeHFBzI7AAGohAgJ/QdSQwAAoAgAiAUEBIARBA3Z0IgBxBEAgAigCCAwBC0HUkMAAIAAgAXI2AgAgAgshACACIAc2AgggACAHNgIMIAcgAjYCDCAHIAA2AgggBhBSIQMMAgtB/JDAAEH/HzYCAEHIjsAAIAw2AgBBwI7AACAKNgIAQbyOwAAgCDYCAEHYjsAAQcyOwAA2AgBB4I7AAEHUjsAANgIAQdSOwABBzI7AADYCAEHojsAAQdyOwAA2AgBB3I7AAEHUjsAANgIAQfCOwABB5I7AADYCAEHkjsAAQdyOwAA2AgBB+I7AAEHsjsAANgIAQeyOwABB5I7AADYCAEGAj8AAQfSOwAA2AgBB9I7AAEHsjsAANgIAQYiPwABB/I7AADYCAEH8jsAAQfSOwAA2AgBBkI/AAEGEj8AANgIAQYSPwABB/I7AADYCAEGYj8AAQYyPwAA2AgBBjI/AAEGEj8AANgIAQZSPwABBjI/AADYCAEGgj8AAQZSPwAA2AgBBnI/AAEGUj8AANgIAQaiPwABBnI/AADYCAEGkj8AAQZyPwAA2AgBBsI/AAEGkj8AANgIAQayPwABBpI/AADYCAEG4j8AAQayPwAA2AgBBtI/AAEGsj8AANgIAQcCPwABBtI/AADYCAEG8j8AAQbSPwAA2AgBByI/AAEG8j8AANgIAQcSPwABBvI/AADYCAEHQj8AAQcSPwAA2AgBBzI/AAEHEj8AANgIAQdiPwABBzI/AADYCAEHgj8AAQdSPwAA2AgBB1I/AAEHMj8AANgIAQeiPwABB3I/AADYCAEHcj8AAQdSPwAA2AgBB8I/AAEHkj8AANgIAQeSPwABB3I/AADYCAEH4j8AAQeyPwAA2AgBB7I/AAEHkj8AANgIAQYCQwABB9I/AADYCAEH0j8AAQeyPwAA2AgBBiJDAAEH8j8AANgIAQfyPwABB9I/AADYCAEGQkMAAQYSQwAA2AgBBhJDAAEH8j8AANgIAQZiQwABBjJDAADYCAEGMkMAAQYSQwAA2AgBBoJDAAEGUkMAANgIAQZSQwABBjJDAADYCAEGokMAAQZyQwAA2AgBBnJDAAEGUkMAANgIAQbCQwABBpJDAADYCAEGkkMAAQZyQwAA2AgBBuJDAAEGskMAANgIAQayQwABBpJDAADYCAEHAkMAAQbSQwAA2AgBBtJDAAEGskMAANgIAQciQwABBvJDAADYCAEG8kMAAQbSQwAA2AgBB0JDAAEHEkMAANgIAQcSQwABBvJDAADYCAEHMkMAAQcSQwAA2AgBBCEEIEDQhBUEUQQgQNCECQRBBCBA0IQFB6JDAACAIIAgQUiIAQQgQNCAAayIAEFAiAzYCAEHgkMAAIApBCGogASACIAVqaiAAamsiBTYCACADIAVBAXI2AgRBCEEIEDQhAkEUQQgQNCEBQRBBCBA0IQAgAyAFEFAgACABIAJBCGtqajYCBEH0kMAAQYCAgAE2AgALQQAhA0HgkMAAKAIAIgAgBE0NAEHgkMAAIAAgBGsiATYCAEHokMAAQeiQwAAoAgAiAiAEEFAiADYCACAAIAFBAXI2AgQgAiAEEEIgAhBSIQMLIAtBEGokACADC5gHAQV/IAAQUyIAIAAQSCIBEFAhAgJAAkACQCAAEEkNACAAKAIAIQMCQCAAEEFFBEAgASADaiEBIAAgAxBRIgBB5JDAACgCAEcNASACKAIEQQNxQQNHDQJB3JDAACABNgIAIAAgASACEC4PCyABIANqQRBqIQAMAgsgA0GAAk8EQCAAEA4MAQsgAEEMaigCACIEIABBCGooAgAiBUcEQCAFIAQ2AgwgBCAFNgIIDAELQdSQwABB1JDAACgCAEF+IANBA3Z3cTYCAAsCQCACED4EQCAAIAEgAhAuDAELAkACQAJAQeiQwAAoAgAgAkcEQCACQeSQwAAoAgBHDQFB5JDAACAANgIAQdyQwABB3JDAACgCACABaiICNgIAIAAgAhAzDwtB6JDAACAANgIAQeCQwABB4JDAACgCACABaiICNgIAIAAgAkEBcjYCBCAAQeSQwAAoAgBGDQEMAgsgAhBIIgMgAWohAQJAIANBgAJPBEAgAhAODAELIAJBDGooAgAiBCACQQhqKAIAIgJHBEAgAiAENgIMIAQgAjYCCAwBC0HUkMAAQdSQwAAoAgBBfiADQQN2d3E2AgALIAAgARAzIABB5JDAACgCAEcNAkHckMAAIAE2AgAMAwtB3JDAAEEANgIAQeSQwABBADYCAAtB9JDAACgCACACTw0BQQhBCBA0IQBBFEEIEDQhAkEQQQgQNCEDQQBBEEEIEDRBAnRrIgFBgIB8IAMgACACamprQXdxQQNrIgAgACABSxtFDQFB6JDAACgCAEUNAUEIQQgQNCEAQRRBCBA0IQJBEEEIEDQhAUEAIQMCQEHgkMAAKAIAIgQgASACIABBCGtqaiIATQ0AIAQgAGtB//8DakGAgHxxIgRBgIAEayECQeiQwAAoAgAhAUG8jsAAIQACQANAIAEgACgCAE8EQCAAEEMgAUsNAgsgACgCCCIADQALQQAhAAsgABBKDQAgAEEMaigCABoMAAsQEEEAIANrRw0BQeCQwAAoAgBB9JDAACgCAE0NAUH0kMAAQX82AgAPCyABQYACSQ0BIAAgARAPQfyQwABB/JDAACgCAEEBayIANgIAIAANABAQGg8LDwsgAUF4cUHMjsAAaiECAn9B1JDAACgCACIDQQEgAUEDdnQiAXEEQCACKAIIDAELQdSQwAAgASADcjYCACACCyEDIAIgADYCCCADIAA2AgwgACACNgIMIAAgAzYCCAvIDQEMfwJAAkAgACgCCCIKIAAoAhAiA3IEQAJAIANFDQAgASACaiEIIABBFGooAgBBAWohByABIQQDQAJAIAQhAyAHQQFrIgdFDQAgAyAIRg0CAn8gAywAACIEQQBOBEAgBEH/AXEhBSADQQFqDAELIAMtAAFBP3EhCSAEQR9xIQUgBEFfTQRAIAVBBnQgCXIhBSADQQJqDAELIAMtAAJBP3EgCUEGdHIhCSAEQXBJBEAgCSAFQQx0ciEFIANBA2oMAQsgBUESdEGAgPAAcSADLQADQT9xIAlBBnRyciIFQYCAxABGDQMgA0EEagsiBCAGIANraiEGIAVBgIDEAEcNAQwCCwsgAyAIRg0AIAMsAAAiBEEATiAEQWBJciAEQXBJckUEQCAEQf8BcUESdEGAgPAAcSADLQADQT9xIAMtAAJBP3FBBnQgAy0AAUE/cUEMdHJyckGAgMQARg0BCwJAAkAgBkUNACACIAZNBEBBACEDIAIgBkYNAQwCC0EAIQMgASAGaiwAAEFASA0BCyABIQMLIAYgAiADGyECIAMgASADGyEBCyAKRQ0CIABBDGooAgAhDAJAIAJBEE8EQAJ/QQAhBUEAIQcCQAJAIAEiA0EDakF8cSIEIANrIgggAksgCEEES3INACACIAhrIglBBEkNACAJQQNxIQpBACEGAkAgAyAERg0AIAhBA3EhBQJAIAQgA0F/c2pBA0kEQCADIQQMAQsgCEF8cSELIAMhBANAIAYgBCwAAEG/f0pqIAQsAAFBv39KaiAELAACQb9/SmogBCwAA0G/f0pqIQYgBEEEaiEEIAtBBGsiCw0ACwsgBUUNAANAIAYgBCwAAEG/f0pqIQYgBEEBaiEEIAVBAWsiBQ0ACwsgAyAIaiEDAkAgCkUNACADIAlBfHFqIgQsAABBv39KIQcgCkEBRg0AIAcgBCwAAUG/f0pqIQcgCkECRg0AIAcgBCwAAkG/f0pqIQcLIAlBAnYhCCAGIAdqIQUDQCADIQYgCEUNAkHAASAIIAhBwAFPGyIHQQNxIQkgB0ECdCELAkAgB0H8AXEiCkUEQEEAIQQMAQsgBiAKQQJ0aiENQQAhBANAIANFDQEgBCADKAIAIg5Bf3NBB3YgDkEGdnJBgYKECHFqIANBBGooAgAiBEF/c0EHdiAEQQZ2ckGBgoQIcWogA0EIaigCACIEQX9zQQd2IARBBnZyQYGChAhxaiADQQxqKAIAIgRBf3NBB3YgBEEGdnJBgYKECHFqIQQgA0EQaiIDIA1HDQALCyAIIAdrIQggBiALaiEDIARBCHZB/4H8B3EgBEH/gfwHcWpBgYAEbEEQdiAFaiEFIAlFDQALAn9BACAGRQ0AGiAGIApBAnRqIgMoAgAiBEF/c0EHdiAEQQZ2ckGBgoQIcSIEIAlBAUYNABogBCADKAIEIgZBf3NBB3YgBkEGdnJBgYKECHFqIgQgCUECRg0AGiAEIAMoAggiA0F/c0EHdiADQQZ2ckGBgoQIcWoLIgNBCHZB/4EccSADQf+B/AdxakGBgARsQRB2IAVqDAILQQAgAkUNARogAkEDcSEEIAJBBE8EQCACQXxxIQYDQCAFIAMsAABBv39KaiADLAABQb9/SmogAywAAkG/f0pqIAMsAANBv39KaiEFIANBBGohAyAGQQRrIgYNAAsLIARFDQADQCAFIAMsAABBv39KaiEFIANBAWohAyAEQQFrIgQNAAsLIAULIQQMAQsgAkUEQEEAIQQMAQsgAkEDcSEFAkAgAkEESQRAQQAhBCABIQMMAQsgAkF8cSEHQQAhBCABIQMDQCAEIAMsAABBv39KaiADLAABQb9/SmogAywAAkG/f0pqIAMsAANBv39KaiEEIANBBGohAyAHQQRrIgcNAAsLIAVFDQADQCAEIAMsAABBv39KaiEEIANBAWohAyAFQQFrIgUNAAsLIAQgDEkEQCAMIARrIgQhBgJAAkACQCAALQAgIgNBACADQQNHGyIDQQFrDgIAAQILQQAhBiAEIQMMAQsgBEEBdiEDIARBAWpBAXYhBgsgA0EBaiEDIABBBGooAgAhBCAAKAIcIQUgACgCACEAAkADQCADQQFrIgNFDQEgACAFIAQoAhARAABFDQALQQEPC0EBIQMgBUGAgMQARg0CIAAgASACIAQoAgwRAgANAkEAIQMDQCADIAZGBEBBAA8LIANBAWohAyAAIAUgBCgCEBEAAEUNAAsgA0EBayAGSQ8LDAILIAAoAgAgASACIAAoAgQoAgwRAgAhAwsgAw8LIAAoAgAgASACIAAoAgQoAgwRAgAL9wQBCn8jAEEwayIDJAAgA0EDOgAoIANCgICAgIAENwMgIANBADYCGCADQQA2AhAgAyABNgIMIAMgADYCCAJ/AkACQCACKAIAIgpFBEAgAkEUaigCACIARQ0BIAIoAhAhASAAQQN0IQUgAEEBa0H/////AXFBAWohByACKAIIIQADQCAAQQRqKAIAIgQEQCADKAIIIAAoAgAgBCADKAIMKAIMEQIADQQLIAEoAgAgA0EIaiABQQRqKAIAEQAADQMgAUEIaiEBIABBCGohACAFQQhrIgUNAAsMAQsgAigCBCIARQ0AIABBBXQhCyAAQQFrQf///z9xQQFqIQcgAigCCCEAA0AgAEEEaigCACIBBEAgAygCCCAAKAIAIAEgAygCDCgCDBECAA0DCyADIAUgCmoiBEEcai0AADoAKCADIARBFGopAgA3AyAgBEEQaigCACEGIAIoAhAhCEEAIQlBACEBAkACQAJAIARBDGooAgBBAWsOAgACAQsgBkEDdCAIaiIMQQRqKAIAQR5HDQEgDCgCACgCACEGC0EBIQELIAMgBjYCFCADIAE2AhAgBEEIaigCACEBAkACQAJAIARBBGooAgBBAWsOAgACAQsgAUEDdCAIaiIGQQRqKAIAQR5HDQEgBigCACgCACEBC0EBIQkLIAMgATYCHCADIAk2AhggCCAEKAIAQQN0aiIBKAIAIANBCGogASgCBBEAAA0CIABBCGohACALIAVBIGoiBUcNAAsLIAJBDGooAgAgB0sEQCADKAIIIAIoAgggB0EDdGoiACgCACAAKAIEIAMoAgwoAgwRAgANAQtBAAwBC0EBCyADQTBqJAALywQBBH8gACABEFAhAgJAAkACQCAAEEkNACAAKAIAIQMCQCAAEEFFBEAgASADaiEBIAAgAxBRIgBB5JDAACgCAEcNASACKAIEQQNxQQNHDQJB3JDAACABNgIAIAAgASACEC4PCyABIANqQRBqIQAMAgsgA0GAAk8EQCAAEA4MAQsgAEEMaigCACIEIABBCGooAgAiBUcEQCAFIAQ2AgwgBCAFNgIIDAELQdSQwABB1JDAACgCAEF+IANBA3Z3cTYCAAsgAhA+BEAgACABIAIQLgwCCwJAQeiQwAAoAgAgAkcEQCACQeSQwAAoAgBHDQFB5JDAACAANgIAQdyQwABB3JDAACgCACABaiIBNgIAIAAgARAzDwtB6JDAACAANgIAQeCQwABB4JDAACgCACABaiIBNgIAIAAgAUEBcjYCBCAAQeSQwAAoAgBHDQFB3JDAAEEANgIAQeSQwABBADYCAA8LIAIQSCIDIAFqIQECQCADQYACTwRAIAIQDgwBCyACQQxqKAIAIgQgAkEIaigCACICRwRAIAIgBDYCDCAEIAI2AggMAQtB1JDAAEHUkMAAKAIAQX4gA0EDdndxNgIACyAAIAEQMyAAQeSQwAAoAgBHDQFB3JDAACABNgIACw8LIAFBgAJPBEAgACABEA8PCyABQXhxQcyOwABqIQICf0HUkMAAKAIAIgNBASABQQN2dCIBcQRAIAIoAggMAQtB1JDAACABIANyNgIAIAILIQEgAiAANgIIIAEgADYCDCAAIAI2AgwgACABNgIIC/cCAQV/AkACQAJAAkAgAUEJTwRAQRBBCBA0IAFLDQEMAgsgABAFIQQMAgtBEEEIEDQhAQtBCEEIEDQhA0EUQQgQNCECQRBBCBA0IQVBAEEQQQgQNEECdGsiBkGAgHwgBSACIANqamtBd3FBA2siAyADIAZLGyABayAATQ0AIAFBECAAQQRqQRBBCBA0QQVrIABLG0EIEDQiA2pBEEEIEDRqQQRrEAUiAkUNACACEFMhAAJAIAFBAWsiBCACcUUEQCAAIQEMAQsgAiAEakEAIAFrcRBTIQJBEEEIEDQhBCAAEEggAiABQQAgAiAAayAETRtqIgEgAGsiAmshBCAAEEFFBEAgASAEECwgACACECwgACACEAkMAQsgACgCACEAIAEgBDYCBCABIAAgAmo2AgALIAEQQQ0BIAEQSCICQRBBCBA0IANqTQ0BIAEgAxBQIQAgASADECwgACACIANrIgMQLCAAIAMQCQwBCyAEDwsgARBSIAEQQRoL0gIBAn8jAEEQayICJAAgACgCACEAAkAgAUH/AE0EQCAAKAIIIgMgACgCAEYEfyAAIAMQFSAAKAIIBSADCyAAKAIEaiABOgAAIAAgACgCCEEBajYCCAwBCyACQQA2AgwCfyABQYAQTwRAIAFBgIAETwRAIAIgAUE/cUGAAXI6AA8gAiABQQZ2QT9xQYABcjoADiACIAFBDHZBP3FBgAFyOgANIAIgAUESdkEHcUHwAXI6AAxBBAwCCyACIAFBP3FBgAFyOgAOIAIgAUEMdkHgAXI6AAwgAiABQQZ2QT9xQYABcjoADUEDDAELIAIgAUE/cUGAAXI6AA0gAiABQQZ2QcABcjoADEECCyEBIAEgACgCACAAKAIIIgNrSwRAIAAgAyABEBMgACgCCCEDCyAAKAIEIANqIAJBDGogARBOGiAAIAEgA2o2AggLIAJBEGokAEEAC9ACAQJ/IwBBEGsiAiQAIAAoAgAhAAJAIAFB/wBNBEAgACgCCCIDIAAoAgBGBEAgACADEBUgACgCCCEDCyAAIANBAWo2AgggACgCBCADaiABOgAADAELIAJBADYCDAJ/IAFBgBBPBEAgAUGAgARPBEAgAiABQT9xQYABcjoADyACIAFBBnZBP3FBgAFyOgAOIAIgAUEMdkE/cUGAAXI6AA0gAiABQRJ2QQdxQfABcjoADEEEDAILIAIgAUE/cUGAAXI6AA4gAiABQQx2QeABcjoADCACIAFBBnZBP3FBgAFyOgANQQMMAQsgAiABQT9xQYABcjoADSACIAFBBnZBwAFyOgAMQQILIQEgASAAKAIAIAAoAggiA2tLBEAgACADIAEQEyAAKAIIIQMLIAAoAgQgA2ogAkEMaiABEE4aIAAgASADajYCCAsgAkEQaiQAQQALywIBAn8jAEEQayICJAACQCABQf8ATQRAIAAoAggiAyAAKAIARgR/IAAgAxAVIAAoAggFIAMLIAAoAgRqIAE6AAAgACAAKAIIQQFqNgIIDAELIAJBADYCDAJ/IAFBgBBPBEAgAUGAgARPBEAgAiABQT9xQYABcjoADyACIAFBBnZBP3FBgAFyOgAOIAIgAUEMdkE/cUGAAXI6AA0gAiABQRJ2QQdxQfABcjoADEEEDAILIAIgAUE/cUGAAXI6AA4gAiABQQx2QeABcjoADCACIAFBBnZBP3FBgAFyOgANQQMMAQsgAiABQT9xQYABcjoADSACIAFBBnZBwAFyOgAMQQILIQEgASAAKAIAIAAoAggiA2tLBEAgACADIAEQEyAAKAIIIQMLIAAoAgQgA2ogAkEMaiABEE4aIAAgASADajYCCAsgAkEQaiQAQQALvAIBBX8gACgCGCEDAkACQCAAIAAoAgxGBEAgAEEUQRAgAEEUaiIBKAIAIgQbaigCACICDQFBACEBDAILIAAoAggiAiAAKAIMIgE2AgwgASACNgIIDAELIAEgAEEQaiAEGyEEA0AgBCEFIAIiAUEUaiICIAFBEGogAigCACICGyEEIAFBFEEQIAIbaigCACICDQALIAVBADYCAAsCQCADRQ0AAkAgACAAKAIcQQJ0QbyNwABqIgIoAgBHBEAgA0EQQRQgAygCECAARhtqIAE2AgAgAUUNAgwBCyACIAE2AgAgAQ0AQdiQwABB2JDAACgCAEF+IAAoAhx3cTYCAA8LIAEgAzYCGCAAKAIQIgIEQCABIAI2AhAgAiABNgIYCyAAQRRqKAIAIgBFDQAgAUEUaiAANgIAIAAgATYCGAsLoAIBBH8gAEIANwIQIAACf0EAIAFBgAJJDQAaQR8gAUH///8HSw0AGiABQQYgAUEIdmciAmt2QQFxIAJBAXRrQT5qCyIDNgIcIANBAnRBvI3AAGohAgJAAkACQAJAQdiQwAAoAgAiBEEBIAN0IgVxBEAgAigCACECIAMQMiEDIAIQSCABRw0BIAIhAwwCC0HYkMAAIAQgBXI2AgAgAiAANgIADAMLIAEgA3QhBANAIAIgBEEddkEEcWpBEGoiBSgCACIDRQ0CIARBAXQhBCADIgIQSCABRw0ACwsgAygCCCIBIAA2AgwgAyAANgIIIAAgAzYCDCAAIAE2AgggAEEANgIYDwsgBSAANgIACyAAIAI2AhggACAANgIIIAAgADYCDAtgAQx/QcSOwAAoAgAiAgRAQbyOwAAhBgNAIAIiASgCCCECIAEoAgQhAyABKAIAIQQgAUEMaigCABogASEGIAVBAWohBSACDQALC0H8kMAAQf8fIAUgBUH/H00bNgIAIAgLlgIBA38gACABaiEHAkACQAJAAkADQCAAIAdHBEAgAC0AACEFIABBAWoiASEAIAVBgAFGDQEgBcBBAE4EQEEAIQYDQCAAIAdGDQQgAiAETw0FIAIgA2ogAC0AADoAACACQQRqIQIgAEEBaiEAIAZB/wFxIAZBAWohBiAFSQ0ACwwCCyABIAdGDQVBASAFayEFIAFBAWohACABLQAAIQZBACEBA0AgAiAETw0FIAIgA2ogBjoAACACQQRqIQIgAUEBaiIBQf8BcSAFQf8BcUkNAAsMAQsLDwtBtIDAAEHBAEGIgcAAECAAC0GAgMAAQRlB+IDAABAgAAtBgIDAAEEZQdSBwAAQIAALQZiBwABBO0HkgcAAECAAC+oEAQt/IwBBEGsiESQAAkACQAJAIAQOAgEAAgtBASEPCwJAAkAgBw4CAQACC0EBIRALQQAhBAJAAkAgCg4CAQACC0EBIQQLQQEhBwJAAkACQCANDgIAAQILQQAhBwsgEUEIaiEYIAIhEiADIRMgDyENIAUhFCAGIRUgECEKIAghFiAJIRcgCyEPIAwhEAJAAkACQAJAAkAgAUECdCIORQRAQQEhAQwBCyAOQQBIDQEgDhArIgFFDQILAkAgDUUEQCATRQ0BQQAhDQNAIA0gDk8NBSABIA1qIBItAAA6AAAgDUEEaiENIBJBAWohEiATQQFrIhMNAAsMAQsgEiATQQAgASAOEBELAkAgCkUEQCAVRQ0BQQEhDQNAIA0gDk8NBSABIA1qIBQtAAA6AAAgDUEEaiENIBRBAWohFCAVQQFrIhUNAAsMAQsgFCAVQQEgASAOEBELAkAgBEUEQCAXRQ0BQQIhDQNAIA0gDk8NBSABIA1qIBYtAAA6AAAgDUEEaiENIBZBAWohFiAXQQFrIhcNAAsMAQsgFiAXQQIgASAOEBELAkAgB0UEQCAQRQ0BQQMhDQNAIA0gDk8NBSABIA1qIA8tAAA6AAAgDUEEaiENIA9BAWohDyAQQQFrIhANAAsMAQsgDyAQQQMgASAOEBELIBggDjYCBCAYIAE2AgAMAwsQJgALIA5BARBMAAtBgIDAAEEZQaSAwAAQIAALIBEoAgwhBCARKAIIIQEgDARAIAsQBgsgCQRAIAgQBgsgBgRAIAUQBgsgAwRAIAIQBgsgACABNgIAIAAgBDYCBCARQRBqJAAPCwsQRwALyQEBAn8jAEEgayIDJAACQAJAIAEgASACaiIBSw0AQQggACgCACICQQF0IgQgASABIARJGyIBIAFBCE0bIgFBf3NBH3YhBAJAIAIEQCADQQE2AhggAyACNgIUIAMgAEEEaigCADYCEAwBCyADQQA2AhgLIAMgASAEIANBEGoQGCADKAIEIQIgAygCAEUEQCAAIAE2AgAgACACNgIEDAILIANBCGooAgAiAEGBgICAeEYNASAARQ0AIAIgABBMAAsQJgALIANBIGokAAuDBAEKfyMAQRBrIg8kAAJAAkACQCAEDgIBAAILQQEhDQsCQAJAIAcOAgEAAgtBASEOC0EBIQQCQAJAAkAgCg4CAAECC0EAIQQLIA9BCGohEiACIQcgAyEKIA0hEyAFIQ0gBiEQIA4hFCAIIQ4gCSERAkACQAJAAkACQCABQQJ0IgtFBEBBASEBDAELIAtBAEgNASALQQEQPCIBRQ0CCyABQf8BIAsQTSEMAkAgE0UEQCAKRQ0BQQAhAQNAIAEgC08NBSABIAxqIActAAA6AAAgAUEEaiEBIAdBAWohByAKQQFrIgoNAAsMAQsgByAKQQAgDCALEBELAkAgFEUEQCAQRQ0BQQEhAQNAIAEgC08NBSABIAxqIA0tAAA6AAAgAUEEaiEBIA1BAWohDSAQQQFrIhANAAsMAQsgDSAQQQEgDCALEBELAkAgBEUEQCARRQ0BQQIhAQNAIAEgC08NBSABIAxqIA4tAAA6AAAgAUEEaiEBIA5BAWohDiARQQFrIhENAAsMAQsgDiARQQIgDCALEBELIBIgCzYCBCASIAw2AgAMAwsQJgALIAtBARBMAAtBgIDAAEEZQaSAwAAQIAALIA8oAgwhASAPKAIIIQQgCQRAIAgQBgsgBgRAIAUQBgsgAwRAIAIQBgsgACAENgIAIAAgATYCBCAPQRBqJAAPCwsQRwALxwEBA38jAEEgayICJAACQAJAIAFBAWoiAUUNAEEIIAAoAgAiA0EBdCIEIAEgASAESRsiASABQQhNGyIBQX9zQR92IQQCQCADBEAgAkEBNgIYIAIgAzYCFCACIABBBGooAgA2AhAMAQsgAkEANgIYCyACIAEgBCACQRBqEBggAigCBCEDIAIoAgBFBEAgACABNgIAIAAgAzYCBAwCCyACQQhqKAIAIgBBgYCAgHhGDQEgAEUNACADIAAQTAALECYACyACQSBqJAAL3AECA38BfiMAQSBrIgIkACABKAIERQRAIAEoAgwhAyACQRhqIgRBADYCACACQoCAgIAQNwMQIAIgAkEQajYCHCACQRxqQYCHwAAgAxAIGiABQQhqIAQoAgA2AgAgASACKQMQNwIACyABKQIAIQUgAUKAgICAEDcCACACQQhqIgMgAUEIaiIBKAIANgIAIAFBADYCACACIAU3AwBBDEEEEDwiAUUEQEEMQQQQTAALIAEgAikDADcCACABQQhqIAMoAgA2AgAgAEGoicAANgIEIAAgATYCACACQSBqJAAL7wEBAn8jAEEgayIFJABBuI3AAEG4jcAAKAIAIgZBAWo2AgACQAJAIAZBAEgNAEGAkcAAQYCRwAAoAgBBAWoiBjYCACAGQQJLDQAgBSAEOgAYIAUgAzYCFCAFIAI2AhAgBUHwicAANgIMIAVBmIfAADYCCEGojcAAKAIAIgJBAEgNAEGojcAAIAJBAWo2AgBBqI3AAEGwjcAAKAIABH8gBSAAIAEoAhARAQAgBSAFKQMANwMIQbCNwAAoAgAgBUEIakG0jcAAKAIAKAIUEQEAQaiNwAAoAgBBAWsFIAILNgIAIAZBAUsNACAEDQELAAsAC6sBAQF/AkAgAgRAAn8CQAJAAkAgAUEATgRAIAMoAghFDQIgAygCBCIEDQEgAQ0DIAIMBAsgAEEIakEANgIADAULIAMoAgAgBCACIAEQNQwCCyABDQAgAgwBCyABIAIQPAsiAwRAIAAgAzYCBCAAQQhqIAE2AgAgAEEANgIADwsgACABNgIEIABBCGogAjYCAAwBCyAAIAE2AgQgAEEIakEANgIACyAAQQE2AgALkQQBCX8jAEEQayIMJAACQAJAAkAgBA4CAgEACxBHAAtBASEIC0EBIQQCQAJAAkAgBw4CAAECC0EAIQQLIAxBCGohDyACIQsgAyEHIAUhDSAGIQ4gBCEQAkACQAJAAkACQCABQQJ0IglFBEBBASEKDAELIAlBAEgNASAJECsiCkUNAgsCQCAIRQRAIAdFDQFBACEIIAchASALIQQDQCAIIAlPDQUgCCAKaiAELQAAOgAAIAhBBGohCCAEQQFqIQQgAUEBayIBDQALIAchAUEBIQggCyEEA0AgCCAJTw0FIAggCmogBC0AADoAACAIQQRqIQggBEEBaiEEIAFBAWsiAQ0AC0ECIQgDQCAIIAlPDQUgCCAKaiALLQAAOgAAIAhBBGohCCALQQFqIQsgB0EBayIHDQALDAELIAsgB0EAIAogCRARIAsgB0EBIAogCRARIAsgB0ECIAogCRARCwJAIBBFBEAgDkUNAUEDIQgDQCAIIAlPDQUgCCAKaiANLQAAOgAAIAhBBGohCCANQQFqIQ0gDkEBayIODQALDAELIA0gDkEDIAogCRARCyAPIAk2AgQgDyAKNgIADAMLECYACyAJQQEQTAALQYCAwABBGUGkgMAAECAACyAMKAIMIQQgDCgCCCEBIAYEQCAFEAYLIAMEQCACEAYLIAAgATYCACAAIAQ2AgQgDEEQaiQADwsQRwALcQAjAEEwayIBJABBgI3AAC0AAARAIAFBFGpBAjYCACABQRxqQQE2AgAgAUHoh8AANgIQIAFBADYCCCABQQ82AiQgASAANgIsIAEgAUEgajYCGCABIAFBLGo2AiAgAUEIakGQiMAAECkACyABQTBqJAALpAMBB38jAEEQayIKJABBASEHAkACQAJAIAQOAgABAgtBACEHCyAKQQhqIQsgAiEEIAMhCAJAAkACQAJAAkAgAUECdCIGRQRAQQEhBQwBCyAGQQBIDQEgBkEBEDwiBUUNAgsgBUH/ASAGEE0hCQJAIAdFBEAgCEUNAUEAIQUgCCEHIAQhAQNAIAUgBk8NBSAFIAlqIAEtAAA6AAAgBUEEaiEFIAFBAWohASAHQQFrIgcNAAsgCCEHQQEhBSAEIQEDQCAFIAZPDQUgBSAJaiABLQAAOgAAIAVBBGohBSABQQFqIQEgB0EBayIHDQALQQIhBQNAIAUgBk8NBSAFIAlqIAQtAAA6AAAgBUEEaiEFIARBAWohBCAIQQFrIggNAAsMAQsgBCAIQQAgCSAGEBEgBCAIQQEgCSAGEBEgBCAIQQIgCSAGEBELIAsgBjYCBCALIAk2AgAMAwsQJgALIAZBARBMAAtBgIDAAEEZQaSAwAAQIAALIAooAgwhASAKKAIIIQQgAwRAIAIQBgsgACAENgIAIAAgATYCBCAKQRBqJAAPCxBHAAt5AQN/IwBBEGsiAiQAIAEoAgRFBEAgASgCDCEDIAJBCGoiBEEANgIAIAJCgICAgBA3AwAgAiACNgIMIAJBDGpBgIfAACADEAgaIAFBCGogBCgCADYCACABIAIpAwA3AgALIABBqInAADYCBCAAIAE2AgAgAkEQaiQAC10BAX8jAEEgayICJAAgACgCACEAIAJBGGogAUEQaikCADcDACACQRBqIAFBCGopAgA3AwAgAiABKQIANwMIIAIgADYCBCACQQRqQaCFwAAgAkEIahAIIAJBIGokAAtdAQF/IwBBIGsiAiQAIAAoAgAhACACQRhqIAFBEGopAgA3AwAgAkEQaiABQQhqKQIANwMAIAIgASkCADcDCCACIAA2AgQgAkEEakGAh8AAIAJBCGoQCCACQSBqJAALVgEBfyMAQSBrIgIkACACIAA2AgQgAkEYaiABQRBqKQIANwMAIAJBEGogAUEIaikCADcDACACIAEpAgA3AwggAkEEakGghcAAIAJBCGoQCCACQSBqJAALZQEBfyMAQTBrIgMkACADIAE2AgwgAyAANgIIIANBHGpBATYCACADQSRqQQE2AgAgA0HIisAANgIYIANBADYCECADQSA2AiwgAyADQShqNgIgIAMgA0EIajYCKCADQRBqIAIQKQALUQEBfyMAQSBrIgIkACACQQxqQQE2AgAgAkEUakEANgIAIAJByIrAADYCECACQQA2AgAgAkErNgIcIAIgADYCGCACIAJBGGo2AgggAiABECkAC0YBAX8gAiAAKAIAIgAoAgAgACgCCCIDa0sEQCAAIAMgAhATIAAoAgghAwsgACgCBCADaiABIAIQThogACACIANqNgIIQQALQQEBfyACIAAoAgAgACgCCCIDa0sEQCAAIAMgAhATIAAoAgghAwsgACgCBCADaiABIAIQThogACACIANqNgIIQQAL6QQBBn8jAEEQayIDJABBgY3AAC0AAEEDRwRAIANBAToACyADIANBC2o2AgwgA0EMaiEAIwBBIGsiASQAAkACQAJAAkACQAJAAkBBgY3AAC0AAEEBaw4DAgQBAAtBgY3AAEECOgAAIAFBgY3AADYCCCAAKAIAIgAtAAAgAEEAOgAARQ0CIwBBIGsiACQAAkACQAJAQbiNwAAoAgBB/////wdxBEAQT0UNAQtBqI3AACgCAEGojcAAQX82AgANAQJAAkBBuI3AACgCAEH/////B3FFBEBBtI3AACgCACECQbSNwABBjIPAADYCAEGwjcAAKAIAIQRBsI3AAEEBNgIADAELEE9BtI3AACgCACECQbSNwABBjIPAADYCAEGwjcAAKAIAIQRBsI3AAEEBNgIARQ0BC0G4jcAAKAIAQf////8HcUUNABBPDQBBrI3AAEEBOgAAC0GojcAAQQA2AgACQCAERQ0AIAQgAigCABEEACACQQRqKAIARQ0AIAJBCGooAgAaIAQQBgsgAEEgaiQADAILIABBFGpBATYCACAAQRxqQQA2AgAgAEHUiMAANgIQIABBmIfAADYCGCAAQQA2AgggAEEIakH4iMAAECkACwALIAFBAzoADCABQQhqIgAoAgAgAC0ABDoAAAsgAUEgaiQADAQLIAFBFGpBATYCACABQRxqQQA2AgAgAUGQhMAANgIQDAILQZiEwABBkIXAABAhAAsgAUEUakEBNgIAIAFBHGpBADYCACABQdyDwAA2AhALIAFBoIXAADYCGCABQQA2AgggAUEIakHggsAAECkACwsgA0EQaiQACzgBAX8CQCABaUEBRw0AQYCAgIB4IAFrIABJIgINACAABEAgAEEAIAEgAhsQPCIBRQ0BCyABDwsAC0kBAX8jAEEgayIAJAAgAEEUakEBNgIAIABBHGpBADYCACAAQbCKwAA2AhAgAEGAisAANgIYIABBADYCCCAAQQhqQbiKwAAQKQALRAECfyABKAIEIQIgASgCACEDQQhBBBA8IgFFBEBBCEEEEEwACyABIAI2AgQgASADNgIAIABBuInAADYCBCAAIAE2AgALOQACQAJ/IAJBgIDEAEcEQEEBIAAgAiABKAIQEQAADQEaCyADDQFBAAsPCyAAIANBACABKAIMEQIAC7kCAQJ/IwBBIGsiAiQAIAJBAToAGCACIAE2AhQgAiAANgIQIAJBjIvAADYCDCACQciKwAA2AggjAEEQayIAJAACQCACQQhqIgEoAgwiAgRAIAEoAggiA0UNASAAIAI2AgggACABNgIEIAAgAzYCACMAQRBrIgEkACAAKAIAIgJBFGooAgAhAwJAAn8CQAJAIAJBDGooAgAOAgABAwsgAw0CQQAhAkGYh8AADAELIAMNASACKAIIIgMoAgQhAiADKAIACyEDIAEgAjYCBCABIAM2AgAgAUHcicAAIAAoAgQiASgCCCAAKAIIIAEtABAQFwALIAFBADYCBCABIAI2AgwgAUHIicAAIAAoAgQiASgCCCAAKAIIIAEtABAQFwALQZiHwABBmInAABAhAAtBmIfAAEGIicAAECEACy0AAkAgA2lBAUdBgICAgHggA2sgAUlyRQRAIAAgASADIAIQNSIADQELAAsgAAslAQF/AkAgAEEBEAoiAUUNACABEFMQQQ0AIAFBACAAEE0aCyABCycAIAAgACgCBEEBcSABckECcjYCBCAAIAFqIgAgACgCBEEBcjYCBAsgAQF/AkAgAEEEaigCACIBRQ0AIAAoAgBFDQAgARAGCwsjACACIAIoAgRBfnE2AgQgACABQQFyNgIEIAAgAWogATYCAAseACAAIAFBA3I2AgQgACABaiIAIAAoAgRBAXI2AgQLFAAgACgCAARAIABBBGooAgAQBgsLGQEBfyAAKAIQIgEEfyABBSAAQRRqKAIACwsSAEEZIABBAXZrQQAgAEEfRxsLFgAgACABQQFyNgIEIAAgAWogATYCAAsQACAAIAFqQQFrQQAgAWtxC+oFAQZ/An8gACEFAkACQAJAIAJBCU8EQCADIAIQCiIHDQFBAAwEC0EIQQgQNCEAQRRBCBA0IQFBEEEIEDQhAkEAQRBBCBA0QQJ0ayIEQYCAfCACIAAgAWpqa0F3cUEDayIAIAAgBEsbIANNDQFBECADQQRqQRBBCBA0QQVrIANLG0EIEDQhAiAFEFMiACAAEEgiBBBQIQECQAJAAkACQAJAAkACQCAAEEFFBEAgAiAETQ0BIAFB6JDAACgCAEYNAiABQeSQwAAoAgBGDQMgARA+DQcgARBIIgYgBGoiCCACSQ0HIAggAmshBCAGQYACSQ0EIAEQDgwFCyAAEEghASACQYACSQ0GIAEgAmtBgYAISSACQQRqIAFNcQ0FIAEgACgCACIBakEQaiEEIAJBH2pBgIAEEDQhAgwGC0EQQQgQNCAEIAJrIgFLDQQgACACEFAhBCAAIAIQLCAEIAEQLCAEIAEQCQwEC0HgkMAAKAIAIARqIgQgAk0NBCAAIAIQUCEBIAAgAhAsIAEgBCACayICQQFyNgIEQeCQwAAgAjYCAEHokMAAIAE2AgAMAwtB3JDAACgCACAEaiIEIAJJDQMCQEEQQQgQNCAEIAJrIgFLBEAgACAEECxBACEBQQAhBAwBCyAAIAIQUCIEIAEQUCEGIAAgAhAsIAQgARAzIAYgBigCBEF+cTYCBAtB5JDAACAENgIAQdyQwAAgATYCAAwCCyABQQxqKAIAIgkgAUEIaigCACIBRwRAIAEgCTYCDCAJIAE2AggMAQtB1JDAAEHUkMAAKAIAQX4gBkEDdndxNgIAC0EQQQgQNCAETQRAIAAgAhBQIQEgACACECwgASAEECwgASAEEAkMAQsgACAIECwLIAANAwsgAxAFIgFFDQEgASAFIAAQSEF4QXwgABBBG2oiACADIAAgA0kbEE4gBRAGDAMLIAcgBSABIAMgASADSRsQThogBRAGCyAHDAELIAAQQRogABBSCwsLACABBEAgABAGCwsPACAAQQF0IgBBACAAa3ILFQAgASAAKAIAIgAoAgAgACgCBBAHCxkAIAEoAgBB+IzAAEEFIAEoAgQoAgwRAgALEwAgASgCACABKAIEIAAoAgAQCAsUACAAKAIAIAEgACgCBCgCDBEAAAsIACAAIAEQCgsTACAAQbiJwAA2AgQgACABNgIACw0AIAAtAARBAnFBAXYLEAAgASAAKAIAIAAoAgQQBwsKAEEAIABrIABxCwsAIAAtAARBA3FFCwwAIAAgAUEDcjYCBAsNACAAKAIAIAAoAgRqCw4AIAAoAgAaA0AMAAsAC9gGAgt/An4gADUCACENIwBBMGsiBCQAQSchAAJAIA1CkM4AVARAIA0hDgwBCwNAIARBCWogAGoiAkEEayANIA1CkM4AgCIOQpDOAH59pyIDQf//A3FB5ABuIgVBAXRBsIvAAGovAAA7AAAgAkECayADIAVB5ABsa0H//wNxQQF0QbCLwABqLwAAOwAAIABBBGshACANQv/B1y9WIA4hDQ0ACwsgDqciAkHjAEsEQCAAQQJrIgAgBEEJamogDqciAiACQf//A3FB5ABuIgJB5ABsa0H//wNxQQF0QbCLwABqLwAAOwAACwJAIAJBCk8EQCAAQQJrIgAgBEEJamogAkEBdEGwi8AAai8AADsAAAwBCyAAQQFrIgAgBEEJamogAkEwajoAAAsCfyAEQQlqIABqIQhBK0GAgMQAIAEoAhgiA0EBcSICGyEFIAJBJyAAayIJaiECQciKwABBACADQQRxGyEHAkACQCABKAIIRQRAQQEhACABKAIAIgMgAUEEaigCACICIAUgBxAoDQEMAgsCQAJAAkACQCACIAFBDGooAgAiBkkEQCADQQhxDQQgBiACayICIQNBASABLQAgIgAgAEEDRhsiAEEBaw4CAQIDC0EBIQAgASgCACIDIAFBBGooAgAiAiAFIAcQKA0EDAULQQAhAyACIQAMAQsgAkEBdiEAIAJBAWpBAXYhAwsgAEEBaiEAIAFBBGooAgAhAiABKAIcIQYgASgCACEBAkADQCAAQQFrIgBFDQEgASAGIAIoAhARAABFDQALQQEMBAtBASEAIAZBgIDEAEYNASABIAIgBSAHECgNASABIAggCSACKAIMEQIADQFBACEAAn8DQCADIAAgA0YNARogAEEBaiEAIAEgBiACKAIQEQAARQ0ACyAAQQFrCyADSSEADAELIAEoAhwhCyABQTA2AhwgAS0AICEMQQEhACABQQE6ACAgASgCACIDIAFBBGooAgAiCiAFIAcQKA0AIAYgAmtBAWohAAJAA0AgAEEBayIARQ0BIANBMCAKKAIQEQAARQ0AC0EBDAMLQQEhACADIAggCSAKKAIMEQIADQAgASAMOgAgIAEgCzYCHEEADAILIAAMAQsgAyAIIAkgAigCDBECAAsgBEEwaiQACwsAIAAjAGokACMACwwAQfCCwABBGRAEAAsKACAAKAIEQXhxCwoAIAAoAgRBAXELCgAgACgCDEEBcQsKACAAKAIMQQF2CxkAIAAgAUGkjcAAKAIAIgBBECAAGxEBAAALrwEBA38gASEFAkAgAkEPTQRAIAAhAQwBCyAAQQAgAGtBA3EiA2ohBCADBEAgACEBA0AgASAFOgAAIAFBAWoiASAESQ0ACwsgBCACIANrIgJBfHEiA2ohASADQQBKBEAgBUH/AXFBgYKECGwhAwNAIAQgAzYCACAEQQRqIgQgAUkNAAsLIAJBA3EhAgsgAgRAIAEgAmohAgNAIAEgBToAACABQQFqIgEgAkkNAAsLIAALswIBB38CQCACIgRBD00EQCAAIQIMAQsgAEEAIABrQQNxIgNqIQUgAwRAIAAhAiABIQYDQCACIAYtAAA6AAAgBkEBaiEGIAJBAWoiAiAFSQ0ACwsgBSAEIANrIghBfHEiB2ohAgJAIAEgA2oiA0EDcSIEBEAgB0EATA0BIANBfHEiBkEEaiEBQQAgBEEDdCIJa0EYcSEEIAYoAgAhBgNAIAUgBiAJdiABKAIAIgYgBHRyNgIAIAFBBGohASAFQQRqIgUgAkkNAAsMAQsgB0EATA0AIAMhAQNAIAUgASgCADYCACABQQRqIQEgBUEEaiIFIAJJDQALCyAIQQNxIQQgAyAHaiEBCyAEBEAgAiAEaiEDA0AgAiABLQAAOgAAIAFBAWohASACQQFqIgIgA0kNAAsLIAALCwBBgJHAACgCAEULBwAgACABagsHACAAIAFrCwcAIABBCGoLBwAgAEEIawvDBwEFfwJAIwBB0ABrIgIkACACQQA2AhggAkKAgICAEDcDECACQSBqIgQiAEEDOgAgIABCgICAgIAENwIYIABBADYCECAAQQA2AgggAEG4hcAANgIEIAAgAkEQajYCACMAQUBqIgAkAEEBIQMCQCAEKAIAIgVB7IrAAEEMIAQoAgQiBCgCDBECAA0AAkAgASgCCCIDBEAgACADNgIMIABBITYCFCAAIABBDGo2AhBBASEDIABBATYCPCAAQQI2AjQgAEH8isAANgIwIABBADYCKCAAIABBEGo2AjggBSAEIABBKGoQCEUNAQwCCyABKAIAIgMgASgCBEEMaigCABEGAELB9/nozJOy0UFSDQAgACADNgIMIABBIjYCFCAAIABBDGo2AhBBASEDIABBATYCPCAAQQI2AjQgAEH8isAANgIwIABBADYCKCAAIABBEGo2AjggBSAEIABBKGoQCA0BCyABKAIMIQEgAEEkakEPNgIAIABBHGpBDzYCACAAIAFBDGo2AiAgACABQQhqNgIYIABBIDYCFCAAIAE2AhAgAEEDNgI8IABBAzYCNCAAQdSKwAA2AjAgAEEANgIoIAAgAEEQajYCOCAFIAQgAEEoahAIIQMLIABBQGskAAJAIANFBEAgAigCECACKAIYIgBrQQlNBEAgAkEQaiAAQQoQEyACKAIYIQALIAIoAhQgAGoiAUH0hsAAKQAANwAAIAFBCGpB/IbAAC8AADsAACACIABBCmo2AhggAkEIahAAIgQQASACKAIIIQYgAigCDCIFIAIoAhAgAigCGCIAa0sEQCACQRBqIAAgBRATIAIoAhghAAsgAigCFCAAaiAGIAUQThogAiAAIAVqIgA2AhggAigCECAAa0EBTQRAIAJBEGogAEECEBMgAigCGCEACyACKAIUIABqQYoUOwAAIAIgAEECaiIDNgIYIAIoAhQhAAJAIAMgAigCECIBTwRAIAAhAQwBCyADRQRAQQEhASAAEAYMAQsgACABQQEgAxA1IgFFDQILIAEgAxACIAUEQCAGEAYLIARBhAFPBEAgBBADCyACQdAAaiQADAILIwBBQGoiACQAIABBNzYCDCAAQdCFwAA2AgggAEGIhsAANgIUIAAgAkHIAGo2AhAgAEEkakECNgIAIABBLGpBAjYCACAAQTxqQR82AgAgAEGgi8AANgIgIABBADYCGCAAQSA2AjQgACAAQTBqNgIoIAAgAEEQajYCOCAAIABBCGo2AjAgAEEYakHkhsAAECkACyADQQEQTAALCwwAQsH3+ejMk7LRQQsNAEKy+KXLheeH1Jt/CwwAQuLnycndnOOADQsDAAELC4cNAQBBgIDAAAv9DG91dHB1dCBzbGljZSBpcyB0b28gc21hbGxzcmMvbGliLnJzABkAEAAKAAAAggAAAA4AAABpbnB1dCB0ZXJtaW5hdGVkIHdoaWxlIGRlY29kaW5nIHVuY29tcHJlc3NlZCBzZWdtZW50IGluIFJMRSBzbGljZQAAABkAEAAKAAAAmQAAABYAAAAZABAACgAAAJYAAAAWAAAAaW5wdXQgdGVybWluYXRlZCB3aGlsZSBkZWNvZGluZyByZXBlYXQgc2VnbWVudCBpbiBSTEUgc2xpY2UAGQAQAAoAAACmAAAAFgAAABkAEAAKAAAAoQAAABIAAAAvVXNlcnMveWhrYW5nLy5jYXJnby9yZWdpc3RyeS9zcmMvaW5kZXguY3JhdGVzLmlvLTZmMTdkMjJiYmExNTAwMWYvY29uc29sZV9lcnJvcl9wYW5pY19ob29rLTAuMS43L3NyYy9saWIucnP0ABAAbAAAAJUAAAAOAAAAaW52YWxpZCBlbnVtIHZhbHVlIHBhc3NlZAAAAAEAAAAAAAAAAQAAAAIAAAADAAAABAAAAG9uZS10aW1lIGluaXRpYWxpemF0aW9uIG1heSBub3QgYmUgcGVyZm9ybWVkIHJlY3Vyc2l2ZWx5pAEQADgAAABPbmNlIGluc3RhbmNlIGhhcyBwcmV2aW91c2x5IGJlZW4gcG9pc29uZWQAAOQBEAAqAAAAY2FsbGVkIGBPcHRpb246OnVud3JhcCgpYCBvbiBhIGBOb25lYCB2YWx1ZS9ydXN0Yy85MGM1NDE4MDZmMjNhMTI3MDAyZGU1YjQwMzhiZTczMWJhMTQ1OGNhL2xpYnJhcnkvc3RkL3NyYy9zeW5jL29uY2UucnMAQwIQAEwAAACVAAAAMgAAAAUAAAAEAAAABAAAAAYAAAAHAAAACAAAAAkAAAAMAAAABAAAAAoAAAALAAAADAAAAGEgRGlzcGxheSBpbXBsZW1lbnRhdGlvbiByZXR1cm5lZCBhbiBlcnJvciB1bmV4cGVjdGVkbHkADQAAAAAAAAABAAAADgAAAC9ydXN0Yy85MGM1NDE4MDZmMjNhMTI3MDAyZGU1YjQwMzhiZTczMWJhMTQ1OGNhL2xpYnJhcnkvYWxsb2Mvc3JjL3N0cmluZy5ycwAYAxAASwAAAN0JAAAOAAAACgpTdGFjazoKCgAAEQAAAAQAAAAEAAAAEgAAABMAAAAUAAAAY2FsbGVkIGBPcHRpb246OnVud3JhcCgpYCBvbiBhIGBOb25lYCB2YWx1ZW1lbW9yeSBhbGxvY2F0aW9uIG9mICBieXRlcyBmYWlsZWQAAADDAxAAFQAAANgDEAANAAAAbGlicmFyeS9zdGQvc3JjL2FsbG9jLnJz+AMQABgAAABVAQAACQAAAGNhbm5vdCBtb2RpZnkgdGhlIHBhbmljIGhvb2sgZnJvbSBhIHBhbmlja2luZyB0aHJlYWQgBBAANAAAAGxpYnJhcnkvc3RkL3NyYy9wYW5pY2tpbmcucnNcBBAAHAAAAIcAAAAJAAAAXAQQABwAAABBAgAAHgAAAFwEEAAcAAAAQAIAAB8AAAAVAAAADAAAAAQAAAAWAAAAEQAAAAgAAAAEAAAAFwAAABgAAAAQAAAABAAAABkAAAAaAAAAEQAAAAgAAAAEAAAAGwAAABwAAAARAAAAAAAAAAEAAAAdAAAAbGlicmFyeS9hbGxvYy9zcmMvcmF3X3ZlYy5yc2NhcGFjaXR5IG92ZXJmbG93AAAAHAUQABEAAAAABRAAHAAAAAwCAAAFAAAASAUQAAAAAAA6AAAASAUQAAAAAABQBRAAAQAAAFAFEAABAAAAcGFuaWNrZWQgYXQgJycsIHgFEAABAAAAeQUQAAMAAAAjAAAAAAAAAAEAAAAkAAAAOiAAAEgFEAAAAAAAnAUQAAIAAAAwMDAxMDIwMzA0MDUwNjA3MDgwOTEwMTExMjEzMTQxNTE2MTcxODE5MjAyMTIyMjMyNDI1MjYyNzI4MjkzMDMxMzIzMzM0MzUzNjM3MzgzOTQwNDE0MjQzNDQ0NTQ2NDc0ODQ5NTA1MTUyNTM1NDU1NTY1NzU4NTk2MDYxNjI2MzY0NjU2NjY3Njg2OTcwNzE3MjczNzQ3NTc2Nzc3ODc5ODA4MTgyODM4NDg1ODY4Nzg4ODk5MDkxOTI5Mzk0OTU5Njk3OTg5OUVycm9yAG8JcHJvZHVjZXJzAghsYW5ndWFnZQEEUnVzdAAMcHJvY2Vzc2VkLWJ5AwVydXN0Yx0xLjcwLjAgKDkwYzU0MTgwNiAyMDIzLTA1LTMxKQZ3YWxydXMGMC4xOS4wDHdhc20tYmluZGdlbgYwLjIuODcALA90YXJnZXRfZmVhdHVyZXMCKw9tdXRhYmxlLWdsb2JhbHMrCHNpZ24tZXh0",t=(...D)=>_t(void 0,[...D],function*(B={},k){let Y;if(k.startsWith("data:")){const I=k.replace(/^data:.*?base64,/,"");let E;if(typeof Buffer=="function"&&typeof Buffer.from=="function")E=Buffer.from(I,"base64");else if(typeof atob=="function"){const P=atob(I);E=new Uint8Array(P.length);for(let N=0;N<P.length;N++)E[N]=P.charCodeAt(N)}else throw new Error("Cannot decode base64-encoded data URL");Y=yield WebAssembly.instantiate(E,B)}else{const I=yield fetch(k),E=I.headers.get("Content-Type")||"";if("instantiateStreaming"in WebAssembly&&E.startsWith("application/wasm"))Y=yield WebAssembly.instantiateStreaming(I,B);else{const P=yield I.arrayBuffer();Y=yield WebAssembly.instantiate(P,B)}}return Y.instance.exports});let n;ql=function(B){n=B};const o=new Array(128).fill(void 0);o.push(void 0,null,!0,!1);function g(B){return o[B]}let A=o.length;function v(B){B<132||(o[B]=A,A=B)}function f(B){const k=g(B);return v(B),k}const i=typeof TextDecoder>"u"?(0,module.require)("util").TextDecoder:TextDecoder;let c=new i("utf-8",{ignoreBOM:!0,fatal:!0});c.decode();let l=null;function r(){return(l===null||l.byteLength===0)&&(l=new Uint8Array(n.memory.buffer)),l}function a(B,k){return B=B>>>0,c.decode(r().subarray(B,B+k))}let s=0;function u(B,k){const D=k(B.length*1,1)>>>0;return r().set(B,D/1),s=B.length,D}let d=null;function h(){return(d===null||d.byteLength===0)&&(d=new Int32Array(n.memory.buffer)),d}function p(B,k){return B=B>>>0,r().subarray(B/1,B/1+k)}Dh=function(B,k,D,Y,I,E,P){try{const rt=n.__wbindgen_add_to_stack_pointer(-16),lt=u(k,n.__wbindgen_malloc),dt=s,U=u(Y,n.__wbindgen_malloc),j=s,K=u(E,n.__wbindgen_malloc),it=s;n.decode_rgb(rt,B,lt,dt,D,U,j,I,K,it,P);var N=h()[rt/4+0],q=h()[rt/4+1],J=p(N,q).slice();return n.__wbindgen_free(N,q*1),J}finally{n.__wbindgen_add_to_stack_pointer(16)}},Mh=function(B,k,D,Y,I,E,P,N,q){try{const dt=n.__wbindgen_add_to_stack_pointer(-16),U=u(k,n.__wbindgen_malloc),j=s,K=u(Y,n.__wbindgen_malloc),it=s,tt=u(E,n.__wbindgen_malloc),ct=s,ht=u(N,n.__wbindgen_malloc),yt=s;n.decode_rgba(dt,B,U,j,D,K,it,I,tt,ct,P,ht,yt,q);var J=h()[dt/4+0],rt=h()[dt/4+1],lt=p(J,rt).slice();return n.__wbindgen_free(J,rt*1),lt}finally{n.__wbindgen_add_to_stack_pointer(16)}},Oh=function(B,k,D){try{const P=n.__wbindgen_add_to_stack_pointer(-16),N=u(k,n.__wbindgen_malloc),q=s;n.decode_grayscale(P,B,N,q,D);var Y=h()[P/4+0],I=h()[P/4+1],E=p(Y,I).slice();return n.__wbindgen_free(Y,I*1),E}finally{n.__wbindgen_add_to_stack_pointer(16)}},kh=function(B,k,D,Y,I){try{const q=n.__wbindgen_add_to_stack_pointer(-16),J=u(k,n.__wbindgen_malloc),rt=s,lt=u(Y,n.__wbindgen_malloc),dt=s;n.decode_grayscale_a(q,B,J,rt,D,lt,dt,I);var E=h()[q/4+0],P=h()[q/4+1],N=p(E,P).slice();return n.__wbindgen_free(E,P*1),N}finally{n.__wbindgen_add_to_stack_pointer(16)}};function m(B){A===o.length&&o.push(o.length+1);const k=A;return A=o[k],o[k]=B,k}const y=typeof TextEncoder>"u"?(0,module.require)("util").TextEncoder:TextEncoder;let _=new y("utf-8");const C=typeof _.encodeInto=="function"?function(B,k){return _.encodeInto(B,k)}:function(B,k){const D=_.encode(B);return k.set(D),{read:B.length,written:D.length}};function w(B,k,D){if(D===void 0){const N=_.encode(B),q=k(N.length,1)>>>0;return r().subarray(q,q+N.length).set(N),s=N.length,q}let Y=B.length,I=k(Y,1)>>>0;const E=r();let P=0;for(;P<Y;P++){const N=B.charCodeAt(P);if(N>127)break;E[I+P]=N}if(P!==Y){P!==0&&(B=B.slice(P)),I=D(I,Y,Y=P+B.length*3,1)>>>0;const N=r().subarray(I+P,I+Y),q=C(B,N);P+=q.written}return s=P,I}Kl=function(){const B=new Error;return m(B)},Zl=function(B,k){const D=g(k).stack,Y=w(D,n.__wbindgen_malloc,n.__wbindgen_realloc),I=s;h()[B/4+1]=I,h()[B/4+0]=Y},Jl=function(B,k){let D,Y;try{D=B,Y=k,console.error(a(B,k))}finally{n.__wbindgen_free(D,Y,1)}},tc=function(B){f(B)},ec=function(B,k){throw new Error(a(B,k))},URL=globalThis.URL;const b=yield t({"./webtoon_psd_decoder_bg.js":{__wbg_new_abda76e883ba8a5f:Kl,__wbg_stack_658279fe44541cf6:Zl,__wbg_error_f851667af71bcfc6:Jl,__wbindgen_object_drop_ref:tc,__wbindgen_throw:ec}},e),S=b.memory,F=b.main_js,$=b.decode_rgb,Q=b.decode_rgba,R=b.decode_grayscale,H=b.decode_grayscale_a,W=b.__wbindgen_add_to_stack_pointer,G=b.__wbindgen_malloc,V=b.__wbindgen_free,st=b.__wbindgen_realloc,et=b.__wbindgen_start,x=Object.freeze(Object.defineProperty({__proto__:null,__wbindgen_add_to_stack_pointer:W,__wbindgen_free:V,__wbindgen_malloc:G,__wbindgen_realloc:st,__wbindgen_start:et,decode_grayscale:R,decode_grayscale_a:H,decode_rgb:$,decode_rgba:Q,main_js:F,memory:S},Symbol.toStringTag,{value:"Module"}));ql(x),et()}))();function dw(e,t,n,o,g,A){return _t(this,null,function*(){const v=e*t;if(!(v>0&&Number.isInteger(v)))throw new Error(`Pixel count must be a positive integer, got ${v}`);let f;if(o&&g)f=yield gw(v,n,o,g,A);else if(!g&&!o)f=yield no(v,n,A);else throw new Error(`Missing ${g?"green":"blue"} channel in RGB image`);return new Uint8ClampedArray(f.buffer,f.byteOffset,f.byteLength)})}function On(e){switch(e){case Pe.RawData:case Pe.RleCompressed:return}throw new Ch(`Unsupported compression method: ${e}`)}function gw(e,t,n,o,g){return _t(this,null,function*(){return yield Ph,On(t.compression),On(o.compression),On(t.compression),g&&On(g.compression),g?Mh(e,t.data,t.compression,n.data,n.compression,o.data,o.compression,g.data,g.compression):Dh(e,t.data,t.compression,n.data,n.compression,o.data,o.compression)})}function no(e,t,n){return _t(this,null,function*(){return yield Ph,On(t.compression),n&&On(n.compression),n?kh(e,t.data,t.compression,n.data,n.compression):Oh(e,t.data,t.compression)})}function pw(e){const t=sw(e),{fileHeader:n}=t,o=Wo(n.version),g=dC(t.imageResources),A=iw(t.layerAndMaskInformation,o),v=aC(t.imageData,n.depth,n.height,n.channelCount,o);return{fileHeader:n,colorModeData:void 0,imageResources:g,layerAndMaskInfo:A,imageData:v}}function Sr(e){const t=e.readUnicodeString(0),n=e.readIdString(),o=e.read("u32"),g=new Map;for(;g.size<o;){const A=e.readIdString(),v=io(e);if(g.has(A))throw new j_(`Duplicate descriptor key: ${A}`);g.set(A,v)}return{name:t,classId:n,items:g}}function Ee(e){const t=e.read("u32");if(t!==16)throw new R_(`Invalid descriptor version: ${t}`);const n=Sr(e);return{descriptorVersion:t,descriptor:n}}function io(e){const t=e.readString(4);switch(t){case Lt.Alias:{const n=e.read("u32"),o=e.take(n);return{type:t,data:o}}case Lt.Boolean:{const n=!!e.read("u8");return{type:t,value:n}}case Lt.Class:case Lt.GlobalClass:{const n=e.readUnicodeString(0),o=e.readIdString();return{type:t,name:n,classId:o}}case Lt.Descriptor:case Lt.GlobalObject:{const n=Sr(e);return{type:t,descriptor:n}}case Lt.Double:{const n=e.read("f64");return{type:t,value:n}}case Lt.Enumerated:{const n=e.readIdString(),o=e.readIdString();return{type:t,enumType:n,enumValue:o}}case Lt.Integer:{const n=e.read("i32");return{type:t,value:n}}case Lt.LargeInteger:{const n=e.read("i64");return{type:t,value:n}}case Lt.List:{const n=e.read("u32"),o=[];for(;o.length<n;)o.push(io(e));return{type:t,values:o}}case Lt.RawData:{const n=e.read("u32"),o=e.take(n);return{type:t,data:o}}case Lt.Reference:{const n=e.read("u32"),o=[];for(;o.length<n;)o.push(Aw(e));return{type:t,references:o}}case Lt.String:{const n=e.readUnicodeString(0);return{type:t,value:n}}case Lt.UnitFloat:{const n=nc(e.readString(4)),o=e.read("f64");return{type:t,unitType:n,value:o}}case Lt.ObjectArray:{e.read("u32");const n=e.readUnicodeString(0),o=e.readIdString(),g=e.read("u32"),A=Array.from(Array(g),()=>{const v=e.readIdString(),f=io(e);return{key:v,value:f}});return{type:t,classObj:{name:n,classId:o},items:A}}case Lt.UnitFloats:{const n=nc(e.readString(4)),o=e.read("u32"),g=Array.from(Array(o),()=>e.read("f64"));return{type:t,unitType:n,values:g}}default:throw new F_(`Unexpected descriptor type: ${t}`)}}function Aw(e){const t=e.readString(4);switch(t){case Ye.Class:{const n=e.readUnicodeString(0),o=e.readIdString();return{type:t,name:n,classId:o}}case Ye.Enumerated:{const n=e.readUnicodeString(0),o=e.readIdString(),g=e.readIdString(),A=e.readIdString();return{type:t,name:n,classId:o,typeId:g,enumValue:A}}case Ye.Identifier:{const n=e.readString(4);return{type:t,identifier:n}}case Ye.Index:{const n=e.read("u32");return{type:t,index:n}}case Ye.Name:{const n=e.readUnicodeString(0);return{type:t,name:n}}case Ye.Offset:{const n=e.readUnicodeString(0),o=e.readIdString(),g=e.read("u32");return{type:t,name:n,classId:o,offset:g}}case Ye.Property:{const n=e.readUnicodeString(0),o=e.readIdString(),g=e.readIdString();return{type:t,name:n,classId:o,keyId:g}}default:throw new U_(`Invalid reference type: ${t}`)}}function nc(e){if(!Object.values(Zs).includes(e))throw new H_(`Invalid Unit Float type: ${e}`);return e}var Jt;(function(e){e[e.String=0]="String",e[e.DictBeg=1]="DictBeg",e[e.DictEnd=2]="DictEnd",e[e.ArrBeg=3]="ArrBeg",e[e.ArrEnd=4]="ArrEnd",e[e.Name=5]="Name",e[e.Number=6]="Number",e[e.Boolean=7]="Boolean"})(Jt||(Jt={}));const ro=new Set([0,9,12,32,10,13]),mw=new Set([102,116]),Oe={"(":40,")":41,"<":60,">":62,"[":91,"]":93,"/":47,"\\":92},Qh=new Set(Object.values(Oe)),Lh=[];for(let e=0;e<256;e+=1)Lh[e]=ro.has(e)||Qh.has(e);const vw=new TextDecoder("utf-8");function yw(e){const t=e.position;let n=e.position;for(const o of e.iter()){if(Lh[o])break;n+=1}return vw.decode(e.take(n-t))}class _w{constructor(t){this.cursor=rn.from(t)}tokens(){const t=[];for(;!this.done();){const n=this.cursor.one();if(ro.has(n)){for(;!this.done()&&ro.has(this.cursor.peek());)this.cursor.pass(1);continue}if(Qh.has(n)){if(n===Oe["("]){t.push({type:Jt.String,value:this.text()});continue}if(n===Oe["["]){t.push({type:Jt.ArrBeg});continue}if(n===Oe["]"]){t.push({type:Jt.ArrEnd});continue}if(n===Oe["<"]){this.cursor.pass(1),t.push({type:Jt.DictBeg});continue}if(n===Oe[">"]){this.cursor.pass(1),t.push({type:Jt.DictEnd});continue}if(n===Oe["/"]){t.push({type:Jt.Name,value:this.string()});continue}console.assert(!1,"Unhandled delimiter: '%s'",String.fromCharCode(n));continue}this.cursor.unpass(1),mw.has(n)?t.push({type:Jt.Boolean,value:this.boolean()}):t.push({type:Jt.Number,value:this.number()})}return t}done(){return this.cursor.position>=this.cursor.length}text(){const t=this.cursor.peek();if(t===Oe[")"])return this.cursor.pass(1),"";const n=t===255||t===254;let o=new TextDecoder("utf-16be");n&&(o=this.textDecoderFromBOM());const g=[],A=this.cursor.clone();for(;A.peek()!==Oe[")"];)if(A.pass(1),A.peek()===Oe["\\"]){const i=A.position-this.cursor.position;g.push(o.decode(this.cursor.take(i),{stream:!0})),A.pass(2),this.cursor.pass(1),g.push(o.decode(this.cursor.take(1),{stream:!0}))}const v=A.position-this.cursor.position,f=this.cursor.take(v);return g.push(o.decode(f)),this.cursor.pass(1),g.join("")}textDecoderFromBOM(){const t=this.cursor.one(),n=this.cursor.one();if(t===255&&n===254)return new TextDecoder("utf-16le");if(t===254&&n===255)return new TextDecoder("utf-16be");throw new V_(`Unknown BOM value: [${t}, ${n}]`)}string(){return yw(this.cursor)}number(){const t=this.string(),n=Number(t);if(Number.isNaN(n))throw new z_(`parsing '${t}' as Number failed`);return n}boolean(){const t=this.string();if(t==="true")return!0;if(t==="false")return!1;throw new G_(`'${t}' is neither 'true' nor 'false'`)}}const as=Symbol(Jt[Jt.ArrBeg]),ls=Symbol(Jt[Jt.DictBeg]);class Cw{constructor(t){this.tokens=t,this.stack=[]}parse(){this.runParser();const[t]=this.stack;if(typeof t=="object"&&!Array.isArray(t))return t;throw new Y_(`EngineData top-level value is not a dict; is ${typeof t}`)}runParser(){for(const t of this.tokens)switch(t.type){case Jt.Name:case Jt.Number:case Jt.Boolean:case Jt.String:this.stack.push(t.value);continue;case Jt.DictBeg:this.stack.push(ls);continue;case Jt.ArrBeg:this.stack.push(as);continue;case Jt.DictEnd:this.stack.push(this.dict());continue;case Jt.ArrEnd:this.stack.push(this.array().reverse());continue}}dict(){const t={};for(;;){const n=this.stack.pop();if(n===void 0)throw new Hl("Stack empty when parsing dict");if(n===ls)return t;if(n===as)throw new is("Got ArrBeg while parsing a dict");const o=this.stack.pop();if(typeof o!="string")throw new is(`Dict key is not Name; is ${typeof o}`);t[o]=n}}array(){const t=[];for(;;){const n=this.stack.pop();if(n===void 0)throw new Hl("Stack empty when parsing array");if(n===ls)throw new is("Got DictBeg while parsing array");if(n===as)return t;t.push(n)}}}const ww=new Set(["DocumentResources","EngineDict","ResourceDict"]);function bw(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Sw(e){let t=!0;if(typeof e!="object"||!e)return!1;for(const n of ww)if(bw(e,n)){const o=e[n];t=t&&typeof o=="object"&&!Array.isArray(o)&&!!o}else return!1;return t}function Ew(e){const t=new Cw(new _w(e).tokens()).parse();if(Sw(t))return t;throw new W_(`Object with keys ${JSON.stringify(Object.keys(t))} is not valid EngineData`)}class Fh{composite(t=!0,n=!0){return _t(this,null,function*(){const{red:o,green:g,blue:A,alpha:v}=this.imageData,{width:f,height:i}=this,c=yield dw(f,i,o,g,A,v);if(t===!0)if(n===!0){const l=this.composedOpacity*255;return Xl(c,l)}else return Xl(c,this.opacity);return c})}}class Iw extends Fh{constructor(t,n){super(),this.layerFrame=t,this.parent=n,this.type="Layer"}get name(){return this.layerFrame.layerProperties.name}get width(){return this.layerFrame.width}get height(){return this.layerFrame.height}get top(){return this.layerFrame.layerProperties.top}get left(){return this.layerFrame.layerProperties.left}get opacity(){return this.layerFrame.layerProperties.opacity}get composedOpacity(){return this.parent.composedOpacity*(this.opacity/255)}get maskData(){return this.layerFrame.layerProperties.maskData}userMask(){return _t(this,null,function*(){const t=this.layerFrame.userMask;if(t)return no(Gl(this.maskData),t)})}realUserMask(){return _t(this,null,function*(){const t=this.maskData.realData,n=this.layerFrame.realUserMask;if(!(!t||!n))return no(Gl(t),n)})}get isHidden(){return this.layerFrame.layerProperties.hidden}get isTransparencyLocked(){return this.layerFrame.layerProperties.transparencyLocked}get additionalProperties(){return this.layerFrame.layerProperties.additionalLayerProperties}get text(){return this.layerFrame.layerProperties.text}get textProperties(){return this.layerFrame.layerProperties.textProperties}get imageData(){const{red:t,green:n,blue:o,alpha:g}=this.layerFrame;return{red:t,green:n,blue:o,alpha:g}}}function xw(e){return e.type==="Psd"||e.type==="Group"}function ic(e){if(!xw(e))throw new Et(`Node (name = '${e.name}', type: '${e.type}') cannot be a parent node`)}class Bw{constructor(t,n,o,g,A){this.origin=t,this.left=n,this.top=o,this.right=g,this.bottom=A}}function Tw(e){if(e.resource.descriptor){const t=e.resource.descriptor.descriptor.items.get("slices");if(!(t&&t.type===Lt.List))throw new oi('Missing key "slices" in slice descriptor');return t.values.reduce((n,o)=>{if(o.type!==Lt.Descriptor)throw new oi(`Slice list contains a non-descriptor (type: ${o.type})`);return n.push(Ow(o.descriptor)),n},[])}else throw new oi("No slice descriptor in slice resource block")}function Ow(e){const t=kw(e),n=In(e,"bounds",Lt.Descriptor).descriptor,o=In(n,"Top ",Lt.Integer).value,g=In(n,"Left",Lt.Integer).value,A=In(n,"Btom",Lt.Integer).value,v=In(n,"Rght",Lt.Integer).value;return new Bw(t,g,o,v,A)}function kw(e){const t=In(e,"origin",Lt.Enumerated);if(t.enumType!=="ESliceOrigin")throw new oi(`Unexpected enum type for slice origin: got "${t.enumType}"`);switch(t.enumValue){case"layerGenerated":return Ln.LayerGenerated;case"userGenerated":return Ln.UserGenerated;case"autoGenerated":return Ln.AutoGenerated;default:throw new oi(`Unexpected enum value for slice origin: got "${t.enumValue}"`)}}class Xo extends Fh{static parse(t){const n=pw(t);return new Xo(n)}constructor(t){super(),this.parsingResult=t,this.name="ROOT",this.type="Psd",this.opacity=255,this.composedOpacity=1,this.children=[],this.layers=[],this.guides=[],this.slices=[],this.icc_profile=void 0,this.globalLightAngle=void 0,this.globalLightAltitude=void 0,this.resolutionInfo=void 0,this.additionalLayerProperties={},this.buildTreeStructure(),this.additionalLayerProperties=t.layerAndMaskInfo.globalAdditionalLayerInformation;for(const n of t.imageResources.resources)if(n.resource!==null)switch(n.id){case fe.GridAndGuides:this.guides=n.resource.guides;break;case fe.Slices:this.slices=Tw(n);break;case fe.ICCProfile:this.icc_profile=n.resource;break;case fe.GlobalLightAltitude:this.globalLightAltitude=n.resource;break;case fe.GlobalLightAngle:this.globalLightAngle=n.resource;break;case fe.ResolutionInfo:this.resolutionInfo=n.resource;break}}get width(){return this.parsingResult.fileHeader.width}get height(){return this.parsingResult.fileHeader.height}get channelCount(){return this.parsingResult.fileHeader.channelCount}get depth(){return this.parsingResult.fileHeader.depth}get colorMode(){return this.parsingResult.fileHeader.colorMode}get imageData(){const{compression:t,red:n,green:o,blue:g,alpha:A}=this.parsingResult.imageData;return{red:{compression:t,data:n},green:o?{compression:t,data:o}:void 0,blue:g?{compression:t,data:g}:void 0,alpha:A?{compression:t,data:A}:void 0}}buildTreeStructure(){const{groups:t,layers:n,orders:o}=this.parsingResult.layerAndMaskInfo,g=[this];let A=0,v=0;o.forEach(f=>{const i=g[g.length-1];switch(f){case"G":{const c=t[A];ic(i);const l=new d_(c,i);g.push(l),i.children.push(l),A+=1;break}case"L":{const c=n[v];ic(i);const l=new Iw(c,i);this.layers.push(l),i.children.push(l),v+=1;break}case"D":g.pop()}}),g.length=0,this.children.forEach(f=>{var i,c;return(c=(i=f).freeze)===null||c===void 0?void 0:c.call(i)}),Object.freeze(this.children)}}class so{constructor(t,n){X(this,"canvas");X(this,"editor");X(this,"psdFile");X(this,"json");this.canvas=t,this.editor=n,this.json={}}insertPSD(){return new Promise((t,n)=>{wo({accept:".psd"}).then(o=>{if(o&&o.length>0){const g=o[0],A=new FileReader;A.readAsText(g,"UTF-8"),A.onload=()=>_t(this,null,function*(){const v=yield g.arrayBuffer();this.psdFile=Xo.parse(v),this.json=this.getFabricBaseJson(),this.getBgSize(),yield this.childrenTransform(),this.loadJSON(),t()})}}).catch(n)})}childrenTransform(){return _t(this,null,function*(){const t=yield this.psdChildrenTransform(this.psdFile.children);this.json.objects.push(...t.reverse())})}psdChildrenTransform(t){return _t(this,null,function*(){const n=this;function o(A){return A.map(v=>_t(this,null,function*(){const f=n.getCommonAttr(v);if(v.type==="Group"){const i=yield Promise.all(o(t));return Ft(pt(pt({},cs("group")),f),{objects:i})}else if(v.text){console.log(v,"111");const{FontSize:c,FillColor:l,Tracking:r}=v.textProperties.EngineDict.StyleRun.RunArray[0].StyleSheet.StyleSheetData;return console.log(v.text,l.Values,n.getColor(l.Values)),Ft(pt(pt({},cs("textbox")),f),{text:v.text,charSpacing:r,fontFamily:"站酷快乐体",fill:n.getColor(l.Values),fontSize:c||12})}else{const c=yield n.getLayerBse64(v);return Ft(pt(pt({},cs("image")),f),{src:c})}}))}return yield Promise.all(o(t))})}getColor(t){const[,n,o,g]=t;return`rgb(${n*255}, ${o*255}, ${g*255})`}getBgSize(){const{clipPath:t,workspase:n}=this.getClipPath();this.json.clipPath=t,this.json.objects.push(n)}loadJSON(){console.log(this.json),this.editor.loadJSON(JSON.stringify(this.json))}getLayerBse64(t){return _t(this,null,function*(){try{const n=yield t.composite(),o=document.createElement("canvas"),g=o.getContext("2d"),A=new ImageData(n,t.width,t.height);return o.width=t.width,o.height=t.height,g.putImageData(A,0,0),o.toDataURL("image/png")}catch(n){return""}})}getCommonAttr(t){const n=["left","top","width","height","name",["visible",g=>!g.isHidden],["opacity",g=>255/g.opacity]],o={id:Mt()};return n.forEach(g=>{if(typeof g=="string")o[g]=t[g];else{const[A,v]=g;o[A]=v(t)}}),o}getFabricBaseJson(){return{version:"5.3.0",objects:[],clipPath:null}}getClipPath(){const{width:t,height:n}=this.psdFile;return{clipPath:{type:"rect",version:"5.3.0",originX:"left",originY:"top",left:0,top:0,width:t,height:n,fill:"rgba(255,255,255,1)",stroke:null,strokeWidth:0,strokeDashArray:null,strokeLineCap:"butt",strokeDashOffset:0,strokeLineJoin:"miter",strokeUniform:!1,strokeMiterLimit:4,scaleX:1,scaleY:1,angle:0,flipX:!1,flipY:!1,opacity:1,shadow:null,visible:!0,backgroundColor:"",fillRule:"nonzero",paintFirst:"fill",globalCompositeOperation:"source-over",skewX:0,skewY:0,rx:0,ry:0,selectable:!0,hasControls:!0},workspase:{type:"rect",version:"5.3.0",originX:"left",originY:"top",left:0,top:0,width:t,height:n,fill:"rgba(255,255,255,1)",stroke:null,strokeWidth:0,strokeDashArray:null,strokeLineCap:"butt",strokeDashOffset:0,strokeLineJoin:"miter",strokeUniform:!1,strokeMiterLimit:4,scaleX:1,scaleY:1,angle:0,flipX:!1,flipY:!1,shadow:null,visible:!0,backgroundColor:"",fillRule:"nonzero",paintFirst:"fill",globalCompositeOperation:"source-over",skewX:0,skewY:0,rx:0,ry:0,id:"workspace",selectable:!1,hasControls:!0}}}}X(so,"pluginName","PsdPlugin"),X(so,"apis",["insertPSD"]);function cs(e){return{group:{type:"group",version:"5.3.0",originX:"left",originY:"top",fill:"rgb(0,0,0)",stroke:null,strokeWidth:0,strokeDashArray:null,strokeLineCap:"butt",strokeDashOffset:0,strokeLineJoin:"miter",strokeUniform:!1,strokeMiterLimit:4,scaleX:1,scaleY:1,flipX:!1,flipY:!1,shadow:null,visible:!0,backgroundColor:"",fillRule:"nonzero",paintFirst:"fill",globalCompositeOperation:"source-over",skewX:0,skewY:0,selectable:!0,hasControls:!0},textbox:{type:"textbox",version:"5.3.0",originX:"left",originY:"top",fill:"rgb(0,0,0)",stroke:null,strokeWidth:1,strokeDashArray:null,strokeLineCap:"butt",strokeDashOffset:0,strokeLineJoin:"miter",strokeUniform:!1,strokeMiterLimit:4,scaleX:1,scaleY:1,angle:0,flipX:!1,flipY:!1,shadow:"",backgroundColor:"",fillRule:"nonzero",paintFirst:"fill",globalCompositeOperation:"source-over",skewX:0,skewY:0,fontFamily:"arial",fontWeight:"normal",fontSize:80,text:"诸事顺遂",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,textBackgroundColor:"",charSpacing:0,styles:[],direction:"ltr",path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",minWidth:20,splitByGrapheme:!0,selectable:!0,hasControls:!0},image:{type:"image",version:"5.3.0",originX:"left",originY:"top",fill:"rgb(0,0,0)",stroke:null,strokeWidth:0,strokeDashArray:null,strokeLineCap:"butt",strokeDashOffset:0,strokeLineJoin:"miter",strokeUniform:!1,strokeMiterLimit:4,scaleX:1,scaleY:1,angle:0,flipX:!1,flipY:!1,shadow:null,backgroundColor:"",fillRule:"nonzero",paintFirst:"fill",globalCompositeOperation:"source-over",skewX:0,skewY:0,cropX:0,cropY:0,selectable:!0,hasControls:!0,src:"",crossOrigin:"anonymous",filters:[]}}[e]}const Dw={style:{display:"inline-block"}},Mw={href:"javascript:void(0)"},Pw=bt({name:"ImportFile"}),Qw=Object.assign(Pw,{setup(e){const{getImgStr:t,selectFiles:n}=mr,{fabric:o,canvasEditor:g}=kt(),A=zt({showModal:!1,svgStr:""}),v={insertImg:function(){n({accept:"image/*",multiple:!0}).then(l=>{Array.from(l).forEach(r=>{t(r).then(a=>{i(a)})})})},insertSvg:function(){n({accept:".svg",multiple:!0}).then(l=>{Array.from(l).forEach(r=>{t(r).then(a=>{c(a)})})})},insertSvgStrModal:function(){A.svgStr="",A.showModal=!0},insertSvgStr:function(){o.loadSVGFromString(A.svgStr,(l,r)=>{const a=o.util.groupSVGElements(l,Ft(pt({},r),{name:"defaultSVG",id:Mt()}));g.canvas.add(a).centerObject(a).renderAll()})}},f=l=>{const r=v[l];r&&typeof r=="function"&&r()};function i(l){if(!l)throw new Error("file is undefined");const r=document.createElement("img");r.src=l,document.body.appendChild(r),r.onload=()=>{const a=new o.Image(r,{id:Mt(),name:"图片1",left:100,top:100});g.canvas.add(a),g.canvas.setActiveObject(a),g.canvas.renderAll(),r.remove()}}function c(l){if(!l)throw new Error("file is undefined");o.loadSVGFromURL(l,(r,a)=>{const s=o.util.groupSVGElements(r,Ft(pt({},a),{name:"defaultSVG",id:Mt()}));g.canvas.add(s).centerObject(s).renderAll()})}return(l,r)=>{const a=z("Icon"),s=z("DropdownItem"),u=z("DropdownMenu"),d=z("Dropdown"),h=z("Input"),p=z("Modal");return Z(),ut("div",Dw,[O(d,{"transfer-class-name":"fix",onOnClick:f},{list:L(()=>[O(u,null,{default:L(()=>[O(s,{name:"insertImg"},{default:L(()=>[vt(gt(l.$t("insertFile.insert_picture")),1)]),_:1}),O(s,{name:"insertSvg"},{default:L(()=>[vt(gt(l.$t("insertFile.insert_SVG")),1)]),_:1}),O(s,{name:"insertSvgStrModal"},{default:L(()=>[vt(gt(l.$t("insertFile.insert_SVGStr")),1)]),_:1})]),_:1})]),default:L(()=>[M("a",Mw,[vt(gt(l.$t("insertFile.insert"))+" ",1),O(a,{type:"ios-arrow-down"})])]),_:1}),O(p,{modelValue:T(A).showModal,"onUpdate:modelValue":r[1]||(r[1]=m=>T(A).showModal=m),title:l.$t("insertFile.modal_tittle"),onOnOk:r[2]||(r[2]=m=>f("insertSvgStr")),onOnCancel:r[3]||(r[3]=m=>l.showModal=!1)},{default:L(()=>[O(h,{modelValue:T(A).svgStr,"onUpdate:modelValue":r[0]||(r[0]=m=>T(A).svgStr=m),"show-word-limit":"",type:"textarea",placeholder:l.$t("insertFile.insert_SVGStr_placeholder")},null,8,["modelValue","placeholder"])]),_:1},8,["modelValue","title"])])}}}),Lw=xt(Qw,[["__scopeId","data-v-dfbf874e"]]),Ke=e=>(te("data-v-3e1ba47f"),e=e(),ee(),e),Fw={key:0,class:"attr-item-box"},Rw=Ke(()=>M("h4",null,"对齐",-1)),jw={class:"bg-item"},$w=Ke(()=>M("svg",{t:"1650442284704",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2345",width:"14",height:"14"},[M("path",{d:"M80 24h64v976H80zM198 227h448v190H198zM198 607h746v190H198z","p-id":"2346"})],-1)),Nw=Ke(()=>M("svg",{t:"1650442754876",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1514",width:"14",height:"14"},[M("path",{d:"M477.312 576V448H266.688a32 32 0 0 1-32-32v-192a32 32 0 0 1 32-32h210.624V34.688a34.688 34.688 0 0 1 69.376 0V192h210.624a32 32 0 0 1 32 32v192a32 32 0 0 1-32 32H546.688v128H896a32 32 0 0 1 32 32v192a32 32 0 0 1-32 32H546.688v157.312a34.688 34.688 0 1 1-69.376 0V832H128a32 32 0 0 1-32-32v-192A32 32 0 0 1 128 576h349.312z",fill:"#666666","p-id":"1515"})],-1)),Uw=Ke(()=>M("svg",{t:"1650442299564",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2543",width:"14",height:"14"},[M("path",{d:"M944 1000h-64V24h64zM826 417H378V227h448zM826 797H80V607h746z","p-id":"2544"})],-1)),Hw=Ke(()=>M("svg",{t:"1650442692910",class:"icon",viewBox:"0 0 1170 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1118",width:"14",height:"14"},[M("path",{d:"M1170.285714 36.571429a36.571429 36.571429 0 0 1-36.571428 36.571428H36.571429a36.571429 36.571429 0 0 1 0-73.142857h1097.142857a36.571429 36.571429 0 0 1 36.571428 36.571429z m-219.428571 146.285714v512a36.571429 36.571429 0 0 1-36.571429 36.571428h-219.428571a36.571429 36.571429 0 0 1-36.571429-36.571428v-512a36.571429 36.571429 0 0 1 36.571429-36.571429h219.428571a36.571429 36.571429 0 0 1 36.571429 36.571429z m-438.857143 0v804.571428a36.571429 36.571429 0 0 1-36.571429 36.571429h-219.428571a36.571429 36.571429 0 0 1-36.571429-36.571429v-804.571428a36.571429 36.571429 0 0 1 36.571429-36.571429h219.428571a36.571429 36.571429 0 0 1 36.571429 36.571429z",fill:"#666666","p-id":"1119"})],-1)),Gw=Ke(()=>M("svg",{t:"1650442732396",class:"icon",viewBox:"0 0 1243 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1316",width:"14",height:"14"},[M("path",{d:"M548.571429 472.356571h146.285714V231.643429a36.571429 36.571429 0 0 1 36.571428-36.571429h219.428572a36.571429 36.571429 0 0 1 36.571428 36.571429v240.713142h179.785143a39.643429 39.643429 0 0 1 0 79.286858H987.428571v240.713142a36.571429 36.571429 0 0 1-36.571428 36.571429h-219.428572a36.571429 36.571429 0 0 1-36.571428-36.571429V551.643429h-146.285714V950.857143a36.571429 36.571429 0 0 1-36.571429 36.571428H292.571429a36.571429 36.571429 0 0 1-36.571429-36.571428V551.643429H76.214857a39.643429 39.643429 0 1 1 0-79.286858H256V73.142857A36.571429 36.571429 0 0 1 292.571429 36.571429h219.428571a36.571429 36.571429 0 0 1 36.571429 36.571428v399.213714z",fill:"#666666","p-id":"1317"})],-1)),zw=Ke(()=>M("svg",{t:"1650442674784",class:"icon",viewBox:"0 0 1170 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"920",width:"14",height:"14"},[M("path",{d:"M1170.285714 987.428571a36.571429 36.571429 0 0 0-36.571428-36.571428H36.571429a36.571429 36.571429 0 0 0 0 73.142857h1097.142857a36.571429 36.571429 0 0 0 36.571428-36.571429z m-219.428571-146.285714v-512a36.571429 36.571429 0 0 0-36.571429-36.571428h-219.428571a36.571429 36.571429 0 0 0-36.571429 36.571428v512a36.571429 36.571429 0 0 0 36.571429 36.571429h219.428571a36.571429 36.571429 0 0 0 36.571429-36.571429z m-438.857143 0V36.571429a36.571429 36.571429 0 0 0-36.571429-36.571429h-219.428571a36.571429 36.571429 0 0 0-36.571429 36.571429v804.571428a36.571429 36.571429 0 0 0 36.571429 36.571429h219.428571a36.571429 36.571429 0 0 0 36.571429-36.571429z",fill:"#666666","p-id":"921"})],-1)),Yw=Ke(()=>M("svg",{t:"1650442800956",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1910",width:"14",height:"14"},[M("path",{d:"M96 0a32 32 0 0 1 32 32v960a32 32 0 0 1-64 0V32A32 32 0 0 1 96 0z m832 0a32 32 0 0 1 32 32v960a32 32 0 0 1-64 0V32a32 32 0 0 1 32-32zM384 800v-576a32 32 0 0 1 32-32h192a32 32 0 0 1 32 32v576a32 32 0 0 1-32 32h-192a32 32 0 0 1-32-32z",fill:"#515151","p-id":"1911"})],-1)),Vw=Ke(()=>M("svg",{t:"1650442784286",class:"icon",viewBox:"0 0 1170 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1712",width:"14",height:"14"},[M("path",{d:"M1170.285714 36.571429a36.571429 36.571429 0 0 1-36.571428 36.571428H36.571429a36.571429 36.571429 0 0 1 0-73.142857h1097.142857a36.571429 36.571429 0 0 1 36.571428 36.571429z m0 950.857142a36.571429 36.571429 0 0 1-36.571428 36.571429H36.571429a36.571429 36.571429 0 0 1 0-73.142857h1097.142857a36.571429 36.571429 0 0 1 36.571428 36.571428zM256 365.714286h658.285714a36.571429 36.571429 0 0 1 36.571429 36.571428v219.428572a36.571429 36.571429 0 0 1-36.571429 36.571428h-658.285714a36.571429 36.571429 0 0 1-36.571429-36.571428v-219.428572a36.571429 36.571429 0 0 1 36.571429-36.571428z",fill:"#515151","p-id":"1713"})],-1)),Ww=bt({name:"Align"}),Xw=bt(Ft(pt({},Ww),{setup(e){const{mixinState:t,canvasEditor:n}=kt(),o=ie(()=>t.mSelectMode!=="multiple"),g=()=>{n.left()},A=()=>{n.right()},v=()=>{n.xcenter()},f=()=>{n.ycenter()},i=()=>{n.top()},c=()=>{n.bottom()},l=()=>{n.xequation()},r=()=>{n.yequation()};return(a,s)=>{const u=z("Divider"),d=z("Button"),h=z("Tooltip");return T(t).mSelectMode==="multiple"?(Z(),ut("div",Fw,[O(u,{plain:"",orientation:"left"},{default:L(()=>[Rw]),_:1}),M("div",jw,[O(h,{content:a.$t("group_align.left")},{default:L(()=>[O(d,{disabled:T(o),onClick:g,size:"small",type:"text"},{default:L(()=>[$w]),_:1},8,["disabled"])]),_:1},8,["content"]),O(h,{content:a.$t("group_align.centerX")},{default:L(()=>[O(d,{disabled:T(o),onClick:v,size:"small",type:"text"},{default:L(()=>[Nw]),_:1},8,["disabled"])]),_:1},8,["content"]),O(h,{content:a.$t("group_align.right")},{default:L(()=>[O(d,{disabled:T(o),onClick:A,size:"small",type:"text"},{default:L(()=>[Uw]),_:1},8,["disabled"])]),_:1},8,["content"]),O(h,{content:a.$t("group_align.top")},{default:L(()=>[O(d,{disabled:T(o),onClick:i,size:"small",type:"text"},{default:L(()=>[Hw]),_:1},8,["disabled"])]),_:1},8,["content"]),O(h,{content:a.$t("group_align.centerY")},{default:L(()=>[O(d,{disabled:T(o),onClick:f,size:"small",type:"text"},{default:L(()=>[Gw]),_:1},8,["disabled"])]),_:1},8,["content"]),O(h,{content:a.$t("group_align.bottom")},{default:L(()=>[O(d,{disabled:T(o),onClick:c,size:"small",type:"text"},{default:L(()=>[zw]),_:1},8,["disabled"])]),_:1},8,["content"]),O(h,{content:a.$t("group_align.averageX")},{default:L(()=>[O(d,{disabled:T(o),onClick:l,size:"small",type:"text"},{default:L(()=>[Yw]),_:1},8,["disabled"])]),_:1},8,["content"]),O(h,{content:a.$t("group_align.averageY")},{default:L(()=>[O(d,{disabled:T(o),onClick:r,size:"small",type:"text"},{default:L(()=>[Vw]),_:1},8,["disabled"])]),_:1},8,["content"])])])):Ct("",!0)}}}));const Jw=xt(Xw,[["__scopeId","data-v-3e1ba47f"]]);const Kw={key:0,style:{display:"inline-block"}},qw=bt({name:"ImportJson"}),Zw=Object.assign(qw,{setup(e){const{getTemplInfo:t,updataTemplInfo:n}=pr(),{canvasEditor:o}=kt(),g=ft(""),A=co(),v=ft(!1);ge(()=>A.query,c=>{c!=null&&c.id?t(c==null?void 0:c.id).then(l=>{var r,a;g.value=(a=(r=l==null?void 0:l.data)==null?void 0:r.attributes)==null?void 0:a.name}):g.value=!1}),Qt(()=>{var c,l;(c=A==null?void 0:A.query)!=null&&c.id&&t((l=A==null?void 0:A.query)==null?void 0:l.id).then(r=>{var a,s,u,d;g.value=(s=(a=r==null?void 0:r.data)==null?void 0:a.attributes)==null?void 0:s.name,o.loadJSON(JSON.stringify((d=(u=r==null?void 0:r.data)==null?void 0:u.attributes)==null?void 0:d.json))}).catch(()=>{window.location.href="/"})});const f=()=>{v.value=!0,n(A.query.id,g.value).then().finally(()=>{v.value=!1})},i=_n(()=>{f()},1e3);return(c,l)=>{var d,h;const r=z("Input"),a=z("Icon"),s=z("Button"),u=z("Divider");return(h=(d=T(A))==null?void 0:d.query)!=null&&h.id?(Z(),ut("div",Kw,[O(r,{modelValue:T(g),"onUpdate:modelValue":l[0]||(l[0]=p=>Vt(g)?g.value=p:null),placeholder:"请输入文件名称",style:{width:"190px"},size:"small",onOnChange:T(i),loading:T(v)},null,8,["modelValue","onOnChange","loading"]),O(s,{type:"text",onClick:f,loading:T(v)},{default:L(()=>[O(a,{type:"ios-cloud-done",color:T(v)?"#ff9900":"#19be6b"},null,8,["color"])]),_:1},8,["loading"]),O(u,{type:"vertical"})])):Ct("",!0)}}}),tb=xt(Zw,[["__scopeId","data-v-aa24cccc"]]);const Jo=e=>(te("data-v-9b6d6f7c"),e=e(),ee(),e),eb={key:0,class:"attr-item-box"},nb={class:"bg-item"},ib=Jo(()=>M("svg",{t:"1650442559691",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3787",width:"14",height:"14"},[M("path",{d:"M885 607H544V417h192V227H544V24h-64v203H288v190h192v190H139v190h341v203h64V797h341z","p-id":"3788"})],-1)),rb=Jo(()=>M("svg",{t:"1650852784867",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2351",width:"14",height:"14"},[M("path",{d:"M544 480V64h-64v416H64v64h416v416h64V544h416v-64z",fill:"#727272","p-id":"2352"}),M("path",{d:"M123.7 241.1h119.5v64H123.7zM302.9 241.1h119.5v64H302.9zM601.6 241.1h119.5v64H601.6zM780.8 241.1h119.5v64H780.8zM123.7 718.9h119.5v64H123.7zM302.9 718.9h119.5v64H302.9zM601.6 718.9h119.5v64H601.6zM780.8 718.9h119.5v64H780.8z",fill:"#B2B2B2","p-id":"2353"})],-1)),sb=Jo(()=>M("svg",{t:"1650442510967",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3412",width:"14",height:"14"},[M("path",{d:"M859.9 474H164.1c-4.5 0-8.1 3.6-8.1 8v60c0 4.4 3.6 8 8.1 8h695.8c4.5 0 8.1-3.6 8.1-8v-60c0-4.4-3.6-8-8.1-8z m-353.6-74.7c2.9 3.7 8.5 3.7 11.3 0l100.8-127.5c3.7-4.7 0.4-11.7-5.7-11.7H550V104c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v156h-62.8c-6 0-9.4 7-5.7 11.7l100.8 127.6z m11.4 225.4c-2.9-3.7-8.5-3.7-11.3 0L405.6 752.3c-3.7 4.7-0.4 11.7 5.7 11.7H474v156c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V764h62.8c6 0 9.4-7 5.7-11.7L517.7 624.7z","p-id":"3413"})],-1)),ob=bt({name:"CenterAlign"}),ab=Object.assign(ob,{setup(e){const{mixinState:t,canvasEditor:n}=kt(),o=g=>{n.position(g)};return(g,A)=>{const v=z("Divider"),f=z("Button"),i=z("Tooltip");return T(t).mSelectMode?(Z(),ut("div",eb,[O(v,{plain:"",orientation:"left"},{default:L(()=>[M("h4",null,gt(g.$t("attrSeting.centerAlign.name")),1)]),_:1}),M("div",nb,[O(i,{content:g.$t("attrSeting.centerAlign.centerX")},{default:L(()=>[O(f,{long:"",disabled:!T(t).mSelectMode,onClick:A[0]||(A[0]=c=>o("centerH")),type:"text"},{default:L(()=>[ib]),_:1},8,["disabled"])]),_:1},8,["content"]),O(i,{content:g.$t("attrSeting.centerAlign.center")},{default:L(()=>[O(f,{long:"",disabled:!T(t).mSelectMode,onClick:A[1]||(A[1]=c=>o("center")),type:"text"},{default:L(()=>[rb]),_:1},8,["disabled"])]),_:1},8,["content"]),O(i,{content:g.$t("attrSeting.centerAlign.centerY")},{default:L(()=>[O(f,{long:"",disabled:!T(t).mSelectMode,onClick:A[2]||(A[2]=c=>o("centerV")),type:"text"},{default:L(()=>[sb]),_:1},8,["disabled"])]),_:1},8,["content"])])])):Ct("",!0)}}}),rc=xt(ab,[["__scopeId","data-v-9b6d6f7c"]]);const Rh=e=>(te("data-v-fb7b0462"),e=e(),ee(),e),lb={key:0,class:"attr-item-box"},cb={class:"bg-item"},ub=Rh(()=>M("svg",{t:"1650443094178",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1549",width:"14",height:"14"},[M("path",{d:"M252.76928 299.904l146.2784 0 0 472.42752-146.2784 0 0-472.42752Z","p-id":"1550"}),M("path",{d:"M477.48096 85.34528l70.87104 0 0 885.80608-70.87104 0 0-885.80608Z","p-id":"1551"}),M("path",{d:"M629.80096 284.8l31.0016 0 0 502.88128-31.0016 0L629.80096 284.8zM776.42752 284.8l31.0016 0 0 502.88128-31.0016 0L776.42752 284.8zM657.09056 315.8016l0-31.0016 123.04896 0 0 31.0016L657.09056 315.8016zM657.27488 787.64544l0-31.0016 123.04896 0 0 31.0016L657.27488 787.64544z","p-id":"1552"})],-1)),hb=Rh(()=>M("svg",{t:"1650443104385",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1749",width:"14",height:"14"},[M("path",{d:"M286.01856 250.91584l472.4224 0 0 146.2784-472.4224 0 0-146.2784Z","p-id":"1750"}),M("path",{d:"M87.19872 475.62752l885.80096 0 0 70.87104-885.80096 0 0-70.87104Z","p-id":"1751"}),M("path",{d:"M773.55008 627.94752l0 31.0016L270.6688 658.94912l0-31.0016L773.55008 627.94752zM773.55008 774.5792l0 31.0016L270.6688 805.5808l0-31.0016L773.55008 774.5792zM742.54848 655.24224l31.0016 0 0 123.04896-31.0016 0L742.54848 655.24224zM270.70464 655.42144l31.0016 0 0 123.04896-31.0016 0L270.70464 655.42144z","p-id":"1752"})],-1)),fb=bt({name:"Flip"}),db=Object.assign(fb,{setup(e){const{mixinState:t,canvasEditor:n}=kt(),o=()=>t.mSelectMode!=="one",g=A=>{const v=n.canvas.getActiveObject();v.set(`flip${A}`,!v[`flip${A}`]).setCoords(),n.canvas.requestRenderAll()};return(A,v)=>{const f=z("Button"),i=z("Tooltip");return T(t).mSelectMode==="one"?(Z(),ut("div",lb,[M("div",cb,[O(i,{content:A.$t("attrSeting.flip.x")},{default:L(()=>[O(f,{long:"",disabled:o(),onClick:v[0]||(v[0]=c=>g("X")),type:"text"},{default:L(()=>[ub]),_:1},8,["disabled"])]),_:1},8,["content"]),O(i,{content:A.$t("attrSeting.flip.y")},{default:L(()=>[O(f,{long:"",disabled:o(),onClick:v[1]||(v[1]=c=>g("Y")),type:"text"},{default:L(()=>[hb]),_:1},8,["disabled"])]),_:1},8,["content"])])])):Ct("",!0)}}}),gb=xt(db,[["__scopeId","data-v-fb7b0462"]]),pb=bt({__name:"previewCurrent",setup(e){const t=fn("canvasEditor"),n=()=>{t.preview().then(o=>{Bt.ImagePreview.show({previewList:[o]})})};return(o,g)=>{const A=z("Button");return Z(),wt(A,{type:"text",onClick:n},{default:L(()=>[vt(gt(o.$t("preview")),1)]),_:1})}}});const Ab={class:"save-box"},mb=bt({name:"save-bar"}),vb=Object.assign(mb,{setup(e){const t=co(),{createTmplByCommon:n,updataTemplInfo:o,routerToId:g}=pr(),{t:A}=Ne(),{canvasEditor:v}=kt(),f={clipboard(){v.clipboard()},saveJson(){v.saveJson()},saveSvg(){v.saveSvg()},saveImg(){v.saveImg()},clipboardBase64(){v.clipboardBase64()},saveMyClould(){return _t(this,null,function*(){var a,s;try{if(Bt.Spin.show(),(a=t==null?void 0:t.query)!=null&&a.id)yield o((s=t==null?void 0:t.query)==null?void 0:s.id);else{const u=yield n();g(u.data.data.id)}}catch(u){Bt.Message.warning("请登录")}Bt.Spin.hide()})}},i=_n(function(a){f[a]&&typeof f[a]=="function"&&f[a]()},300),c=()=>{v.clear()},l=()=>{Bt.Modal.confirm({title:A("tip"),content:`<p>${A("clearTip")}</p>`,okText:A("ok"),cancelText:A("cancel"),onOk:()=>c()})};return(a,s)=>{const u=z("Button"),d=z("Icon"),h=z("DropdownItem"),p=z("DropdownMenu"),m=z("Dropdown");return Z(),ut("div",Ab,[O(u,{style:{"margin-left":"10px"},type:"text",onClick:l},{default:L(()=>[vt(gt(a.$t("save.empty")),1)]),_:1}),O(m,{style:{"margin-left":"10px"},onOnClick:T(i)},{list:L(()=>[O(p,null,{default:L(()=>[O(h,{name:"saveMyClould"},{default:L(()=>[vt(gt(a.$t("save.save_my_spase")),1)]),_:1}),O(h,{name:"saveImg",divided:""},{default:L(()=>[vt(gt(a.$t("save.save_as_picture")),1)]),_:1}),O(h,{name:"saveSvg"},{default:L(()=>[vt(gt(a.$t("save.save_as_svg")),1)]),_:1}),O(h,{name:"clipboard",divided:""},{default:L(()=>[vt(gt(a.$t("save.copy_to_clipboard")),1)]),_:1}),O(h,{name:"clipboardBase64"},{default:L(()=>[vt(gt(a.$t("save.copy_to_clipboardstr")),1)]),_:1}),O(h,{name:"saveJson",divided:""},{default:L(()=>[vt(gt(a.$t("save.save_as_json")),1)]),_:1})]),_:1})]),default:L(()=>[O(u,{type:"primary"},{default:L(()=>[vt(gt(a.$t("save.down"))+" ",1),O(d,{type:"ios-arrow-down"})]),_:1})]),_:1},8,["onOnClick"])])}}}),yb=xt(vb,[["__scopeId","data-v-caf6a60e"]]),_b=bt({name:"saveBar"}),Cb=Object.assign(_b,{setup(e){const{locale:t}=Ne(),n={zh:"中文",en:"En"};let o=zt(Object.keys(n).map(v=>({langType:v,langName:n[v]})));const g=ie(()=>n[t.value]),A=v=>{t.value=v,cf(uf,v)};return(v,f)=>{const i=z("Icon"),c=z("Button"),l=z("DropdownItem"),r=z("DropdownMenu"),a=z("Dropdown");return Z(),wt(a,{onOnClick:A},{list:L(()=>[O(r,null,{default:L(()=>[(Z(!0),ut(Pt,null,Gt(T(o),s=>(Z(),wt(l,{key:s.langType,name:s.langType},{default:L(()=>[vt(gt(s.langName),1)]),_:2},1032,["name"]))),128))]),_:1})]),default:L(()=>[O(c,{type:"text"},{default:L(()=>[vt(gt(T(g))+" ",1),O(i,{type:"ios-arrow-down"})]),_:1})]),_:1})}}}),wb=bt({name:"Clone"}),bb=Object.assign(wb,{setup(e){const{mixinState:t,canvasEditor:n}=kt(),o=_n(function(){n.clone()},300);return(g,A)=>{const v=z("Button"),f=z("Tooltip");return T(t).mSelectMode==="one"?(Z(),wt(f,{key:0,content:g.$t("quick.copy")},{default:L(()=>[O(v,{long:"",onClick:T(o),icon:"ios-copy",type:"text"},null,8,["onClick"])]),_:1},8,["content"])):Ct("",!0)}}}),Sb=bt({name:"Hide"}),Eb=Object.assign(Sb,{setup(e){const{mixinState:t,canvasEditor:n}=kt(),o=ft(!1),g=v=>{n.canvas.getActiveObject().set("visible",!v),n.canvas.requestRenderAll(),o.value=v},A=()=>{const v=n.canvas.getActiveObject();o.value=!v.visible};return Qt(()=>{n.on("selectOne",A)}),de(()=>{n.off("selectOne",A)}),(v,f)=>{const i=z("Button"),c=z("Tooltip");return T(t).mSelectMode==="one"?(Z(),wt(c,{key:0,content:v.$t("quick.hide")},{default:L(()=>[T(o)?(Z(),wt(i,{key:0,long:"",onClick:f[0]||(f[0]=l=>g(!1)),icon:"md-eye-off",type:"text"})):(Z(),wt(i,{key:1,long:"",onClick:f[1]||(f[1]=l=>g(!0)),icon:"md-eye",type:"text"}))]),_:1},8,["content"])):Ct("",!0)}}});const jh=e=>(te("data-v-e74d2d89"),e=e(),ee(),e),Ib={key:0,class:"attr-item-box"},xb={class:"bg-item"},Bb=jh(()=>M("svg",{t:"1650848913991",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"17131",width:"14",height:"14"},[M("path",{d:"M341.333333 341.333333 341.333333 512 554.666667 512 554.666667 341.333333 341.333333 341.333333M42.666667 42.666667 213.333333 42.666667 213.333333 85.333333 810.666667 85.333333 810.666667 42.666667 981.333333 42.666667 981.333333 213.333333 938.666667 213.333333 938.666667 810.666667 981.333333 810.666667 981.333333 981.333333 810.666667 981.333333 810.666667 938.666667 213.333333 938.666667 213.333333 981.333333 42.666667 981.333333 42.666667 810.666667 85.333333 810.666667 85.333333 213.333333 42.666667 213.333333 42.666667 42.666667M213.333333 810.666667 213.333333 853.333333 810.666667 853.333333 810.666667 810.666667 853.333333 810.666667 853.333333 213.333333 810.666667 213.333333 810.666667 170.666667 213.333333 170.666667 213.333333 213.333333 170.666667 213.333333 170.666667 810.666667 213.333333 810.666667M256 256 640 256 640 426.666667 768 426.666667 768 768 341.333333 768 341.333333 597.333333 256 597.333333 256 256M640 597.333333 426.666667 597.333333 426.666667 682.666667 682.666667 682.666667 682.666667 512 640 512 640 597.333333Z","p-id":"17132"})],-1)),Tb=jh(()=>M("svg",{t:"1650848938557",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"17281",width:"14",height:"14"},[M("path",{d:"M85.333333 85.333333 256 85.333333 256 128 554.666667 128 554.666667 85.333333 725.333333 85.333333 725.333333 256 682.666667 256 682.666667 384 768 384 768 341.333333 938.666667 341.333333 938.666667 512 896 512 896 768 938.666667 768 938.666667 938.666667 768 938.666667 768 896 512 896 512 938.666667 341.333333 938.666667 341.333333 768 384 768 384 682.666667 256 682.666667 256 725.333333 85.333333 725.333333 85.333333 554.666667 128 554.666667 128 256 85.333333 256 85.333333 85.333333M768 512 768 469.333333 682.666667 469.333333 682.666667 554.666667 725.333333 554.666667 725.333333 725.333333 554.666667 725.333333 554.666667 682.666667 469.333333 682.666667 469.333333 768 512 768 512 810.666667 768 810.666667 768 768 810.666667 768 810.666667 512 768 512M554.666667 256 554.666667 213.333333 256 213.333333 256 256 213.333333 256 213.333333 554.666667 256 554.666667 256 597.333333 384 597.333333 384 512 341.333333 512 341.333333 341.333333 512 341.333333 512 384 597.333333 384 597.333333 256 554.666667 256M512 512 469.333333 512 469.333333 597.333333 554.666667 597.333333 554.666667 554.666667 597.333333 554.666667 597.333333 469.333333 512 469.333333 512 512Z","p-id":"17282"})],-1)),Ob=bt({name:"Group"}),kb=Object.assign(Ob,{setup(e){const{mixinState:t,canvasEditor:n}=kt();let o=ie(()=>t.mSelectMode==="one"&&t.mSelectOneType==="group"),g=ie(()=>t.mSelectMode==="multiple");const A=()=>{n.unGroup()},v=()=>{n.group()};return(f,i)=>{const c=z("Button");return T(g)||T(o)?(Z(),ut("div",Ib,[M("div",xb,[T(g)?(Z(),wt(c,{key:0,long:"",disabled:!T(g),onClick:v,type:"text"},{default:L(()=>[Bb,vt(" "+gt(f.$t("attrSeting.group")),1)]),_:1},8,["disabled"])):Ct("",!0),T(o)?(Z(),wt(c,{key:1,long:"",disabled:!T(o),onClick:A,type:"text"},{default:L(()=>[Tb,vt(" "+gt(f.$t("attrSeting.unGroup")),1)]),_:1},8,["disabled"])):Ct("",!0)])])):Ct("",!0)}}}),sc=xt(kb,[["__scopeId","data-v-e74d2d89"]]);const $h=e=>(te("data-v-2cddf6f5"),e=e(),ee(),e),Db={class:"box"},Mb=$h(()=>M("svg",{t:"1650853919128",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1271",width:"14",height:"14"},[M("path",{d:"M970.837333 919.850667l-205.696-205.653334A382.421333 382.421333 0 0 0 853.333333 469.333333a384 384 0 0 0-384-384 384 384 0 0 0-384 384 384 384 0 0 0 384 384 382.421333 382.421333 0 0 0 244.906667-88.192l205.653333 205.653334a36.053333 36.053333 0 0 0 50.986667 0 36.266667 36.266667 0 0 0-0.042667-50.944z m-380.117333-162.986667c-38.4 16.256-79.189333 24.448-121.386667 24.448a311.296 311.296 0 0 1-220.586666-91.392A311.296 311.296 0 0 1 157.312 469.333333 311.296 311.296 0 0 1 248.746667 248.746667 311.296 311.296 0 0 1 469.333333 157.354667a311.296 311.296 0 0 1 220.586667 91.392A311.296 311.296 0 0 1 781.354667 469.333333a311.296 311.296 0 0 1-91.392 220.586667 310.186667 310.186667 0 0 1-99.242667 66.901333z",fill:"#595959","p-id":"1272"}),M("path",{d:"M652.672 431.829333h-147.84V292.010667a35.968 35.968 0 1 0-71.978667 0v139.818666H292.010667a35.968 35.968 0 1 0 0 72.021334h140.8v140.8a35.968 35.968 0 1 0 72.021333 0v-140.8h147.84a35.968 35.968 0 1 0 0-72.021334z",fill:"#595959","p-id":"1273"})],-1)),Pb=$h(()=>M("svg",{t:"1650853934351",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1470",width:"14",height:"14"},[M("path",{d:"M970.837333 919.850667l-205.696-205.653334A382.421333 382.421333 0 0 0 853.333333 469.333333a384 384 0 0 0-384-384 384 384 0 0 0-384 384 384 384 0 0 0 384 384 382.421333 382.421333 0 0 0 244.906667-88.192l205.653333 205.653334a36.053333 36.053333 0 0 0 50.986667 0 36.266667 36.266667 0 0 0-0.042667-50.944z m-380.117333-162.986667c-38.4 16.256-79.189333 24.448-121.386667 24.448a311.296 311.296 0 0 1-220.586666-91.392A311.296 311.296 0 0 1 157.312 469.333333 311.296 311.296 0 0 1 248.746667 248.746667 311.296 311.296 0 0 1 469.333333 157.354667a311.296 311.296 0 0 1 220.586667 91.392A311.296 311.296 0 0 1 781.354667 469.333333a311.296 311.296 0 0 1-91.392 220.586667 310.186667 310.186667 0 0 1-99.242667 66.901333z",fill:"#595959","p-id":"1471"}),M("path",{d:"M652.672 431.829333H292.010667a35.968 35.968 0 1 0 0 72.021334h360.661333a35.968 35.968 0 1 0 0-72.021334z",fill:"#595959","p-id":"1472"})],-1)),Qb=bt({name:"Zoom"}),Lb=Object.assign(Qb,{setup(e){const{canvasEditor:t}=kt(),n=()=>{t.one()},o=()=>{t.big()},g=()=>{t.small()},A=()=>{t.auto()};return(v,f)=>{const i=z("Button"),c=z("ButtonGroup");return Z(),ut("div",Db,[O(c,null,{default:L(()=>[O(i,{onClick:o},{default:L(()=>[Mb]),_:1}),O(i,{onClick:g},{default:L(()=>[Pb]),_:1}),O(i,{onClick:n,icon:"ios-expand"}),O(i,{onClick:A,icon:"md-contract"})]),_:1})])}}}),Fb=xt(Lb,[["__scopeId","data-v-2cddf6f5"]]);const Rb=e=>(te("data-v-09a5434f"),e=e(),ee(),e),jb={class:"box"},$b=Rb(()=>M("span",null,"Drag",-1)),Nb=bt({name:"Drag"}),Ub=Object.assign(Nb,{setup(e){const t=ft(!1),{canvasEditor:n}=kt(),o=g=>{g?n.startDring():n.endDring()};return Qt(()=>{n.on("startDring",()=>t.value=!0),n.on("endDring",()=>t.value=!1)}),de(()=>{n.off("startDring"),n.off("endDring")}),(g,A)=>{const v=z("Switch");return Z(),ut("div",jb,[O(v,{size:"large",modelValue:T(t),"onUpdate:modelValue":A[0]||(A[0]=f=>Vt(t)?t.value=f:null),onOnChange:o},{open:L(()=>[$b]),_:1},8,["modelValue"])])}}}),Hb=xt(Ub,[["__scopeId","data-v-09a5434f"]]);const Gb=bt({name:"Lock"}),zb=Object.assign(Gb,{setup(e){const{mixinState:t,canvasEditor:n}=kt(),o=["lockMovementX","lockMovementY","lockRotation","lockScalingX","lockScalingY"],g=ft(!1),A=()=>{t.mSelectActive.hasControls=!1,o.forEach(c=>{t.mSelectActive[c]=!0}),t.mSelectActive.selectable=!1,g.value=!0,n.canvas.renderAll()},v=()=>{t.mSelectActive.hasControls=!0,o.forEach(c=>{t.mSelectActive[c]=!1}),t.mSelectActive.selectable=!0,g.value=!1,n.canvas.renderAll()},f=c=>{c?A():v()},i=c=>{g.value=!c[0].hasControls,t.mSelectActive=c[0]};return Qt(()=>{n.on("selectOne",i)}),de(()=>{n.off("selectOne",i)}),(c,l)=>{const r=z("Button"),a=z("Tooltip");return T(t).mSelectMode==="one"?(Z(),wt(a,{key:0,content:c.$t("quick.lock")},{default:L(()=>[T(g)?(Z(),wt(r,{key:0,long:"",onClick:l[0]||(l[0]=s=>f(!1)),icon:"md-lock",type:"text"})):(Z(),wt(r,{key:1,long:"",onClick:l[1]||(l[1]=s=>f(!0)),icon:"md-unlock",type:"text"}))]),_:1},8,["content"])):Ct("",!0)}}}),Yb=xt(zb,[["__scopeId","data-v-ed6a903a"]]),Vb=bt({name:"Del"}),Wb=Object.assign(Vb,{setup(e){const{mixinState:t,canvasEditor:n}=kt(),o=_n(function(){n.del()},300);return(g,A)=>{const v=z("Button"),f=z("Tooltip");return T(t).mSelectMode?(Z(),wt(f,{key:0,content:g.$t("quick.del")},{default:L(()=>[O(v,{long:"",onClick:T(o),icon:"ios-trash",type:"text"},null,8,["onClick"])]),_:1},8,["content"])):Ct("",!0)}}}),Xb=e=>(te("data-v-80d93857"),e=e(),ee(),e),Jb={class:"setting-item required"},Kb={class:"mr-10px"},qb={class:"setting-item font-selector"},Zb=Xb(()=>M("span",{class:"mr-10px"},"选择字体",-1)),t6={key:0,class:"font-item"},e6={style:{display:"none"}},n6={class:"setting-item"},i6={class:"mr-10px"},r6={class:"setting-item"},s6={class:"mr-10px"},o6={class:"setting-item"},a6={class:"mr-10px"},l6={class:"setting-item"},c6={class:"mr-10px"},u6=bt({name:"WaterMark"}),h6=bt(Ft(pt({},u6),{setup(e){let t;(l=>{l.lt="Left_Top",l.lb="Left_Right",l.rt="Right_Top",l.rb="Right_Bottom",l.full="Full"})(t||(t={}));const{canvasEditor:n}=kt(),o=ft([]);n.getFontList().then(l=>{o.value=l});const g=zt({text:"",size:24,isRotate:0,fontFamily:"汉体",color:"#ccc",position:"Left_Top"}),A=ft(!1),v=()=>{g.text="",g.size=24,g.fontFamily="serif",g.color="#ccc",g.position="Left_Top",g.isRotate=0,n.clearWaterMMatk(),A.value=!1},f=()=>_t(this,null,function*(){if(!g.text)return Bt.Message.warning("水印名字不能为空");const l=Yu(g);l.isRotate=!!l.isRotate,yield n.drawWaterMark(l),A.value=!1}),i=l=>{l&&n.loadFont(l)},c=_n(function(){A.value=!0},250);return(l,r)=>{const a=z("Button"),s=z("Input"),u=z("Option"),d=z("Select"),h=z("Slider"),p=z("ColorPicker"),m=z("Radio"),y=z("RadioGroup"),_=z("Modal");return Z(),ut(Pt,null,[O(a,{type:"text",onClick:T(c)},{default:L(()=>[vt(gt(l.$t("waterMark.text")),1)]),_:1},8,["onClick"]),O(_,{modelValue:T(A),"onUpdate:modelValue":r[6]||(r[6]=C=>Vt(A)?A.value=C:null),title:l.$t("waterMark.modalTitle")},{footer:L(()=>[O(a,{type:"text",onClick:v},{default:L(()=>[vt(gt(`${l.$t("cleanUp")}${l.$t("waterMark.text")}`),1)]),_:1}),O(a,{type:"primary",onClick:f},{default:L(()=>[vt("确定")]),_:1})]),default:L(()=>[M("div",Jb,[M("span",Kb,gt(l.$t("waterMark.setting.name")),1),O(s,{class:"w-320",modelValue:T(g).text,"onUpdate:modelValue":r[0]||(r[0]=C=>T(g).text=C),maxlength:"15","show-word-limit":"",placeholder:l.$t("placeholder")},null,8,["modelValue","placeholder"])]),M("div",qb,[Zb,O(d,{class:"w-320",modelValue:T(g).fontFamily,"onUpdate:modelValue":r[1]||(r[1]=C=>T(g).fontFamily=C),onOnChange:i},{default:L(()=>[(Z(!0),ut(Pt,null,Gt(T(o),C=>(Z(),wt(u,{value:C.name,key:`font-${C.name}`},{default:L(()=>[C.img?(Z(),ut("div",{key:1,class:"font-item",style:me(`background-image:url('${C.img}');`)},[vt(gt(C.img?"":C)+" ",1),M("span",e6,gt(C.name),1)],4)):(Z(),ut("div",t6,gt(C.name),1))]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),M("div",n6,[M("span",i6,gt(l.$t("waterMark.setting.size")),1),O(h,{class:"w-320",modelValue:T(g).size,"onUpdate:modelValue":r[2]||(r[2]=C=>T(g).size=C),min:18,max:48},null,8,["modelValue"])]),M("div",r6,[M("span",s6,gt(l.$t("waterMark.setting.color")),1),O(p,{modelValue:T(g).color,"onUpdate:modelValue":r[3]||(r[3]=C=>T(g).color=C),alpha:"",size:"small"},null,8,["modelValue"])]),M("div",o6,[M("span",a6,gt(l.$t("waterMark.setting.position.label")),1),O(y,{modelValue:T(g).position,"onUpdate:modelValue":r[4]||(r[4]=C=>T(g).position=C)},{default:L(()=>[O(m,{label:"Left_Top"},{default:L(()=>[vt(gt(l.$t("waterMark.setting.position.lt")),1)]),_:1},8,["label"]),O(m,{label:"Right_Top"},{default:L(()=>[vt(gt(l.$t("waterMark.setting.position.rt")),1)]),_:1},8,["label"]),O(m,{label:"Left_Right"},{default:L(()=>[vt(gt(l.$t("waterMark.setting.position.lb")),1)]),_:1},8,["label"]),O(m,{label:"Right_Bottom"},{default:L(()=>[vt(gt(l.$t("waterMark.setting.position.rb")),1)]),_:1},8,["label"]),O(m,{label:"Full"},{default:L(()=>[vt(gt(l.$t("waterMark.setting.position.full")),1)]),_:1},8,["label"])]),_:1},8,["modelValue"])]),Ae(M("div",l6,[M("span",c6,gt(l.$t("waterMark.setting.angle")),1),M("div",null,[O(y,{modelValue:T(g).isRotate,"onUpdate:modelValue":r[5]||(r[5]=C=>T(g).isRotate=C)},{default:L(()=>[O(m,{label:0},{default:L(()=>[vt("横向")]),_:1}),O(m,{label:1},{default:L(()=>[vt("倾斜")]),_:1})]),_:1},8,["modelValue"])])],512),[[we,T(g).position==="Full"]])]),_:1},8,["modelValue","title"])],64)}}}));const f6=xt(h6,[["__scopeId","data-v-80d93857"]]);const d6={class:"box"},g6={href:"javascript:void(0)"},p6=bt({name:"Login"}),A6=Object.assign(p6,{setup(e){const t=ft(!1),{t:n}=Ne(),o=ft("");Jd().then(d=>{o.value=d.data.username}).catch(()=>{ya()});const g=()=>{setTimeout(()=>{window.location.reload()},1e3)},A=()=>{Bt.Modal.confirm({title:n("login.logoutTip"),onOk:()=>{ya(),Bt.Message.success(n("login.logoutSuccessTip")),g()}})},v=zt({identifier:"",password:""}),f=zt({identifier:[{required:!0,message:n("login.identifierValidate"),trigger:"blur"}],password:[{required:!0,message:n("login.passwordValidate"),trigger:"blur"},{type:"string",min:6,message:n("login.passwordValidate"),trigger:"blur"}]}),i=ft(null),c=()=>{i.value.validate(d=>{d&&Kd(v).then(h=>{_a(h.data.jwt),Bt.Message.success(n("login.welcome")),g()}).catch(h=>{Bt.Message.error(h.response.data.error.message)})})},l=zt({username:"",password:"",email:""}),r=zt({username:[{required:!0,message:n("login.identifierValidate"),trigger:"blur"}],password:[{required:!0,message:n("login.passwordValidate"),trigger:"blur"},{type:"string",min:6,message:n("login.passwordValidate"),trigger:"blur"}],email:[{required:!0,message:n("login.emailValidate"),trigger:"blur"},{type:"email",message:n("login.emailValidate"),trigger:"blur"}]}),a=ft(null),s=()=>{a.value.validate(d=>{d&&qd(l).then(h=>{_a(h.data.jwt),Bt.Message.success(n("login.welcome")),g()}).catch(h=>{Bt.Message.error(h.response.data.error.message)})})},u=()=>{a.value&&a.value.resetFields(),i.value&&i.value.resetFields()};return(d,h)=>{const p=z("Icon"),m=z("DropdownItem"),y=z("DropdownMenu"),_=z("Dropdown"),C=z("Button"),w=z("Input"),b=z("FormItem"),S=z("Form"),F=z("TabPane"),$=z("Tabs");return Z(),ut("div",d6,[T(o)?(Z(),wt(_,{key:0,onOnClick:A},{list:L(()=>[O(y,null,{default:L(()=>[O(m,null,{default:L(()=>[vt("退出登录")]),_:1})]),_:1})]),default:L(()=>[M("a",g6,[O(p,{type:"ios-person",size:"20"}),vt(" "+gt(T(o))+" ",1),O(p,{type:"ios-arrow-down"})])]),_:1})):(Z(),wt(C,{key:1,shape:"circle",icon:"ios-person",onClick:h[0]||(h[0]=Q=>t.value=!0)})),O(T(Bt.Modal),{modelValue:T(t),"onUpdate:modelValue":h[6]||(h[6]=Q=>Vt(t)?t.value=Q:null),"footer-hide":""},{default:L(()=>[M("h3",null,gt(d.$t("login.title")),1),O($,{animated:!1,onOnClick:u},{default:L(()=>[O(F,{label:d.$t("login.login")},{default:L(()=>[O(S,{ref_key:"loginForm",ref:i,model:T(v),rules:T(f),class:"form-box"},{default:L(()=>[O(b,{prop:"identifier"},{default:L(()=>[O(w,{type:"text",modelValue:T(v).identifier,"onUpdate:modelValue":h[1]||(h[1]=Q=>T(v).identifier=Q),placeholder:d.$t("login.identifier")},{prepend:L(()=>[O(p,{type:"ios-person-outline"})]),_:1},8,["modelValue","placeholder"])]),_:1}),O(b,{prop:"password"},{default:L(()=>[O(w,{type:"password",modelValue:T(v).password,"onUpdate:modelValue":h[2]||(h[2]=Q=>T(v).password=Q),placeholder:d.$t("login.password")},{prepend:L(()=>[O(p,{type:"ios-lock-outline"})]),_:1},8,["modelValue","placeholder"])]),_:1}),O(b,null,{default:L(()=>[O(C,{type:"primary",long:"",onClick:c},{default:L(()=>[vt(gt(d.$t("login.login")),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["label"]),O(F,{label:d.$t("login.register")},{default:L(()=>[O(S,{ref_key:"registerForm",ref:a,model:T(l),rules:T(r),class:"form-box"},{default:L(()=>[O(b,{prop:"username"},{default:L(()=>[O(w,{type:"text",modelValue:T(l).username,"onUpdate:modelValue":h[3]||(h[3]=Q=>T(l).username=Q),placeholder:d.$t("login.username")},{prepend:L(()=>[O(p,{type:"ios-person-outline"})]),_:1},8,["modelValue","placeholder"])]),_:1}),O(b,{prop:"email"},{default:L(()=>[O(w,{type:"text",modelValue:T(l).email,"onUpdate:modelValue":h[4]||(h[4]=Q=>T(l).email=Q),placeholder:d.$t("login.email")},{prepend:L(()=>[O(p,{type:"ios-mail-outline"})]),_:1},8,["modelValue","placeholder"])]),_:1}),O(b,{prop:"password"},{default:L(()=>[O(w,{type:"password",modelValue:T(l).password,"onUpdate:modelValue":h[5]||(h[5]=Q=>T(l).password=Q),placeholder:d.$t("login.password")},{prepend:L(()=>[O(p,{type:"ios-lock-outline"})]),_:1},8,["modelValue","placeholder"])]),_:1}),O(b,null,{default:L(()=>[O(C,{type:"primary",long:"",onClick:s},{default:L(()=>[vt(gt(d.$t("login.register")),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["label"])]),_:1})]),_:1},8,["modelValue"])])}}}),m6=xt(A6,[["__scopeId","data-v-50e73e40"]]),Er="https://www.kuaitu.cc",v6=e=>Ce.get(`${Er}/api/${e}?pagination[pageSize]=200`),y6=(e,t)=>Ce.get(`${Er}/api/${e}?${t}`);function _6(e,t){return t.forEach(n=>{const{key:o,value:g,type:A}=n;g&&(e.filters[o]={[A]:g})}),zo.stringify(e)}function C6(e,t,n,o,g,A){return _6({populate:{img:"*"},filters:{},pagination:{page:e,pageSize:A}},[{key:o,value:t,type:"$eq"},{key:g,value:n,type:"$contains"}])}function w6(e){var n,o;const t=((o=(n=e==null?void 0:e.data)==null?void 0:n.attributes)==null?void 0:o.url)||"";return Er+t}function b6(e){var n,o,g,A,v,f;const t=((A=(g=(o=(n=e==null?void 0:e.data)==null?void 0:n.attributes)==null?void 0:o.formats)==null?void 0:g.small)==null?void 0:A.url)||((f=(v=e==null?void 0:e.data)==null?void 0:v.attributes)==null?void 0:f.url)||"";return Er+t}function Ko({typeUrl:e,listUrl:t,searchTypeKey:n,searchWordKey:o,scrollElement:g,pageSize:A}){const v=ft(!1),f=ft(""),i=ft(""),c=ft([]),l=ie(()=>{const w=c.value.find(b=>b.value===i.value);return(w==null?void 0:w.lable)||"全部"}),r=ft([]),a=ft(1),s=zt({page:0,pageCount:0,pageSize:10,total:0}),u=ie(()=>s.page===a.value&&s.page>=s.pageCount),d=()=>_t(this,null,function*(){v.value=!0;try{const b=(yield v6(e)).data.data.map(S=>({value:S.id,label:S.attributes.name}));c.value=[{label:"全部",value:""},...b]}catch(w){c.value=[]}v.value=!1}),h=()=>_t(this,null,function*(){v.value=!0;try{const w=C6(a.value,i.value,f.value,n,o,A),b=yield y6(t,w),S=b.data.data.map(F=>{var $;return{name:F.attributes.name,desc:F.attributes.desc,json:($=F.attributes)==null?void 0:$.json,src:w6(F.attributes.img),previewSrc:b6(F.attributes.img)}});Object.keys(b.data.meta.pagination).forEach(F=>{s[F]=b.data.meta.pagination[F]}),r.value=[...r.value,...S]}catch(w){console.log(w)}v.value=!1}),p=()=>{r.value=[],a.value=1,h()},m=()=>{a.value>=s.pageCount||(a.value++,setTimeout(()=>{h()},1e3))},y=ft(!1),_=ft(0);return{startPage:()=>_t(this,null,function*(){const w=document.querySelector(g);_.value=w.offsetHeight,y.value=!0,yield d(),yield h()}),searchKeyWord:f,typeValue:i,typeText:l,typeList:c,pageLoading:v,pageData:r,isDownBottm:u,startGetList:p,nextPage:m,scrollHeight:_,showScroll:y}}const S6={class:"search-box"},E6={style:{height:"calc(100vh - 108px)"},id:"myTemplBox"},I6={class:"list-box"},x6={class:"tmpl-img-box"},B6=bt({name:"ImportTmpl"}),T6=Object.assign(B6,{setup(e){const t=fc(),{t:n}=Ne(),{canvasEditor:o}=kt(),{startPage:g,typeValue:A,typeText:v,typeList:f,pageLoading:i,pageData:c,searchKeyWord:l,isDownBottm:r,startGetList:a,nextPage:s,showScroll:u,scrollHeight:d}=Ko({typeUrl:"templ-types",listUrl:"templs",searchTypeKey:"templ_type",searchWordKey:"name",pageSize:10,scrollElement:"#myTemplBox"}),h=m=>{Bt.Modal.confirm({title:n("tip"),content:`<p>${n("replaceTip")}</p>`,okText:n("ok"),cancelText:n("cancel"),onOk:()=>p(m)})};Qt(()=>{g()});const p=m=>{Bt.Spin.show({render:y=>y("div",n("alert.loading_data"))}),t.replace("/"),o.loadJSON(JSON.stringify(m),Bt.Spin.hide)};return(m,y)=>{const _=z("Option"),C=z("Select"),w=z("Input"),b=z("Image"),S=z("Tooltip"),F=z("Divider"),$=z("Scroll");return Z(),ut("div",null,[M("div",S6,[O(C,{class:"select",modelValue:T(A),"onUpdate:modelValue":y[0]||(y[0]=Q=>Vt(A)?A.value=Q:null),onOnChange:T(a),disabled:T(i)},{default:L(()=>[(Z(!0),ut(Pt,null,Gt(T(f),Q=>(Z(),wt(_,{value:Q.value,key:Q.value},{default:L(()=>[vt(gt(Q.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","onOnChange","disabled"]),O(w,{class:"input",placeholder:`在${T(v)}中搜索`,modelValue:T(l),"onUpdate:modelValue":y[1]||(y[1]=Q=>Vt(l)?l.value=Q:null),search:"",disabled:T(i),onOnSearch:T(a)},null,8,["placeholder","modelValue","disabled","onOnSearch"])]),M("div",E6,[T(u)?(Z(),wt($,{key:"mysscroll","on-reach-bottom":T(s),height:T(d),"distance-to-edge":[-1,-1]},{default:L(()=>[M("div",I6,[(Z(!0),ut(Pt,null,Gt(T(c),Q=>(Z(),wt(S,{content:Q.name,key:Q.src,placement:"top"},{default:L(()=>[M("div",x6,[O(b,{lazy:"",src:Q.src,fit:"contain",height:"100%",alt:Q.name,onClick:R=>h(Q.json)},null,8,["src","alt","onClick"])])]),_:2},1032,["content"]))),128))]),O(T(Bt.Spin),{size:"large",fix:"",show:T(i)},null,8,["show"]),T(r)?(Z(),wt(F,{key:0,plain:""},{default:L(()=>[vt("已经到底了")]),_:1})):Ct("",!0)]),_:1},8,["on-reach-bottom","height"])):Ct("",!0)])])}}}),O6=xt(T6,[["__scopeId","data-v-21304b41"]]);function qo(){const e=fn("canvasEditor"),t=()=>e.canvas.getSelectionElement().getBoundingClientRect();return{getCanvasBound:t,isOutsideCanvas:(o,g)=>{const{left:A,right:v,top:f,bottom:i}=t();return o<A||o>v||g<f||g>i}}}const k6={class:"search-box"},D6={style:{height:"calc(100vh - 108px)"},id:"myTemplBox3"},M6={class:"img-group"},P6={class:"tmpl-img-box"},Q6=bt({name:"ImportSvg"}),L6=Object.assign(Q6,{setup(e){const{t}=Ne(),{startPage:n,typeValue:o,typeText:g,typeList:A,pageLoading:v,pageData:f,searchKeyWord:i,isDownBottm:c,startGetList:l,nextPage:r,showScroll:a,scrollHeight:s}=Ko({typeUrl:"font-style-types",listUrl:"font-styles",searchTypeKey:"font_style_type",searchWordKey:"name",pageSize:50,scrollElement:"#myTemplBox3"}),{canvasEditor:u}=kt(),{isOutsideCanvas:d}=qo(),h=(y,_)=>_t(this,null,function*(){if(d(y.clientX,y.clientY))return;Bt.Spin.show({render:b=>b("div",t("alert.loading_data"))}),yield u.downFontByJSON(JSON.stringify(_.json));const C=JSON.parse(JSON.stringify(_.json));C.id=Mt();const w=m(C.type);new nt.fabric[w].fromObject(C,b=>{u.dragAddItem(b,y),Bt.Spin.hide()})}),p=y=>_t(this,null,function*(){Bt.Spin.show({render:w=>w("div",t("alert.loading_data"))}),yield u.downFontByJSON(JSON.stringify(y.json));const _=JSON.parse(JSON.stringify(y.json));_.id=Mt();const C=m(_.type);new nt.fabric[C].fromObject(_,w=>{u.dragAddItem(w),Bt.Spin.hide()})});function m(y){return y.charAt(0).toUpperCase()+y.slice(1)}return Qt(()=>_t(this,null,function*(){n()})),(y,_)=>{const C=z("Option"),w=z("Select"),b=z("Input"),S=z("Image"),F=z("Tooltip"),$=z("Divider"),Q=z("Scroll");return Z(),ut("div",null,[M("div",k6,[O(w,{class:"select",modelValue:T(o),"onUpdate:modelValue":_[0]||(_[0]=R=>Vt(o)?o.value=R:null),onOnChange:T(l),disabled:T(v)},{default:L(()=>[(Z(!0),ut(Pt,null,Gt(T(A),R=>(Z(),wt(C,{value:R.value,key:R.value},{default:L(()=>[vt(gt(R.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","onOnChange","disabled"]),O(b,{class:"input",placeholder:`在${T(g)}中搜索`,modelValue:T(i),"onUpdate:modelValue":_[1]||(_[1]=R=>Vt(i)?i.value=R:null),search:"",disabled:T(v),onOnSearch:T(l)},null,8,["placeholder","modelValue","disabled","onOnSearch"])]),M("div",D6,[T(a)?(Z(),wt(Q,{key:"mysscroll2","on-reach-bottom":T(r),height:T(s),"distance-to-edge":[-1,-1]},{default:L(()=>[M("div",M6,[(Z(!0),ut(Pt,null,Gt(T(f),R=>(Z(),wt(F,{content:R.name,key:R.src,placement:"top"},{default:L(()=>[M("div",P6,[O(S,{lazy:"",src:R.src,fit:"contain",height:"100%",alt:R.name,onClick:H=>p(R),onDragend:H=>h(H,R)},null,8,["src","alt","onClick","onDragend"])])]),_:2},1032,["content"]))),128))]),O(T(Bt.Spin),{size:"large",fix:"",show:T(v)},null,8,["show"]),T(c)?(Z(),wt($,{key:0,plain:""},{default:L(()=>[vt("已经到底了")]),_:1})):Ct("",!0)]),_:1},8,["on-reach-bottom","height"])):Ct("",!0)])])}}}),F6=xt(L6,[["__scopeId","data-v-1791a6ad"]]);const R6={class:"my-material"},j6={key:0,class:"img-group"},$6={class:"tmpl-img-box"},N6={key:1,class:"tip"},U6=bt({name:"ImportTmpl"}),H6=Object.assign(U6,{setup(e){const t="https://www.kuaitu.cc",{selectFiles:n}=mr,o=fn("canvasEditor"),g=ft([]),A=ft(!1),v=()=>{Rc().then(r=>{g.value=r.data.data.map(a=>({id:a.id,name:a.attributes.name,imgUrl:t+a.attributes.img.data.attributes.url})),A.value=!0}).catch(()=>{A.value=!1})};v();const f=()=>{n({accept:"image/*"}).then(r=>{const a=new FormData,s=new Date,[u]=r;a.append("files",u,`${s.getTime()}`),jc(a).then(d=>{const[h]=d.data;i(h.id,u.name)}).catch(d=>{console.log(d)})})},i=(r,a)=>{Zd({data:{img:r,name:a}}).finally(v)},c=r=>{o.addImgByElement(r.target)},l=r=>{tg(r).finally(v)};return(r,a)=>{const s=z("Button"),u=z("Icon"),d=z("Image"),h=z("Tooltip");return Z(),ut("div",R6,[O(s,{icon:"md-cloud-upload",onClick:f,long:"",type:"primary"},{default:L(()=>[vt(gt(r.$t("myMaterial.uploadBtn")),1)]),_:1}),T(g).length?(Z(),ut("div",j6,[(Z(!0),ut(Pt,null,Gt(T(g),(p,m)=>(Z(),wt(h,{content:p.name,key:`${m}-bai1-button`,placement:"top"},{default:L(()=>[M("div",$6,[O(u,{type:"ios-trash",class:"del-btn",color:"red",onClick:y=>l(p.id)},null,8,["onClick"]),O(d,{lazy:"",src:p.imgUrl,fit:"contain",height:"100%",alt:p.name,onClick:c},null,8,["src","alt"])])]),_:2},1032,["content"]))),128))])):(Z(),ut("div",N6,"暂无素材"))])}}}),G6=xt(H6,[["__scopeId","data-v-cbe38427"]]);const z6={class:"search-box"},Y6={style:{height:"calc(100vh - 180px)"},id:"myFileTemplBox"},V6={class:"tmpl-img-box"},W6=bt({name:"ImportTmpl"}),X6=Object.assign(W6,{setup(e){const{routerToId:t,removeTemplInfo:n}=pr(),o="https://www.kuaitu.cc",{t:g}=Ne(),{canvasEditor:A}=kt(),v=ft([]),f=ft(""),i=ft(!1),c=ft(1),l=zt({page:0,pageCount:0,pageSize:10,total:0}),r=()=>l.page===c.value&&l.page>=l.pageCount,a=()=>{i.value=!0,y(c.value,f.value).then(S=>{const{list:F,pagination:$}=S;Object.keys($).forEach(Q=>{l[Q]=$[Q]}),v.value=[...v.value,...F],i.value=!1})},s=()=>{v.value=[],c.value=1,a()},u=()=>{c.value>=l.pageCount||(c.value++,setTimeout(()=>{a()},1e3))},d=(S,F)=>{Bt.Modal.confirm({title:g("tip"),content:`<p>${g("replaceTip")}</p>`,okText:g("ok"),cancelText:g("cancel"),onOk:()=>m(S,F)})},h=ft(!1),p=ft(0);Qt(()=>{const S=document.querySelector("#myFileTemplBox");p.value=S.offsetHeight-10,h.value=!0,a()});const m=(S,F)=>{Bt.Spin.show({render:$=>$("div",g("alert.loading_data"))}),t(F),A.loadJSON(JSON.stringify(S),Bt.Spin.hide)},y=(S,F)=>{const Q=_({populate:{img:"*"},filters:{},pagination:{page:S,pageSize:50}},[{key:"name",value:F,type:"$contains"}]);return ig(Q).then(R=>{var W,G;return{list:R.data.data.map(V=>({id:V.id,name:V.attributes.name,desc:V.attributes.desc,json:V.attributes.json,src:C(V.attributes.img),previewSrc:w(V.attributes.img)})),pagination:(G=(W=R==null?void 0:R.data)==null?void 0:W.meta)==null?void 0:G.pagination}}).catch(R=>R)},_=(S,F)=>(F.forEach($=>{const{key:Q,value:R,type:H}=$;R&&(S.filters[Q]={[H]:R})}),zo.stringify(S)),C=S=>{var $,Q;const F=((Q=($=S==null?void 0:S.data)==null?void 0:$.attributes)==null?void 0:Q.url)||"";return o+F},w=S=>{var $,Q,R,H,W,G;const F=((H=(R=(Q=($=S==null?void 0:S.data)==null?void 0:$.attributes)==null?void 0:Q.formats)==null?void 0:R.medium)==null?void 0:H.url)||((G=(W=S==null?void 0:S.data)==null?void 0:W.attributes)==null?void 0:G.url)||"";return o+F},b=S=>{n(S).then(()=>{Bt.Message.success("删除成功"),s()})};return(S,F)=>{const $=z("Input"),Q=z("Icon"),R=z("Image"),H=z("Tooltip"),W=z("Divider"),G=z("Scroll");return Z(),ut("div",null,[M("div",z6,[O($,{class:"input",placeholder:"请输入关键词",modelValue:T(f),"onUpdate:modelValue":F[0]||(F[0]=V=>Vt(f)?f.value=V:null),search:"",disabled:T(i),onOnSearch:s},null,8,["modelValue","disabled"])]),M("div",Y6,[T(h)?(Z(),wt(G,{key:"myFileTemplBox","on-reach-bottom":u,height:T(p),"distance-to-edge":[-1,-1]},{default:L(()=>[M("div",null,[(Z(!0),ut(Pt,null,Gt(T(v),V=>(Z(),wt(H,{content:V.name,key:V.src,placement:"top"},{default:L(()=>[M("div",V6,[O(Q,{type:"ios-trash",class:"del-btn",color:"red",onClick:st=>b(V.id)},null,8,["onClick"]),O(R,{lazy:"",src:V.src,fit:"contain",height:"100%",alt:V.name,onClick:st=>d(V.json,V.id)},null,8,["src","alt","onClick"])])]),_:2},1032,["content"]))),128))]),O(T(Bt.Spin),{size:"large",fix:"",show:T(i)},null,8,["show"]),r()?(Z(),wt(W,{key:0,plain:""},{default:L(()=>[vt("已经到底了")]),_:1})):Ct("",!0)]),_:1},8,["height"])):Ct("",!0)])])}}}),J6=xt(X6,[["__scopeId","data-v-fc0a26b2"]]);const K6={key:0,class:"my-material"},q6={key:1,class:"tip"},Z6=bt({name:"ImportTmpl"}),tS=Object.assign(Z6,{setup(e){const t=ft("templ"),n=ft(!1);return(()=>{Rc().then(()=>{n.value=!0}).catch(()=>{n.value=!1})})(),(g,A)=>{const v=z("TabPane"),f=z("Tabs");return T(n)?(Z(),ut("div",K6,[O(f,{size:"small",modelValue:T(t),"onUpdate:modelValue":A[0]||(A[0]=i=>Vt(t)?t.value=i:null)},{default:L(()=>[O(v,{label:"模板",name:"templ"},{default:L(()=>[T(t)==="templ"?(Z(),wt(T(J6),{key:0})):Ct("",!0)]),_:1}),O(v,{label:"图片",name:"img"},{default:L(()=>[T(t)==="img"?(Z(),wt(T(G6),{key:0})):Ct("",!0)]),_:1})]),_:1},8,["modelValue"])])):(Z(),ut("div",q6,"请先登录"))}}}),eS=xt(tS,[["__scopeId","data-v-7e301dd4"]]),nS=(e,t)=>{const n=[],o=Math.PI*2/e;let g=-Math.PI/2;e%2===0&&(g+=o/2);for(let A=0;A<e;A++){const v=A*o+g;n.push({x:Math.cos(v)*t,y:Math.sin(v)*t})}return n};const Ge=e=>(te("data-v-dd234154"),e=e(),ee(),e),iS={class:"tool-box"},rS=Ge(()=>M("svg",{t:"1650875455324",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5401",width:"26",height:"26"},[M("path",{d:"M213.333333 209.92v128h85.333334v-42.666667h170.666666v433.493334H384.853333v85.333333h256v-85.333333H554.666667V295.253333h170.666666v42.666667h85.333334v-128H213.333333z","p-id":"5402"})],-1)),sS=[rS],oS=Ge(()=>M("svg",{t:"1650854954008",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"14038",width:"26",height:"26"},[M("path",{d:"M720.832 692.352h-12.64L530.208 260.448a19.968 19.968 0 0 0-36.416 0L316.608 692.352h-13.44c-7.904 0-15.04 3.968-17.408 11.072a19.872 19.872 0 0 0 18.208 27.68h56.96c9.504 0 18.208-6.336 19.776-15.808a18.752 18.752 0 0 0-15.808-21.344l36.384-87.808h159.776l34.816 87.808a18.88 18.88 0 0 0-15.808 21.344c1.568 9.504 10.272 15.808 19.776 15.808h121.024c7.904 0 15.04-3.968 17.408-11.072a19.2 19.2 0 0 0-17.408-27.68z m-306.112-125.76l64.864-158.208 64.864 158.208H414.72z m-246.816-80.704c0 6.336 5.536 11.872 11.872 11.872s11.872-5.536 11.872-11.872v-23.744c0-6.336-5.536-11.872-11.872-11.872s-11.872 5.536-11.872 11.872v23.744z m0-75.936c0 6.336 5.536 11.872 11.872 11.872s11.872-5.536 11.872-11.872v-23.744c0-6.336-5.536-11.872-11.872-11.872s-11.872 5.536-11.872 11.872v23.744z m0 151.872c0 6.336 5.536 11.872 11.872 11.872s11.872-5.536 11.872-11.872v-23.744c0-6.336-5.536-11.872-11.872-11.872s-11.872 5.536-11.872 11.872v23.744z m11.872-216.736a12.16 12.16 0 0 0 11.872-11.872v-23.744c-0.8-6.336-5.536-11.072-11.872-11.072s-11.872 5.536-11.872 11.872v23.744c0 6.336 4.736 11.072 11.872 11.072z m-11.872 292.672c0 6.336 5.536 11.872 11.872 11.872s11.872-5.536 11.872-11.872v-23.744c0-6.336-5.536-11.872-11.872-11.872s-11.872 5.536-11.872 11.872v23.744z m0 75.936c0 7.104 4.736 11.872 11.872 11.872a12.16 12.16 0 0 0 11.872-11.872v-23.744c0-6.336-5.536-11.872-11.872-11.872s-11.872 5.536-11.872 11.872v23.744z m665.248-227.808c0 6.336 5.536 11.872 11.872 11.872s11.872-5.536 11.872-11.872v-23.744c0-6.336-5.536-11.872-11.872-11.872s-11.872 5.536-11.872 11.872v23.744z m0-75.936c0 6.336 5.536 11.872 11.872 11.872s11.872-5.536 11.872-11.872v-23.744c0-6.336-5.536-11.872-11.872-11.872s-11.872 5.536-11.872 11.872v23.744z m0 151.872c0 6.336 5.536 11.872 11.872 11.872s11.872-5.536 11.872-11.872v-23.744c0-6.336-5.536-11.872-11.872-11.872s-11.872 5.536-11.872 11.872v23.744z m11.072-216.736a12.16 12.16 0 0 0 11.872-11.872v-23.744c0-6.336-5.536-11.872-11.872-11.872s-11.872 5.536-11.872 11.872v23.744c0.8 7.104 5.536 11.872 11.872 11.872z m-11.072 292.672c0 6.336 5.536 11.872 11.872 11.872s11.872-5.536 11.872-11.872v-23.744c0-6.336-5.536-11.872-11.872-11.872s-11.872 5.536-11.872 11.872v23.744z m0 75.936c0 6.336 5.536 11.872 11.872 11.872s11.872-5.536 11.872-11.872v-23.744c0-6.336-5.536-11.872-11.872-11.872s-11.872 5.536-11.872 11.872v23.744z m-347.264 119.456h-23.744c-6.336 0-11.872 5.536-11.872 11.872s5.536 11.872 11.872 11.872h23.744c6.336 0 11.872-5.536 11.872-11.872s-5.536-11.872-11.872-11.872z m-75.936 0h-23.744c-6.336 0-11.872 5.536-11.872 11.872s5.536 11.872 11.872 11.872h23.744c6.336 0 11.872-5.536 11.872-11.872s-5.536-11.872-11.872-11.872z m151.872 0h-23.744c-6.336 0-11.872 5.536-11.872 11.872s5.536 11.872 11.872 11.872h23.744c6.336 0 11.872-5.536 11.872-11.872s-5.536-11.872-11.872-11.872z m-228.608 0h-23.744c-6.336 0-11.872 5.536-11.872 11.872s5.536 11.872 11.872 11.872h23.744c6.336 0 11.872-5.536 11.872-11.872s-4.736-11.872-11.872-11.872z m-75.136-7.904H222.496v-11.072a12.48 12.48 0 0 0-12.672-12.64h-18.976v-37.984c0-7.104-5.536-12.64-11.872-12.64s-11.872 5.536-11.872 12.64v37.984h-10.272a12.512 12.512 0 0 0-12.672 12.64v52.992a12.48 12.48 0 0 0 12.672 12.64h52.992a12.512 12.512 0 0 0 12.672-12.64v-11.072h35.584c7.104-1.568 12.672-7.904 12.672-14.24 0-7.104-12.672-16.608-12.672-16.608z m379.68 7.904h-23.744c-6.336 0-11.872 5.536-11.872 11.872s5.536 11.872 11.872 11.872h23.744c6.336 0 11.872-5.536 11.872-11.872s-5.536-11.872-11.872-11.872z m75.936 0h-23.744c-6.336 0-11.872 5.536-11.872 11.872s5.536 11.872 11.872 11.872h23.744c6.336 0 11.872-5.536 11.872-11.872s-4.736-11.872-11.872-11.872z m-251.52-642.304h23.744c6.336 0 11.872-5.536 11.872-11.872s-5.536-11.872-11.872-11.872h-23.744c-6.336 0-11.872 5.536-11.872 11.872s5.536 11.872 11.872 11.872z m-75.936 0h23.744c6.336 0 11.872-5.536 11.872-11.872s-5.536-11.872-11.872-11.872h-23.744c-6.336 0-11.872 5.536-11.872 11.872s5.536 11.872 11.872 11.872z m151.872 0h23.744c6.336 0 11.872-5.536 11.872-11.872s-5.536-11.872-11.872-11.872h-23.744c-6.336 0-11.872 5.536-11.872 11.872s5.536 11.872 11.872 11.872z m-227.808 0h23.744c6.336 0 11.872-5.536 11.872-11.872s-5.536-11.872-11.872-11.872h-23.744c-7.104 0.8-11.872 5.536-11.872 12.672s4.736 11.072 11.872 11.072zM257.28 167.904H221.696v-11.072a12.512 12.512 0 0 0-12.672-12.672H156.832a12.512 12.512 0 0 0-12.672 12.672v52.992c0 7.104 5.536 12.672 12.672 12.672h11.072v35.584c1.568 7.104 7.904 12.672 14.24 12.672s16.608-12.672 16.608-12.672V222.496h11.072a12.512 12.512 0 0 0 12.672-12.672v-18.976h35.584a12.16 12.16 0 0 0 11.872-11.872 12.224 12.224 0 0 0-12.672-11.072z m356.768 22.944h23.744c6.336 0 11.872-5.536 11.872-11.872s-5.536-11.872-11.872-11.872h-23.744c-6.336 0-11.872 5.536-11.872 11.872s5.536 11.872 11.872 11.872z m76.736 0h23.744c6.336 0 11.072-4.736 11.072-11.072s-5.536-11.872-11.872-11.872h-23.744c-6.336 0-11.872 5.536-11.872 11.872s5.536 11.072 12.64 11.072z m176.384-46.656h-52.992a12.48 12.48 0 0 0-12.64 12.672v11.072h-35.584c-7.104 1.568-12.64 7.904-12.64 14.24s12.64 16.608 12.64 16.608h35.584v11.072c0 7.104 5.536 12.672 12.64 12.672h18.976v37.984c0 7.104 5.536 12.672 11.872 12.672s11.872-5.536 11.872-12.672V222.528h11.072a12.48 12.48 0 0 0 12.64-12.672V156.864a13.76 13.76 0 0 0-13.44-12.672z m0 657.312h-11.072v-35.584c-1.568-7.104-7.904-12.64-14.24-12.64-7.104 0-16.608 12.64-16.608 12.64v35.584h-11.072a12.48 12.48 0 0 0-12.64 12.64v18.976h-35.584c-6.336 0-11.872 5.536-11.872 11.872s5.536 11.872 11.872 11.872h35.584v11.072a12.48 12.48 0 0 0 12.64 12.64h52.992a12.48 12.48 0 0 0 12.64-12.64v-52.992c0-7.904-5.536-13.44-12.64-13.44z","p-id":"14039"})],-1)),aS=[oS],lS=Ge(()=>M("svg",{t:"1650855811131",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"18499",width:"26",height:"26"},[M("path",{d:"M864 896H160a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h704a32 32 0 0 1 32 32v704a32 32 0 0 1-32 32zM192 832h640V192H192v640z","p-id":"18500"})],-1)),cS=[lS],uS=Ge(()=>M("svg",{t:"1650855860236",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"19440",width:"26",height:"26"},[M("path",{d:"M512 928C282.624 928 96 741.376 96 512S282.624 96 512 96s416 186.624 416 416-186.624 416-416 416z m0-768C317.92 160 160 317.92 160 512s157.92 352 352 352 352-157.92 352-352S706.08 160 512 160z","p-id":"19441"})],-1)),hS=[uS],fS=Ge(()=>M("svg",{t:"1650874633978",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2032",width:"26",height:"26"},[M("path",{d:"M928.64 896a2.144 2.144 0 0 1-0.64 0H96a32.032 32.032 0 0 1-27.552-48.288l416-704c11.488-19.456 43.552-19.456 55.104 0l413.152 699.2A31.936 31.936 0 0 1 928.64 896zM152.064 832h719.84L512 222.912 152.064 832z","p-id":"2033"})],-1)),dS=[fS],gS=Ge(()=>M("svg",{t:"1650874633978",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2032",width:"26",height:"26"},[M("path",{d:"M161.152 398.016l134.016 412.416h433.664l134.016-412.416L512 143.104 161.152 398.08zM512 64l426.048 309.568-162.752 500.864H248.704L85.952 373.568 512 64z","p-id":"2033"})],-1)),pS=[gS],AS={class:"tool-box"},mS=Ge(()=>M("svg",{t:"1673022047861",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4206",width:"20",height:"20"},[M("path",{d:"M187.733333 1024h-170.666666c-10.24 0-17.066667-6.826667-17.066667-17.066667v-170.666666c0-10.24 6.826667-17.066667 17.066667-17.066667h170.666666c10.24 0 17.066667 6.826667 17.066667 17.066667v170.666666c0 10.24-6.826667 17.066667-17.066667 17.066667zM34.133333 989.866667h136.533334v-136.533334H34.133333v136.533334zM1006.933333 204.8h-170.666666c-10.24 0-17.066667-6.826667-17.066667-17.066667v-170.666666c0-10.24 6.826667-17.066667 17.066667-17.066667h170.666666c10.24 0 17.066667 6.826667 17.066667 17.066667v170.666666c0 10.24-6.826667 17.066667-17.066667 17.066667zM853.333333 170.666667h136.533334V34.133333h-136.533334v136.533334z",fill:"","p-id":"4207"}),M("path",{d:"M187.733333 853.333333c-3.413333 0-10.24 0-13.653333-3.413333-6.826667-6.826667-6.826667-17.066667 0-23.893333l648.533333-648.533334c6.826667-6.826667 17.066667-6.826667 23.893334 0s6.826667 17.066667 0 23.893334l-648.533334 648.533333c0 3.413333-6.826667 3.413333-10.24 3.413333z",fill:"","p-id":"4208"})],-1)),vS=[mS],yS=Ge(()=>M("svg",{t:"1673026778912",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2659",width:"20",height:"20"},[M("path",{d:"M320 738.133333L827.733333 230.4l-29.866666-29.866667L290.133333 708.266667v-268.8h-42.666666v341.333333h341.333333v-42.666667H320z",fill:"#444444","p-id":"2660"})],-1)),_S=[yS],CS=Ge(()=>M("svg",{t:"1715323097309",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"24572",width:"20",height:"20"},[M("path",{d:"M485.954269 735.978673 643.38051 811.107852C688.831327 832.798434 686.17686 860.459274 635.3838 871.903075L81.378406 996.721881C31.19882 1008.027444-1.313538 976.266799 10.130269 925.473745L134.949081 371.468357C146.254656 321.288783 173.611855 317.095036 195.744311 363.471653L270.873453 520.897858 903.670271 62.052983C986.301645 2.136458 1004.805285 20.426857 944.799125 103.181838L485.954269 735.978673Z",fill:"#444444","p-id":"24573"})],-1)),wS=[CS],bS=Ge(()=>M("svg",{t:"1650874633978",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"203255",width:"26",height:"26"},[M("path",{d:"M161.152 398.016l134.016 412.416h433.664l134.016-412.416L512 143.104 161.152 398.08zM512 64l426.048 309.568-162.752 500.864H248.704L85.952 373.568 512 64z","p-id":"203355"})],-1)),SS=[bS],ES=bt({name:"Tools"}),IS=Object.assign(ES,{setup(e){const t={polygon:"polygon",freeDraw:"freeDraw",pathText:"pathText"},n={shadow:"",fontFamily:"arial"},o={left:0,top:0},{t:g}=Ne(),{fabric:A,canvasEditor:v}=kt(),{getCanvasBound:f,isOutsideCanvas:i}=qo(),c=zt({isDrawingLineMode:!1,lineType:!1}),l=b=>{const S=new A.IText(g("everything_is_fine"),Ft(pt(pt({},n),b),{fontSize:80,id:Mt()}));v.canvas.add(S),b||S.center(),v.canvas.setActiveObject(S)},r=b=>{const S=new A.Textbox(g("everything_goes_well"),Ft(pt(pt({},n),b),{splitByGrapheme:!0,width:400,fontSize:80,id:Mt()}));v.canvas.add(S),b||S.center(),v.canvas.setActiveObject(S)},a=b=>{const S=new A.Triangle(Ft(pt(pt({},n),b),{width:400,height:400,fill:"#92706B",id:Mt(),name:"三角形"}));v.canvas.add(S),b||S.center(),v.canvas.setActiveObject(S)},s=b=>{const S=new A.Polygon(nS(5,200),Ft(pt(pt({},n),b),{fill:"#ccc",id:Mt(),name:"多边形"}));S.set({width:400,height:400,pathOffset:{x:0,y:0}}),v.canvas.add(S),b||S.center(),v.canvas.setActiveObject(S)},u=b=>{const S=new A.Circle(Ft(pt(pt({},n),b),{radius:150,fill:"#57606B",id:Mt(),name:"圆形"}));v.canvas.add(S),b||S.center(),v.canvas.setActiveObject(S)},d=b=>{const S=new A.Rect(Ft(pt(pt({},n),b),{fill:"#F57274",width:400,height:400,id:Mt(),name:"矩形"}));v.canvas.add(S),b||S.center(),v.canvas.setActiveObject(S)},h=()=>{const b=()=>{c.lineType=!1,c.isDrawingLineMode=!1,C(!c.isDrawingLineMode,!c.isDrawingLineMode)};c.lineType!==t.polygon?(y(),c.lineType=t.polygon,c.isDrawingLineMode=!0,v.beginDrawPolygon(b),v.endDraw(),C(!c.isDrawingLineMode,!c.isDrawingLineMode)):v.discardPolygon()},p=()=>{c.lineType===t.pathText?(c.lineType=!1,c.isDrawingLineMode=!1,v.endTextPathDraw()):(y(),c.lineType=t.pathText,c.isDrawingLineMode=!0,v.startTextPathDraw())},m=()=>{c.lineType===t.freeDraw?(v.endDraw(),c.lineType=!1,c.isDrawingLineMode=!1):(y(),c.lineType=t.freeDraw,c.isDrawingLineMode=!0,v.startDraw({width:20}))},y=()=>{v.discardPolygon(),v.endDraw(),v.endTextPathDraw()},_=b=>{[t.polygon,t.freeDraw,t.freeDraw].includes(c.lineType)&&y(),c.lineType=b,c.isDrawingLineMode=!c.isDrawingLineMode,v.setMode(c.isDrawingLineMode),v.setLineType(b),C(!c.isDrawingLineMode,!c.isDrawingLineMode)},C=(b,S)=>{v.canvas.forEachObject(F=>{F.id!=="workspace"&&(F.selectable=S,F.evented=b)})},w=(b,S)=>{if(!i(S.clientX,S.clientY))switch(b){case"text":l(o);break;case"textBox":r(o);break;case"rect":d(o);break;case"circle":u(o);break;case"triangle":a(o);break;case"polygon":s(o);break}};return Qt(()=>{lr(()=>{v.canvas.on("drop",b=>{const{left:S,top:F}=f(),$={left:S,top:F},Q={x:b.e.x-$.left,y:b.e.y-$.top},R=v.canvas.restorePointerVpt(Q);o.left=R.x,o.top=R.y})})}),(b,S)=>{const F=z("Divider"),$=z("Icon");return Z(),ut("div",null,[O(F,{plain:"",orientation:"left"},{default:L(()=>[vt(gt(b.$t("common_elements")),1)]),_:1}),M("div",iS,[M("span",{onClick:S[0]||(S[0]=()=>l()),draggable:!0,onDragend:S[1]||(S[1]=Q=>w("text",Q))},sS,32),M("span",{onClick:S[2]||(S[2]=()=>r()),draggable:!0,onDragend:S[3]||(S[3]=Q=>w("textBox",Q))},aS,32),M("span",{onClick:S[4]||(S[4]=()=>d()),draggable:!0,onDragend:S[5]||(S[5]=Q=>w("rect",Q))},cS,32),M("span",{onClick:S[6]||(S[6]=()=>u()),draggable:!0,onDragend:S[7]||(S[7]=Q=>w("circle",Q))},hS,32),M("span",{onClick:S[8]||(S[8]=()=>a()),draggable:!0,onDragend:S[9]||(S[9]=Q=>w("triangle",Q))},dS,32),M("span",{onClick:S[10]||(S[10]=()=>s()),draggable:!0,onDragend:S[11]||(S[11]=Q=>w("polygon",Q))},pS,32)]),O(F,{plain:"",orientation:"left"},{default:L(()=>[vt(gt(b.$t("draw_elements")),1)]),_:1}),M("div",AS,[M("span",{onClick:S[12]||(S[12]=Q=>_("line")),class:Xt(T(c).isDrawingLineMode&&T(c).lineType==="line"&&"bg")},vS,2),M("span",{onClick:S[13]||(S[13]=Q=>_("arrow")),class:Xt(T(c).isDrawingLineMode&&T(c).lineType==="arrow"&&"bg")},_S,2),M("span",{onClick:S[14]||(S[14]=Q=>_("thinTailArrow")),class:Xt(T(c).isDrawingLineMode&&T(c).lineType==="thinTailArrow"&&"bg")},wS,2),M("span",{onClick:h,class:Xt(T(c).isDrawingLineMode&&T(c).lineType==="polygon"&&"bg")},SS,2),M("span",{onClick:p,class:Xt(T(c).isDrawingLineMode&&T(c).lineType==="pathText"&&"bg")},[O($,{type:"logo-tumblr",size:22})],2),M("span",{onClick:m,class:Xt(T(c).isDrawingLineMode&&T(c).lineType==="freeDraw"&&"bg")},[O($,{type:"md-brush",size:22})],2)])])}}}),xS=xt(IS,[["__scopeId","data-v-dd234154"]]);const BS={class:"search-box"},TS={style:{height:"calc(100vh - 108px)"},id:"myTemplBox1"},OS={class:"img-group"},kS={class:"tmpl-img-box"},DS=bt({name:"ImportSvg"}),MS=Object.assign(DS,{setup(e){const{startPage:t,typeValue:n,typeText:o,typeList:g,pageLoading:A,pageData:v,searchKeyWord:f,isDownBottm:i,startGetList:c,nextPage:l,showScroll:r,scrollHeight:a}=Ko({typeUrl:"material-types",listUrl:"materials",searchTypeKey:"material_type",searchWordKey:"name",pageSize:50,scrollElement:"#myTemplBox1"}),{canvasEditor:s}=kt(),{isOutsideCanvas:u}=qo(),d=p=>{if(u(p.clientX,p.clientY))return;const m=p.target;s.getImageExtension(m.src)==="svg"?nt.fabric.loadSVGFromURL(m.src,_=>{const C=nt.fabric.util.groupSVGElements(_,{shadow:"",fontFamily:"arial",id:Mt(),name:"svg元素"});s.dragAddItem(C,p)}):nt.fabric.Image.fromURL(m.src,_=>{_.set({left:100,top:100}),s.dragAddItem(_,p)},{crossOrigin:"anonymous"})},h=p=>{const m=p.target;s.getImageExtension(m.src)==="svg"?nt.fabric.loadSVGFromURL(m.src,_=>{const C=nt.fabric.util.groupSVGElements(_,{shadow:"",fontFamily:"arial",id:Mt(),name:"svg元素"});s.dragAddItem(C)}):nt.fabric.Image.fromURL(m.src,_=>{_.set({left:100,top:100}),s.dragAddItem(_)},{crossOrigin:"anonymous"})};return Qt(()=>_t(this,null,function*(){var m;const p=co();if((m=p==null?void 0:p.query)!=null&&m.loadFile){const y=p.query.loadFile,_=yield mr.insertImgFile(y);h({target:_})}t()})),(p,m)=>{const y=z("Option"),_=z("Select"),C=z("Input"),w=z("Image"),b=z("Tooltip"),S=z("Spin"),F=z("Divider"),$=z("Scroll");return Z(),ut("div",null,[M("div",BS,[O(_,{class:"select",modelValue:T(n),"onUpdate:modelValue":m[0]||(m[0]=Q=>Vt(n)?n.value=Q:null),onOnChange:T(c),disabled:T(A)},{default:L(()=>[(Z(!0),ut(Pt,null,Gt(T(g),Q=>(Z(),wt(y,{value:Q.value,key:Q.value},{default:L(()=>[vt(gt(Q.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","onOnChange","disabled"]),O(C,{class:"input",placeholder:`在${T(o)}中搜索`,modelValue:T(f),"onUpdate:modelValue":m[1]||(m[1]=Q=>Vt(f)?f.value=Q:null),search:"",disabled:T(A),onOnSearch:T(c)},null,8,["placeholder","modelValue","disabled","onOnSearch"])]),M("div",TS,[T(r)?(Z(),wt($,{key:"mysscroll2","on-reach-bottom":T(l),height:T(a),"distance-to-edge":[-1,-1]},{default:L(()=>[M("div",OS,[(Z(!0),ut(Pt,null,Gt(T(v),Q=>(Z(),wt(b,{content:Q.name,key:Q.src,placement:"top"},{default:L(()=>[M("div",kS,[O(w,{lazy:"",src:Q.src,fit:"contain",height:"100%",alt:Q.name,onClick:h,onDragend:d},null,8,["src","alt"])])]),_:2},1032,["content"]))),128))]),O(S,{size:"large",fix:"",show:T(A)},null,8,["show"]),T(i)?(Z(),wt(F,{key:0,plain:""},{default:L(()=>[vt("已经到底了")]),_:1})):Ct("",!0)]),_:1},8,["on-reach-bottom","height"])):Ct("",!0)])])}}}),PS=xt(MS,[["__scopeId","data-v-cc46e0ca"]]);const QS={key:0},LS={class:"attr-item-box"},FS={class:"attr-item-box"},RS={class:"color-list"},jS=["onClick"],$S=bt({name:"BgBar"}),NS=Object.assign($S,{setup(e){const{mixinState:t,canvasEditor:n}=kt(),o=ft(["#5F2B63","#B23554","#F27E56","#FCE766","#86DCCD","#E7FDCB","#FFDC84","#F57677","#5FC2C7","#98DFE5","#C2EFF3","#DDFDFD","#9EE9D3","#2FC6C8","#2D7A9D","#48466d","#61c0bf","#bbded6","#fae3d9","#ffb6b9","#ffaaa5","#ffd3b6","#dcedc1","#a8e6cf"]),g=ft("rgba(255, 255, 255, 1)"),A=()=>{v(g.value)};function v(i){n.canvas.getObjects().find(l=>l.id==="workspace").set("fill",i),n.canvas.renderAll(),g.value=i}const f=()=>{const i=n.canvas.getObjects().find(c=>c.id==="workspace");g.value=i.fill};return Qt(()=>{n.on("loadJson",f)}),dc(()=>{n.off("loadJson",f)}),(i,c)=>{const l=z("Divider"),r=z("ColorPicker"),a=z("FormItem"),s=z("Form");return T(t).mSelectMode?Ct("",!0):(Z(),ut("div",QS,[M("div",LS,[O(l,{plain:"",orientation:"left"},{default:L(()=>[M("h4",null,gt(i.$t("bgSeting.color")),1)]),_:1}),O(s,{"label-width":0},{default:L(()=>[O(a,{prop:"name"},{default:L(()=>[O(r,{modelValue:g.value,"onUpdate:modelValue":c[0]||(c[0]=u=>g.value=u),onOnChange:A,alpha:""},null,8,["modelValue"])]),_:1})]),_:1})]),M("div",FS,[O(l,{plain:"",orientation:"left"},{default:L(()=>[M("h4",null,gt(i.$t("bgSeting.colorMacthing")),1)]),_:1}),M("div",RS,[(Z(!0),ut(Pt,null,Gt(o.value,(u,d)=>(Z(),ut("span",{key:u+d,style:me(`background:${u}`),onClick:h=>v(u)},null,12,jS))),128))])])]))}}}),US=xt(NS,[["__scopeId","data-v-1bfaf5be"]]);const HS={key:0,class:"attr-item-box"},GS=bt({name:"CanvasSize"}),zS=Object.assign(GS,{setup(e){const{mixinState:t,canvasEditor:n}=kt(),o={width:900,height:1200},g=ft(null);let A=ft(o.width),v=ft(o.height);Qt(()=>{n.setSize(A.value,v.value),n.on("sizeChange",(l,r)=>{A.value=l,v.value=r})});const f=()=>{n.setSize(A.value,v.value)},i=()=>{g.value.showSetSize(A.value,v.value)},c=(l,r)=>{A.value=l,v.value=r,f()};return(l,r)=>{const a=z("Divider"),s=z("InputNumber"),u=z("FormItem"),d=z("Icon"),h=z("Button"),p=z("Form");return T(t).mSelectMode?Ct("",!0):(Z(),ut("div",HS,[O(a,{plain:"",orientation:"left"},{default:L(()=>[M("h4",null,gt(l.$t("bgSeting.size")),1)]),_:1}),O(p,{"label-width":40,inline:"",class:"form-wrap"},{default:L(()=>[O(u,{label:l.$t("bgSeting.width"),prop:"name"},{default:L(()=>[O(s,{disabled:"",modelValue:T(A),"onUpdate:modelValue":r[0]||(r[0]=m=>Vt(A)?A.value=m:A=m),readonly:"",onOnChange:f},null,8,["modelValue"])]),_:1},8,["label"]),O(u,{label:l.$t("bgSeting.height"),prop:"name"},{default:L(()=>[O(s,{disabled:"",modelValue:T(v),"onUpdate:modelValue":r[1]||(r[1]=m=>Vt(v)?v.value=m:v=m),readonly:"",onOnChange:f},null,8,["modelValue"])]),_:1},8,["label"]),O(u,{"label-width":0},{default:L(()=>[O(h,{type:"text",onClick:i},{default:L(()=>[O(d,{type:"md-create"})]),_:1})]),_:1})]),_:1}),O(T($c),{title:l.$t("setSizeTip"),ref_key:"modalSizeRef",ref:g,onSet:c},null,8,["title"])]))}}}),YS=xt(zS,[["__scopeId","data-v-1e8a77d9"]]);const VS={key:0,class:"attr-item-box"},WS={class:"bg-item"},XS=bt({name:"ReplaceImg"}),JS=Object.assign(XS,{setup(e){const{getImgStr:t,selectFiles:n,insertImgFile:o}=mr,g=ye(),{mixinState:A,canvasEditor:v}=kt(),f=ft(""),i=()=>_t(this,null,function*(){const l=v.canvas.getActiveObjects()[0];if(l&&l.type==="image"){const[r]=yield n({accept:"image/*",multiple:!1}),a=yield t(r),s=yield o(a),u=l.get("width"),d=l.get("height"),h=l.get("scaleX"),p=l.get("scaleY");l.setSrc(s.src,()=>{l.set("scaleX",u*h/s.width),l.set("scaleY",d*p/s.height),v.canvas.renderAll()}),s.remove()}}),c=()=>{var r;const l=v.canvas.getActiveObjects()[0];l&&(f.value=l.type,(r=g==null?void 0:g.proxy)==null||r.$forceUpdate())};return Qt(()=>{v.on("selectOne",c)}),de(()=>{v.off("selectOne",c)}),(l,r)=>{const a=z("Button");return T(A).mSelectMode==="one"&&T(f)==="image"?(Z(),ut("div",VS,[M("div",WS,[O(a,{onClick:i,type:"text",long:""},{default:L(()=>[vt(gt(l.$t("repleaceImg")),1)]),_:1})])])):Ct("",!0)}}}),KS=xt(JS,[["__scopeId","data-v-01ca14f7"]]),qS="/vue-fabric-editor/assets/BlackWhite-f7b682f8.png",ZS="/vue-fabric-editor/assets/Brownie-e1fd7075.png",tE="/vue-fabric-editor/assets/Invert-5af1c3a4.png",eE="/vue-fabric-editor/assets/Kodachrome-2b49b22c.png",nE="/vue-fabric-editor/assets/Polaroid-9023c2a3.png",iE="/vue-fabric-editor/assets/Sepia-2ff95c35.png",rE="/vue-fabric-editor/assets/Vintage-f02e23f3.png",sE="/vue-fabric-editor/assets/technicolor-48049f1e.png",se={SELECT:"select",COLOR:"color",NUMBER:"number"},oc=[{type:"Brightness",status:!1,params:[{key:"brightness",value:0,uiType:se.NUMBER,min:-1,max:1,step:.01}]},{type:"Contrast",status:!1,params:[{key:"contrast",value:0,uiType:se.NUMBER,min:-1,max:1,step:.01}]},{type:"Saturation",status:!1,params:[{key:"saturation",value:0,uiType:se.NUMBER,min:-1,max:1,step:.01}]},{type:"Vibrance",status:!1,params:[{key:"vibrance",value:0,uiType:se.NUMBER,min:-1,max:1,step:.01}]},{type:"HueRotation",status:!1,params:[{key:"rotation",value:0,uiType:se.NUMBER,min:-1,max:1,step:.01}]},{type:"Noise",status:!1,params:[{key:"noise",value:0,uiType:se.NUMBER,min:-1,max:1e3,step:.1}]},{type:"Pixelate",status:!1,params:[{key:"blocksize",value:.01,uiType:se.NUMBER,min:.01,max:100,step:.01}]},{type:"Blur",status:!1,params:[{key:"blur",value:0,uiType:se.NUMBER,min:0,max:1,step:.01}]},{type:"Grayscale",status:!1,params:[{key:"mode",value:"average",uiType:se.SELECT,list:["average","lightness","luminosity"]}]},{type:"RemoveColor",status:!1,params:[{key:"color",value:"",uiType:se.COLOR},{key:"distance",value:0,uiType:se.NUMBER,min:0,max:1,step:.01}]}],ac=[{type:"Gamma",status:!1,params:[{key:"red",value:0,uiType:se.NUMBER,min:.01,max:2.2,step:.01},{key:"green",value:0,uiType:se.NUMBER,min:.01,max:2.2,step:.01},{key:"blue",value:0,uiType:se.NUMBER,min:.01,max:2.2,step:.01}],handler(e,t,n){return{gamma:[e,t,n]}}}];const oE=e=>(te("data-v-f44a09e8"),e=e(),ee(),e),aE={key:0,class:"box"},lE=oE(()=>M("h4",null,"图片滤镜",-1)),cE={class:"filter-box"},uE=["src","onClick"],hE={key:0,class:"content"},fE={key:0},dE={key:1},gE={key:2},pE=bt({name:"Filter"}),AE=Object.assign(pE,{setup(e){const{fabric:t,mixinState:n,canvasEditor:o}=kt(),g=ye(),A={BlackWhite:!1,Brownie:!1,Vintage:!1,Kodachrome:!1,technicolor:!1,Polaroid:!1,Invert:!1,Sepia:!1},v=zt({uiType:se,noParamsFilters:A,paramsFilters:[...oc],combinationFilters:[...ac],type:""}),f=(p,m)=>{const y=o.canvas.getActiveObjects()[0];v.noParamsFilters[p]=m,m?u(y,p)||s(y,p):d(y,p)},i=p=>{const m=o.canvas.getActiveObjects()[0],_=[...v.paramsFilters,...v.combinationFilters].find(C=>C.type===p);_.status?_.handler?a(_):_.params.forEach(C=>{r(p,C.key,C.value)}):d(m,p)},c=()=>{var m;const p=o.canvas.getActiveObjects()[0];p&&(v.type=p.type,v.type==="image"&&(Object.keys(A).forEach(y=>{var _;v.noParamsFilters[y]=!!u(p,y),(_=g==null?void 0:g.proxy)==null||_.$forceUpdate()}),oc.forEach(y=>{const _=v.paramsFilters.find(w=>w.type===y.type),C=u(p,y.type);_.status=!!C,_.params.forEach(w=>{w.value=C?C[w.key]:w.value})}),ac.forEach(y=>{const _=v.combinationFilters.find(w=>w.type===y.type),C=u(p,y.type);_.status=!!C})),(m=g==null?void 0:g.proxy)==null||m.$forceUpdate())};Qt(()=>{o.on("selectOne",c)}),de(()=>{o.off("selectOne",c)});function l(p){return new URL(Object.assign({"../assets/filters/BlackWhite.png":qS,"../assets/filters/Brownie.png":ZS,"../assets/filters/Invert.png":tE,"../assets/filters/Kodachrome.png":eE,"../assets/filters/Polaroid.png":nE,"../assets/filters/Sepia.png":iE,"../assets/filters/Vintage.png":rE,"../assets/filters/technicolor.png":sE})[`../assets/filters/${p}.png`],self.location).href}function r(p,m,y){const _=o.canvas.getActiveObjects()[0],C=u(_,p);if(C)C[m]=y;else{const w=s(_,p);w[m]=y}_.applyFilters(),o.canvas.renderAll()}function a(p){const m=o.canvas.getActiveObjects()[0];d(m,p.type);const y=p.params.map(_=>_.value);s(m,p.type,p.handler(...y))}function s(p,m,y=null){let _;const C=h(m),w=t.Image.filters[C];return w&&(_=new w(y),_.options=y,p.filters.push(_)),p.applyFilters(),o.canvas.renderAll(),_}function u(p,m){let y=null;if(p){const _=h(m),{length:C}=p.filters;let w,b;for(b=0;b<C;b+=1)if(w=p.filters[b],w.type===_){y=w;break}}return y}function d(p,m){const y=h(m);p.filters=p.filters.filter(_=>_.type!==y),p.applyFilters(),o.canvas.renderAll()}function h(p){return p.charAt(0).toUpperCase()+p.slice(1)}return(p,m)=>{const y=z("Divider"),_=z("Checkbox"),C=z("Panel"),w=z("Radio"),b=z("RadioGroup"),S=z("Slider"),F=z("ColorPicker"),$=z("Collapse");return T(n).mSelectMode==="one"&&T(v).type==="image"?(Z(),ut("div",aE,[O(y,{plain:"",orientation:"left"},{default:L(()=>[lE]),_:1}),O($,null,{default:L(()=>[O(C,{name:"1"},{content:L(()=>[M("div",cE,[(Z(!0),ut(Pt,null,Gt(T(v).noParamsFilters,(Q,R)=>(Z(),ut("div",{class:"filter-item",key:R},[M("img",{src:l(R),alt:"",onClick:H=>f(R,!A[R])},null,8,uE),O(_,{modelValue:T(v).noParamsFilters[R],"onUpdate:modelValue":H=>T(v).noParamsFilters[R]=H,onOnChange:H=>f(R,H)},{default:L(()=>[vt(gt(p.$t("filters."+R)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","onOnChange"])]))),128))])]),default:L(()=>[vt(gt(p.$t("filters.simple"))+" ",1)]),_:1}),O(C,{name:"2"},{content:L(()=>[M("div",null,[(Z(!0),ut(Pt,null,Gt([...T(v).paramsFilters,...T(v).combinationFilters],Q=>(Z(),ut("div",{class:"filter-item has-params",key:Q.type},[O(_,{modelValue:Q.status,"onUpdate:modelValue":R=>Q.status=R,onOnChange:R=>i(Q.type)},{default:L(()=>[vt(gt(p.$t("filters."+Q.type)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","onOnChange"]),Q.status?(Z(),ut("div",hE,[(Z(!0),ut(Pt,null,Gt(Q.params,R=>(Z(),ut("div",{class:"content slider-box",key:R},[R.uiType===T(se).SELECT?(Z(),ut("div",fE,[O(b,{modelValue:R.value,"onUpdate:modelValue":H=>R.value=H,onOnChange:H=>i(Q.type)},{default:L(()=>[(Z(!0),ut(Pt,null,Gt(R.list,H=>(Z(),wt(w,{label:H,key:H},{default:L(()=>[vt(gt(p.$t("filters."+Q.type+"List."+H)),1)]),_:2},1032,["label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onOnChange"])])):Ct("",!0),R.uiType===T(se).NUMBER?(Z(),ut("div",dE,[O(S,{modelValue:R.value,"onUpdate:modelValue":H=>R.value=H,max:R.max,min:R.min,step:R.step,onOnInput:H=>i(Q.type)},null,8,["modelValue","onUpdate:modelValue","max","min","step","onOnInput"])])):Ct("",!0),R.uiType===T(se).COLOR?(Z(),ut("div",gE,[O(F,{modelValue:R.value,"onUpdate:modelValue":H=>R.value=H,alpha:"",size:"small",onOnChange:H=>i(Q.type)},null,8,["modelValue","onUpdate:modelValue","onOnChange"])])):Ct("",!0)]))),128))])):Ct("",!0)]))),128))])]),default:L(()=>[vt(gt(p.$t("filters.complex"))+" ",1)]),_:1})]),_:1})])):Ct("",!0)}}}),mE=xt(AE,[["__scopeId","data-v-f44a09e8"]]),qe=e=>(te("data-v-84fdc5e6"),e=e(),ee(),e),vE={key:0,class:"box"},yE=qe(()=>M("h4",null,"图像描边",-1)),_E={class:"hd-wrap"},CE={class:"hd"},wE=qe(()=>M("span",null,"启用图像描边",-1)),bE=qe(()=>M("span",null,"开启",-1)),SE=qe(()=>M("span",null,"关闭",-1)),EE={class:"hd-wrap"},IE=qe(()=>M("div",{class:"hd"},[M("span",null,"是否只显示描边")],-1)),xE=qe(()=>M("span",null,"是",-1)),BE=qe(()=>M("span",null,"否",-1)),TE={class:"operation"},OE=qe(()=>M("div",{class:"hd",style:{"flex-basis":"98px"}},[M("span",null,"描边大小")],-1)),kE={style:{width:"100%"}},DE={class:"operation",style:{"justify-content":"space-between"}},ME=qe(()=>M("div",{class:"hd"},[M("span",null,"描边颜色")],-1)),PE=bt({name:"ImgStroke"}),QE=bt(Ft(pt({},PE),{setup(e){const{mixinState:t,canvasEditor:n}=kt(),o=ft(!1),g=ft(!1),A=ft(5),v=ft("#000"),f=ft(!1),i=()=>{var m;return(m=n.canvas)==null?void 0:m.getActiveObjects()[0]},c=()=>{const m=i();m!=null&&m.originSrc||(m.set("originWidth",m==null?void 0:m.get("width")),m.set("originHeight",m==null?void 0:m.get("height")),m.set("originSrc",m==null?void 0:m.getSrc()))},l=()=>{c();const m=T(f)?"destination-out":"source-over";h(T(v),T(A),m)},r=()=>{A.value=0,l()},a=m=>_t(this,null,function*(){m?(T(A)===0&&(A.value=5),l()):r()}),s=m=>{A.value=m,l()},u=m=>{v.value=m,l()},d=()=>{const m=i();o.value=m.type==="image"};Qt(()=>{n.on("selectOne",d)}),de(()=>{n.off("selectOne",d)});function h(m,y,_="source-over"){return _t(this,null,function*(){const C=i(),w=C.originWidth||0,b=C.originHeight||0,S=(C==null?void 0:C.originSrc)||C.getSrc();let F=document.createElement("canvas");const $=F.getContext("2d");if(!$)return;if(y===0){C.setSrc(S,()=>{var W;(W=C.canvas)==null||W.renderAll()});return}$.save(),$.clearRect(0,0,F.width,F.height),$.restore(),F.width=w+y*2,F.height=b+y*2;const Q=[-1,-1,0,-1,1,-1,-1,0,1,0,-1,1,0,1,1,1],R=yield p(S);if(!R)return;for(let W=0;W<Q.length;W+=2)$.drawImage(R,y+Q[W]*y,y+Q[W+1]*y,w,b);$.globalCompositeOperation="source-in",$.fillStyle=m,$.fillRect(0,0,w+y*2,b+y*2),$.globalCompositeOperation=_,$.drawImage(R,y,y,w,b);const H=F==null?void 0:F.toDataURL();F=null,H&&C.setSrc(H,()=>{var W;(W=C.canvas)==null||W.renderAll()})})}function p(m){return _t(this,null,function*(){return new Promise((y,_)=>{const C=new Image;C.crossOrigin="anonymous",C.onload=()=>y(C),C.onerror=()=>_(),C.src=m})})}return(m,y)=>{const _=z("Divider"),C=z("Icon"),w=z("Poptip"),b=z("iSwitch"),S=z("ColorPicker");return T(t).mSelectMode==="one"&&T(o)?(Z(),ut("div",vE,[O(_,{plain:"",orientation:"left"},{default:L(()=>[yE]),_:1}),M("div",_E,[M("div",CE,[wE,O(w,{trigger:"hover",content:"只支持png透明图像"},{default:L(()=>[M("span",null,[O(C,{type:"ios-alert",color:"#f34250"})])]),_:1})]),O(b,{modelValue:T(g),"onUpdate:modelValue":y[0]||(y[0]=F=>Vt(g)?g.value=F:null),size:"large",class:"switch",onOnChange:a},{open:L(()=>[bE]),close:L(()=>[SE]),_:1},8,["modelValue"])]),T(g)?(Z(),ut(Pt,{key:0},[M("div",EE,[IE,O(b,{modelValue:T(f),"onUpdate:modelValue":y[1]||(y[1]=F=>Vt(f)?f.value=F:null),size:"large",class:"switch",onOnChange:l},{open:L(()=>[xE]),close:L(()=>[BE]),_:1},8,["modelValue"])]),M("div",TE,[OE,M("div",kE,[O(T(Bt.Slider),{modelValue:T(A),"onUpdate:modelValue":y[2]||(y[2]=F=>Vt(A)?A.value=F:null),max:50,onOnChange:s},null,8,["modelValue"])])]),M("div",DE,[ME,M("div",null,[O(S,{modelValue:T(v),"onUpdate:modelValue":y[3]||(y[3]=F=>Vt(v)?v.value=F:null),onOnChange:u},null,8,["modelValue"])])])],64)):Ct("",!0)])):Ct("",!0)}}}));const LE=xt(QE,[["__scopeId","data-v-84fdc5e6"]]),FE={style:{display:"inline-block"}},RE={name:"ToolBar"},jE=bt(Ft(pt({},RE),{setup(e){const{canvasEditor:t}=kt(),n=ft(0),o=ft(0),g=()=>{t.undo()},A=()=>{t.redo()};return Qt(()=>{t.on("historyUpdate",(v,f)=>{n.value=v,o.value=f})}),(v,f)=>{const i=z("Icon"),c=z("Button"),l=z("Tooltip");return Z(),ut("div",FE,[O(l,{content:v.$t("history.revocation")+`(${T(n)})`},{default:L(()=>[O(c,{onClick:g,type:"text",size:"small",disabled:!T(n)},{default:L(()=>[O(i,{type:"ios-undo",size:"20"})]),_:1},8,["disabled"])]),_:1},8,["content"]),O(l,{content:v.$t("history.redo")+`(${T(o)})`},{default:L(()=>[O(c,{onClick:A,type:"text",size:"small",disabled:!T(o)},{default:L(()=>[O(i,{type:"ios-redo",size:"20"})]),_:1},8,["disabled"])]),_:1},8,["content"])])}}}));const $E=xt(jE,[["__scopeId","data-v-ec0313df"]]);const NE={class:"box"},UE={class:"layer-box"},HE=["onClick"],GE={class:"ellipsis"},zE=["innerHTML"],YE={class:"btn-box"},VE=["innerHTML"],WE=["innerHTML"],XE=["innerHTML"],JE=["innerHTML"],KE={key:1,class:"empty-text"},qE=bt({name:"Layer"}),ZE=Object.assign(qE,{setup(e){const{canvasEditor:t,fabric:n,mixinState:o}=kt(),g=ft([]),A=d=>d.id===o.mSelectId||o.mSelectIds.includes(d.id),v=d=>{const h={group:'<svg t="1650855307397" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2503" width="16" height="16"><path d="M839.036 130.458h-654.072c-30.102 0-54.506 24.404-54.506 54.506v654.072c0 30.102 24.404 54.506 54.506 54.506h654.072c30.102 0 54.506-24.404 54.506-54.506v-654.072c0-30.102-24.404-54.506-54.506-54.506zM839.036 811.786c0 15.050-12.196 27.249-27.249 27.249h-598.721c-15.050 0-27.249-12.196-27.249-27.249v-598.721c0-15.050 12.196-27.249 27.249-27.249h598.721c15.049 0 27.249 12.196 27.249 27.249v598.721zM730.028 421.639h-127.324v-126.817c0-30.091-24.402-54.499-54.501-54.499h-252.755c-30.098 0-54.501 24.401-54.501 54.499v253.89c0 30.091 24.402 54.499 54.501 54.499h127.324v126.817c0 30.091 24.402 54.499 54.501 54.499h252.755c30.098 0 54.501-24.401 54.501-54.499v-253.89c0-30.091-24.402-54.499-54.501-54.499zM323.36 548.137c-15.050 0-27.251-12.207-27.251-27.26v-197.694c0-15.055 12.201-27.26 27.251-27.26h196.928c15.051 0 27.251 12.207 27.251 27.26v98.458h-70.267c-30.098 0-54.501 24.401-54.501 54.499v71.998h-99.411zM547.539 477.24v43.638c0 15.055-12.202 27.26-27.251 27.26h-42.353v-43.638c0-15.055 12.202-27.26 27.251-27.26h42.353zM729.365 702.193c0 15.055-12.201 27.26-27.251 27.26h-196.928c-15.050 0-27.251-12.207-27.251-27.26v-98.981h70.267c30.098 0 54.501-24.401 54.501-54.499v-71.474h99.411c15.050 0 27.251 12.207 27.251 27.26v197.693z" p-id="2504"></path></svg>',textbox:'<svg t="1650854954008" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="14038" width="16" height="16"><path d="M720.832 692.352h-12.64L530.208 260.448a19.968 19.968 0 0 0-36.416 0L316.608 692.352h-13.44c-7.904 0-15.04 3.968-17.408 11.072a19.872 19.872 0 0 0 18.208 27.68h56.96c9.504 0 18.208-6.336 19.776-15.808a18.752 18.752 0 0 0-15.808-21.344l36.384-87.808h159.776l34.816 87.808a18.88 18.88 0 0 0-15.808 21.344c1.568 9.504 10.272 15.808 19.776 15.808h121.024c7.904 0 15.04-3.968 17.408-11.072a19.2 19.2 0 0 0-17.408-27.68z m-306.112-125.76l64.864-158.208 64.864 158.208H414.72z m-246.816-80.704c0 6.336 5.536 11.872 11.872 11.872s11.872-5.536 11.872-11.872v-23.744c0-6.336-5.536-11.872-11.872-11.872s-11.872 5.536-11.872 11.872v23.744z m0-75.936c0 6.336 5.536 11.872 11.872 11.872s11.872-5.536 11.872-11.872v-23.744c0-6.336-5.536-11.872-11.872-11.872s-11.872 5.536-11.872 11.872v23.744z m0 151.872c0 6.336 5.536 11.872 11.872 11.872s11.872-5.536 11.872-11.872v-23.744c0-6.336-5.536-11.872-11.872-11.872s-11.872 5.536-11.872 11.872v23.744z m11.872-216.736a12.16 12.16 0 0 0 11.872-11.872v-23.744c-0.8-6.336-5.536-11.072-11.872-11.072s-11.872 5.536-11.872 11.872v23.744c0 6.336 4.736 11.072 11.872 11.072z m-11.872 292.672c0 6.336 5.536 11.872 11.872 11.872s11.872-5.536 11.872-11.872v-23.744c0-6.336-5.536-11.872-11.872-11.872s-11.872 5.536-11.872 11.872v23.744z m0 75.936c0 7.104 4.736 11.872 11.872 11.872a12.16 12.16 0 0 0 11.872-11.872v-23.744c0-6.336-5.536-11.872-11.872-11.872s-11.872 5.536-11.872 11.872v23.744z m665.248-227.808c0 6.336 5.536 11.872 11.872 11.872s11.872-5.536 11.872-11.872v-23.744c0-6.336-5.536-11.872-11.872-11.872s-11.872 5.536-11.872 11.872v23.744z m0-75.936c0 6.336 5.536 11.872 11.872 11.872s11.872-5.536 11.872-11.872v-23.744c0-6.336-5.536-11.872-11.872-11.872s-11.872 5.536-11.872 11.872v23.744z m0 151.872c0 6.336 5.536 11.872 11.872 11.872s11.872-5.536 11.872-11.872v-23.744c0-6.336-5.536-11.872-11.872-11.872s-11.872 5.536-11.872 11.872v23.744z m11.072-216.736a12.16 12.16 0 0 0 11.872-11.872v-23.744c0-6.336-5.536-11.872-11.872-11.872s-11.872 5.536-11.872 11.872v23.744c0.8 7.104 5.536 11.872 11.872 11.872z m-11.072 292.672c0 6.336 5.536 11.872 11.872 11.872s11.872-5.536 11.872-11.872v-23.744c0-6.336-5.536-11.872-11.872-11.872s-11.872 5.536-11.872 11.872v23.744z m0 75.936c0 6.336 5.536 11.872 11.872 11.872s11.872-5.536 11.872-11.872v-23.744c0-6.336-5.536-11.872-11.872-11.872s-11.872 5.536-11.872 11.872v23.744z m-347.264 119.456h-23.744c-6.336 0-11.872 5.536-11.872 11.872s5.536 11.872 11.872 11.872h23.744c6.336 0 11.872-5.536 11.872-11.872s-5.536-11.872-11.872-11.872z m-75.936 0h-23.744c-6.336 0-11.872 5.536-11.872 11.872s5.536 11.872 11.872 11.872h23.744c6.336 0 11.872-5.536 11.872-11.872s-5.536-11.872-11.872-11.872z m151.872 0h-23.744c-6.336 0-11.872 5.536-11.872 11.872s5.536 11.872 11.872 11.872h23.744c6.336 0 11.872-5.536 11.872-11.872s-5.536-11.872-11.872-11.872z m-228.608 0h-23.744c-6.336 0-11.872 5.536-11.872 11.872s5.536 11.872 11.872 11.872h23.744c6.336 0 11.872-5.536 11.872-11.872s-4.736-11.872-11.872-11.872z m-75.136-7.904H222.496v-11.072a12.48 12.48 0 0 0-12.672-12.64h-18.976v-37.984c0-7.104-5.536-12.64-11.872-12.64s-11.872 5.536-11.872 12.64v37.984h-10.272a12.512 12.512 0 0 0-12.672 12.64v52.992a12.48 12.48 0 0 0 12.672 12.64h52.992a12.512 12.512 0 0 0 12.672-12.64v-11.072h35.584c7.104-1.568 12.672-7.904 12.672-14.24 0-7.104-12.672-16.608-12.672-16.608z m379.68 7.904h-23.744c-6.336 0-11.872 5.536-11.872 11.872s5.536 11.872 11.872 11.872h23.744c6.336 0 11.872-5.536 11.872-11.872s-5.536-11.872-11.872-11.872z m75.936 0h-23.744c-6.336 0-11.872 5.536-11.872 11.872s5.536 11.872 11.872 11.872h23.744c6.336 0 11.872-5.536 11.872-11.872s-4.736-11.872-11.872-11.872z m-251.52-642.304h23.744c6.336 0 11.872-5.536 11.872-11.872s-5.536-11.872-11.872-11.872h-23.744c-6.336 0-11.872 5.536-11.872 11.872s5.536 11.872 11.872 11.872z m-75.936 0h23.744c6.336 0 11.872-5.536 11.872-11.872s-5.536-11.872-11.872-11.872h-23.744c-6.336 0-11.872 5.536-11.872 11.872s5.536 11.872 11.872 11.872z m151.872 0h23.744c6.336 0 11.872-5.536 11.872-11.872s-5.536-11.872-11.872-11.872h-23.744c-6.336 0-11.872 5.536-11.872 11.872s5.536 11.872 11.872 11.872z m-227.808 0h23.744c6.336 0 11.872-5.536 11.872-11.872s-5.536-11.872-11.872-11.872h-23.744c-7.104 0.8-11.872 5.536-11.872 12.672s4.736 11.072 11.872 11.072zM257.28 167.904H221.696v-11.072a12.512 12.512 0 0 0-12.672-12.672H156.832a12.512 12.512 0 0 0-12.672 12.672v52.992c0 7.104 5.536 12.672 12.672 12.672h11.072v35.584c1.568 7.104 7.904 12.672 14.24 12.672s16.608-12.672 16.608-12.672V222.496h11.072a12.512 12.512 0 0 0 12.672-12.672v-18.976h35.584a12.16 12.16 0 0 0 11.872-11.872 12.224 12.224 0 0 0-12.672-11.072z m356.768 22.944h23.744c6.336 0 11.872-5.536 11.872-11.872s-5.536-11.872-11.872-11.872h-23.744c-6.336 0-11.872 5.536-11.872 11.872s5.536 11.872 11.872 11.872z m76.736 0h23.744c6.336 0 11.072-4.736 11.072-11.072s-5.536-11.872-11.872-11.872h-23.744c-6.336 0-11.872 5.536-11.872 11.872s5.536 11.072 12.64 11.072z m176.384-46.656h-52.992a12.48 12.48 0 0 0-12.64 12.672v11.072h-35.584c-7.104 1.568-12.64 7.904-12.64 14.24s12.64 16.608 12.64 16.608h35.584v11.072c0 7.104 5.536 12.672 12.64 12.672h18.976v37.984c0 7.104 5.536 12.672 11.872 12.672s11.872-5.536 11.872-12.672V222.528h11.072a12.48 12.48 0 0 0 12.64-12.672V156.864a13.76 13.76 0 0 0-13.44-12.672z m0 657.312h-11.072v-35.584c-1.568-7.104-7.904-12.64-14.24-12.64-7.104 0-16.608 12.64-16.608 12.64v35.584h-11.072a12.48 12.48 0 0 0-12.64 12.64v18.976h-35.584c-6.336 0-11.872 5.536-11.872 11.872s5.536 11.872 11.872 11.872h35.584v11.072a12.48 12.48 0 0 0 12.64 12.64h52.992a12.48 12.48 0 0 0 12.64-12.64v-52.992c0-7.904-5.536-13.44-12.64-13.44z" p-id="14039"></path></svg>',"i-text":'<svg t="1650875455324" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5401" width="16" height="16"><path d="M213.333333 209.92v128h85.333334v-42.666667h170.666666v433.493334H384.853333v85.333333h256v-85.333333H554.666667V295.253333h170.666666v42.666667h85.333334v-128H213.333333z" p-id="5402"></path></svg>',image:'<svg t="1650855321307" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2701" width="16" height="16"><path d="M813.752 223.168H209.584a25.168 25.168 0 0 0-25.168 25.176v528.648a25.16 25.16 0 0 0 25.168 25.168h604.168a25.152 25.152 0 0 0 25.168-25.168V248.344a25.168 25.168 0 0 0-25.168-25.176z m-8.08 544.168H217.664V258h588.008v509.336z" p-id="2702"></path><path d="M406.752 454.168a44.24 44.24 0 1 0-0.008-88.48 44.24 44.24 0 0 0 0.008 88.48zM474.72 611.368l-67.968-94.376-110.584 158.336h442.328L605.8 426.52z" p-id="2703"></path></svg>',rect:'<svg t="1650855811131" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="18499" width="16" height="16"><path d="M864 896H160a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h704a32 32 0 0 1 32 32v704a32 32 0 0 1-32 32zM192 832h640V192H192v640z" p-id="18500"></path></svg>',circle:'<svg t="1650855860236" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="19440" width="16" height="16"><path d="M512 928C282.624 928 96 741.376 96 512S282.624 96 512 96s416 186.624 416 416-186.624 416-416 416z m0-768C317.92 160 160 317.92 160 512s157.92 352 352 352 352-157.92 352-352S706.08 160 512 160z" p-id="19441"></path></svg>',triangle:'<svg t="1650874633978" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2032" width="16" height="16"><path d="M928.64 896a2.144 2.144 0 0 1-0.64 0H96a32.032 32.032 0 0 1-27.552-48.288l416-704c11.488-19.456 43.552-19.456 55.104 0l413.152 699.2A31.936 31.936 0 0 1 928.64 896zM152.064 832h719.84L512 222.912 152.064 832z" p-id="2033"></path></svg>',polygon:'<svg t="1650874633978" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2032" width="16" height="16"><path d="M161.152 398.016l134.016 412.416h433.664l134.016-412.416L512 143.104 161.152 398.08zM512 64l426.048 309.568-162.752 500.864H248.704L85.952 373.568 512 64z" p-id="2033"></path></svg>'},p='<svg t="1650855578257" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="17630" width="16" height="16"><path d="M620.606061 0a62.060606 62.060606 0 0 1 62.060606 62.060606v188.943515C874.945939 273.997576 1024 437.651394 1024 636.121212c0 214.217697-173.661091 387.878788-387.878788 387.878788-198.469818 0-362.123636-149.054061-385.117091-341.333333H62.060606a62.060606 62.060606 0 0 1-62.060606-62.060606V62.060606a62.060606 62.060606 0 0 1 62.060606-62.060606h558.545455z m62.060606 297.937455V620.606061a62.060606 62.060606 0 0 1-62.060606 62.060606H297.937455C320.636121 849.159758 463.39103 977.454545 636.121212 977.454545c188.509091 0 341.333333-152.824242 341.333333-341.333333 0-172.730182-128.294788-315.485091-294.787878-338.183757zM620.606061 46.545455H62.060606a15.515152 15.515152 0 0 0-15.406545 13.699878L46.545455 62.060606v558.545455a15.515152 15.515152 0 0 0 13.699878 15.406545L62.060606 636.121212h186.181818c0-214.217697 173.661091-387.878788 387.878788-387.878788V62.060606a15.515152 15.515152 0 0 0-13.699879-15.406545L620.606061 46.545455z m15.515151 248.242424c-188.509091 0-341.333333 152.824242-341.333333 341.333333h325.818182a15.515152 15.515152 0 0 0 15.406545-13.699879L636.121212 620.606061V294.787879z" p-id="17631"></path></svg>';return h[d]||p},f=(d,h)=>d.includes("text")?h.name||h.text:{group:"组合",image:"图片",rect:"矩形",circle:"圆形",triangle:"三角形",polygon:"多边形",path:"路径"}[d]||"默认元素",i=d=>{const h=t.canvas.getObjects().find(p=>p.id===d);t.canvas.discardActiveObject(),t.canvas.setActiveObject(h),t.canvas.requestRenderAll()},c=d=>({up:'<svg t="1650442206559" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1799" width="12" height="12"><path d="M876.2 434.3L536.7 94.9c-6.6-6.6-15.5-10.3-24.7-10.3-9.3 0-18.2 3.7-24.7 10.3L147.8 434.3c-13.7 13.7-13.7 35.8 0 49.5 13.7 13.7 35.8 13.7 49.5 0L477 204.1v700.2c0 19.3 15.7 35 35 35s35-15.7 35-35V204.1l279.7 279.7c6.8 6.8 15.8 10.3 24.7 10.3s17.9-3.4 24.7-10.3c13.7-13.7 13.7-35.8 0.1-49.5z" p-id="1800"></path></svg>',down:'<svg t="1650442229022" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1997" width="12" height="12"><path d="M876.2 589.7L536.7 929.1c-6.6 6.6-15.5 10.3-24.7 10.3-9.3 0-18.2-3.7-24.7-10.3L147.8 589.7c-13.7-13.7-13.7-35.8 0-49.5 13.7-13.7 35.8-13.7 49.5 0L477 819.9V119.6c0-19.3 15.7-35 35-35s35 15.7 35 35v700.2l279.7-279.7c6.8-6.8 15.8-10.3 24.7-10.3s17.9 3.4 24.7 10.3c13.7 13.8 13.7 35.9 0.1 49.6z" p-id="1998" ></path></svg>',upTop:'<svg t="1650442106652" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1839" width="11" height="11"><path d="M548.352 219.648a58.88 58.88 0 0 0-16.896-10.752 51.2 51.2 0 0 0-38.912 0 58.88 58.88 0 0 0-16.896 10.752l-256 256a51.2 51.2 0 0 0 72.704 72.704L460.8 379.392V972.8a51.2 51.2 0 0 0 102.4 0V379.392l168.448 168.96a51.2 51.2 0 0 0 72.704-72.704zM972.8 0H51.2a51.2 51.2 0 0 0 0 102.4h921.6a51.2 51.2 0 0 0 0-102.4z" p-id="1840" ></path></svg>',downTop:'<svg t="1650442146918" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2045" width="11" height="11"><path d="M548.352 804.352a58.88 58.88 0 0 1-16.896 10.752 51.2 51.2 0 0 1-38.912 0 58.88 58.88 0 0 1-16.896-10.752l-256-256a51.2 51.2 0 0 1 72.704-72.704L460.8 644.608V51.2a51.2 51.2 0 0 1 102.4 0v593.408l168.448-168.96a51.2 51.2 0 0 1 72.704 72.704zM972.8 1024H51.2a51.2 51.2 0 0 1 0-102.4h921.6a51.2 51.2 0 0 1 0 102.4z" p-id="2046"></path></svg>'})[d],l=()=>{t.up()},r=()=>{t.upTop()},a=()=>{t.down()},s=()=>{t.downTop()},u=()=>{g.value=[...t.canvas.getObjects().filter(d=>!(d instanceof n.GuideLine||d.id==="workspace"))].reverse().map(d=>{const{type:h,id:p,name:m,text:y}=d;return{type:h,id:p,name:m,text:y}}),g.value=Uy(T(g),"id")};return Qt(()=>{t.canvas.on("after:render",u)}),(d,h)=>{const p=z("Divider"),m=z("Tooltip"),y=z("Button"),_=z("ButtonGroup");return Z(),ut("div",NE,[T(g).length?(Z(),ut(Pt,{key:0},[O(p,{plain:"",orientation:"left"},{default:L(()=>[vt(gt(d.$t("layers")),1)]),_:1}),M("div",UE,[(Z(!0),ut(Pt,null,Gt(T(g),C=>(Z(),ut("div",{onClick:w=>i(C.id),key:C.id,class:Xt(A(C)&&"active")},[O(m,{content:C.name||C.text||C.type,placement:"left"},{default:L(()=>[M("div",GE,[M("span",{class:Xt(A(C)&&"active"),innerHTML:v(C.type)},null,10,zE),vt(" | "+gt(f(C.type,C)),1)])]),_:2},1032,["content"])],10,HE))),128))]),M("div",YE,[Ae(O(_,{size:"small"},{default:L(()=>[O(y,{onClick:l},{default:L(()=>[M("span",{innerHTML:c("up")},null,8,VE)]),_:1}),O(y,{onClick:a},{default:L(()=>[M("span",{innerHTML:c("down")},null,8,WE)]),_:1}),O(y,{onClick:r},{default:L(()=>[M("span",{innerHTML:c("upTop")},null,8,XE)]),_:1}),O(y,{onClick:s},{default:L(()=>[M("span",{innerHTML:c("downTop")},null,8,JE)]),_:1})]),_:1},512),[[we,T(o).mSelectMode==="one"]])])],64)):(Z(),ut("p",KE,"暂无图层"))])}}}),tI=xt(ZE,[["__scopeId","data-v-aedf7713"]]);function Zo(e,t){return t===void 0&&(t=15),+parseFloat(Number(e).toPrecision(t))}function $e(e){var t=e.toString().split(/[eE]/),n=(t[0].split(".")[1]||"").length-+(t[1]||0);return n>0?n:0}function gi(e){if(e.toString().indexOf("e")===-1)return Number(e.toString().replace(".",""));var t=$e(e);return t>0?Zo(Number(e)*Math.pow(10,t)):Number(e)}function oo(e){Uh&&(e>Number.MAX_SAFE_INTEGER||e<Number.MIN_SAFE_INTEGER)&&console.warn(e+" is beyond boundary when transfer to integer, the results may not be accurate")}function Ir(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var o=t[0],g=t.slice(1);return g.reduce(function(A,v){return e(A,v)},o)}}var sn=Ir(function(e,t){var n=gi(e),o=gi(t),g=$e(e)+$e(t),A=n*o;return oo(A),A/Math.pow(10,g)}),eI=Ir(function(e,t){var n=Math.pow(10,Math.max($e(e),$e(t)));return(sn(e,n)+sn(t,n))/n}),nI=Ir(function(e,t){var n=Math.pow(10,Math.max($e(e),$e(t)));return(sn(e,n)-sn(t,n))/n}),Nh=Ir(function(e,t){var n=gi(e),o=gi(t);return oo(n),oo(o),sn(n/o,Zo(Math.pow(10,$e(t)-$e(e))))});function iI(e,t){var n=Math.pow(10,t),o=Nh(Math.round(Math.abs(sn(e,n))),n);return e<0&&o!==0&&(o=sn(o,-1)),o}var Uh=!0;function rI(e){e===void 0&&(e=!0),Uh=e}var Ti={strip:Zo,plus:eI,minus:nI,times:sn,divide:Nh,round:iI,digitLength:$e,float2Fixed:gi,enableBoundaryChecking:rI};const Hh=e=>(te("data-v-4c516747"),e=e(),ee(),e),sI=Hh(()=>M("i",{class:"ivu-icon ivu-icon-ios-remove"},null,-1)),oI=[sI],aI=Hh(()=>M("i",{class:"ivu-icon ivu-icon-ios-add"},null,-1)),lI=[aI],cI=["aria-valuemax","aria-valuemin","aria-valuenow","value","disabled","autofocus","readonly","placeholder"],ce="ivu-input-number",Oi="ivu-icon",uI=150,hI=bt({__name:"inputNumber",props:{autofocus:{type:Boolean},parser:{},formatter:{},min:{default:-1/0},max:{default:1/0},precision:{default:2},step:{default:1},modelValue:{},defaultValue:{},modelEvent:{default:"change"},controlsOutside:{type:Boolean},hideButton:{type:Boolean},downDisabled:{type:Boolean},upDisabled:{type:Boolean},size:{default:"default"},disabled:{type:Boolean},readonly:{type:Boolean},placeholder:{},append:{},prepend:{}},emits:["update:modelValue","on-change","on-focus","on-blur","on-input"],setup(e,{expose:t,emit:n}){var Y;Ti.enableBoundaryChecking(!1);const o=e,g=n,A=ft(`${ce}-input-wrap`),v=ft(`${ce}-input`),f=ft(`${ce}-handler-wrap`),i=ft(`${ce}-handler-up-inner ${Oi} ${Oi}-ios-arrow-up`),c=ft(`${ce}-handler-down-inner ${Oi} ${Oi}-ios-arrow-down`),l=ft([`${ce}-handler`,`${ce}-handler-up`,{[`${ce}-handler-up-disabled`]:o.upDisabled}]),r=ft([`${ce}-handler`,`${ce}-handler-down`,{[`${ce}-handler-down-disabled`]:o.downDisabled}]),a=ft(!1),s=ie(()=>[`${ce}`,{[`${ce}-${o.size}`]:!!o.size,[`${ce}-disabled`]:o.disabled,[`${ce}-focused`]:a.value,[`${ce}-controls-outside`]:o.controlsOutside}]),u=ft(),d=ie(()=>{if(le(o.precision)){const I=`${o.step}`.split(".")[1],E=I&&I.length||0;return Math.max(E,o.precision)}}),h=I=>{var P,N;if(!le(I))return"";const E=d.value?I.toFixed(d.value).replace(/\.?0+$/,""):String(I);return(N=(P=o.formatter)==null?void 0:P.call(o,E))!=null?N:E},p=ft(h((Y=o.modelValue)!=null?Y:o.defaultValue)),m=I=>{a.value=!0,g("on-focus",I)},y=I=>{a.value=!1,g("on-blur",I)},_=I=>{Q(I,"minus",!0)},C=I=>{Q(I,"plus",!0)},w=I=>{I.key==="ArrowUp"?(I.preventDefault(),!o.readonly&&b("plus",I)):I.key==="ArrowDown"&&(I.preventDefault(),!o.readonly&&b("minus",I))},b=(I,E)=>{if(I==="plus"&&(W.value||o.upDisabled)||I==="minus"&&(H.value||o.downDisabled))return;let P;le(R.value)?P=st(Ti[I](R.value,o.step)):P=o.min===-1/0?0:o.min,p.value=h(P),G(P),g("update:modelValue",P),g("on-change",P,E)};let S=0;const F=()=>{S&&(window.clearTimeout(S),S=0)},$={onMouseup:F,onMouseleave:F},Q=(I,E,P=!1)=>{var N;I.preventDefault(),(N=u.value)==null||N.focus(),b(E,I),P&&(S=window.setTimeout(()=>I.target.dispatchEvent(I),uI))},R=ie(()=>{var E,P;if(!p.value)return;const I=Number((P=(E=o.parser)==null?void 0:E.call(o,p.value))!=null?P:p.value);return Number.isNaN(I)?void 0:I}),H=ft(le(R.value)&&R.value<=o.min),W=ft(le(R.value)&&R.value>=o.max),G=I=>{let E=!1,P=!1;le(I)&&(I<=o.min&&(E=!0),I>=o.max&&(P=!0)),W.value!==P&&(W.value=P),H.value!==E&&(H.value=E)},V=I=>{var P,N,q,J;let{value:E}=I.target;E=E.trim().replace(/。/g,"."),E=(N=(P=o.parser)==null?void 0:P.call(o,E))!=null?N:E,(le(Number(E))||/^(\.|-)$/.test(E))&&(p.value=(J=(q=o.formatter)==null?void 0:q.call(o,E))!=null?J:E,G(R.value),o.modelEvent==="input"&&g("update:modelValue",R.value),g("on-input",R.value,p.value,I))},st=I=>{if(!Qy(I))return le(o.min)&&I<o.min&&(I=o.min),le(o.max)&&I>o.max&&(I=o.max),le(d.value)?Ti.round(I,d.value):I},et=I=>{const E=st(R.value),P=h(E);(E!==R.value||p.value!==P)&&(p.value=P,G(E)),lr(()=>{le(o.modelValue)&&o.modelValue!==E&&(p.value=h(o.modelValue),G(o.modelValue))}),g("update:modelValue",E),g("on-change",E,I)},x=()=>{const I=st(R.value),E=h(I);(I!==R.value||p.value!==E)&&(p.value=E),g("update:modelValue",I)},B=ft(),k=ft(),D=I=>{const E=ft(),{posStart:P,posEnd:N}=ep(I,{threshold:0,onSwipeStart:()=>{E.value=R.value},onSwipe:q=>{if(!le(E.value))return;const J=E.value+Ti.round(N.x-P.x,0)*o.step;p.value=h(J),o.modelEvent==="input"?V(q):et(q)}})};return Qt(()=>{B.value&&D(B),k.value&&D(k)}),ge(()=>o.modelValue,I=>{I!==R.value&&(p.value=h(I),G(I))}),ge(()=>o.min,I=>{const E=le(R.value)&&R.value<=I;H.value!==E&&(H.value=E),le(R.value)&&R.value<I&&x()}),ge(()=>o.max,I=>{const E=le(R.value)&&R.value>=I;W.value!==E&&(W.value=E),le(R.value)&&R.value>I&&x()}),t({minus:_,plus:C,input:u.value,focus:()=>{var I;(I=u.value)==null||I.focus()},blur:()=>{var I;(I=u.value)==null||I.blur()}}),(I,E)=>(Z(),ut("div",{class:Xt(T(s))},[I.controlsOutside?(Z(),ut(Pt,{key:0},[M("div",Ci({class:["ivu-input-number-controls-outside-btn ivu-input-number-controls-outside-down",{"ivu-input-number-controls-outside-btn-disabled":I.downDisabled}],onMousedown:_},$),oI,16),M("div",Ci({class:["ivu-input-number-controls-outside-btn ivu-input-number-controls-outside-up",{"ivu-input-number-controls-outside-btn-disabled":I.upDisabled}],onMousedown:C},$),lI,16)],64)):I.hideButton?Ct("",!0):(Z(),ut("div",{key:1,class:Xt(T(f))},[M("a",Ci({class:T(l),onMousedown:C},$),[M("span",{class:Xt(T(i))},null,2)],16),M("a",Ci({class:T(r),onMousedown:_},$),[M("span",{class:Xt(T(c))},null,2)],16)],2)),M("div",{class:Xt(T(A))},[I.$slots.prefix?Wi(I.$slots,"prefix",{key:0},void 0,!0):I.append?(Z(),ut("label",{key:1,ref_key:"appendLabelRef",ref:B,class:Xt(`${T(A)}__label`)},gt(I.append),3)):Ct("",!0),M("input",{ref_key:"inputRef",ref:u,type:"text",autocomplete:"off",spellcheck:"false",role:"spinbutton","aria-valuemax":I.max,"aria-valuemin":I.min,"aria-valuenow":T(p),value:T(p),class:Xt(T(v)),disabled:I.disabled,autofocus:I.autofocus,readonly:I.readonly,placeholder:I.placeholder,onFocus:m,onBlur:y,onInput:V,onChange:et,onKeydown:w},null,42,cI),I.$slots.suffix?Wi(I.$slots,"suffix",{key:2},void 0,!0):I.prepend?(Z(),ut("label",{key:3,ref_key:"prependLabelRef",ref:k,class:Xt(`${T(A)}__label`)},gt(I.prepend),3)):Ct("",!0)],2)],2))}});const Qe=xt(hI,[["__scopeId","data-v-4c516747"]]);const fI=e=>(te("data-v-edbd74ba"),e=e(),ee(),e),dI={key:0,class:"box attr-item-box"},gI=fI(()=>M("h4",null,"位置信息",-1)),pI=bt({name:"AttrBute"}),AI=Object.assign(pI,{setup(e){const t=ye(),{mixinState:n,canvasEditor:o}=kt(),g=["text","i-text","textbox","rect","circle","triangle","polygon","image","group","line","arrow","thinTailArrow"],A=zt({opacity:0,angle:0,left:0,top:0}),v=c=>{const l=o.canvas.getActiveObject();c&&c.target&&c.target!==l||l&&g.includes(l.type)&&(A.opacity=l.get("opacity")*100,A.left=l.get("left"),A.top=l.get("top"),A.angle=l.get("angle")||0)},f=(c,l)=>{const r=o.canvas.getActiveObjects()[0];if(r){if(c==="opacity"){r&&r.set(c,l/100),o.canvas.renderAll();return}if(c==="angle"){r.rotate(l),o.canvas.renderAll();return}r&&r.set(c,l),o.canvas.renderAll()}},i=()=>{var c;(c=t==null?void 0:t.proxy)==null||c.$forceUpdate()};return Qt(()=>{v(),o.on("selectCancel",i),o.on("selectOne",v),o.canvas.on("object:modified",v)}),de(()=>{o.off("selectCancel",i),o.off("selectOne",v),o.canvas.off("object:modified",v)}),(c,l)=>{const r=z("Divider"),a=z("Col"),s=z("Row"),u=z("Slider"),d=z("FormItem"),h=z("Form");return T(n).mSelectMode==="one"?(Z(),ut("div",dI,[O(r,{plain:"",orientation:"left"},{default:L(()=>[gI]),_:1}),Ae(M("div",null,[O(s,{gutter:10},{default:L(()=>[O(a,{flex:"1"},{default:L(()=>[O(T(Qe),{modelValue:T(A).left,"onUpdate:modelValue":l[0]||(l[0]=p=>T(A).left=p),onOnChange:l[1]||(l[1]=p=>f("left",p)),append:c.$t("attributes.left")},null,8,["modelValue","append"])]),_:1}),O(a,{flex:"1"},{default:L(()=>[O(T(Qe),{modelValue:T(A).top,"onUpdate:modelValue":l[2]||(l[2]=p=>T(A).top=p),onOnChange:l[3]||(l[3]=p=>f("top",p)),append:c.$t("attributes.top")},null,8,["modelValue","append"])]),_:1})]),_:1}),O(h,{"label-width":40,class:"form-wrap"},{default:L(()=>[O(d,{label:c.$t("attributes.angle")},{default:L(()=>[O(u,{modelValue:T(A).angle,"onUpdate:modelValue":l[4]||(l[4]=p=>T(A).angle=p),max:360,onOnInput:l[5]||(l[5]=p=>f("angle",p))},null,8,["modelValue"])]),_:1},8,["label"]),O(d,{label:c.$t("attributes.opacity")},{default:L(()=>[O(u,{modelValue:T(A).opacity,"onUpdate:modelValue":l[6]||(l[6]=p=>T(A).opacity=p),onOnInput:l[7]||(l[7]=p=>f("opacity",p))},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})],512),[[we,g.includes(T(n).mSelectOneType)]])])):Ct("",!0)}}}),mI=xt(AI,[["__scopeId","data-v-edbd74ba"]]);const vI=e=>(te("data-v-90da8e6a"),e=e(),ee(),e),yI={key:0,class:"box attr-item-box"},_I=vI(()=>M("h4",null,"数据",-1)),CI=bt({name:"AttrBute"}),wI=Object.assign(CI,{setup(e){const t=ye(),{mixinState:n,canvasEditor:o}=kt(),g=zt({id:0,linkData:["",""]}),A=i=>{const c=o.canvas.getActiveObject();i&&i.target&&i.target!==c||c&&(g.id=c.get("id"),g.linkData=c.get("linkData")||["",""])},v=(i,c)=>{const l=o.canvas.getActiveObjects()[0];l&&(l&&l.set(i,c),o.canvas.renderAll())},f=()=>{var i;(i=t==null?void 0:t.proxy)==null||i.$forceUpdate()};return Qt(()=>{A(),o.on("selectCancel",f),o.on("selectOne",A),o.canvas.on("object:modified",A)}),de(()=>{o.off("selectCancel",f),o.off("selectOne",A),o.canvas.off("object:modified",A)}),(i,c)=>{const l=z("Divider"),r=z("Input"),a=z("FormItem"),s=z("Form"),u=z("Option"),d=z("Select"),h=z("Col"),p=z("Row");return T(n).mSelectMode==="one"?(Z(),ut("div",yI,[O(l,{plain:"",orientation:"left"},{default:L(()=>[_I]),_:1}),O(s,{"label-width":40,class:"form-wrap"},{default:L(()=>[O(a,{label:i.$t("attributes.id")},{default:L(()=>[O(r,{modelValue:T(g).id,"onUpdate:modelValue":c[0]||(c[0]=m=>T(g).id=m),onOnChange:c[1]||(c[1]=m=>v("id",T(g).id)),size:"small"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),O(p,{gutter:10},{default:L(()=>[O(h,{flex:"1"},{default:L(()=>[O(d,{modelValue:T(g).linkData[0],"onUpdate:modelValue":c[2]||(c[2]=m=>T(g).linkData[0]=m),filterable:"","allow-create":"",onOnChange:c[3]||(c[3]=m=>v("linkData",T(g).linkData))},{default:L(()=>[O(u,{value:"src"}),O(u,{value:"text"})]),_:1},8,["modelValue"])]),_:1}),O(h,{flex:"1"},{default:L(()=>[O(r,{modelValue:T(g).linkData[1],"onUpdate:modelValue":c[4]||(c[4]=m=>T(g).linkData[1]=m),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1})])):Ct("",!0)}}}),bI=xt(wI,[["__scopeId","data-v-90da8e6a"]]);const SI=e=>(te("data-v-9137c42e"),e=e(),ee(),e),EI={key:0,class:"box attr-item-box"},II=SI(()=>M("h4",null,"阴影",-1)),xI={class:"ivu-col__box"},BI={class:"label"},TI={class:"content"},OI=bt({name:"AttrBute"}),kI=Object.assign(OI,{setup(e){const t=ye(),{fabric:n,mixinState:o,canvasEditor:g}=kt(),A=zt({shadow:{}}),v=c=>{const l=g.canvas.getActiveObject();c&&c.target&&c.target!==l||l&&(A.shadow=l.get("shadow")||{})},f=()=>{const c=g.canvas.getActiveObjects()[0];c&&(c.set("shadow",new n.Shadow(A.shadow)),g.canvas.renderAll())},i=()=>{var c;(c=t==null?void 0:t.proxy)==null||c.$forceUpdate()};return Qt(()=>{v(),g.on("selectCancel",i),g.on("selectOne",v),g.canvas.on("object:modified",v)}),de(()=>{g.off("selectCancel",i),g.off("selectOne",v),g.canvas.off("object:modified",v)}),(c,l)=>{const r=z("Divider"),a=z("ColorPicker"),s=z("Col"),u=z("Row");return T(o).mSelectMode==="one"?(Z(),ut("div",EI,[O(r,{plain:"",orientation:"left"},{default:L(()=>[II]),_:1}),M("div",null,[O(u,{gutter:10},{default:L(()=>[O(s,{flex:"1"},{default:L(()=>[M("div",xI,[M("span",BI,gt(c.$t("color")),1),M("div",TI,[O(a,{modelValue:T(A).shadow.color,"onUpdate:modelValue":l[0]||(l[0]=d=>T(A).shadow.color=d),onOnChange:f,alpha:""},null,8,["modelValue"])])])]),_:1}),O(s,{flex:"1"},{default:L(()=>[O(T(Qe),{modelValue:T(A).shadow.blur,"onUpdate:modelValue":l[1]||(l[1]=d=>T(A).shadow.blur=d),defaultValue:0,onOnChange:f,append:c.$t("attributes.blur"),min:0},null,8,["modelValue","append"])]),_:1})]),_:1}),M("div",null,[O(u,{gutter:10},{default:L(()=>[O(s,{flex:"1"},{default:L(()=>[O(T(Qe),{modelValue:T(A).shadow.offsetX,"onUpdate:modelValue":l[2]||(l[2]=d=>T(A).shadow.offsetX=d),defaultValue:0,onOnChange:f,append:c.$t("attributes.offset_x")},null,8,["modelValue","append"])]),_:1}),O(s,{flex:"1"},{default:L(()=>[O(T(Qe),{modelValue:T(A).shadow.offsetY,"onUpdate:modelValue":l[3]||(l[3]=d=>T(A).shadow.offsetY=d),defaultValue:0,onOnChange:f,append:c.$t("attributes.offset_y")},null,8,["modelValue","append"])]),_:1})]),_:1})])])])):Ct("",!0)}}}),DI=xt(kI,[["__scopeId","data-v-9137c42e"]]);const MI=e=>(te("data-v-88d3a189"),e=e(),ee(),e),PI={key:0,class:"box attr-item-box"},QI=MI(()=>M("h4",null,"边框",-1)),LI={class:"ivu-col__box"},FI={class:"label"},RI={class:"content"},jI={class:"ivu-col__box"},$I={class:"label"},NI={class:"content"},UI=bt({name:"AttrBute"}),HI=Object.assign(UI,{setup(e){const t=ye(),{mixinState:n,canvasEditor:o}=kt(),g=zt({stroke:"#fff",strokeWidth:0,strokeDashArray:[]}),A=[{value:{strokeUniform:!0,strokeDashArray:[],strokeLineCap:"butt"},label:"Stroke"},{value:{strokeUniform:!0,strokeDashArray:[1,10],strokeLineCap:"butt"},label:"Dash-1"},{value:{strokeUniform:!0,strokeDashArray:[1,10],strokeLineCap:"round"},label:"Dash-2"},{value:{strokeUniform:!0,strokeDashArray:[15,15],strokeLineCap:"square"},label:"Dash-3"},{value:{strokeUniform:!0,strokeDashArray:[15,15],strokeLineCap:"round"},label:"Dash-4"},{value:{strokeUniform:!0,strokeDashArray:[25,25],strokeLineCap:"square"},label:"Dash-5"},{value:{strokeUniform:!0,strokeDashArray:[25,25],strokeLineCap:"round"},label:"Dash-6"},{value:{strokeUniform:!0,strokeDashArray:[1,8,16,8,1,20],strokeLineCap:"square"},label:"Dash-7"},{value:{strokeUniform:!0,strokeDashArray:[1,8,16,8,1,20],strokeLineCap:"round"},label:"Dash-8"}],v=l=>{const r=o.canvas.getActiveObject();if(!(l&&l.target&&l.target!==r)&&r){g.stroke=r.get("stroke"),g.strokeWidth=r.get("strokeWidth");const a=JSON.stringify(r.get("strokeDashArray")||[]),s=A.find(u=>JSON.stringify(u.value.strokeDashArray)===a&&r.get("strokeLineCap")===u.value.strokeLineCap);s&&(g.strokeDashArray=s.label)}},f=(l,r)=>{const a=o.canvas.getActiveObjects()[0];a&&(a.set(l,r),a.set("strokeUniform",!0),o.canvas.renderAll())},i=l=>{const r=o.canvas.getActiveObjects()[0];if(r){const a=A.find(s=>s.label===l);r.set(a.value),o.canvas.renderAll()}},c=()=>{var l;(l=t==null?void 0:t.proxy)==null||l.$forceUpdate()};return Qt(()=>{v(),o.on("selectCancel",c),o.on("selectOne",v),o.canvas.on("object:modified",v)}),de(()=>{o.off("selectCancel",c),o.off("selectOne",v),o.canvas.off("object:modified",v)}),(l,r)=>{const a=z("Divider"),s=z("ColorPicker"),u=z("Col"),d=z("Row"),h=z("Option"),p=z("Select");return T(n).mSelectMode==="one"?(Z(),ut("div",PI,[O(a,{plain:"",orientation:"left"},{default:L(()=>[QI]),_:1}),M("div",null,[O(d,{gutter:12},{default:L(()=>[O(u,{flex:"1"},{default:L(()=>[M("div",LI,[M("span",FI,gt(l.$t("color")),1),M("div",RI,[O(s,{modelValue:T(g).stroke,"onUpdate:modelValue":r[0]||(r[0]=m=>T(g).stroke=m),onOnChange:r[1]||(r[1]=m=>f("stroke",m)),alpha:""},null,8,["modelValue"])])])]),_:1}),O(u,{flex:"1"},{default:L(()=>[O(T(Qe),{modelValue:T(g).strokeWidth,"onUpdate:modelValue":r[2]||(r[2]=m=>T(g).strokeWidth=m),onOnChange:r[3]||(r[3]=m=>f("strokeWidth",m)),append:l.$t("width"),min:0},null,8,["modelValue","append"])]),_:1})]),_:1}),O(d,{gutter:12},{default:L(()=>[O(u,{flex:"1"},{default:L(()=>[M("div",jI,[M("span",$I,gt(l.$t("attributes.stroke")),1),M("div",NI,[O(p,{modelValue:T(g).strokeDashArray,"onUpdate:modelValue":r[4]||(r[4]=m=>T(g).strokeDashArray=m),onOnChange:i},{default:L(()=>[(Z(),ut(Pt,null,Gt(A,m=>O(h,{value:m.label,key:`stroke-${m.label}`},{default:L(()=>[vt(gt(m.label),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"])])])]),_:1})]),_:1})])])):Ct("",!0)}}}),GI=xt(HI,[["__scopeId","data-v-88d3a189"]]);const zI=e=>(te("data-v-7b284bf9"),e=e(),ee(),e),YI={key:0,class:"box attr-item-box"},VI=zI(()=>M("h4",null,"字体属性",-1)),WI={class:"flex-view"},XI={class:"flex-item"},JI={class:"left font-selector"},KI={style:{display:"none"}},qI={class:"right"},ZI={class:"flex-view"},tx={class:"flex-item"},ex=["innerHTML"],nx={class:"flex-view"},ix={class:"flex-item"},rx={viewBox:"0 0 1024 1024",width:"14",height:"14"},sx=["fill"],ox={viewBox:"0 0 1024 1024",width:"14",height:"14"},ax=["fill"],lx={viewBox:"0 0 1024 1024",width:"14",height:"14"},cx=["fill"],ux={viewBox:"0 0 1024 1024",width:"14",height:"14"},hx=["fill"],fx={class:"flex-view"},dx={class:"flex-item"},gx={class:"label"},px={class:"content"},Ax=bt({name:"AttrBute"}),mx=Object.assign(Ax,{setup(e){const t=ye(),{mixinState:n,canvasEditor:o}=kt(),g=["i-text","textbox","text"],A=zt({fontSize:0,fontFamily:"",lineHeight:0,charSpacing:0,fontWeight:"",textBackgroundColor:"#fff",textAlign:"",fontStyle:"",underline:!1,linethrough:!1,overline:!1}),v=ft([]);o.getFontList().then(p=>{v.value=p});const f=["left","center","right"],i=['<svg t="1650441458823" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3554" width="18" height="18"><path d="M198.4 198.4h341.333333c8.533333 0 14.933333 2.133333 19.2 8.533333 6.4 6.4 8.533333 12.8 8.533334 19.2v57.6c0 8.533333-2.133333 14.933333-8.533334 19.2-6.4 6.4-12.8 8.533333-19.2 8.533334h-341.333333c-8.533333 0-14.933333-2.133333-19.2-8.533334-6.4-6.4-8.533333-12.8-8.533333-19.2v-57.6c0-8.533333 2.133333-14.933333 8.533333-19.2 4.266667-4.266667 12.8-8.533333 19.2-8.533333z m0 170.666667h569.6c8.533333 0 14.933333 2.133333 19.2 8.533333 6.4 6.4 8.533333 12.8 8.533333 19.2v57.6c0 8.533333-2.133333 14.933333-8.533333 19.2-6.4 6.4-12.8 8.533333-19.2 8.533333h-569.6c-8.533333 0-14.933333-2.133333-19.2-8.533333-6.4-6.4-8.533333-12.8-8.533333-19.2v-57.6c0-8.533333 2.133333-14.933333 8.533333-19.2 4.266667-4.266667 12.8-8.533333 19.2-8.533333z m0 170.666666h454.4c8.533333 0 14.933333 2.133333 19.2 8.533334 6.4 6.4 8.533333 12.8 8.533333 19.2v57.6c0 8.533333-2.133333 14.933333-8.533333 19.2-6.4 6.4-12.8 8.533333-19.2 8.533333h-454.4c-8.533333 0-14.933333-2.133333-19.2-8.533333-6.4-6.4-8.533333-12.8-8.533333-19.2v-57.6c0-8.533333 2.133333-14.933333 8.533333-19.2 4.266667-4.266667 12.8-8.533333 19.2-8.533334z m0 170.666667h625.066667c8.533333 0 14.933333 2.133333 19.2 8.533333 6.4 6.4 8.533333 12.8 8.533333 19.2v57.6c0 8.533333-2.133333 14.933333-8.533333 19.2-6.4 6.4-12.8 8.533333-19.2 8.533334h-625.066667c-8.533333 0-14.933333-2.133333-19.2-8.533334-6.4-6.4-8.533333-12.8-8.533333-19.2v-57.6c0-8.533333 2.133333-14.933333 8.533333-19.2 4.266667-4.266667 12.8-8.533333 19.2-8.533333z" p-id="3555"></path></svg>','<svg t="1650441512015" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3704" width="18" height="18"><path d="M313.6 198.4h398.933333c8.533333 0 14.933333 2.133333 19.2 8.533333 6.4 6.4 8.533333 12.8 8.533334 19.2v57.6c0 8.533333-2.133333 14.933333-8.533334 19.2-6.4 6.4-12.8 8.533333-19.2 8.533334h-398.933333c-8.533333 0-14.933333-2.133333-19.2-8.533334-6.4-6.4-8.533333-12.8-8.533333-19.2v-57.6c0-8.533333 2.133333-14.933333 8.533333-19.2 4.266667-4.266667 10.666667-8.533333 19.2-8.533333z m-115.2 170.666667h625.066667c8.533333 0 14.933333 2.133333 19.2 8.533333 6.4 6.4 8.533333 12.8 8.533333 19.2v57.6c0 8.533333-2.133333 14.933333-8.533333 19.2-6.4 6.4-12.8 8.533333-19.2 8.533333h-625.066667c-8.533333 0-14.933333-2.133333-19.2-8.533333-6.4-6.4-8.533333-12.8-8.533333-19.2v-57.6c0-8.533333 2.133333-14.933333 8.533333-19.2 4.266667-4.266667 12.8-8.533333 19.2-8.533333z m115.2 170.666666h398.933333c8.533333 0 14.933333 2.133333 19.2 8.533334 6.4 6.4 8.533333 12.8 8.533334 19.2v57.6c0 8.533333-2.133333 14.933333-8.533334 19.2-6.4 6.4-12.8 8.533333-19.2 8.533333h-398.933333c-8.533333 0-14.933333-2.133333-19.2-8.533333-6.4-6.4-8.533333-12.8-8.533333-19.2v-57.6c0-8.533333 2.133333-14.933333 8.533333-19.2 4.266667-4.266667 10.666667-8.533333 19.2-8.533334z m-115.2 170.666667h625.066667c8.533333 0 14.933333 2.133333 19.2 8.533333 6.4 6.4 8.533333 12.8 8.533333 19.2v57.6c0 8.533333-2.133333 14.933333-8.533333 19.2-6.4 6.4-12.8 8.533333-19.2 8.533334h-625.066667c-8.533333 0-14.933333-2.133333-19.2-8.533334-6.4-6.4-8.533333-12.8-8.533333-19.2v-57.6c0-8.533333 2.133333-14.933333 8.533333-19.2 4.266667-4.266667 12.8-8.533333 19.2-8.533333z" p-id="3705"></path></svg>','<svg t="1650441519862" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3854" width="18" height="18"><path d="M454.4 283.733333v-57.6c0-8.533333 2.133333-14.933333 8.533333-19.2 6.4-6.4 12.8-8.533333 19.2-8.533333h341.333334c8.533333 0 14.933333 2.133333 19.2 8.533333 6.4 6.4 8.533333 12.8 8.533333 19.2v57.6c0 8.533333-2.133333 14.933333-8.533333 19.2-6.4 6.4-12.8 8.533333-19.2 8.533334h-341.333334c-8.533333 0-14.933333-2.133333-19.2-8.533334-4.266667-4.266667-8.533333-10.666667-8.533333-19.2z m-226.133333 170.666667v-57.6c0-8.533333 2.133333-14.933333 8.533333-19.2 6.4-6.4 12.8-8.533333 19.2-8.533333h569.6c8.533333 0 14.933333 2.133333 19.2 8.533333 6.4 6.4 8.533333 12.8 8.533333 19.2v57.6c0 8.533333-2.133333 14.933333-8.533333 19.2-6.4 6.4-12.8 8.533333-19.2 8.533333H256c-8.533333 0-14.933333-2.133333-19.2-8.533333-6.4-4.266667-8.533333-10.666667-8.533333-19.2z m113.066666 170.666667v-57.6c0-8.533333 2.133333-14.933333 8.533334-19.2 6.4-6.4 12.8-8.533333 19.2-8.533334h454.4c8.533333 0 14.933333 2.133333 19.2 8.533334 6.4 6.4 8.533333 12.8 8.533333 19.2v57.6c0 8.533333-2.133333 14.933333-8.533333 19.2-6.4 6.4-12.8 8.533333-19.2 8.533333h-454.4c-8.533333 0-14.933333-2.133333-19.2-8.533333-6.4-4.266667-8.533333-10.666667-8.533334-19.2z m-170.666666 170.666666v-57.6c0-8.533333 2.133333-14.933333 8.533333-19.2 6.4-6.4 12.8-8.533333 19.2-8.533333h625.066667c8.533333 0 14.933333 2.133333 19.2 8.533333 6.4 6.4 8.533333 12.8 8.533333 19.2v57.6c0 8.533333-2.133333 14.933333-8.533333 19.2-6.4 6.4-12.8 8.533333-19.2 8.533334h-625.066667c-8.533333 0-14.933333-2.133333-19.2-8.533334-6.4-4.266667-8.533333-10.666667-8.533333-19.2z" p-id="3855"></path></svg>'],c=p=>{const m=o.canvas.getActiveObject();p&&p.target&&p.target!==m||m&&g.includes(m.type)&&(A.fontSize=m.get("fontSize"),A.fontFamily=m.get("fontFamily"),A.lineHeight=m.get("lineHeight"),A.textAlign=m.get("textAlign"),A.underline=m.get("underline"),A.linethrough=m.get("linethrough"),A.charSpacing=m.get("charSpacing"),A.overline=m.get("overline"),A.fontStyle=m.get("fontStyle"),A.textBackgroundColor=m.get("textBackgroundColor"),A.fontWeight=m.get("fontWeight"))},l=(p,m)=>{const y=o.canvas.getActiveObjects()[0];y&&(y&&y.set(p,m),o.canvas.renderAll())},r=()=>{var p;(p=t==null?void 0:t.proxy)==null||p.$forceUpdate()},a=p=>_t(this,null,function*(){p&&(Bt.Spin.show(),o.loadFont(p).finally(()=>Bt.Spin.hide()))}),s=(p,m)=>{const y=m==="normal"?"bold":"normal";A.fontWeight=y;const _=o.canvas.getActiveObjects()[0];_&&_.set(p,y),o.canvas.renderAll()},u=(p,m)=>{const y=m==="normal"?"italic":"normal";A.fontStyle=y;const _=o.canvas.getActiveObjects()[0];_&&_.set(p,y),o.canvas.renderAll()},d=(p,m)=>{const y=m===!1;A.linethrough=y;const _=o.canvas.getActiveObjects()[0];_&&_.set(p,y),o.canvas.renderAll()},h=(p,m)=>{const y=m===!1;A.underline=y;const _=o.canvas.getActiveObjects()[0];_&&_.set(p,y),o.canvas.renderAll()};return Qt(()=>{c(),o.on("selectCancel",r),o.on("selectOne",c),o.canvas.on("object:modified",c)}),de(()=>{o.off("selectCancel",r),o.off("selectOne",c),o.canvas.off("object:modified",c)}),(p,m)=>{const y=z("Divider"),_=z("Option"),C=z("Select"),w=z("Radio"),b=z("RadioGroup"),S=z("Button"),F=z("ButtonGroup"),$=z("Col"),Q=z("Row"),R=z("ColorPicker");return T(n).mSelectMode==="one"&&g.includes(T(n).mSelectOneType)?(Z(),ut("div",YI,[O(y,{plain:"",orientation:"left"},{default:L(()=>[VI]),_:1}),M("div",null,[M("div",WI,[M("div",XI,[M("div",JI,[O(C,{modelValue:T(A).fontFamily,"onUpdate:modelValue":m[0]||(m[0]=H=>T(A).fontFamily=H),onOnChange:a},{default:L(()=>[(Z(!0),ut(Pt,null,Gt(T(v),H=>(Z(),wt(_,{value:H.name,key:`font-${H.name}`},{default:L(()=>[M("div",{class:"font-item",style:me(`background-image:url('${H.img}');`)},[vt(gt(H.img?"":H)+" ",1),M("span",KI,gt(H.name),1)],4)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),M("div",qI,[O(T(Qe),{modelValue:T(A).fontSize,"onUpdate:modelValue":m[1]||(m[1]=H=>T(A).fontSize=H),onOnChange:m[2]||(m[2]=H=>l("fontSize",H)),append:"字号",min:1},null,8,["modelValue"])])])]),M("div",ZI,[M("div",tx,[O(b,{class:"button-group",modelValue:T(A).textAlign,"onUpdate:modelValue":m[3]||(m[3]=H=>T(A).textAlign=H),onOnChange:m[4]||(m[4]=H=>l("textAlign",H)),type:"button"},{default:L(()=>[(Z(),ut(Pt,null,Gt(f,(H,W)=>O(w,{label:H,key:H},{default:L(()=>[M("span",{innerHTML:i[W]},null,8,ex)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])])]),M("div",nx,[M("div",ix,[O(F,{class:"button-group"},{default:L(()=>[O(S,{onClick:m[5]||(m[5]=H=>s("fontWeight",T(A).fontWeight))},{default:L(()=>[(Z(),ut("svg",rx,[M("path",{d:"M793.99865 476a244 244 0 0 0 54-130.42C862.75865 192.98 743.01865 64 593.85865 64H195.01865a32 32 0 0 0-32 32v96a32 32 0 0 0 32 32h63.74v576H195.01865a32 32 0 0 0-32 32v96a32 32 0 0 0 32 32h418.64c141.6 0 268.28-103.5 282-244.8 9.48-96.9-32.78-184.12-101.66-239.2zM418.33865 224h175.52a96 96 0 0 1 0 192h-175.52z m175.52 576h-175.52V576h175.52a112 112 0 0 1 0 224z",fill:T(A).fontWeight==="bold"?"#305ef4":"#666"},null,8,sx)]))]),_:1}),O(S,{onClick:m[6]||(m[6]=H=>u("fontStyle",T(A).fontStyle))},{default:L(()=>[(Z(),ut("svg",ox,[M("path",{d:"M832 96v64a32 32 0 0 1-32 32h-125.52l-160 640H608a32 32 0 0 1 32 32v64a32 32 0 0 1-32 32H224a32 32 0 0 1-32-32v-64a32 32 0 0 1 32-32h125.52l160-640H416a32 32 0 0 1-32-32V96a32 32 0 0 1 32-32h384a32 32 0 0 1 32 32z",fill:T(A).fontStyle==="italic"?"#305ef4":"#666"},null,8,ax)]))]),_:1}),O(S,{onClick:m[7]||(m[7]=H=>d("linethrough",T(A).linethrough))},{default:L(()=>[(Z(),ut("svg",lx,[M("path",{d:"M893.088 501.792H125.344a32 32 0 0 0 0 64h767.744a32 32 0 0 0 0-64zM448 448h112V208h288V96H160v112h288zM448 640h112v288H448z",fill:T(A).linethrough?"#305ef4":"#666"},null,8,cx)]))]),_:1}),O(S,{onClick:m[8]||(m[8]=H=>h("underline",T(A).underline))},{default:L(()=>[(Z(),ut("svg",ux,[M("path",{d:"M703.232 67.008h127.488v413.248c0 158.016-142.656 286.016-318.72 286.016-176 0-318.72-128-318.72-286.016V67.008h127.488v413.248c0 39.872 18.176 78.144 51.136 107.776 36.8 32.96 86.528 51.072 140.096 51.072s103.36-18.112 140.032-51.136c33.024-29.632 51.2-67.968 51.2-107.776V67.008zM193.28 871.616h637.44v85.376H193.28v-85.376z",fill:T(A).underline?"#305ef4":"#666"},null,8,hx)]))]),_:1})]),_:1})])]),O(Q,{gutter:12},{default:L(()=>[O($,{flex:"1"},{default:L(()=>[O(T(Qe),{modelValue:T(A).lineHeight,"onUpdate:modelValue":m[9]||(m[9]=H=>T(A).lineHeight=H),onOnChange:m[10]||(m[10]=H=>l("lineHeight",H)),step:.1,append:p.$t("attributes.line_height")},null,8,["modelValue","append"])]),_:1}),O($,{flex:"1"},{default:L(()=>[O(T(Qe),{modelValue:T(A).charSpacing,"onUpdate:modelValue":m[11]||(m[11]=H=>T(A).charSpacing=H),onOnChange:m[12]||(m[12]=H=>l("charSpacing",H)),append:p.$t("attributes.char_spacing")},null,8,["modelValue","append"])]),_:1})]),_:1}),M("div",fx,[M("div",dx,[M("span",gx,gt(p.$t("background")),1),M("div",px,[O(R,{modelValue:T(A).textBackgroundColor,"onUpdate:modelValue":m[13]||(m[13]=H=>T(A).textBackgroundColor=H),onOnChange:m[14]||(m[14]=H=>l("textBackgroundColor",H)),alpha:""},null,8,["modelValue"])])])])])])):Ct("",!0)}}}),vx=xt(mx,[["__scopeId","data-v-7b284bf9"]]),lc=(e,{decimal:t=0}={})=>t>0?Number(e.toFixed(t)):Math.round(e),ki=(e,{onmousedown:t,onmousemove:n,onmouseup:o}={})=>{let g=e.getBoundingClientRect();const A={x:0,y:0},v=l=>{let r=l.pageX-g.x,a=l.pageY-g.y;r<0&&(r=0),r>g.width&&(r=g.width),a<0&&(a=0),a>g.height&&(a=g.height),A.x=lc(r/g.width,{decimal:2}),A.y=lc(a/g.height,{decimal:2})},f=l=>{v(l),n&&n(A,l)},i=l=>{document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",i),o&&o(A,l)},c=l=>{g=e.getBoundingClientRect(),v(l),document.addEventListener("mousemove",f),document.addEventListener("mouseup",i),t&&t(A,l)};return e.addEventListener("mousedown",c),{destroy(){e.removeEventListener("mousedown",c)}}},Gh=(e,t,n)=>{let o=Math.round(e).toString(16),g=Math.round(t).toString(16),A=Math.round(n).toString(16);return o.length===1&&(o="0"+o),g.length===1&&(g="0"+g),A.length===1&&(A="0"+A),"#"+o+g+A},cc=(e,t,n,o=1)=>{const g=Gh(e,t,n);let A=Math.round(o*255).toString(16);return A.length===1&&(A="0"+A),g+A},zh=(e,t,n)=>{e/=255,t/=255,n/=255;const o=Math.min(e,t,n),g=Math.max(e,t,n),A=g-o;let v=0,f=0;const i=g;if(A===0)v=f=0;else{f=A/g;const c=((g-e)/6+A/2)/A,l=((g-t)/6+A/2)/A,r=((g-n)/6+A/2)/A;e===g?v=r-l:t===g?v=1/3+c-r:n===g&&(v=2/3+l-c),v<0?v+=1:v>1&&(v-=1)}return[v*360,f*100,i*100]},yx=(e,t,n,o=1)=>[...zh(e,t,n),o];function _x(e,t,n){e=e/360*6,t/=100,n/=100;const o=Math.floor(e),g=e-o,A=n*(1-t),v=n*(1-g*t),f=n*(1-(1-g)*t),i=o%6,c=[n,v,A,A,f,n][i],l=[f,n,n,v,A,A][i],r=[A,A,f,n,n,v][i];return[Math.round(c*255),Math.round(l*255),Math.round(r*255)]}const Cx=(e,t,n)=>{const[o,g,A]=_x(e,t,n);return Gh(o,g,A)},wx=(e,t,n,o=1)=>`${Cx(e,t,n)}${o===0?"00":Math.round(o*255).toString(16)}`,ao=e=>{e=e.slice(0,7);let t=0,n=0,o=0;return e.length==4?(t=+("0x"+e[1]+e[1]),n=+("0x"+e[2]+e[2]),o=+("0x"+e[3]+e[3])):e.length==7&&(t=+("0x"+e[1]+e[2]),n=+("0x"+e[3]+e[4]),o=+("0x"+e[5]+e[6])),[t,n,o]},lo=e=>{const t=ao(e),n=+("0x"+e[7]+e[8]);return[...t,Number((n/255).toFixed(2))]},bx=e=>{const[t,n,o,g]=lo(e);return yx(t,n,o,g)},uc=e=>e.startsWith("#")?"纯色":e.startsWith("linear-gradient")?"渐变":"图案",us=(e,t)=>{const n=[];return t.forEach(o=>{n.push(`${o.color} ${o.offset*100}%`)}),`linear-gradient(${e}deg, ${n.join(",")})`};function Sx(e){const t=Ex(e);document.body.appendChild(t),setTimeout(()=>{var n;return(n=t==null?void 0:t.parentNode)==null?void 0:n.removeChild(t)},2e3)}function Ex(e,t=!0){const n=document.createElement("div");return n.id="color-pipette-tooltip-container",n.innerHTML=e,n.style=`
    position: fixed;
    left: 50%;
    top: 9%;
    z-index: 10002;
    display: ${t?"flex":"none"};
    align-items: center;
    background-color: rgba(0,0,0,0.4);
    padding: 6px 12px;
    border-radius: 4px;
    color: #fff;
    font-size: 18px;
    pointer-events: none;
  `,n}const Ix={class:"my-tabs"},xx={class:"my-tabs__header p-0.5 mb-3 rounded bg-gray-100 cursor-pointers"},Bx={class:"my-tabs__header-shell relative flex justify-between"},Tx=["onClick"],Ox={class:"my-tabs__content"},kx={name:"Tabs"},Dx=Object.assign(kx,{props:{value:{type:String,required:!0}},emits:["update:value","change"],setup(e,{expose:t,emit:n}){const o=e,g=n;ge(()=>o.value,()=>{c()});const A=ft([]),v=zt({width:0,left:0});let f=0;Qt(()=>{f=100/A.value.length,v.width=`${f}%`,c()});let i=null;function c(r=-1){return _t(this,null,function*(){var a,s,u,d;r<0&&(r=A.value.findIndex(h=>h.props.label===o.value)),v.left=`${f*r}%`;try{yield lr(),(s=(a=i==null?void 0:i.exposed)==null?void 0:a.changeActive)==null||s.call(a,!1),i=A.value[r],(d=(u=i.exposed)==null?void 0:u.changeActive)==null||d.call(u,!0)}catch(h){console.log(h)}})}function l(r,a){g("update:value",r.props.label),c(a)}return t({tabs:A}),(r,a)=>(Z(),ut("div",Ix,[M("div",xx,[M("div",Bx,[(Z(!0),ut(Pt,null,Gt(A.value,(s,u)=>(Z(),ut("div",{key:s.props.label,class:Xt(["my-tab__title relative flex-auto py-1 text-center",{"my-active":s.props.label===e.value}]),onClick:d=>l(s,u)},gt(s.props.label),11,Tx))),128)),M("div",{class:"my-tab__slider",style:me(v)},null,4)])]),M("div",Ox,[Wi(r.$slots,"default",{},void 0,!0)])]))}}),Mx=xt(Dx,[["__scopeId","data-v-77aef3cc"]]),Px={},Qx={t:"1685345224620",class:"sd-xggj",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8489",width:"20",height:"20"},Lx=M("path",{d:"M716.288 140.501333a42.666667 42.666667 0 0 1 60.373333 0l90.496 90.496a42.666667 42.666667 0 0 1 0 60.330667l-120.661333 120.704L595.626667 261.12l120.661333-120.661333zM520.192 185.770667l301.696 301.653333-60.330667 60.373333-301.653333-301.696 60.288-60.330666z","p-id":"8490"},null,-1),Fx=M("path",{d:"M580.565333 366.762667l-60.373333-60.330667-362.026667 362.026667V853.333333l181.034667-3.84 362.026667-362.026666-60.330667-60.373334-331.861333 331.904-60.373334-60.373333 331.904-331.861333z","p-id":"8491"},null,-1),Rx=[Lx,Fx];function jx(e,t){return Z(),ut("svg",Qx,Rx)}const $x=xt(Px,[["render",jx]]),Nx={name:"TabPanel"},Ux=Object.assign(Nx,{props:{label:{type:String,required:!0}},setup(e,{expose:t}){const n=ye();n.parent.exposed.tabs.value.push(n);const o=ft(!1),g=ie(()=>({display:o.value?"block":"none"}));function A(v){o.value=v}return t({changeActive:A}),(v,f)=>(Z(),ut("div",{class:"tab-panel",style:me(g.value)},[Wi(v.$slots,"default")],4))}}),Hx=bt({props:["modelValue"],emits:["change","update:modelValue"],setup(e,{emit:t}){const n=ft(90),o=ft(null),g=ie(()=>n.value-90);let A=!1;const v=ft(!1),f=l=>{t("change",l)};return ge(()=>n.value,l=>{e.modelValue!==n.value&&t("update:modelValue",l),t("change")}),ge(()=>e.modelValue,l=>{n.value=l}),{inputChange:f,num:n,turn:l=>{if(!A)return;const r={x:27,y:27},a=l.offsetX-r.x,s=l.offsetY-r.y,d=Math.atan2(s,a)*180/Math.PI;n.value=Math.round(d+90)},touch:(l,r)=>{l.preventDefault(),A=r},angleInDegrees:g,numInput:o,visiable:v}}});const Gx={class:"angle-input-box"};function zx(e,t,n,o,g,A){return Z(),ut("div",Gx,[Ae(M("input",{ref:"numInput","onUpdate:modelValue":t[0]||(t[0]=v=>e.num=v),class:"angle-input",onFocus:t[1]||(t[1]=v=>e.visiable=!0),onBlur:t[2]||(t[2]=v=>e.visiable=!1),onInput:t[3]||(t[3]=(...v)=>e.inputChange&&e.inputChange(...v))},null,544),[[hf,e.num]]),Ae(M("div",{class:"AngleHandle",onMousedown:t[6]||(t[6]=v=>e.touch(v,!0)),onMouseup:t[7]||(t[7]=v=>e.touch(v,!1))},[M("div",{class:"angle",onMouseup:t[4]||(t[4]=(...v)=>e.turn&&e.turn(...v)),onMousemove:t[5]||(t[5]=(...v)=>e.turn&&e.turn(...v))},[M("div",{style:me(`transform: rotate(${e.angleInDegrees}deg)`),class:"line"},null,4)],32)],544),[[we,e.visiable]])])}const Yx=xt(Hx,[["render",zx]]);const Yh=e=>(te("data-v-31f3c419"),e=e(),ee(),e),Vx={class:"color-picker"},Wx={key:1,class:"title"},Xx={key:2,class:"cp__gradient flex-center"},Jx={class:"cp__gradient-bar"},Kx=["data-sort","onMousedown"],qx=Yh(()=>M("div",{class:"cpp__color-saturation"},null,-1)),Zx=Yh(()=>M("div",{class:"cpp__color-value"},null,-1)),tB={class:"cps__track"},eB={class:"cps__track"},nB={class:"cp__box"},iB=["value"],rB=["value"],sB=["onClick"],oB={name:"ColorPicker",inheritAttrs:!1},aB=Object.assign(oB,{props:{value:{type:String,default:"#ffffffff"},modes:{type:Array,default:()=>["纯色","渐变"]},defaultColor:{type:String,default:"#ffffffff"},defaultGradient:{type:String,default:"linear-gradient(90deg, #fffae0ff 0%, #ffd1f1ff 100%)"},defaultImage:{type:String,default:"https://st0.dancf.com/csc/157/material-2d-textures/0/20190714-174653-ed3c.jpg"}},emits:["update:value","change","native-pick","blur"],setup(e,{emit:t}){const n=e,o=t,g=ft(uc(n.value)),A=ft(90),v=ft([]),f=zt({h:0,s:0,l:0,a:0}),i=ft("#f00"),c=ft("#000"),l=ft(0);let r=ft({});const a="EyeDropper"in window,s=ft(),u=ft(),d=ft(),h=ft(),p=ft(),m=ft(),y=ft();let _=null,C=null,w=null,b=null,S=null,F=!0,$=null;const Q=ft([]),R={color:n.defaultColor,gradient:n.defaultGradient,image:n.defaultImage},H=ie(()=>n.modes.includes("渐变")),W=ie(()=>{const U=ao(c.value).join(",");return{background:`linear-gradient(to right, rgba(${U}, 0) 0%, rgb(${U}) 100%)`}});ge(r,U=>{I(U.color)}),ge(c,U=>{N(U)}),ge(()=>n.value,U=>{const j=uc(U);j!==g.value&&(g.value=j),D(j),x(U),G(U)});const G=_n(U=>_t(this,null,function*(){const j=Q.value,K=j.indexOf(U);K!==-1&&Q.value.splice(K,1),j.length>=4&&Q.value.splice(j.length-1,1);const it=[U];Q.value=it.concat(j)}),300),V=ge(f,st,{deep:!0});function st(U){const j=wx(...Object.values(U));let K;g.value==="纯色"?K=j:g.value==="渐变"&&(r.value.color=j,K=us(A.value,v.value)),Y(j),B(K)}Qt(et);function et(){return _t(this,null,function*(){d.value.style.left=`${f.s}%`,d.value.style.top=`${100-f.l}%`,h.value.style.left=`${f.h/360*100}%`,m.value.style.left=`${f.a*100}%`,H.value&&(_=ki(s.value,{onmousedown:U,onmousemove:j,onmouseup:K}));function U(ht){if(S)return;const yt=v.value.findIndex(Yt=>Yt.offset>=ht.x),At=v.value[yt-1],at=lo(At.color),mt=v.value[yt],St=lo(mt.color),Tt=[];for(let Yt=0;Yt<3;Yt+=1)Tt.push(at[Yt]+(St[Yt]-at[Yt])*ht.x);const jt=mt.offset-ht.x-(ht.x-At.offset)>0?at[3]:St[3],Dt=cc(...Tt,jt);r.value={color:Dt,offset:ht.x},v.value.splice(yt,0,r.value)}function j(ht){if(!S)return;r.value.offset=ht.x,v.value.sort((At,at)=>At.offset-at.offset);const yt=us(A.value,v.value);B(yt)}function K(){S=!1}C=ki(u.value,{onmousemove:it,onmouseup:it});function it(ht){q();const yt=ht.x*100,At=ht.y*100;f.s=Math.round(yt),f.l=Math.round(100-At),d.value.style.left=`${yt}%`,d.value.style.top=`${At}%`}w=ki(p.value,{onmousemove:tt,onmouseup:tt});function tt(ht){q(),f.h=ht.x*360,h.value.style.left=`${ht.x*100}%`}b=ki(y.value,{onmousemove:ct,onmouseup:ct});function ct(ht){q(),f.a=ht.x,m.value.style.left=`${ht.x*100}%`}D(g.value),x(n.value)})}de(()=>{C==null||C.destroy(),w==null||w.destroy(),b==null||b.destroy(),V(),_&&_.destroy()});function x(U){g.value==="纯色"?R.color=U:g.value==="渐变"?R.gradient=U:g.value==="图案"&&(R.image=U)}function B(U){U!==n.value&&(x(U),o("update:value",U),o("change",{mode:g.value,color:U,angle:Number(A.value),stops:v.value}))}function k(U){return _t(this,null,function*(){if(U===g.value)return;g.value=U;let j;U==="纯色"?j=R.color:U==="渐变"?j=R.gradient:U==="图案"&&(j=R.image),B(j)})}function D(U){U==="纯色"?I(n.value):U==="渐变"&&(v.value.length===0?n.value.match(/[^,]+/g).forEach((j,K)=>{if(K===0){A.value=Number(j.match(/\d+/)[0]);return}let[it,tt]=j.trim().split(" ");it.startsWith("#")||(it=cc(it)),tt=tt.match(/\d+/)[0]/100,v.value.push({color:it,offset:tt}),r.value=v.value[0]}):I(r.value.color))}function Y(U){var j;i.value=`hsl(${f.h}, 100%, 50%)`,c.value=U.slice(0,7),c.value,l.value=Math.round(((j=f.a)!=null?j:1)*100)}function I(U){if(F){const j=bx(U);f.h=j[0],f.s=j[1],f.l=j[2],f.a=j[3],Y(U);let K=f.s;const it=Math.round(100-f.l);d.value.style.left=`${K}%`,d.value.style.top=`${it}%`,K=f.h/360,h.value.style.left=`${K*100}%`,m.value.style.left=`${f.a*100}%`}}function E(U){S=!0,r.value=U}function P(U){if(U.stopPropagation(),U.preventDefault(),!["Backspace","Delete"].includes(U.key)||v.value.length===2)return;const j=v.value.indexOf(r.value);v.value.splice(j,1),r.value=v.value[0]}function N(U){if(/^#(?:[0-9a-f]{3}){1,2}$/i.test(U)){const j=ao(U),[K,it,tt]=zh(...j);f.h=K,f.s=it,f.l=tt,d.value.style.left=`${f.s}%`,d.value.style.top=`${100-f.l}%`,h.value.style.left=`${f.h/360*100}%`,c.value=U}}function q(){F=!1,$&&clearTimeout($),$=setTimeout(()=>{F=!0},16)}function J(U){return _t(this,null,function*(){let j="";if(U&&U.target.value){const K=U.target.value;j=K+(K.length===7?"ff":"")}else{const K=new window.EyeDropper;Sx("按Esc可退出");try{j=(yield K.open()).sRGBHex+"ff"}catch(it){console.log("用户取消了取色")}}g.value==="渐变"?(r.value.color=j,r.value=pt({},r.value)):o("update:value",j),o("native-pick",j)})}const rt=U=>{const j=lt(U.target.value);o("blur",j),o("update:value",j)};function lt(U){let j=U.replace(/\s/g,"");return U.startsWith("#")||(j="#"+j),j.length<9&&(j=j.padEnd(9,"f")),j}function dt(){B(us(A.value,v.value))}return(U,j)=>(Z(),ut("div",Vx,[e.modes.length>1?(Z(),wt(Mx,{key:0,value:T(g),"onUpdate:value":k},{default:L(()=>[(Z(!0),ut(Pt,null,Gt(e.modes,K=>(Z(),wt(Ux,{key:K,label:K},null,8,["label"]))),128))]),_:1},8,["value"])):(Z(),ut("div",Wx,gt(T(g)),1)),T(H)?Ae((Z(),ut("div",Xx,[M("div",Jx,[M("div",{ref_key:"elGradientTrack",ref:s,class:"cpgb__track",style:me([{width:"100%"},{background:e.value}])},[(Z(!0),ut(Pt,null,Gt(T(v),(K,it)=>(Z(),ut("div",{key:it,class:Xt(["cpgb__pointer",{"cpgb__pointer--active":K===T(r)}]),"data-sort":it,style:me({left:`${K.offset*100}%`,background:K.color}),tabindex:"-1",onMousedown:tt=>E(K),onKeydown:ff(P,["stop"])},null,46,Kx))),128))],4)]),O(Yx,{modelValue:T(A),"onUpdate:modelValue":j[0]||(j[0]=K=>Vt(A)?A.value=K:null),onChange:dt},null,8,["modelValue"])],512)),[[we,T(g)==="渐变"]]):Ct("",!0),M("div",{ref_key:"elPalette",ref:u,class:"cp__palette",style:me({background:T(i)})},[qx,Zx,M("div",{ref_key:"elPalettePointer",ref:d,class:"cpp__pointer"},null,512)],4),M("div",{ref_key:"elSliderHux",ref:p,class:"cp__slider cp__slider-hux"},[M("div",tB,[M("div",{ref_key:"elSliderHuxPointer",ref:h,class:"cpst__pointer"},null,512)])],512),M("div",{ref_key:"elSliderAlpha",ref:y,class:"cp__slider cp__slider-alpha"},[M("div",{class:"cpsa__background",style:me(T(W))},null,4),M("div",eB,[M("div",{ref_key:"elSliderAlphaPointer",ref:m,class:"cpst__pointer"},null,512)])],512),M("div",nB,[M("div",{class:"item",onClick:J},[a?(Z(),wt($x,{key:0})):(Z(),ut("input",{key:1,class:"native",type:"color",onInput:J},null,32))]),T(g)==="渐变"?(Z(),ut("input",{key:0,class:"input",value:T(r).color},null,8,iB)):(Z(),ut("input",{key:1,value:e.value,class:"input",onBlur:rt},null,40,rB)),T(g)==="纯色"?(Z(!0),ut(Pt,{key:2},Gt(T(Q),K=>(Z(),ut("div",{key:K,class:"item item-color",style:me({background:K}),onClick:it=>J({target:{value:K}})},null,12,sB))),128)):Ct("",!0)])]))}}),lB=xt(aB,[["__scopeId","data-v-31f3c419"]]);const cB=e=>(te("data-v-1405be5b"),e=e(),ee(),e),uB={key:0,class:"box attr-item-box"},hB=cB(()=>M("h4",null,"颜色",-1)),fB={class:"bg-item"},dB=bt({name:"AttrBute"}),gB=Object.assign(dB,{setup(e){const t=ye(),{fabric:n,mixinState:o,canvasEditor:g}=kt(),A="gradientAngle",v=zt({fill:"#ffffffff"}),f=s=>{const u=g.canvas.getActiveObject();if(!(s&&s.target&&s.target!==u)&&u){console.log(u.type);const d=u.get("fill");typeof d=="string"?v.fill=d:(console.log(d),v.fill=l(d,u))}},i=s=>{const u=g.canvas.getActiveObjects()[0];if(u){const d=String(s.color).replace("NaN","");if(s.mode==="纯色")u.set("fill",d);else if(s.mode==="渐变"){const h=r(df(s.stops),u.width,u.height,s.angle);u.set("fill",h,s.angle),u.set(A,s.angle)}g.canvas.renderAll()}},c=s=>{i(s)},l=(s,u)=>{if(!s)return;const d=u.get(A,s.degree),h=s.colorStops.map(p=>p.color+" "+p.offset*100+"%");return`linear-gradient(${d}deg, ${h})`},r=(s,u,d,h)=>{const m=(y=>{const _=-parseInt(y,10)*(Math.PI/180);return{x1:Math.round(50+Math.sin(_)*50)/100,y1:Math.round(50+Math.cos(_)*50)/100,x2:Math.round(50+Math.sin(_+Math.PI)*50)/100,y2:Math.round(50+Math.cos(_+Math.PI)*50)/100}})(h);return new n.Gradient({type:"linear",gradientUnits:"pencentage",coords:{x1:m.x1*u,y1:m.y1*d,x2:m.x2*u,y2:m.y2*d},colorStops:[...s]})},a=()=>{var s;(s=t==null?void 0:t.proxy)==null||s.$forceUpdate()};return Qt(()=>{f(),g.on("selectCancel",a),g.on("selectOne",f),g.canvas.on("object:modified",f)}),de(()=>{g.off("selectCancel",a),g.off("selectOne",f),g.canvas.off("object:modified",f)}),(s,u)=>{const d=z("Divider"),h=z("Tooltip");return T(o).mSelectMode==="one"&&T(o).mSelectOneType!=="image"&&T(o).mSelectOneType!=="group"?(Z(),ut("div",uB,[O(d,{plain:"",orientation:"left"},{default:L(()=>[hB]),_:1}),M("div",fB,[O(h,{placement:"top",theme:"light"},{content:L(()=>[O(T(lB),{value:T(v).fill,"onUpdate:value":u[0]||(u[0]=p=>T(v).fill=p),modes:["渐变","纯色"],onChange:i,onNativePick:c},null,8,["value"])]),default:L(()=>[M("div",{class:"color-bar",style:me({background:T(v).fill})},null,4)]),_:1})])])):Ct("",!0)}}}),pB=xt(gB,[["__scopeId","data-v-1405be5b"]]),{SelectEvent:Sn,SelectMode:Di}=op;function AB(e){const t=zt({mSelectMode:Di.EMPTY,mSelectOneType:"",mSelectId:"",mSelectIds:[],mSelectActive:[]}),n=A=>{t.mSelectMode=Di.ONE,A[0]&&(t.mSelectId=A[0].id,t.mSelectOneType=A[0].type,t.mSelectIds=A.map(v=>v.id))},o=A=>{t.mSelectMode=Di.MULTI,t.mSelectId="",t.mSelectIds=A.map(v=>v.id)},g=()=>{t.mSelectId="",t.mSelectIds=[],t.mSelectMode=Di.EMPTY,t.mSelectOneType=""};return Qt(()=>{e.on(Sn.ONE,n),e.on(Sn.MULTI,o),e.on(Sn.CANCEL,g)}),gf(()=>{e.off(Sn.ONE,n),e.off(Sn.MULTI,o),e.off(Sn.CANCEL,g)}),{mixinState:t}}const mB=bt({__name:"edit",setup(e){const{mixinState:t,canvasEditor:n}=kt(),o=()=>{var A;const g=(A=n.fabricCanvas)==null?void 0:A.getActiveObject();g&&g.type==="polygon"?n.activeEdit():Bt.Message.warning("请检查选择polygon")};return(g,A)=>{const v=z("Button"),f=z("Tooltip");return T(t).mSelectOneType==="polygon"?(Z(),wt(f,{key:0,content:g.$t("quick.editPoly")},{default:L(()=>[O(v,{long:"",onClick:o,icon:"md-brush",type:"text"})]),_:1},8,["content"])):Ct("",!0)}}});const Vh=e=>(te("data-v-81119bbe"),e=e(),ee(),e),vB={key:0,class:"box attr-item-box"},yB=Vh(()=>M("h4",null,"文本内容",-1)),_B=Vh(()=>M("h4",null,"文本路径",-1)),CB={class:"ivu-col__box"},wB={class:"label"},bB={class:"content"},SB=bt({name:"AttrBute"}),EB=Object.assign(SB,{setup(e){const t=ye(),{mixinState:n,canvasEditor:o}=kt(),g=zt({text:"",strokeWidth:1,stroke:"",showPathAttr:!1}),A=i=>{const c=o.canvas.getActiveObject();if(!(i&&i.target&&i.target!==c)&&c){g.text=c.get("text");const l=c.get("path");l?(g.strokeWidth=l.strokeWidth,g.stroke=l.stroke,g.showPathAttr=!0):g.showPathAttr=!1}},v=(i,c)=>{const l=o.canvas.getActiveObjects()[0];l&&(g[i]=c,i==="text"?l.set(i,c):l.get("path").set(i,c),o.canvas.renderAll())},f=()=>{var i;(i=t==null?void 0:t.proxy)==null||i.$forceUpdate()};return Qt(()=>{o.on("selectCancel",f),o.on("selectOne",A),o.canvas.on("object:modified",A)}),de(()=>{o.off("selectCancel",f),o.off("selectOne",A),o.canvas.off("object:modified",A)}),(i,c)=>{const l=z("Divider"),r=z("Input"),a=z("FormItem"),s=z("Form"),u=z("ColorPicker"),d=z("Col"),h=z("Row");return T(n).mSelectMode==="one"&&T(n).mSelectOneType==="text"?(Z(),ut("div",vB,[O(l,{plain:"",orientation:"left"},{default:L(()=>[yB]),_:1}),O(s,{"label-width":40,class:"form-wrap"},{default:L(()=>[O(a,{label:i.$t("attributes.id")},{default:L(()=>[O(r,{modelValue:T(g).text,"onUpdate:modelValue":c[0]||(c[0]=p=>T(g).text=p),onOnChange:c[1]||(c[1]=p=>v("text",T(g).text)),size:"small"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),T(g).showPathAttr?(Z(),ut(Pt,{key:0},[O(l,{plain:"",orientation:"left"},{default:L(()=>[_B]),_:1}),M("div",null,[O(h,{gutter:12},{default:L(()=>[O(d,{flex:"1"},{default:L(()=>[M("div",CB,[M("span",wB,gt(i.$t("color")),1),M("div",bB,[O(u,{modelValue:T(g).stroke,"onUpdate:modelValue":c[2]||(c[2]=p=>T(g).stroke=p),onOnChange:c[3]||(c[3]=p=>v("stroke",p)),alpha:""},null,8,["modelValue"])])])]),_:1}),O(d,{flex:"1"},{default:L(()=>[O(T(Qe),{modelValue:T(g).strokeWidth,"onUpdate:modelValue":c[4]||(c[4]=p=>T(g).strokeWidth=p),onOnChange:c[5]||(c[5]=p=>v("strokeWidth",p)),append:i.$t("width"),min:0},null,8,["modelValue","append"])]),_:1})]),_:1})])],64)):Ct("",!0)])):Ct("",!0)}}}),IB=xt(EB,[["__scopeId","data-v-81119bbe"]]);const Wh=e=>(te("data-v-96d7539b"),e=e(),ee(),e),xB={class:"home"},BB={class:"logo"},TB={href:"https://github.com/nihaojob/vue-fabric-editor",target:"_blank"},OB={style:{float:"right"}},kB={class:"content"},DB={class:"left-panel"},MB={id:"workspace"},PB={class:"canvas-box"},QB=Wh(()=>M("div",{class:"inside-shadow"},null,-1)),LB={class:"right-bar"},FB={key:0,style:{"padding-top":"10px"}},RB={class:"attr-item-box"},jB=Wh(()=>M("h4",null,"快捷操作",-1)),$B={class:"bg-item"},NB=bt({name:"Home"}),UB=Object.assign(NB,{setup(e){const{t}=Ne(),n="https://www.kuaitu.cc",o=new aA,g=zt({menuActive:1,show:!1,toolsBarShow:!0,attrBarShow:!0,select:null,ruler:!0}),A=ft("importTmpl"),v={importTmpl:O6,tools:xS,importSvgEl:PS,fontStyle:F6,layer:tI,myMaterial:eS},f=ft([{key:"importTmpl",name:t("templates"),icon:"md-book"},{key:"tools",name:t("elements"),icon:"md-images"},{key:"fontStyle",name:t("font_style"),icon:"ios-pulse"},{key:"importSvgEl",name:t("material.cartoon"),icon:"ios-leaf-outline"},{key:"layer",name:t("layers"),icon:"md-reorder"},{key:"myMaterial",name:t("mymaterial"),icon:"ios-contact-outline"}]);Qt(()=>{const s=new nt.fabric.Canvas("canvas",{fireRightClick:!0,stopContextMenu:!0,controlsAboveOverlay:!0,imageSmoothingEnabled:!1,preserveObjectStacking:!0});o.init(s),o.use(ji),o.use(Yi),o.use($i),o.use(mu),o.use(_s),o.use(Cs),o.use(ws),o.use(vu),o.use(bs),o.use(Ss),o.use(Es),o.use(yu),o.use(Is),o.use(Ui),o.use(Hi),o.use(Ms),o.use(Qs),o.use(Ys),o.use(Vs),o.use(Ws),o.use(zs,{repoSrc:n}),o.use(Hs,{repoSrc:n}),o.use(Gs),o.use(so),g.show=!0,g.ruler&&o.rulerEnable()}),dc(()=>o.destory());const i=s=>{s?o.rulerEnable():o.rulerDisable()},c=()=>{g.toolsBarShow=!g.toolsBarShow},l=s=>{A.value=s,g.toolsBarShow=!0},r=()=>{g.attrBarShow=!g.attrBarShow},{mixinState:a}=AB(o);return Br("fabric",nt.fabric),Br("canvasEditor",o),Br("mixinState",a),(s,u)=>{const d=z("Icon"),h=z("Divider"),p=z("iSwitch"),m=z("Tooltip"),y=z("Header"),_=z("MenuItem"),C=z("Menu"),w=z("Content"),b=z("Layout");return Z(),ut("div",xB,[O(b,null,{default:L(()=>[T(g).show?(Z(),wt(y,{key:0},{default:L(()=>[M("span",BB,[M("a",TB,[O(d,{type:"logo-github",size:30})])]),O(hg),O(h,{type:"vertical"}),O(Lw),O(h,{type:"vertical"}),O(tb),O(m,{content:s.$t("grid")},{default:L(()=>[O(p,{modelValue:T(g).ruler,"onUpdate:modelValue":u[0]||(u[0]=S=>T(g).ruler=S),onOnChange:i,size:"small",class:"switch"},null,8,["modelValue"])]),_:1},8,["content"]),O(h,{type:"vertical"}),O($E),M("div",OB,[O(T(pb)),O(f6),O(yb),O(T(m6)),O(Cb)])]),_:1})):Ct("",!0),O(w,{style:{display:"flex",height:"calc(100vh - 64px)"}},{default:L(()=>[T(g).show?(Z(),ut("div",{key:0,class:Xt(`left-bar ${T(g).toolsBarShow&&"show-tools-bar"}`)},[O(C,{"active-name":T(A),accordion:"",onOnSelect:l,width:"65px"},{default:L(()=>[(Z(!0),ut(Pt,null,Gt(T(f),S=>(Z(),wt(_,{key:S.key,name:S.key,class:"menu-item"},{default:L(()=>[O(d,{type:S.icon,size:"24"},null,8,["type"]),M("div",null,gt(S.name),1)]),_:2},1032,["name"]))),128))]),_:1},8,["active-name"]),Ae(M("div",kB,[M("div",DB,[(Z(),wt(Af,null,[(Z(),wt(pf(v[T(A)])))],1024))])],512),[[we,T(g).toolsBarShow]]),M("div",{class:Xt(`close-btn left-btn ${T(g).toolsBarShow&&"left-btn-open"}`),onClick:c},null,2)],2)):Ct("",!0),M("div",MB,[M("div",PB,[QB,M("canvas",{id:"canvas",class:Xt(T(g).ruler?"design-stage-grid":"")},null,2),T(g).show?(Z(),wt(Hb,{key:0})):Ct("",!0),O(Fb)])]),Ae(M("div",LB,[T(g).show?(Z(),ut("div",FB,[Ae(M("div",null,[O(YS),O(US)],512),[[we,!T(a).mSelectMode]]),Ae(M("div",null,[O(sc),O(Jw),O(rc)],512),[[we,T(a).mSelectMode==="multiple"]]),Ae(M("div",RB,[O(sc),O(h,{plain:"",orientation:"left"},{default:L(()=>[jB]),_:1}),Ae(M("div",$B,[O(Yb),O(Wb),O(bb),O(Eb),O(mB)],512),[[we,T(a).mSelectMode]]),O(rc),O(KS),O(gb),O(mE),O(LE),O(pB),O(vx),O(IB),O(mI),O(DI),O(GI),O(bI)],512),[[we,T(a).mSelectMode==="one"]])])):Ct("",!0)],512),[[we,T(g).attrBarShow]]),M("div",{class:Xt(`close-btn right-btn ${T(g).attrBarShow&&"right-btn-open"}`),onClick:r},null,2)]),_:1})]),_:1})])}}}),VB=xt(UB,[["__scopeId","data-v-96d7539b"]]);export{VB as default};
